(()=>{function t(i){var r=n[i];if(void 0!==r)return r.exports;var o=n[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var e={8718:t=>{"use strict";function e(){}function n(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,i,r,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new n(i,r||t,o),l=a?a+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function r(t,n){0==--t._eventsCount?t._events=new e:delete t._events[n]}function o(){this._events=new e,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(e.prototype=Object.create(null),(new e).__proto__||(a=!1)),o.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)s.call(t,e)&&n.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var e=a?a+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,r=n.length,o=new Array(r);i<r;i++)o[i]=n[i].fn;return o},o.prototype.listenerCount=function(t){var e=a?a+t:t,n=this._events[e];return n?n.fn?1:n.length:0},o.prototype.emit=function(t,e,n,i,r,o){var s=a?a+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,r),!0;case 6:return c.fn.call(c.context,e,n,i,r,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},o.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},o.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},o.prototype.removeListener=function(t,e,n,i){var o=a?a+t:t;if(!this._events[o])return this;if(!e)return r(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||n&&s.context!==n||r(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||i&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:r(this,o)}return this},o.prototype.removeAllListeners=function(t){var n;return t?(n=a?a+t:t,this._events[n]&&r(this,n)):(this._events=new e,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=a,o.EventEmitter=o,t.exports=o},5654:function(t,e,n){!function(e){"use strict";function n(t,e,n,o){var s=e&&e.prototype instanceof r?e:r,a=Object.create(s.prototype),l=new d(o||[]);return a._invoke=function(t,e,n){var r=S;return function(o,s){if(r===M)throw new Error("Generator is already running");if(r===T){if("throw"===o)throw s;return f()}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var l=u(a,n);if(l){if(l===E)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===S)throw r=T,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=M;var c=i(t,e,n);if("normal"===c.type){if(r=n.done?T:A,c.arg===E)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=T,n.method="throw",n.arg=c.arg)}}}(t,n,l),a}function i(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function r(){}function o(){}function s(){}function a(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function l(t){function n(e,r,o,s){var a=i(t[e],t,r);if("throw"!==a.type){var l=a.arg,u=l.value;return u&&"object"==typeof u&&y.call(u,"__await")?Promise.resolve(u.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):Promise.resolve(u).then((function(t){l.value=t,o(l)}),s)}s(a.arg)}var r;"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(t,e){function i(){return new Promise((function(i,r){n(t,e,i,r)}))}return r=r?r.then(i,i):i()}}function u(t,e){var n=t.iterator[e.method];if(n===m){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=m,u(t,e),"throw"===e.method))return E;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var r=i(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,E;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=m),e.delegate=null,E):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,E)}function c(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(c,this),this.reset(!0)}function p(t){if(t){var e=t[x];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(y.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=m,e.done=!0,e};return i.next=i}}return{next:f}}function f(){return{value:m,done:!0}}var m,g=Object.prototype,y=g.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},x=v.iterator||"@@iterator",b=v.asyncIterator||"@@asyncIterator",_=v.toStringTag||"@@toStringTag",w=e.regeneratorRuntime;if(w)t.exports=w;else{(w=e.regeneratorRuntime=t.exports).wrap=n;var S="suspendedStart",A="suspendedYield",M="executing",T="completed",E={},P={};P[x]=function(){return this};var C=Object.getPrototypeOf,I=C&&C(C(p([])));I&&I!==g&&y.call(I,x)&&(P=I);var R=s.prototype=r.prototype=Object.create(P);o.prototype=R.constructor=s,s.constructor=o,s[_]=o.displayName="GeneratorFunction",w.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},w.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(R),t},w.awrap=function(t){return{__await:t}},a(l.prototype),l.prototype[b]=function(){return this},w.AsyncIterator=l,w.async=function(t,e,i,r){var o=new l(n(t,e,i,r));return w.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},a(R),R[_]="Generator",R[x]=function(){return this},R.toString=function(){return"[object Generator]"},w.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},w.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&y.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=m)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,i){return o.type="throw",o.arg=t,n.next=e,i&&(n.method="next",n.arg=m),!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var s=y.call(r,"catchLoc"),a=y.call(r,"finallyLoc");if(s&&a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&y.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,E):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),E},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),E}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;h(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:p(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=m),E}}}}("object"==typeof n.g?n.g:"object"==typeof window?window:"object"==typeof self?self:this)},7694:(t,e,n)=>{n(1761),t.exports=n(5645).RegExp.escape},4963:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},3365:(t,e,n)=>{var i=n(2032);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=i(t))throw TypeError(e);return+t}},7722:(t,e,n)=>{var i=n(6314)("unscopables"),r=Array.prototype;null==r[i]&&n(7728)(r,i,{}),t.exports=function(t){r[i][t]=!0}},6793:(t,e,n)=>{"use strict";var i=n(4496)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},3328:t=>{t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},7007:(t,e,n)=>{var i=n(5286);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},5216:(t,e,n)=>{"use strict";var i=n(508),r=n(2337),o=n(875);t.exports=[].copyWithin||function(t,e){var n=i(this),s=o(n.length),a=r(t,s),l=r(e,s),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?s:r(u,s))-l,s-a),h=1;for(l<a&&a<l+c&&(h=-1,l+=c-1,a+=c-1);c-- >0;)l in n?n[a]=n[l]:delete n[a],a+=h,l+=h;return n}},6852:(t,e,n)=>{"use strict";var i=n(508),r=n(2337),o=n(875);t.exports=function(t){for(var e=i(this),n=o(e.length),s=arguments.length,a=r(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,u=void 0===l?n:r(l,n);u>a;)e[a++]=t;return e}},9490:(t,e,n)=>{var i=n(3531);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},9315:(t,e,n)=>{var i=n(2110),r=n(875),o=n(2337);t.exports=function(t){return function(e,n,s){var a,l=i(e),u=r(l.length),c=o(s,u);if(t&&n!=n){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},50:(t,e,n)=>{var i=n(741),r=n(9797),o=n(508),s=n(875),a=n(6886);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,h=6==t,d=5==t||h,p=e||a;return function(e,a,f){for(var m,g,y=o(e),v=r(y),x=i(a,f,3),b=s(v.length),_=0,w=n?p(e,b):l?p(e,0):void 0;b>_;_++)if((d||_ in v)&&(g=x(m=v[_],_,y),t))if(n)w[_]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return _;case 2:w.push(m)}else if(c)return!1;return h?-1:u||c?c:w}}},7628:(t,e,n)=>{var i=n(4963),r=n(508),o=n(9797),s=n(875);t.exports=function(t,e,n,a,l){i(e);var u=r(t),c=o(u),h=s(u.length),d=l?h-1:0,p=l?-1:1;if(n<2)for(;;){if(d in c){a=c[d],d+=p;break}if(d+=p,l?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;l?d>=0:h>d;d+=p)d in c&&(a=e(a,c[d],d,u));return a}},2736:(t,e,n)=>{var i=n(5286),r=n(4302),o=n(6314)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},6886:(t,e,n)=>{var i=n(2736);t.exports=function(t,e){return new(i(t))(e)}},4398:(t,e,n)=>{"use strict";var i=n(4963),r=n(5286),o=n(7242),s=[].slice,a={},l=function(t,e,n){if(!(e in a)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";a[e]=Function("F,a","return new F("+i.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=s.call(arguments,1),a=function(){var i=n.concat(s.call(arguments));return this instanceof a?l(e,i.length,i):o(e,i,t)};return r(e.prototype)&&(a.prototype=e.prototype),a}},1488:(t,e,n)=>{var i=n(2032),r=n(6314)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},2032:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},9824:(t,e,n)=>{"use strict";var i=n(9275).f,r=n(2503),o=n(4408),s=n(741),a=n(3328),l=n(3531),u=n(2923),c=n(5436),h=n(2974),d=n(7057),p=n(4728).fastKey,f=n(1616),m=d?"_s":"size",g=function(t,e){var n,i=p(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t((function(t,i){a(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[m]=0,null!=i&&l(i,n,t[u],t)}));return o(c.prototype,{clear:function(){for(var t=f(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var n=f(this,e),i=g(n,t);if(i){var r=i.n,o=i.p;delete n._i[i.i],i.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==i&&(n._f=r),n._l==i&&(n._l=o),n[m]--}return!!i},forEach:function(t){f(this,e);for(var n,i=s(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(f(this,e),t)}}),d&&i(c.prototype,"size",{get:function(){return f(this,e)[m]}}),c},def:function(t,e,n){var i,r,o=g(t,e);return o?o.v=n:(t._l=o={i:r=p(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[m]++,"F"!==r&&(t._i[r]=o)),t},getEntry:g,setStrong:function(t,e,n){u(t,e,(function(t,n){this._t=f(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?c(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,c(1))}),n?"entries":"values",!n,!0),h(e)}}},6132:(t,e,n)=>{var i=n(1488),r=n(9490);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},3657:(t,e,n)=>{"use strict";var i=n(4408),r=n(4728).getWeak,o=n(7007),s=n(5286),a=n(3328),l=n(3531),u=n(50),c=n(9181),h=n(1616),d=u(5),p=u(6),f=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},y=function(t,e){return d(t.a,(function(t){return t[0]===e}))};g.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var n=y(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var u=t((function(t,i){a(t,u,e,"_i"),t._t=e,t._i=f++,t._l=void 0,null!=i&&l(i,n,t[o],t)}));return i(u.prototype,{delete:function(t){if(!s(t))return!1;var n=r(t);return!0===n?m(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=r(t);return!0===n?m(h(this,e)).has(t):n&&c(n,this._i)}}),u},def:function(t,e,n){var i=r(o(e),!0);return!0===i?m(t).set(e,n):i[t._i]=n,t},ufstore:m}},5795:(t,e,n)=>{"use strict";var i=n(3816),r=n(2985),o=n(7234),s=n(4408),a=n(4728),l=n(3531),u=n(3328),c=n(5286),h=n(4253),d=n(7462),p=n(2943),f=n(266);t.exports=function(t,e,n,m,g,y){var v=i[t],x=v,b=g?"set":"add",_=x&&x.prototype,w={},S=function(t){var e=_[t];o(_,t,"delete"==t||"has"==t?function(t){return!(y&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof x&&(y||_.forEach&&!h((function(){(new x).entries().next()})))){var A=new x,M=A[b](y?{}:-0,1)!=A,T=h((function(){A.has(1)})),E=d((function(t){new x(t)})),P=!y&&h((function(){for(var t=new x,e=5;e--;)t[b](e,e);return!t.has(-0)}));E||((x=e((function(e,n){u(e,x,t);var i=f(new v,e,x);return null!=n&&l(n,g,i[b],i),i}))).prototype=_,_.constructor=x),(T||P)&&(S("delete"),S("has"),g&&S("get")),(P||M)&&S(b),y&&_.clear&&delete _.clear}else x=m.getConstructor(e,t,g,b),s(x.prototype,n),a.NEED=!0;return p(x,t),w[t]=x,r(r.G+r.W+r.F*(x!=v),w),y||m.setStrong(x,t,g),x}},5645:t=>{var e=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e)},2811:(t,e,n)=>{"use strict";var i=n(9275),r=n(681);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},741:(t,e,n)=>{var i=n(4963);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},3537:(t,e,n)=>{"use strict";var i=n(4253),r=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(t){return t>9?t:"0"+t};t.exports=i((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!i((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=e<0?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:o},870:(t,e,n)=>{"use strict";var i=n(7007),r=n(1689),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return r(i(this),t!=o)}},1355:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},7057:(t,e,n)=>{t.exports=!n(4253)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},2457:(t,e,n)=>{var i=n(5286),r=n(3816).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},4430:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},5541:(t,e,n)=>{var i=n(7184),r=n(4548),o=n(4682);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,a=n(t),l=o.f,u=0;a.length>u;)l.call(t,s=a[u++])&&e.push(s);return e}},2985:(t,e,n)=>{var i=n(3816),r=n(5645),o=n(7728),s=n(7234),a=n(741),l="prototype",u=function(t,e,n){var c,h,d,p,f=t&u.F,m=t&u.G,g=t&u.S,y=t&u.P,v=t&u.B,x=m?i:g?i[e]||(i[e]={}):(i[e]||{})[l],b=m?r:r[e]||(r[e]={}),_=b[l]||(b[l]={});for(c in m&&(n=e),n)d=((h=!f&&x&&void 0!==x[c])?x:n)[c],p=v&&h?a(d,i):y&&"function"==typeof d?a(Function.call,d):d,x&&s(x,c,d,t&u.U),b[c]!=d&&o(b,c,p),y&&_[c]!=d&&(_[c]=d)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},8852:(t,e,n)=>{var i=n(6314)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},4253:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},8082:(t,e,n)=>{"use strict";n(8269);var i=n(7234),r=n(7728),o=n(4253),s=n(1355),a=n(6314),l=n(1165),u=a("species"),c=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=a(t),p=!o((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),f=p?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[u]=function(){return n}),n[d](""),!e})):void 0;if(!p||!f||"replace"===t&&!c||"split"===t&&!h){var m=/./[d],g=n(s,d,""[t],(function(t,e,n,i,r){return e.exec===l?p&&!r?{done:!0,value:m.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}})),y=g[0],v=g[1];i(String.prototype,t,y),r(RegExp.prototype,d,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},3218:(t,e,n)=>{"use strict";var i=n(7007);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},3325:(t,e,n)=>{"use strict";var i=n(4302),r=n(5286),o=n(875),s=n(741),a=n(6314)("isConcatSpreadable");t.exports=function t(e,n,l,u,c,h,d,p){for(var f,m,g=c,y=0,v=!!d&&s(d,p,3);y<u;){if(y in l){if(f=v?v(l[y],y,n):l[y],m=!1,r(f)&&(m=void 0!==(m=f[a])?!!m:i(f)),m&&h>0)g=t(e,n,f,o(f.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();e[g]=f}g++}y++}return g}},3531:(t,e,n)=>{var i=n(741),r=n(8851),o=n(6555),s=n(7007),a=n(875),l=n(9002),u={},c={},h=t.exports=function(t,e,n,h,d){var p,f,m,g,y=d?function(){return t}:l(t),v=i(n,h,e?2:1),x=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(p=a(t.length);p>x;x++)if((g=e?v(s(f=t[x])[0],f[1]):v(t[x]))===u||g===c)return g}else for(m=y.call(t);!(f=m.next()).done;)if((g=r(m,v,f.value,e))===u||g===c)return g};h.BREAK=u,h.RETURN=c},18:(t,e,n)=>{t.exports=n(3825)("native-function-to-string",Function.toString)},3816:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},9181:t=>{var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},7728:(t,e,n)=>{var i=n(9275),r=n(681);t.exports=n(7057)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},639:(t,e,n)=>{var i=n(3816).document;t.exports=i&&i.documentElement},1734:(t,e,n)=>{t.exports=!n(7057)&&!n(4253)((function(){return 7!=Object.defineProperty(n(2457)("div"),"a",{get:function(){return 7}}).a}))},266:(t,e,n)=>{var i=n(5286),r=n(7375).set;t.exports=function(t,e,n){var o,s=e.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&i(o)&&r&&r(t,o),t}},7242:t=>{t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},9797:(t,e,n)=>{var i=n(2032);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},6555:(t,e,n)=>{var i=n(2803),r=n(6314)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},4302:(t,e,n)=>{var i=n(2032);t.exports=Array.isArray||function(t){return"Array"==i(t)}},8367:(t,e,n)=>{var i=n(5286),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},5286:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},5364:(t,e,n)=>{var i=n(5286),r=n(2032),o=n(6314)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},8851:(t,e,n)=>{var i=n(7007);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},9988:(t,e,n)=>{"use strict";var i=n(2503),r=n(681),o=n(2943),s={};n(7728)(s,n(6314)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},2923:(t,e,n)=>{"use strict";var i=n(4461),r=n(2985),o=n(7234),s=n(7728),a=n(2803),l=n(9988),u=n(2943),c=n(468),h=n(6314)("iterator"),d=!([].keys&&"next"in[].keys()),p="keys",f="values",m=function(){return this};t.exports=function(t,e,n,g,y,v,x){l(n,e,g);var b,_,w,S=function(t){if(!d&&t in E)return E[t];switch(t){case p:case f:return function(){return new n(this,t)}}return function(){return new n(this,t)}},A=e+" Iterator",M=y==f,T=!1,E=t.prototype,P=E[h]||E["@@iterator"]||y&&E[y],C=P||S(y),I=y?M?S("entries"):C:void 0,R="Array"==e&&E.entries||P;if(R&&(w=c(R.call(new t)))!==Object.prototype&&w.next&&(u(w,A,!0),i||"function"==typeof w[h]||s(w,h,m)),M&&P&&P.name!==f&&(T=!0,C=function(){return P.call(this)}),i&&!x||!d&&!T&&E[h]||s(E,h,C),a[e]=C,a[A]=m,y)if(b={values:M?C:S(f),keys:v?C:S(p),entries:I},x)for(_ in b)_ in E||o(E,_,b[_]);else r(r.P+r.F*(d||T),e,b);return b}},7462:(t,e,n)=>{var i=n(6314)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],s=o[i]();s.next=function(){return{done:n=!0}},o[i]=function(){return s},t(o)}catch(t){}return n}},5436:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},2803:t=>{t.exports={}},4461:t=>{t.exports=!1},3086:t=>{var e=Math.expm1;t.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||-2e-17!=e(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:e},4934:(t,e,n)=>{var i=n(1801),r=Math.pow,o=r(2,-52),s=r(2,-23),a=r(2,127)*(2-s),l=r(2,-126);t.exports=Math.fround||function(t){var e,n,r=Math.abs(t),u=i(t);return r<l?u*(r/l/s+1/o-1/o)*l*s:(n=(e=(1+s/o)*r)-(e-r))>a||n!=n?u*(1/0):u*n}},6206:t=>{t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},8757:t=>{t.exports=Math.scale||function(t,e,n,i,r){return 0===arguments.length||t!=t||e!=e||n!=n||i!=i||r!=r?NaN:t===1/0||t===-1/0?t:(t-e)*(r-i)/(n-e)+i}},1801:t=>{t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},4728:(t,e,n)=>{var i=n(3953)("meta"),r=n(5286),o=n(9181),s=n(9275).f,a=0,l=Object.isExtensible||function(){return!0},u=!n(4253)((function(){return l(Object.preventExtensions({}))})),c=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[i].i},getWeak:function(t,e){if(!o(t,i)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[i].w},onFreeze:function(t){return u&&h.NEED&&l(t)&&!o(t,i)&&c(t),t}}},133:(t,e,n)=>{var i=n(8416),r=n(2985),o=n(3825)("metadata"),s=o.store||(o.store=new(n(147))),a=function(t,e,n){var r=s.get(t);if(!r){if(!n)return;s.set(t,r=new i)}var o=r.get(e);if(!o){if(!n)return;r.set(e,o=new i)}return o};t.exports={store:s,map:a,has:function(t,e,n){var i=a(e,n,!1);return void 0!==i&&i.has(t)},get:function(t,e,n){var i=a(e,n,!1);return void 0===i?void 0:i.get(t)},set:function(t,e,n,i){a(n,i,!0).set(t,e)},keys:function(t,e){var n=a(t,e,!1),i=[];return n&&n.forEach((function(t,e){i.push(e)})),i},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){r(r.S,"Reflect",t)}}},4351:(t,e,n)=>{var i=n(3816),r=n(4193).set,o=i.MutationObserver||i.WebKitMutationObserver,s=i.process,a=i.Promise,l="process"==n(2032)(s);t.exports=function(){var t,e,n,u=function(){var i,r;for(l&&(i=s.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(l)n=function(){s.nextTick(u)};else if(!o||i.navigator&&i.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);n=function(){c.then(u)}}else n=function(){r.call(i,u)};else{var h=!0,d=document.createTextNode("");new o(u).observe(d,{characterData:!0}),n=function(){d.data=h=!h}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},3499:(t,e,n)=>{"use strict";function i(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=r(e),this.reject=r(n)}var r=n(4963);t.exports.f=function(t){return new i(t)}},5345:(t,e,n)=>{"use strict";var i=n(7057),r=n(7184),o=n(4548),s=n(4682),a=n(508),l=n(9797),u=Object.assign;t.exports=!u||n(4253)((function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=i}))?function(t,e){for(var n=a(t),u=arguments.length,c=1,h=o.f,d=s.f;u>c;)for(var p,f=l(arguments[c++]),m=h?r(f).concat(h(f)):r(f),g=m.length,y=0;g>y;)p=m[y++],i&&!d.call(f,p)||(n[p]=f[p]);return n}:u},2503:(t,e,n)=>{var i=n(7007),r=n(5588),o=n(4430),s=n(9335)("IE_PROTO"),a=function(){},l="prototype",u=function(){var t,e=n(2457)("iframe"),i=o.length;for(e.style.display="none",n(639).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;i--;)delete u[l][o[i]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(a[l]=i(t),n=new a,a[l]=null,n[s]=t):n=u(),void 0===e?n:r(n,e)}},9275:(t,e,n)=>{var i=n(7007),r=n(1734),o=n(1689),s=Object.defineProperty;e.f=n(7057)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},5588:(t,e,n)=>{var i=n(9275),r=n(7007),o=n(7184);t.exports=n(7057)?Object.defineProperties:function(t,e){r(t);for(var n,s=o(e),a=s.length,l=0;a>l;)i.f(t,n=s[l++],e[n]);return t}},1670:(t,e,n)=>{"use strict";t.exports=n(4461)||!n(4253)((function(){var t=Math.random();__defineSetter__.call(null,t,(function(){})),delete n(3816)[t]}))},8693:(t,e,n)=>{var i=n(4682),r=n(681),o=n(2110),s=n(1689),a=n(9181),l=n(1734),u=Object.getOwnPropertyDescriptor;e.f=n(7057)?u:function(t,e){if(t=o(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},9327:(t,e,n)=>{var i=n(2110),r=n(616).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return r(t)}catch(t){return s.slice()}}(t):r(i(t))}},616:(t,e,n)=>{var i=n(189),r=n(4430).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},4548:(t,e)=>{e.f=Object.getOwnPropertySymbols},468:(t,e,n)=>{var i=n(9181),r=n(508),o=n(9335)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},189:(t,e,n)=>{var i=n(9181),r=n(2110),o=n(9315)(!1),s=n(9335)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),l=0,u=[];for(n in a)n!=s&&i(a,n)&&u.push(n);for(;e.length>l;)i(a,n=e[l++])&&(~o(u,n)||u.push(n));return u}},7184:(t,e,n)=>{var i=n(189),r=n(4430);t.exports=Object.keys||function(t){return i(t,r)}},4682:(t,e)=>{e.f={}.propertyIsEnumerable},3160:(t,e,n)=>{var i=n(2985),r=n(5645),o=n(4253);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*o((function(){n(1)})),"Object",s)}},1131:(t,e,n)=>{var i=n(7057),r=n(7184),o=n(2110),s=n(4682).f;t.exports=function(t){return function(e){for(var n,a=o(e),l=r(a),u=l.length,c=0,h=[];u>c;)n=l[c++],i&&!s.call(a,n)||h.push(t?[n,a[n]]:a[n]);return h}}},7643:(t,e,n)=>{var i=n(616),r=n(4548),o=n(7007),s=n(3816).Reflect;t.exports=s&&s.ownKeys||function(t){var e=i.f(o(t)),n=r.f;return n?e.concat(n(t)):e}},7743:(t,e,n)=>{var i=n(3816).parseFloat,r=n(9599).trim;t.exports=1/i(n(4644)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},5960:(t,e,n)=>{var i=n(3816).parseInt,r=n(9599).trim,o=n(4644),s=/^[-+]?0[xX]/;t.exports=8!==i(o+"08")||22!==i(o+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(s.test(n)?16:10))}:i},188:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},94:(t,e,n)=>{var i=n(7007),r=n(5286),o=n(3499);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},681:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},4408:(t,e,n)=>{var i=n(7234);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},7234:(t,e,n)=>{var i=n(3816),r=n(7728),o=n(9181),s=n(3953)("src"),a=n(18),l="toString",u=(""+a).split(l);n(5645).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,n,a){var l="function"==typeof n;l&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(l&&(o(n,s)||r(n,s,t[e]?""+t[e]:u.join(String(e)))),t===i?t[e]=n:a?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,l,(function(){return"function"==typeof this&&this[s]||a.call(this)}))},7787:(t,e,n)=>{"use strict";var i=n(1488),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},1165:(t,e,n)=>{"use strict";var i,r,o=n(3218),s=RegExp.prototype.exec,a=String.prototype.replace,l=s,u="lastIndex",c=(i=/a/,r=/b*/g,s.call(i,"a"),s.call(r,"a"),0!==i[u]||0!==r[u]),h=void 0!==/()??/.exec("")[1];(c||h)&&(l=function(t){var e,n,i,r,l=this;return h&&(n=new RegExp("^"+l.source+"$(?!\\s)",o.call(l))),c&&(e=l[u]),i=s.call(l,t),c&&i&&(l[u]=l.global?i.index+i[0].length:e),h&&i&&i.length>1&&a.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i}),t.exports=l},5496:t=>{t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},7195:t=>{t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},1024:(t,e,n)=>{"use strict";var i=n(2985),r=n(4963),o=n(741),s=n(3531);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,a,l=arguments[1];return r(this),(e=void 0!==l)&&r(l),null==t?new this:(n=[],e?(i=0,a=o(l,arguments[2],2),s(t,!1,(function(t){n.push(a(t,i++))}))):s(t,!1,n.push,n),new this(n))}})}},4881:(t,e,n)=>{"use strict";var i=n(2985);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},7375:(t,e,n)=>{var i=n(5286),r=n(7007),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(741)(Function.call,n(8693).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},2974:(t,e,n)=>{"use strict";var i=n(3816),r=n(9275),o=n(7057),s=n(6314)("species");t.exports=function(t){var e=i[t];o&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},2943:(t,e,n)=>{var i=n(9275).f,r=n(9181),o=n(6314)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},9335:(t,e,n)=>{var i=n(3825)("keys"),r=n(3953);t.exports=function(t){return i[t]||(i[t]=r(t))}},3825:(t,e,n)=>{var i=n(5645),r=n(3816),o="__core-js_shared__",s=r[o]||(r[o]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(4461)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},8364:(t,e,n)=>{var i=n(7007),r=n(4963),o=n(6314)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||null==(n=i(s)[o])?e:r(n)}},7717:(t,e,n)=>{"use strict";var i=n(4253);t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},4496:(t,e,n)=>{var i=n(1467),r=n(1355);t.exports=function(t){return function(e,n){var o,s,a=String(r(e)),l=i(n),u=a.length;return l<0||l>=u?t?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===u||(s=a.charCodeAt(l+1))<56320||s>57343?t?a.charAt(l):o:t?a.slice(l,l+2):s-56320+(o-55296<<10)+65536}}},2094:(t,e,n)=>{var i=n(5364),r=n(1355);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},9395:(t,e,n)=>{var i=n(2985),r=n(4253),o=n(1355),s=/"/g,a=function(t,e,n,i){var r=String(o(t)),a="<"+e;return""!==n&&(a+=" "+n+'="'+String(i).replace(s,"&quot;")+'"'),a+">"+r+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(a),i(i.P+i.F*r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},5442:(t,e,n)=>{var i=n(875),r=n(8595),o=n(1355);t.exports=function(t,e,n,s){var a=String(o(t)),l=a.length,u=void 0===n?" ":String(n),c=i(e);if(c<=l||""==u)return a;var h=c-l,d=r.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),s?d+a:a+d}},8595:(t,e,n)=>{"use strict";var i=n(1467),r=n(1355);t.exports=function(t){var e=String(r(this)),n="",o=i(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},9599:(t,e,n)=>{var i=n(2985),r=n(1355),o=n(4253),s=n(4644),a="["+s+"]",l=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),c=function(t,e,n){var r={},a=o((function(){return!!s[t]()||"​"!="​"[t]()})),l=r[t]=a?e(h):s[t];n&&(r[n]=l),i(i.P+i.F*a,"String",r)},h=c.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=c},4644:t=>{t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},4193:(t,e,n)=>{var i,r,o,s=n(741),a=n(7242),l=n(639),u=n(2457),c=n(3816),h=c.process,d=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,m=c.Dispatch,g=0,y={},v="onreadystatechange",x=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},b=function(t){x.call(t.data)};d&&p||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++g]=function(){a("function"==typeof t?t:Function(t),e)},i(g),g},p=function(t){delete y[t]},"process"==n(2032)(h)?i=function(t){h.nextTick(s(x,t,1))}:m&&m.now?i=function(t){m.now(s(x,t,1))}:f?(o=(r=new f).port2,r.port1.onmessage=b,i=s(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):i=v in u("script")?function(t){l.appendChild(u("script"))[v]=function(){l.removeChild(this),x.call(t)}}:function(t){setTimeout(s(x,t,1),0)}),t.exports={set:d,clear:p}},2337:(t,e,n)=>{var i=n(1467),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):o(t,e)}},4843:(t,e,n)=>{var i=n(1467),r=n(875);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length!");return n}},1467:t=>{var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},2110:(t,e,n)=>{var i=n(9797),r=n(1355);t.exports=function(t){return i(r(t))}},875:(t,e,n)=>{var i=n(1467),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},508:(t,e,n)=>{var i=n(1355);t.exports=function(t){return Object(i(t))}},1689:(t,e,n)=>{var i=n(5286);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},8440:(t,e,n)=>{"use strict";if(n(7057)){var i=n(4461),r=n(3816),o=n(4253),s=n(2985),a=n(9383),l=n(1125),u=n(741),c=n(3328),h=n(681),d=n(7728),p=n(4408),f=n(1467),m=n(875),g=n(4843),y=n(2337),v=n(1689),x=n(9181),b=n(1488),_=n(5286),w=n(508),S=n(6555),A=n(2503),M=n(468),T=n(616).f,E=n(9002),P=n(3953),C=n(6314),I=n(50),R=n(9315),O=n(8364),q=n(6997),L=n(2803),D=n(7462),z=n(2974),k=n(6852),B=n(5216),F=n(9275),V=n(8693),N=F.f,U=V.f,j=r.RangeError,G=r.TypeError,H=r.Uint8Array,W="ArrayBuffer",X="Shared"+W,Y="BYTES_PER_ELEMENT",Z="prototype",Q=Array[Z],J=l.ArrayBuffer,K=l.DataView,$=I(0),tt=I(2),et=I(3),nt=I(4),it=I(5),rt=I(6),ot=R(!0),st=R(!1),at=q.values,lt=q.keys,ut=q.entries,ct=Q.lastIndexOf,ht=Q.reduce,dt=Q.reduceRight,pt=Q.join,ft=Q.sort,mt=Q.slice,gt=Q.toString,yt=Q.toLocaleString,vt=C("iterator"),xt=C("toStringTag"),bt=P("typed_constructor"),_t=P("def_constructor"),wt=a.CONSTR,St=a.TYPED,At=a.VIEW,Mt="Wrong length!",Tt=I(1,(function(t,e){return Rt(O(t,t[_t]),e)})),Et=o((function(){return 1===new H(new Uint16Array([1]).buffer)[0]})),Pt=!!H&&!!H[Z].set&&o((function(){new H(1).set({})})),Ct=function(t,e){var n=f(t);if(n<0||n%e)throw j("Wrong offset!");return n},It=function(t){if(_(t)&&St in t)return t;throw G(t+" is not a typed array!")},Rt=function(t,e){if(!_(t)||!(bt in t))throw G("It is not a typed array constructor!");return new t(e)},Ot=function(t,e){return qt(O(t,t[_t]),e)},qt=function(t,e){for(var n=0,i=e.length,r=Rt(t,i);i>n;)r[n]=e[n++];return r},Lt=function(t,e,n){N(t,e,{get:function(){return this._d[n]}})},Dt=function(t){var e,n,i,r,o,s,a=w(t),l=arguments.length,c=l>1?arguments[1]:void 0,h=void 0!==c,d=E(a);if(null!=d&&!S(d)){for(s=d.call(a),i=[],e=0;!(o=s.next()).done;e++)i.push(o.value);a=i}for(h&&l>2&&(c=u(c,arguments[2],2)),e=0,n=m(a.length),r=Rt(this,n);n>e;e++)r[e]=h?c(a[e],e):a[e];return r},zt=function(){for(var t=0,e=arguments.length,n=Rt(this,e);e>t;)n[t]=arguments[t++];return n},kt=!!H&&o((function(){yt.call(new H(1))})),Bt=function(){return yt.apply(kt?mt.call(It(this)):It(this),arguments)},Ft={copyWithin:function(t,e){return B.call(It(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return nt(It(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return k.apply(It(this),arguments)},filter:function(t){return Ot(this,tt(It(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return it(It(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return rt(It(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){$(It(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return st(It(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(It(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return pt.apply(It(this),arguments)},lastIndexOf:function(t){return ct.apply(It(this),arguments)},map:function(t){return Tt(It(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ht.apply(It(this),arguments)},reduceRight:function(t){return dt.apply(It(this),arguments)},reverse:function(){for(var t,e=this,n=It(e).length,i=Math.floor(n/2),r=0;r<i;)t=e[r],e[r++]=e[--n],e[n]=t;return e},some:function(t){return et(It(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ft.call(It(this),t)},subarray:function(t,e){var n=It(this),i=n.length,r=y(t,i);return new(O(n,n[_t]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,m((void 0===e?i:y(e,i))-r))}},Vt=function(t,e){return Ot(this,mt.call(It(this),t,e))},Nt=function(t){It(this);var e=Ct(arguments[1],1),n=this.length,i=w(t),r=m(i.length),o=0;if(r+e>n)throw j(Mt);for(;o<r;)this[e+o]=i[o++]},Ut={entries:function(){return ut.call(It(this))},keys:function(){return lt.call(It(this))},values:function(){return at.call(It(this))}},jt=function(t,e){return _(t)&&t[St]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Gt=function(t,e){return jt(t,e=v(e,!0))?h(2,t[e]):U(t,e)},Ht=function(t,e,n){return!(jt(t,e=v(e,!0))&&_(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?N(t,e,n):(t[e]=n.value,t)};wt||(V.f=Gt,F.f=Ht),s(s.S+s.F*!wt,"Object",{getOwnPropertyDescriptor:Gt,defineProperty:Ht}),o((function(){gt.call({})}))&&(gt=yt=function(){return pt.call(this)});var Wt=p({},Ft);p(Wt,Ut),d(Wt,vt,Ut.values),p(Wt,{slice:Vt,set:Nt,constructor:function(){},toString:gt,toLocaleString:Bt}),Lt(Wt,"buffer","b"),Lt(Wt,"byteOffset","o"),Lt(Wt,"byteLength","l"),Lt(Wt,"length","e"),N(Wt,xt,{get:function(){return this[St]}}),t.exports=function(t,e,n,l){var u=t+((l=!!l)?"Clamped":"")+"Array",h="get"+t,p="set"+t,f=r[u],y=f||{},v=f&&M(f),x=!f||!a.ABV,w={},S=f&&f[Z],E=function(t,n){N(t,n,{get:function(){return function(t,n){var i=t._d;return i.v[h](n*e+i.o,Et)}(this,n)},set:function(t){return function(t,n,i){var r=t._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[p](n*e+r.o,i,Et)}(this,n,t)},enumerable:!0})};x?(f=n((function(t,n,i,r){c(t,f,u,"_d");var o,s,a,l,h=0,p=0;if(_(n)){if(!(n instanceof J||(l=b(n))==W||l==X))return St in n?qt(f,n):Dt.call(f,n);o=n,p=Ct(i,e);var y=n.byteLength;if(void 0===r){if(y%e)throw j(Mt);if((s=y-p)<0)throw j(Mt)}else if((s=m(r)*e)+p>y)throw j(Mt);a=s/e}else a=g(n),o=new J(s=a*e);for(d(t,"_d",{b:o,o:p,l:s,e:a,v:new K(o)});h<a;)E(t,h++)})),S=f[Z]=A(Wt),d(S,"constructor",f)):o((function(){f(1)}))&&o((function(){new f(-1)}))&&D((function(t){new f,new f(null),new f(1.5),new f(t)}),!0)||(f=n((function(t,n,i,r){var o;return c(t,f,u),_(n)?n instanceof J||(o=b(n))==W||o==X?void 0!==r?new y(n,Ct(i,e),r):void 0!==i?new y(n,Ct(i,e)):new y(n):St in n?qt(f,n):Dt.call(f,n):new y(g(n))})),$(v!==Function.prototype?T(y).concat(T(v)):T(y),(function(t){t in f||d(f,t,y[t])})),f[Z]=S,i||(S.constructor=f));var P=S[vt],C=!!P&&("values"==P.name||null==P.name),I=Ut.values;d(f,bt,!0),d(S,St,u),d(S,At,!0),d(S,_t,f),(l?new f(1)[xt]==u:xt in S)||N(S,xt,{get:function(){return u}}),w[u]=f,s(s.G+s.W+s.F*(f!=y),w),s(s.S,u,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*o((function(){y.of.call(f,1)})),u,{from:Dt,of:zt}),Y in S||d(S,Y,e),s(s.P,u,Ft),z(u),s(s.P+s.F*Pt,u,{set:Nt}),s(s.P+s.F*!C,u,Ut),i||S.toString==gt||(S.toString=gt),s(s.P+s.F*o((function(){new f(1).slice()})),u,{slice:Vt}),s(s.P+s.F*(o((function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()}))||!o((function(){S.toLocaleString.call([1,2])}))),u,{toLocaleString:Bt}),L[u]=C?P:I,i||C||d(S,vt,I)}}else t.exports=function(){}},1125:(t,e,n)=>{"use strict";function i(t,e,n){var i,r,o,s=new Array(n),a=8*n-e-1,l=(1<<a)-1,u=l>>1,c=23===e?V(2,-24)-V(2,-77):0,h=0,d=t<0||0===t&&1/t<0?1:0;for((t=F(t))!=t||t===k?(r=t!=t?1:0,i=l):(i=N(U(t)/j),t*(o=V(2,-i))<1&&(i--,o*=2),(t+=i+u>=1?c/o:c*V(2,1-u))*o>=2&&(i++,o/=2),i+u>=l?(r=0,i=l):i+u>=1?(r=(t*o-1)*V(2,e),i+=u):(r=t*V(2,u-1)*V(2,e),i=0));e>=8;s[h++]=255&r,r/=256,e-=8);for(i=i<<e|r,a+=e;a>0;s[h++]=255&i,i/=256,a-=8);return s[--h]|=128*d,s}function r(t,e,n){var i,r=8*n-e-1,o=(1<<r)-1,s=o>>1,a=r-7,l=n-1,u=t[l--],c=127&u;for(u>>=7;a>0;c=256*c+t[l],l--,a-=8);for(i=c&(1<<-a)-1,c>>=-a,a+=e;a>0;i=256*i+t[l],l--,a-=8);if(0===c)c=1-s;else{if(c===o)return i?NaN:u?-k:k;i+=V(2,e),c-=s}return(u?-1:1)*i*V(2,c-e)}function o(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function s(t){return[255&t]}function a(t){return[255&t,t>>8&255]}function l(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function u(t){return i(t,52,8)}function c(t){return i(t,23,4)}function h(t,e,n){T(t[R],e,{get:function(){return this[n]}})}function d(t,e,n,i){var r=A(+n);if(r+e>t[Y])throw z(O);var o=t[X]._b,s=r+t[Z],a=o.slice(s,s+e);return i?a:a.reverse()}function p(t,e,n,i,r,o){var s=A(+n);if(s+e>t[Y])throw z(O);for(var a=t[X]._b,l=s+t[Z],u=i(+r),c=0;c<e;c++)a[l+c]=u[o?c:e-c-1]}var f=n(3816),m=n(7057),g=n(4461),y=n(9383),v=n(7728),x=n(4408),b=n(4253),_=n(3328),w=n(1467),S=n(875),A=n(4843),M=n(616).f,T=n(9275).f,E=n(6852),P=n(2943),C="ArrayBuffer",I="DataView",R="prototype",O="Wrong index!",q=f[C],L=f[I],D=f.Math,z=f.RangeError,k=f.Infinity,B=q,F=D.abs,V=D.pow,N=D.floor,U=D.log,j=D.LN2,G="buffer",H="byteLength",W="byteOffset",X=m?"_b":G,Y=m?"_l":H,Z=m?"_o":W;if(y.ABV){if(!b((function(){q(1)}))||!b((function(){new q(-1)}))||b((function(){return new q,new q(1.5),new q(NaN),q.name!=C}))){for(var Q,J=(q=function(t){return _(this,q),new B(A(t))})[R]=B[R],K=M(B),$=0;K.length>$;)(Q=K[$++])in q||v(q,Q,B[Q]);g||(J.constructor=q)}var tt=new L(new q(2)),et=L[R].setInt8;tt.setInt8(0,2147483648),tt.setInt8(1,2147483649),!tt.getInt8(0)&&tt.getInt8(1)||x(L[R],{setInt8:function(t,e){et.call(this,t,e<<24>>24)},setUint8:function(t,e){et.call(this,t,e<<24>>24)}},!0)}else q=function(t){_(this,q,C);var e=A(t);this._b=E.call(new Array(e),0),this[Y]=e},L=function(t,e,n){_(this,L,I),_(t,q,I);var i=t[Y],r=w(e);if(r<0||r>i)throw z("Wrong offset!");if(r+(n=void 0===n?i-r:S(n))>i)throw z("Wrong length!");this[X]=t,this[Z]=r,this[Y]=n},m&&(h(q,H,"_l"),h(L,G,"_b"),h(L,H,"_l"),h(L,W,"_o")),x(L[R],{getInt8:function(t){return d(this,1,t)[0]<<24>>24},getUint8:function(t){return d(this,1,t)[0]},getInt16:function(t){var e=d(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=d(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return o(d(this,4,t,arguments[1]))},getUint32:function(t){return o(d(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return r(d(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return r(d(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){p(this,1,t,s,e)},setUint8:function(t,e){p(this,1,t,s,e)},setInt16:function(t,e){p(this,2,t,a,e,arguments[2])},setUint16:function(t,e){p(this,2,t,a,e,arguments[2])},setInt32:function(t,e){p(this,4,t,l,e,arguments[2])},setUint32:function(t,e){p(this,4,t,l,e,arguments[2])},setFloat32:function(t,e){p(this,4,t,c,e,arguments[2])},setFloat64:function(t,e){p(this,8,t,u,e,arguments[2])}});P(q,C),P(L,I),v(L[R],y.VIEW,!0),e[C]=q,e[I]=L},9383:(t,e,n)=>{for(var i,r=n(3816),o=n(7728),s=n(3953),a=s("typed_array"),l=s("view"),u=!(!r.ArrayBuffer||!r.DataView),c=u,h=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(i=r[d[h++]])?(o(i.prototype,a,!0),o(i.prototype,l,!0)):c=!1;t.exports={ABV:u,CONSTR:c,TYPED:a,VIEW:l}},3953:t=>{var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},575:(t,e,n)=>{var i=n(3816).navigator;t.exports=i&&i.userAgent||""},1616:(t,e,n)=>{var i=n(5286);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},6074:(t,e,n)=>{var i=n(3816),r=n(5645),o=n(4461),s=n(8787),a=n(9275).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},8787:(t,e,n)=>{e.f=n(6314)},6314:(t,e,n)=>{var i=n(3825)("wks"),r=n(3953),o=n(3816).Symbol,s="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=i},9002:(t,e,n)=>{var i=n(1488),r=n(6314)("iterator"),o=n(2803);t.exports=n(5645).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},1761:(t,e,n)=>{var i=n(2985),r=n(5496)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(t){return r(t)}})},2e3:(t,e,n)=>{var i=n(2985);i(i.P,"Array",{copyWithin:n(5216)}),n(7722)("copyWithin")},5745:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(4);i(i.P+i.F*!n(7717)([].every,!0),"Array",{every:function(t){return r(this,t,arguments[1])}})},8977:(t,e,n)=>{var i=n(2985);i(i.P,"Array",{fill:n(6852)}),n(7722)("fill")},8837:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(2);i(i.P+i.F*!n(7717)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},4899:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(6),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),i(i.P+i.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(7722)(o)},2310:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(5),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),i(i.P+i.F*s,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(7722)(o)},4336:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(0),o=n(7717)([].forEach,!0);i(i.P+i.F*!o,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},522:(t,e,n)=>{"use strict";var i=n(741),r=n(2985),o=n(508),s=n(8851),a=n(6555),l=n(875),u=n(2811),c=n(9002);r(r.S+r.F*!n(7462)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,h,d=o(t),p="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,y=0,v=c(d);if(g&&(m=i(m,f>2?arguments[2]:void 0,2)),null==v||p==Array&&a(v))for(n=new p(e=l(d.length));e>y;y++)u(n,y,g?m(d[y],y):d[y]);else for(h=v.call(d),n=new p;!(r=h.next()).done;y++)u(n,y,g?s(h,m,[r.value,y],!0):r.value);return n.length=y,n}})},3369:(t,e,n)=>{"use strict";var i=n(2985),r=n(9315)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(s||!n(7717)(o)),"Array",{indexOf:function(t){return s?o.apply(this,arguments)||0:r(this,t,arguments[1])}})},774:(t,e,n)=>{var i=n(2985);i(i.S,"Array",{isArray:n(4302)})},6997:(t,e,n)=>{"use strict";var i=n(7722),r=n(5436),o=n(2803),s=n(2110);t.exports=n(2923)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},7842:(t,e,n)=>{"use strict";var i=n(2985),r=n(2110),o=[].join;i(i.P+i.F*(n(9797)!=Object||!n(7717)(o)),"Array",{join:function(t){return o.call(r(this),void 0===t?",":t)}})},9564:(t,e,n)=>{"use strict";var i=n(2985),r=n(2110),o=n(1467),s=n(875),a=[].lastIndexOf,l=!!a&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(l||!n(7717)(a)),"Array",{lastIndexOf:function(t){if(l)return a.apply(this,arguments)||0;var e=r(this),n=s(e.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,o(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in e&&e[i]===t)return i||0;return-1}})},1802:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(1);i(i.P+i.F*!n(7717)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},8295:(t,e,n)=>{"use strict";var i=n(2985),r=n(2811);i(i.S+i.F*n(4253)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)r(n,t,arguments[t++]);return n.length=e,n}})},3750:(t,e,n)=>{"use strict";var i=n(2985),r=n(7628);i(i.P+i.F*!n(7717)([].reduceRight,!0),"Array",{reduceRight:function(t){return r(this,t,arguments.length,arguments[1],!0)}})},3057:(t,e,n)=>{"use strict";var i=n(2985),r=n(7628);i(i.P+i.F*!n(7717)([].reduce,!0),"Array",{reduce:function(t){return r(this,t,arguments.length,arguments[1],!1)}})},110:(t,e,n)=>{"use strict";var i=n(2985),r=n(639),o=n(2032),s=n(2337),a=n(875),l=[].slice;i(i.P+i.F*n(4253)((function(){r&&l.call(r)})),"Array",{slice:function(t,e){var n=a(this.length),i=o(this);if(e=void 0===e?n:e,"Array"==i)return l.call(this,t,e);for(var r=s(t,n),u=s(e,n),c=a(u-r),h=new Array(c),d=0;d<c;d++)h[d]="String"==i?this.charAt(r+d):this[r+d];return h}})},6773:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(3);i(i.P+i.F*!n(7717)([].some,!0),"Array",{some:function(t){return r(this,t,arguments[1])}})},75:(t,e,n)=>{"use strict";var i=n(2985),r=n(4963),o=n(508),s=n(4253),a=[].sort,l=[1,2,3];i(i.P+i.F*(s((function(){l.sort(void 0)}))||!s((function(){l.sort(null)}))||!n(7717)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),r(t))}})},1842:(t,e,n)=>{n(2974)("Array")},1822:(t,e,n)=>{var i=n(2985);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},1031:(t,e,n)=>{var i=n(2985),r=n(3537);i(i.P+i.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},9977:(t,e,n)=>{"use strict";var i=n(2985),r=n(508),o=n(1689);i(i.P+i.F*n(4253)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(t){var e=r(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},1560:(t,e,n)=>{var i=n(6314)("toPrimitive"),r=Date.prototype;i in r||n(7728)(r,i,n(870))},6331:(t,e,n)=>{var i=Date.prototype,r="Invalid Date",o="toString",s=i[o],a=i.getTime;new Date(NaN)+""!=r&&n(7234)(i,o,(function(){var t=a.call(this);return t==t?s.call(this):r}))},9730:(t,e,n)=>{var i=n(2985);i(i.P,"Function",{bind:n(4398)})},8377:(t,e,n)=>{"use strict";var i=n(5286),r=n(468),o=n(6314)("hasInstance"),s=Function.prototype;o in s||n(9275).f(s,o,{value:function(t){if("function"!=typeof this||!i(t))return!1;if(!i(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}})},6059:(t,e,n)=>{var i=n(9275).f,r=Function.prototype,o=/^\s*function ([^ (]*)/,s="name";s in r||n(7057)&&i(r,s,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},8416:(t,e,n)=>{"use strict";var i=n(9824),r=n(1616),o="Map";t.exports=n(5795)(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(r(this,o),t);return e&&e.v},set:function(t,e){return i.def(r(this,o),0===t?0:t,e)}},i,!0)},6503:(t,e,n)=>{var i=n(2985),r=n(6206),o=Math.sqrt,s=Math.acosh;i(i.S+i.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+o(t-1)*o(t+1))}})},6786:(t,e,n)=>{var i=n(2985),r=Math.asinh;i(i.S+i.F*!(r&&1/r(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},932:(t,e,n)=>{var i=n(2985),r=Math.atanh;i(i.S+i.F*!(r&&1/r(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},7526:(t,e,n)=>{var i=n(2985),r=n(1801);i(i.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},1591:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},9073:(t,e,n)=>{var i=n(2985),r=Math.exp;i(i.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},347:(t,e,n)=>{var i=n(2985),r=n(3086);i(i.S+i.F*(r!=Math.expm1),"Math",{expm1:r})},579:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{fround:n(4934)})},4669:(t,e,n)=>{var i=n(2985),r=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var n,i,o=0,s=0,a=arguments.length,l=0;s<a;)l<(n=r(arguments[s++]))?(o=o*(i=l/n)*i+1,l=n):o+=n>0?(i=n/l)*i:n;return l===1/0?1/0:l*Math.sqrt(o)}})},7710:(t,e,n)=>{var i=n(2985),r=Math.imul;i(i.S+i.F*n(4253)((function(){return-5!=r(4294967295,5)||2!=r.length})),"Math",{imul:function(t,e){var n=65535,i=+t,r=+e,o=n&i,s=n&r;return 0|o*s+((n&i>>>16)*s+o*(n&r>>>16)<<16>>>0)}})},5789:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},3514:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{log1p:n(6206)})},9978:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},8472:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{sign:n(1801)})},6946:(t,e,n)=>{var i=n(2985),r=n(3086),o=Math.exp;i(i.S+i.F*n(4253)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},5068:(t,e,n)=>{var i=n(2985),r=n(3086),o=Math.exp;i(i.S,"Math",{tanh:function(t){var e=r(t=+t),n=r(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},413:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},1246:(t,e,n)=>{"use strict";var i=n(3816),r=n(9181),o=n(2032),s=n(266),a=n(1689),l=n(4253),u=n(616).f,c=n(8693).f,h=n(9275).f,d=n(9599).trim,p="Number",f=i[p],m=f,g=f.prototype,y=o(n(2503)(g))==p,v="trim"in String.prototype,x=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var n,i,r,o=(e=v?e.trim():d(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var s,l=e.slice(2),u=0,c=l.length;u<c;u++)if((s=l.charCodeAt(u))<48||s>r)return NaN;return parseInt(l,i)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof f&&(y?l((function(){g.valueOf.call(n)})):o(n)!=p)?s(new m(x(e)),n,f):x(e)};for(var b,_=n(7057)?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)r(m,b=_[w])&&!r(f,b)&&h(f,b,c(m,b));f.prototype=g,g.constructor=f,n(7234)(i,p,f)}},5972:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},3403:(t,e,n)=>{var i=n(2985),r=n(3816).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},2516:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{isInteger:n(8367)})},9371:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{isNaN:function(t){return t!=t}})},6479:(t,e,n)=>{var i=n(2985),r=n(8367),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&o(t)<=9007199254740991}})},1736:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},1889:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},5177:(t,e,n)=>{var i=n(2985),r=n(7743);i(i.S+i.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},6943:(t,e,n)=>{var i=n(2985),r=n(5960);i(i.S+i.F*(Number.parseInt!=r),"Number",{parseInt:r})},726:(t,e,n)=>{"use strict";var i=n(2985),r=n(1467),o=n(3365),s=n(8595),a=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h="0",d=function(t,e){for(var n=-1,i=e;++n<6;)i+=t*u[n],u[n]=i%1e7,i=l(i/1e7)},p=function(t){for(var e=6,n=0;--e>=0;)n+=u[e],u[e]=l(n/t),n=n%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==u[t]){var n=String(u[t]);e=""===e?n:e+s.call(h,7-n.length)+n}return e},m=function(t,e,n){return 0===e?n:e%2==1?m(t,e-1,n*t):m(t*t,e/2,n)};i(i.P+i.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(4253)((function(){a.call({})}))),"Number",{toFixed:function(t){var e,n,i,a,l=o(this,c),u=r(t),g="",y=h;if(u<0||u>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*m(2,69,1))-69,n=e<0?l*m(2,-e,1):l/m(2,e,1),n*=4503599627370496,(e=52-e)>0){for(d(0,n),i=u;i>=7;)d(1e7,0),i-=7;for(d(m(10,i,1),0),i=e-1;i>=23;)p(1<<23),i-=23;p(1<<i),d(1,1),p(2),y=f()}else d(0,n),d(1<<-e,0),y=f()+s.call(h,u);return u>0?g+((a=y.length)<=u?"0."+s.call(h,u-a)+y:y.slice(0,a-u)+"."+y.slice(a-u)):g+y}})},1901:(t,e,n)=>{"use strict";var i=n(2985),r=n(4253),o=n(3365),s=1..toPrecision;i(i.P+i.F*(r((function(){return"1"!==s.call(1,void 0)}))||!r((function(){s.call({})}))),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},5115:(t,e,n)=>{var i=n(2985);i(i.S+i.F,"Object",{assign:n(5345)})},8132:(t,e,n)=>{var i=n(2985);i(i.S,"Object",{create:n(2503)})},7470:(t,e,n)=>{var i=n(2985);i(i.S+i.F*!n(7057),"Object",{defineProperties:n(5588)})},8388:(t,e,n)=>{var i=n(2985);i(i.S+i.F*!n(7057),"Object",{defineProperty:n(9275).f})},9375:(t,e,n)=>{var i=n(5286),r=n(4728).onFreeze;n(3160)("freeze",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},4882:(t,e,n)=>{var i=n(2110),r=n(8693).f;n(3160)("getOwnPropertyDescriptor",(function(){return function(t,e){return r(i(t),e)}}))},9622:(t,e,n)=>{n(3160)("getOwnPropertyNames",(function(){return n(9327).f}))},1520:(t,e,n)=>{var i=n(508),r=n(468);n(3160)("getPrototypeOf",(function(){return function(t){return r(i(t))}}))},9892:(t,e,n)=>{var i=n(5286);n(3160)("isExtensible",(function(t){return function(e){return!!i(e)&&(!t||t(e))}}))},4157:(t,e,n)=>{var i=n(5286);n(3160)("isFrozen",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},5095:(t,e,n)=>{var i=n(5286);n(3160)("isSealed",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},9176:(t,e,n)=>{var i=n(2985);i(i.S,"Object",{is:n(7195)})},7476:(t,e,n)=>{var i=n(508),r=n(7184);n(3160)("keys",(function(){return function(t){return r(i(t))}}))},4672:(t,e,n)=>{var i=n(5286),r=n(4728).onFreeze;n(3160)("preventExtensions",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},3533:(t,e,n)=>{var i=n(5286),r=n(4728).onFreeze;n(3160)("seal",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},8838:(t,e,n)=>{var i=n(2985);i(i.S,"Object",{setPrototypeOf:n(7375).set})},6253:(t,e,n)=>{"use strict";var i=n(1488),r={};r[n(6314)("toStringTag")]="z",r+""!="[object z]"&&n(7234)(Object.prototype,"toString",(function(){return"[object "+i(this)+"]"}),!0)},4299:(t,e,n)=>{var i=n(2985),r=n(7743);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},1084:(t,e,n)=>{var i=n(2985),r=n(5960);i(i.G+i.F*(parseInt!=r),{parseInt:r})},851:(t,e,n)=>{"use strict";var i,r,o,s,a=n(4461),l=n(3816),u=n(741),c=n(1488),h=n(2985),d=n(5286),p=n(4963),f=n(3328),m=n(3531),g=n(8364),y=n(4193).set,v=n(4351)(),x=n(3499),b=n(188),_=n(575),w=n(94),S="Promise",A=l.TypeError,M=l.process,T=M&&M.versions,E=T&&T.v8||"",P=l[S],C="process"==c(M),I=function(){},R=r=x.f,O=!!function(){try{var t=P.resolve(1),e=(t.constructor={})[n(6314)("species")]=function(t){t(I,I)};return(C||"function"==typeof PromiseRejectionEvent)&&t.then(I)instanceof e&&0!==E.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(t){}}(),q=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;v((function(){for(var i=t._v,r=1==t._s,o=0,s=function(e){var n,o,s,a=r?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{a?(r||(2==t._h&&k(t),t._h=1),!0===a?n=i:(c&&c.enter(),n=a(i),c&&(c.exit(),s=!0)),n===e.promise?u(A("Promise-chain cycle")):(o=q(n))?o.call(n,l,u):l(n)):u(i)}catch(t){c&&!s&&c.exit(),u(t)}};n.length>o;)s(n[o++]);t._c=[],t._n=!1,e&&!t._h&&D(t)}))}},D=function(t){y.call(l,(function(){var e,n,i,r=t._v,o=z(t);if(o&&(e=b((function(){C?M.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)})),t._h=C||z(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},z=function(t){return 1!==t._h&&0===(t._a||t._c).length},k=function(t){y.call(l,(function(){var e;C?M.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},B=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},F=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw A("Promise can't be resolved itself");(e=q(t))?v((function(){var i={_w:n,_d:!1};try{e.call(t,u(F,i,1),u(B,i,1))}catch(t){B.call(i,t)}})):(n._v=t,n._s=1,L(n,!1))}catch(t){B.call({_w:n,_d:!1},t)}}};O||(P=function(t){f(this,P,S,"_h"),p(t),i.call(this);try{t(u(F,this,1),u(B,this,1))}catch(t){B.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(4408)(P.prototype,{then:function(t,e){var n=R(g(this,P));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=C?M.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new i;this.promise=t,this.resolve=u(F,t,1),this.reject=u(B,t,1)},x.f=R=function(t){return t===P||t===s?new o(t):r(t)}),h(h.G+h.W+h.F*!O,{Promise:P}),n(2943)(P,S),n(2974)(S),s=n(5645)[S],h(h.S+h.F*!O,S,{reject:function(t){var e=R(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(a||!O),S,{resolve:function(t){return w(a&&this===s?P:this,t)}}),h(h.S+h.F*!(O&&n(7462)((function(t){P.all(t).catch(I)}))),S,{all:function(t){var e=this,n=R(e),i=n.resolve,r=n.reject,o=b((function(){var n=[],o=0,s=1;m(t,!1,(function(t){var a=o++,l=!1;n.push(void 0),s++,e.resolve(t).then((function(t){l||(l=!0,n[a]=t,--s||i(n))}),r)})),--s||i(n)}));return o.e&&r(o.v),n.promise},race:function(t){var e=this,n=R(e),i=n.reject,r=b((function(){m(t,!1,(function(t){e.resolve(t).then(n.resolve,i)}))}));return r.e&&i(r.v),n.promise}})},1572:(t,e,n)=>{var i=n(2985),r=n(4963),o=n(7007),s=(n(3816).Reflect||{}).apply,a=Function.apply;i(i.S+i.F*!n(4253)((function(){s((function(){}))})),"Reflect",{apply:function(t,e,n){var i=r(t),l=o(n);return s?s(i,e,l):a.call(i,e,l)}})},2139:(t,e,n)=>{var i=n(2985),r=n(2503),o=n(4963),s=n(7007),a=n(5286),l=n(4253),u=n(4398),c=(n(3816).Reflect||{}).construct,h=l((function(){function t(){}return!(c((function(){}),[],t)instanceof t)})),d=!l((function(){c((function(){}))}));i(i.S+i.F*(h||d),"Reflect",{construct:function(t,e){o(t),s(e);var n=arguments.length<3?t:o(arguments[2]);if(d&&!h)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(u.apply(t,i))}var l=n.prototype,p=r(a(l)?l:Object.prototype),f=Function.apply.call(t,p,e);return a(f)?f:p}})},685:(t,e,n)=>{var i=n(9275),r=n(2985),o=n(7007),s=n(1689);r(r.S+r.F*n(4253)((function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,n){o(t),e=s(e,!0),o(n);try{return i.f(t,e,n),!0}catch(t){return!1}}})},5535:(t,e,n)=>{var i=n(2985),r=n(8693).f,o=n(7007);i(i.S,"Reflect",{deleteProperty:function(t,e){var n=r(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},7347:(t,e,n)=>{"use strict";var i=n(2985),r=n(7007),o=function(t){this._t=r(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(9988)(o,"Object",(function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}})),i(i.S,"Reflect",{enumerate:function(t){return new o(t)}})},6633:(t,e,n)=>{var i=n(8693),r=n(2985),o=n(7007);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.f(o(t),e)}})},8989:(t,e,n)=>{var i=n(2985),r=n(468),o=n(7007);i(i.S,"Reflect",{getPrototypeOf:function(t){return r(o(t))}})},3049:(t,e,n)=>{var i=n(8693),r=n(468),o=n(9181),s=n(2985),a=n(5286),l=n(7007);s(s.S,"Reflect",{get:function t(e,n){var s,u,c=arguments.length<3?e:arguments[2];return l(e)===c?e[n]:(s=i.f(e,n))?o(s,"value")?s.value:void 0!==s.get?s.get.call(c):void 0:a(u=r(e))?t(u,n,c):void 0}})},8270:(t,e,n)=>{var i=n(2985);i(i.S,"Reflect",{has:function(t,e){return e in t}})},4510:(t,e,n)=>{var i=n(2985),r=n(7007),o=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return r(t),!o||o(t)}})},3984:(t,e,n)=>{var i=n(2985);i(i.S,"Reflect",{ownKeys:n(7643)})},5769:(t,e,n)=>{var i=n(2985),r=n(7007),o=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){r(t);try{return o&&o(t),!0}catch(t){return!1}}})},6014:(t,e,n)=>{var i=n(2985),r=n(7375);r&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},55:(t,e,n)=>{var i=n(9275),r=n(8693),o=n(468),s=n(9181),a=n(2985),l=n(681),u=n(7007),c=n(5286);a(a.S,"Reflect",{set:function t(e,n,a){var h,d,p=arguments.length<4?e:arguments[3],f=r.f(u(e),n);if(!f){if(c(d=o(e)))return t(d,n,a,p);f=l(0)}if(s(f,"value")){if(!1===f.writable||!c(p))return!1;if(h=r.f(p,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=a,i.f(p,n,h)}else i.f(p,n,l(0,a));return!0}return void 0!==f.set&&(f.set.call(p,a),!0)}})},3946:(t,e,n)=>{var i=n(3816),r=n(266),o=n(9275).f,s=n(616).f,a=n(5364),l=n(3218),u=i.RegExp,c=u,h=u.prototype,d=/a/g,p=/a/g,f=new u(d)!==d;if(n(7057)&&(!f||n(4253)((function(){return p[n(6314)("match")]=!1,u(d)!=d||u(p)==p||"/a/i"!=u(d,"i")})))){u=function(t,e){var n=this instanceof u,i=a(t),o=void 0===e;return!n&&i&&t.constructor===u&&o?t:r(f?new c(i&&!o?t.source:t,e):c((i=t instanceof u)?t.source:t,i&&o?l.call(t):e),n?this:h,u)};for(var m=function(t){t in u||o(u,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},g=s(c),y=0;g.length>y;)m(g[y++]);h.constructor=u,u.prototype=h,n(7234)(i,"RegExp",u)}n(2974)("RegExp")},8269:(t,e,n)=>{"use strict";var i=n(1165);n(2985)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},6774:(t,e,n)=>{n(7057)&&"g"!=/./g.flags&&n(9275).f(RegExp.prototype,"flags",{configurable:!0,get:n(3218)})},1466:(t,e,n)=>{"use strict";var i=n(7007),r=n(875),o=n(6793),s=n(7787);n(8082)("match",1,(function(t,e,n,a){return[function(n){var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=a(n,t,this);if(e.done)return e.value;var l=i(t),u=String(this);if(!l.global)return s(l,u);var c=l.unicode;l.lastIndex=0;for(var h,d=[],p=0;null!==(h=s(l,u));){var f=String(h[0]);d[p]=f,""===f&&(l.lastIndex=o(u,r(l.lastIndex),c)),p++}return 0===p?null:d}]}))},9357:(t,e,n)=>{"use strict";var i=n(7007),r=n(508),o=n(875),s=n(1467),a=n(6793),l=n(7787),u=Math.max,c=Math.min,h=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;n(8082)("replace",2,(function(t,e,n,f){function m(t,e,i,o,s,a){var l=i+t.length,u=o.length,c=p;return void 0!==s&&(s=r(s),c=d),n.call(a,c,(function(n,r){var a;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(l);case"<":a=s[r.slice(1,-1)];break;default:var c=+r;if(0===c)return n;if(c>u){var d=h(c/10);return 0===d?n:d<=u?void 0===o[d-1]?r.charAt(1):o[d-1]+r.charAt(1):n}a=o[c-1]}return void 0===a?"":a}))}return[function(i,r){var o=t(this),s=null==i?void 0:i[e];return void 0!==s?s.call(i,o,r):n.call(String(o),i,r)},function(t,e){var r=f(n,t,this,e);if(r.done)return r.value;var h=i(t),d=String(this),p="function"==typeof e;p||(e=String(e));var g=h.global;if(g){var y=h.unicode;h.lastIndex=0}for(var v=[];;){var x=l(h,d);if(null===x)break;if(v.push(x),!g)break;""===String(x[0])&&(h.lastIndex=a(d,o(h.lastIndex),y))}for(var b,_="",w=0,S=0;S<v.length;S++){x=v[S];for(var A=String(x[0]),M=u(c(s(x.index),d.length),0),T=[],E=1;E<x.length;E++)T.push(void 0===(b=x[E])?b:String(b));var P=x.groups;if(p){var C=[A].concat(T,M,d);void 0!==P&&C.push(P);var I=String(e.apply(void 0,C))}else I=m(A,d,M,T,P,e);M>=w&&(_+=d.slice(w,M)+I,w=M+A.length)}return _+d.slice(w)}]}))},6142:(t,e,n)=>{"use strict";var i=n(7007),r=n(7195),o=n(7787);n(8082)("search",1,(function(t,e,n,s){return[function(n){var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=s(n,t,this);if(e.done)return e.value;var a=i(t),l=String(this),u=a.lastIndex;r(u,0)||(a.lastIndex=0);var c=o(a,l);return r(a.lastIndex,u)||(a.lastIndex=u),null===c?-1:c.index}]}))},1876:(t,e,n)=>{"use strict";var i=n(5364),r=n(7007),o=n(8364),s=n(6793),a=n(875),l=n(7787),u=n(1165),c=n(4253),h=Math.min,d=[].push,p="split",f="length",m="lastIndex",g=4294967295,y=!c((function(){RegExp(g,"y")}));n(8082)("split",2,(function(t,e,n,c){var v;return v="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[f]||2!="ab"[p](/(?:ab)*/)[f]||4!="."[p](/(.?)(.?)/)[f]||"."[p](/()()/)[f]>1||""[p](/.?/)[f]?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(r,t,e);for(var o,s,a,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,p=void 0===e?g:e>>>0,y=new RegExp(t.source,c+"g");(o=u.call(y,r))&&!((s=y[m])>h&&(l.push(r.slice(h,o.index)),o[f]>1&&o.index<r[f]&&d.apply(l,o.slice(1)),a=o[0][f],h=s,l[f]>=p));)y[m]===o.index&&y[m]++;return h===r[f]?!a&&y.test("")||l.push(""):l.push(r.slice(h)),l[f]>p?l.slice(0,p):l}:"0"[p](void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var r=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r,i):v.call(String(r),n,i)},function(t,e){var i=c(v,t,this,e,v!==n);if(i.done)return i.value;var u=r(t),d=String(this),p=o(u,RegExp),f=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(y?"y":"g"),x=new p(y?u:"^(?:"+u.source+")",m),b=void 0===e?g:e>>>0;if(0===b)return[];if(0===d.length)return null===l(x,d)?[d]:[];for(var _=0,w=0,S=[];w<d.length;){x.lastIndex=y?w:0;var A,M=l(x,y?d:d.slice(w));if(null===M||(A=h(a(x.lastIndex+(y?0:w)),d.length))===_)w=s(d,w,f);else{if(S.push(d.slice(_,w)),S.length===b)return S;for(var T=1;T<=M.length-1;T++)if(S.push(M[T]),S.length===b)return S;w=_=A}}return S.push(d.slice(_)),S}]}))},6108:(t,e,n)=>{"use strict";n(6774);var i=n(7007),r=n(3218),o=n(7057),s="toString",a=/./[s],l=function(t){n(7234)(RegExp.prototype,s,t,!0)};n(4253)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?l((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)})):a.name!=s&&l((function(){return a.call(this)}))},8184:(t,e,n)=>{"use strict";var i=n(9824),r=n(1616);t.exports=n(5795)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,"Set"),t=0===t?0:t,t)}},i)},856:(t,e,n)=>{"use strict";n(9395)("anchor",(function(t){return function(e){return t(this,"a","name",e)}}))},703:(t,e,n)=>{"use strict";n(9395)("big",(function(t){return function(){return t(this,"big","","")}}))},1539:(t,e,n)=>{"use strict";n(9395)("blink",(function(t){return function(){return t(this,"blink","","")}}))},5292:(t,e,n)=>{"use strict";n(9395)("bold",(function(t){return function(){return t(this,"b","","")}}))},9539:(t,e,n)=>{"use strict";var i=n(2985),r=n(4496)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},6620:(t,e,n)=>{"use strict";var i=n(2985),r=n(875),o=n(2094),s="endsWith",a=""[s];i(i.P+i.F*n(8852)(s),"String",{endsWith:function(t){var e=o(this,t,s),n=arguments.length>1?arguments[1]:void 0,i=r(e.length),l=void 0===n?i:Math.min(r(n),i),u=String(t);return a?a.call(e,u,l):e.slice(l-u.length,l)===u}})},6629:(t,e,n)=>{"use strict";n(9395)("fixed",(function(t){return function(){return t(this,"tt","","")}}))},3694:(t,e,n)=>{"use strict";n(9395)("fontcolor",(function(t){return function(e){return t(this,"font","color",e)}}))},7648:(t,e,n)=>{"use strict";n(9395)("fontsize",(function(t){return function(e){return t(this,"font","size",e)}}))},191:(t,e,n)=>{var i=n(2985),r=n(2337),o=String.fromCharCode,s=String.fromCodePoint;i(i.S+i.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments.length,s=0;i>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},2850:(t,e,n)=>{"use strict";var i=n(2985),r=n(2094),o="includes";i(i.P+i.F*n(8852)(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},7795:(t,e,n)=>{"use strict";n(9395)("italics",(function(t){return function(){return t(this,"i","","")}}))},9115:(t,e,n)=>{"use strict";var i=n(4496)(!0);n(2923)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},4531:(t,e,n)=>{"use strict";n(9395)("link",(function(t){return function(e){return t(this,"a","href",e)}}))},8306:(t,e,n)=>{var i=n(2985),r=n(2110),o=n(875);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=o(e.length),i=arguments.length,s=[],a=0;n>a;)s.push(String(e[a++])),a<i&&s.push(String(arguments[a]));return s.join("")}})},823:(t,e,n)=>{var i=n(2985);i(i.P,"String",{repeat:n(8595)})},3605:(t,e,n)=>{"use strict";n(9395)("small",(function(t){return function(){return t(this,"small","","")}}))},7732:(t,e,n)=>{"use strict";var i=n(2985),r=n(875),o=n(2094),s="startsWith",a=""[s];i(i.P+i.F*n(8852)(s),"String",{startsWith:function(t){var e=o(this,t,s),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return a?a.call(e,i,n):e.slice(n,n+i.length)===i}})},6780:(t,e,n)=>{"use strict";n(9395)("strike",(function(t){return function(){return t(this,"strike","","")}}))},9937:(t,e,n)=>{"use strict";n(9395)("sub",(function(t){return function(){return t(this,"sub","","")}}))},511:(t,e,n)=>{"use strict";n(9395)("sup",(function(t){return function(){return t(this,"sup","","")}}))},4564:(t,e,n)=>{"use strict";n(9599)("trim",(function(t){return function(){return t(this,3)}}))},5767:(t,e,n)=>{"use strict";var i=n(3816),r=n(9181),o=n(7057),s=n(2985),a=n(7234),l=n(4728).KEY,u=n(4253),c=n(3825),h=n(2943),d=n(3953),p=n(6314),f=n(8787),m=n(6074),g=n(5541),y=n(4302),v=n(7007),x=n(5286),b=n(508),_=n(2110),w=n(1689),S=n(681),A=n(2503),M=n(9327),T=n(8693),E=n(4548),P=n(9275),C=n(7184),I=T.f,R=P.f,O=M.f,q=i.Symbol,L=i.JSON,D=L&&L.stringify,z="prototype",k=p("_hidden"),B=p("toPrimitive"),F={}.propertyIsEnumerable,V=c("symbol-registry"),N=c("symbols"),U=c("op-symbols"),j=Object[z],G="function"==typeof q&&!!E.f,H=i.QObject,W=!H||!H[z]||!H[z].findChild,X=o&&u((function(){return 7!=A(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=I(j,e);i&&delete j[e],R(t,e,n),i&&t!==j&&R(j,e,i)}:R,Y=function(t){var e=N[t]=A(q[z]);return e._k=t,e},Z=G&&"symbol"==typeof q.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof q},Q=function(t,e,n){return t===j&&Q(U,e,n),v(t),e=w(e,!0),v(n),r(N,e)?(n.enumerable?(r(t,k)&&t[k][e]&&(t[k][e]=!1),n=A(n,{enumerable:S(0,!1)})):(r(t,k)||R(t,k,S(1,{})),t[k][e]=!0),X(t,e,n)):R(t,e,n)},J=function(t,e){v(t);for(var n,i=g(e=_(e)),r=0,o=i.length;o>r;)Q(t,n=i[r++],e[n]);return t},K=function(t){var e=F.call(this,t=w(t,!0));return!(this===j&&r(N,t)&&!r(U,t))&&(!(e||!r(this,t)||!r(N,t)||r(this,k)&&this[k][t])||e)},$=function(t,e){if(t=_(t),e=w(e,!0),t!==j||!r(N,e)||r(U,e)){var n=I(t,e);return!n||!r(N,e)||r(t,k)&&t[k][e]||(n.enumerable=!0),n}},tt=function(t){for(var e,n=O(_(t)),i=[],o=0;n.length>o;)r(N,e=n[o++])||e==k||e==l||i.push(e);return i},et=function(t){for(var e,n=t===j,i=O(n?U:_(t)),o=[],s=0;i.length>s;)!r(N,e=i[s++])||n&&!r(j,e)||o.push(N[e]);return o};G||(a((q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===j&&e.call(U,n),r(this,k)&&r(this[k],t)&&(this[k][t]=!1),X(this,t,S(1,n))};return o&&W&&X(j,t,{configurable:!0,set:e}),Y(t)})[z],"toString",(function(){return this._k})),T.f=$,P.f=Q,n(616).f=M.f=tt,n(4682).f=K,E.f=et,o&&!n(4461)&&a(j,"propertyIsEnumerable",K,!0),f.f=function(t){return Y(p(t))}),s(s.G+s.W+s.F*!G,{Symbol:q});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),it=0;nt.length>it;)p(nt[it++]);for(var rt=C(p.store),ot=0;rt.length>ot;)m(rt[ot++]);s(s.S+s.F*!G,"Symbol",{for:function(t){return r(V,t+="")?V[t]:V[t]=q(t)},keyFor:function(t){if(!Z(t))throw TypeError(t+" is not a symbol!");for(var e in V)if(V[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),s(s.S+s.F*!G,"Object",{create:function(t,e){return void 0===e?A(t):J(A(t),e)},defineProperty:Q,defineProperties:J,getOwnPropertyDescriptor:$,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var st=u((function(){E.f(1)}));s(s.S+s.F*st,"Object",{getOwnPropertySymbols:function(t){return E.f(b(t))}}),L&&s(s.S+s.F*(!G||u((function(){var t=q();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(x(e)||void 0!==t)&&!Z(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Z(e))return e}),i[1]=e,D.apply(L,i)}}),q[z][B]||n(7728)(q[z],B,q[z].valueOf),h(q,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},142:(t,e,n)=>{"use strict";var i=n(2985),r=n(9383),o=n(1125),s=n(7007),a=n(2337),l=n(875),u=n(5286),c=n(3816).ArrayBuffer,h=n(8364),d=o.ArrayBuffer,p=o.DataView,f=r.ABV&&c.isView,m=d.prototype.slice,g=r.VIEW,y="ArrayBuffer";i(i.G+i.W+i.F*(c!==d),{ArrayBuffer:d}),i(i.S+i.F*!r.CONSTR,y,{isView:function(t){return f&&f(t)||u(t)&&g in t}}),i(i.P+i.U+i.F*n(4253)((function(){return!new d(2).slice(1,void 0).byteLength})),y,{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(s(this),t);for(var n=s(this).byteLength,i=a(t,n),r=a(void 0===e?n:e,n),o=new(h(this,d))(l(r-i)),u=new p(this),c=new p(o),f=0;i<r;)c.setUint8(f++,u.getUint8(i++));return o}}),n(2974)(y)},1786:(t,e,n)=>{var i=n(2985);i(i.G+i.W+i.F*!n(9383).ABV,{DataView:n(1125).DataView})},162:(t,e,n)=>{n(8440)("Float32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},3834:(t,e,n)=>{n(8440)("Float64",8,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},4821:(t,e,n)=>{n(8440)("Int16",2,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},1303:(t,e,n)=>{n(8440)("Int32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},5368:(t,e,n)=>{n(8440)("Int8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},9103:(t,e,n)=>{n(8440)("Uint16",2,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},3318:(t,e,n)=>{n(8440)("Uint32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},6964:(t,e,n)=>{n(8440)("Uint8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},2152:(t,e,n)=>{n(8440)("Uint8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}),!0)},147:(t,e,n)=>{"use strict";var i,r=n(3816),o=n(50)(0),s=n(7234),a=n(4728),l=n(5345),u=n(3657),c=n(5286),h=n(1616),d=n(1616),p=!r.ActiveXObject&&"ActiveXObject"in r,f="WeakMap",m=a.getWeak,g=Object.isExtensible,y=u.ufstore,v=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},x={get:function(t){if(c(t)){var e=m(t);return!0===e?y(h(this,f)).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,f),t,e)}},b=t.exports=n(5795)(f,v,x,u,!0,!0);d&&p&&(l((i=u.getConstructor(v,f)).prototype,x),a.NEED=!0,o(["delete","has","get","set"],(function(t){var e=b.prototype,n=e[t];s(e,t,(function(e,r){if(c(e)&&!g(e)){this._f||(this._f=new i);var o=this._f[t](e,r);return"set"==t?this:o}return n.call(this,e,r)}))})))},9192:(t,e,n)=>{"use strict";var i=n(3657),r=n(1616),o="WeakSet";n(5795)(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,o),t,!0)}},i,!1,!0)},1268:(t,e,n)=>{"use strict";var i=n(2985),r=n(3325),o=n(508),s=n(875),a=n(4963),l=n(6886);i(i.P,"Array",{flatMap:function(t){var e,n,i=o(this);return a(t),e=s(i.length),n=l(i,0),r(n,i,i,e,0,1,t,arguments[1]),n}}),n(7722)("flatMap")},4692:(t,e,n)=>{"use strict";var i=n(2985),r=n(3325),o=n(508),s=n(875),a=n(1467),l=n(6886);i(i.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=s(e.length),i=l(e,0);return r(i,e,e,n,0,void 0===t?1:a(t)),i}}),n(7722)("flatten")},2773:(t,e,n)=>{"use strict";var i=n(2985),r=n(9315)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(7722)("includes")},8267:(t,e,n)=>{var i=n(2985),r=n(4351)(),o=n(3816).process,s="process"==n(2032)(o);i(i.G,{asap:function(t){var e=s&&o.domain;r(e?e.bind(t):t)}})},2559:(t,e,n)=>{var i=n(2985),r=n(2032);i(i.S,"Error",{isError:function(t){return"Error"===r(t)}})},5575:(t,e,n)=>{var i=n(2985);i(i.G,{global:n(3816)})},525:(t,e,n)=>{n(1024)("Map")},8211:(t,e,n)=>{n(4881)("Map")},7698:(t,e,n)=>{var i=n(2985);i(i.P+i.R,"Map",{toJSON:n(6132)("Map")})},8865:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},368:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{DEG_PER_RAD:Math.PI/180})},6427:(t,e,n)=>{var i=n(2985),r=180/Math.PI;i(i.S,"Math",{degrees:function(t){return t*r}})},286:(t,e,n)=>{var i=n(2985),r=n(8757),o=n(4934);i(i.S,"Math",{fscale:function(t,e,n,i,s){return o(r(t,e,n,i,s))}})},2816:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{iaddh:function(t,e,n,i){var r=t>>>0,o=n>>>0;return(e>>>0)+(i>>>0)+((r&o|(r|o)&~(r+o>>>0))>>>31)|0}})},2082:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{imulh:function(t,e){var n=65535,i=+t,r=+e,o=i&n,s=r&n,a=i>>16,l=r>>16,u=(a*s>>>0)+(o*s>>>16);return a*l+(u>>16)+((o*l>>>0)+(u&n)>>16)}})},5986:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{isubh:function(t,e,n,i){var r=t>>>0,o=n>>>0;return(e>>>0)-(i>>>0)-((~r&o|~(r^o)&r-o>>>0)>>>31)|0}})},6308:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{RAD_PER_DEG:180/Math.PI})},9221:(t,e,n)=>{var i=n(2985),r=Math.PI/180;i(i.S,"Math",{radians:function(t){return t*r}})},3570:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{scale:n(8757)})},3776:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},6754:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{umulh:function(t,e){var n=65535,i=+t,r=+e,o=i&n,s=r&n,a=i>>>16,l=r>>>16,u=(a*s>>>0)+(o*s>>>16);return a*l+(u>>>16)+((o*l>>>0)+(u&n)>>>16)}})},8646:(t,e,n)=>{"use strict";var i=n(2985),r=n(508),o=n(4963),s=n(9275);n(7057)&&i(i.P+n(1670),"Object",{__defineGetter__:function(t,e){s.f(r(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},2658:(t,e,n)=>{"use strict";var i=n(2985),r=n(508),o=n(4963),s=n(9275);n(7057)&&i(i.P+n(1670),"Object",{__defineSetter__:function(t,e){s.f(r(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},3276:(t,e,n)=>{var i=n(2985),r=n(1131)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},8351:(t,e,n)=>{var i=n(2985),r=n(7643),o=n(2110),s=n(8693),a=n(2811);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=o(t),l=s.f,u=r(i),c={},h=0;u.length>h;)void 0!==(n=l(i,e=u[h++]))&&a(c,e,n);return c}})},6917:(t,e,n)=>{"use strict";var i=n(2985),r=n(508),o=n(1689),s=n(468),a=n(8693).f;n(7057)&&i(i.P+n(1670),"Object",{__lookupGetter__:function(t){var e,n=r(this),i=o(t,!0);do{if(e=a(n,i))return e.get}while(n=s(n))}})},372:(t,e,n)=>{"use strict";var i=n(2985),r=n(508),o=n(1689),s=n(468),a=n(8693).f;n(7057)&&i(i.P+n(1670),"Object",{__lookupSetter__:function(t){var e,n=r(this),i=o(t,!0);do{if(e=a(n,i))return e.set}while(n=s(n))}})},6409:(t,e,n)=>{var i=n(2985),r=n(1131)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},6534:(t,e,n)=>{"use strict";var i=n(2985),r=n(3816),o=n(5645),s=n(4351)(),a=n(6314)("observable"),l=n(4963),u=n(7007),c=n(3328),h=n(4408),d=n(7728),p=n(3531),f=p.RETURN,m=function(t){return null==t?void 0:l(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},y=function(t){return void 0===t._o},v=function(t){y(t)||(t._o=void 0,g(t))},x=function(t,e){u(t),this._c=void 0,this._o=t,t=new b(this);try{var n=e(t),i=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){i.unsubscribe()}:l(n),this._c=n)}catch(e){return void t.error(e)}y(this)&&g(this)};x.prototype=h({},{unsubscribe:function(){v(this)}});var b=function(t){this._s=t};b.prototype=h({},{next:function(t){var e=this._s;if(!y(e)){var n=e._o;try{var i=m(n.next);if(i)return i.call(n,t)}catch(t){try{v(e)}finally{throw t}}}},error:function(t){var e=this._s;if(y(e))throw t;var n=e._o;e._o=void 0;try{var i=m(n.error);if(!i)throw t;t=i.call(n,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!y(e)){var n=e._o;e._o=void 0;try{var i=m(n.complete);t=i?i.call(n,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var _=function(t){c(this,_,"Observable","_f")._f=l(t)};h(_.prototype,{subscribe:function(t){return new x(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||r.Promise)((function(n,i){l(t);var r=e.subscribe({next:function(e){try{return t(e)}catch(t){i(t),r.unsubscribe()}},error:i,complete:n})}))}}),h(_,{from:function(t){var e="function"==typeof this?this:_,n=m(u(t)[a]);if(n){var i=u(n.call(t));return i.constructor===e?i:new e((function(t){return i.subscribe(t)}))}return new e((function(e){var n=!1;return s((function(){if(!n){try{if(p(t,!1,(function(t){if(e.next(t),n)return f}))===f)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}})),function(){n=!0}}))},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:_)((function(t){var e=!1;return s((function(){if(!e){for(var i=0;i<n.length;++i)if(t.next(n[i]),e)return;t.complete()}})),function(){e=!0}}))}}),d(_.prototype,a,(function(){return this})),i(i.G,{Observable:_}),n(2974)("Observable")},9865:(t,e,n)=>{"use strict";var i=n(2985),r=n(5645),o=n(3816),s=n(8364),a=n(94);i(i.P+i.R,"Promise",{finally:function(t){var e=s(this,r.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then((function(){return n}))}:t,n?function(n){return a(e,t()).then((function(){throw n}))}:t)}})},1898:(t,e,n)=>{"use strict";var i=n(2985),r=n(3499),o=n(188);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},3364:(t,e,n)=>{var i=n(133),r=n(7007),o=i.key,s=i.set;i.exp({defineMetadata:function(t,e,n,i){s(t,e,r(n),o(i))}})},1432:(t,e,n)=>{var i=n(133),r=n(7007),o=i.key,s=i.map,a=i.store;i.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),i=s(r(e),n,!1);if(void 0===i||!i.delete(t))return!1;if(i.size)return!0;var l=a.get(e);return l.delete(n),!!l.size||a.delete(e)}})},4416:(t,e,n)=>{var i=n(8184),r=n(9490),o=n(133),s=n(7007),a=n(468),l=o.keys,u=o.key,c=function(t,e){var n=l(t,e),o=a(t);if(null===o)return n;var s=c(o,e);return s.length?n.length?r(new i(n.concat(s))):s:n};o.exp({getMetadataKeys:function(t){return c(s(t),arguments.length<2?void 0:u(arguments[1]))}})},6562:(t,e,n)=>{var i=n(133),r=n(7007),o=n(468),s=i.has,a=i.get,l=i.key,u=function(t,e,n){if(s(t,e,n))return a(t,e,n);var i=o(e);return null!==i?u(t,i,n):void 0};i.exp({getMetadata:function(t,e){return u(t,r(e),arguments.length<3?void 0:l(arguments[2]))}})},2213:(t,e,n)=>{var i=n(133),r=n(7007),o=i.keys,s=i.key;i.exp({getOwnMetadataKeys:function(t){return o(r(t),arguments.length<2?void 0:s(arguments[1]))}})},8681:(t,e,n)=>{var i=n(133),r=n(7007),o=i.get,s=i.key;i.exp({getOwnMetadata:function(t,e){return o(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},3471:(t,e,n)=>{var i=n(133),r=n(7007),o=n(468),s=i.has,a=i.key,l=function(t,e,n){if(s(t,e,n))return!0;var i=o(e);return null!==i&&l(t,i,n)};i.exp({hasMetadata:function(t,e){return l(t,r(e),arguments.length<3?void 0:a(arguments[2]))}})},4329:(t,e,n)=>{var i=n(133),r=n(7007),o=i.has,s=i.key;i.exp({hasOwnMetadata:function(t,e){return o(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},5159:(t,e,n)=>{var i=n(133),r=n(7007),o=n(4963),s=i.key,a=i.set;i.exp({metadata:function(t,e){return function(n,i){a(t,e,(void 0!==i?r:o)(n),s(i))}}})},9467:(t,e,n)=>{n(1024)("Set")},4837:(t,e,n)=>{n(4881)("Set")},8739:(t,e,n)=>{var i=n(2985);i(i.P+i.R,"Set",{toJSON:n(6132)("Set")})},7220:(t,e,n)=>{"use strict";var i=n(2985),r=n(4496)(!0);i(i.P,"String",{at:function(t){return r(this,t)}})},4208:(t,e,n)=>{"use strict";var i=n(2985),r=n(1355),o=n(875),s=n(5364),a=n(3218),l=RegExp.prototype,u=function(t,e){this._r=t,this._s=e};n(9988)(u,"RegExp String",(function(){var t=this._r.exec(this._s);return{value:t,done:null===t}})),i(i.P,"String",{matchAll:function(t){if(r(this),!s(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in l?String(t.flags):a.call(t),i=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return i.lastIndex=o(t.lastIndex),new u(i,e)}})},2770:(t,e,n)=>{"use strict";var i=n(2985),r=n(5442),o=n(575),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*s,"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},1784:(t,e,n)=>{"use strict";var i=n(2985),r=n(5442),o=n(575),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*s,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},5869:(t,e,n)=>{"use strict";n(9599)("trimLeft",(function(t){return function(){return t(this,1)}}),"trimStart")},4325:(t,e,n)=>{"use strict";n(9599)("trimRight",(function(t){return function(){return t(this,2)}}),"trimEnd")},9665:(t,e,n)=>{n(6074)("asyncIterator")},9593:(t,e,n)=>{n(6074)("observable")},8967:(t,e,n)=>{var i=n(2985);i(i.S,"System",{global:n(3816)})},4188:(t,e,n)=>{n(1024)("WeakMap")},7594:(t,e,n)=>{n(4881)("WeakMap")},3495:(t,e,n)=>{n(1024)("WeakSet")},9550:(t,e,n)=>{n(4881)("WeakSet")},1181:(t,e,n)=>{for(var i=n(6997),r=n(7184),o=n(7234),s=n(3816),a=n(7728),l=n(2803),u=n(6314),c=u("iterator"),h=u("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(p),m=0;m<f.length;m++){var g,y=f[m],v=p[y],x=s[y],b=x&&x.prototype;if(b&&(b[c]||a(b,c,d),b[h]||a(b,h,y),l[y]=d,v))for(g in i)b[g]||o(b,g,i[g],!0)}},4633:(t,e,n)=>{var i=n(2985),r=n(4193);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},2564:(t,e,n)=>{var i=n(3816),r=n(2985),o=n(575),s=[].slice,a=/MSIE .\./.test(o),l=function(t){return function(e,n){var i=arguments.length>2,r=!!i&&s.call(arguments,2);return t(i?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,n)}};r(r.G+r.B+r.F*a,{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},1934:(t,e,n)=>{n(5767),n(8132),n(8388),n(7470),n(4882),n(1520),n(7476),n(9622),n(9375),n(3533),n(4672),n(4157),n(5095),n(9892),n(5115),n(9176),n(8838),n(6253),n(9730),n(6059),n(8377),n(1084),n(4299),n(1246),n(726),n(1901),n(5972),n(3403),n(2516),n(9371),n(6479),n(1736),n(1889),n(5177),n(6943),n(6503),n(6786),n(932),n(7526),n(1591),n(9073),n(347),n(579),n(4669),n(7710),n(5789),n(3514),n(9978),n(8472),n(6946),n(5068),n(413),n(191),n(8306),n(4564),n(9115),n(9539),n(6620),n(2850),n(823),n(7732),n(856),n(703),n(1539),n(5292),n(6629),n(3694),n(7648),n(7795),n(4531),n(3605),n(6780),n(9937),n(511),n(1822),n(9977),n(1031),n(6331),n(1560),n(774),n(522),n(8295),n(7842),n(110),n(75),n(4336),n(1802),n(8837),n(6773),n(5745),n(3057),n(3750),n(3369),n(9564),n(2e3),n(8977),n(2310),n(4899),n(1842),n(6997),n(3946),n(8269),n(6108),n(6774),n(1466),n(9357),n(6142),n(1876),n(851),n(8416),n(8184),n(147),n(9192),n(142),n(1786),n(5368),n(6964),n(2152),n(4821),n(9103),n(1303),n(3318),n(162),n(3834),n(1572),n(2139),n(685),n(5535),n(7347),n(3049),n(6633),n(8989),n(8270),n(4510),n(3984),n(5769),n(55),n(6014),n(2773),n(1268),n(4692),n(7220),n(1784),n(2770),n(5869),n(4325),n(4208),n(9665),n(9593),n(8351),n(6409),n(3276),n(8646),n(2658),n(6917),n(372),n(7698),n(8739),n(8211),n(4837),n(7594),n(9550),n(525),n(9467),n(4188),n(3495),n(5575),n(8967),n(2559),n(8865),n(368),n(6427),n(286),n(2816),n(5986),n(2082),n(6308),n(9221),n(3570),n(6754),n(3776),n(9865),n(1898),n(3364),n(1432),n(6562),n(4416),n(8681),n(2213),n(3471),n(4329),n(5159),n(8267),n(6534),n(2564),n(4633),n(1181),t.exports=n(5645)},4020:t=>{"use strict";function e(t,n){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;n=n||1;var i=t.slice(0,n),r=t.slice(n);return Array.prototype.concat.call([],e(i),e(r))}function n(t){try{return decodeURIComponent(t)}catch(o){for(var n=t.match(r),i=1;i<n.length;i++)n=(t=e(n,i).join("")).match(r);return t}}var i="%[a-f0-9]{2}",r=new RegExp(i,"gi"),o=new RegExp("("+i+")+","gi");t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},i=o.exec(t);i;){try{e[i[0]]=decodeURIComponent(i[0])}catch(t){var r=n(i[0]);r!==i[0]&&(e[i[0]]=r)}i=o.exec(t)}e["%C2"]="�";for(var s=Object.keys(e),a=0;a<s.length;a++){var l=s[a];t=t.replace(new RegExp(l,"g"),e[l])}return t}(t)}}},9187:t=>{"use strict";function e(t,e,o){o=o||2;var s,a,l,h,d,f,m,g=e&&e.length,y=g?e[0]*o:t.length,v=n(t,0,y,o,!0),x=[];if(!v||v.next===v.prev)return x;if(g&&(v=function(t,e,r,o){var s,a,l,h=[];for(s=0,a=e.length;s<a;s++)(l=n(t,e[s]*o,s<a-1?e[s+1]*o:t.length,o,!1))===l.next&&(l.steiner=!0),h.push(p(l));for(h.sort(u),s=0;s<h.length;s++)c(h[s],r),r=i(r,r.next);return r}(t,e,v,o)),t.length>80*o){s=l=t[0],a=h=t[1];for(var b=o;b<y;b+=o)(d=t[b])<s&&(s=d),(f=t[b+1])<a&&(a=f),d>l&&(l=d),f>h&&(h=f);m=0!==(m=Math.max(l-s,h-a))?1/m:0}return r(v,x,o,s,a,m),x}function n(t,e,n,i,r){var o,s;if(r===T(t,e,n,i)>0)for(o=e;o<n;o+=i)s=S(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=S(o,t[o],t[o+1],s);return s&&y(s,s.next)&&(A(s),s=s.next),s}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==g(i.prev,i,i.next))i=i.next;else{if(A(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,u,c,h,p){if(t){!p&&h&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(t,u,c,h);for(var f,m,g=t;t.prev!==t.next;)if(f=t.prev,m=t.next,h?s(t,u,c,h):o(t))e.push(f.i/n),e.push(t.i/n),e.push(m.i/n),A(t),t=m.next,g=m.next;else if((t=m)===g){p?1===p?r(t=a(i(t),e,n),e,n,u,c,h,2):2===p&&l(t,e,n,u,c,h):r(i(t),e,n,u,c,h,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(g(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(f(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&g(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function s(t,e,n,i){var r=t.prev,o=t,s=t.next;if(g(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=d(a,l,e,n,i),p=d(u,c,e,n,i),m=t.prevZ,y=t.nextZ;m&&m.z>=h&&y&&y.z<=p;){if(m!==t.prev&&m!==t.next&&f(r.x,r.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;if(m=m.prevZ,y!==t.prev&&y!==t.next&&f(r.x,r.y,o.x,o.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;m&&m.z>=h;){if(m!==t.prev&&m!==t.next&&f(r.x,r.y,o.x,o.y,s.x,s.y,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;y&&y.z<=p;){if(y!==t.prev&&y!==t.next&&f(r.x,r.y,o.x,o.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function a(t,e,n){var r=t;do{var o=r.prev,s=r.next.next;!y(o,s)&&v(o,r,r.next,s)&&_(o,s)&&_(s,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(s.i/n),A(r),A(r.next),r=t=s),r=r.next}while(r!==t);return i(r)}function l(t,e,n,o,s,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&m(l,u)){var c=w(l,u);return l=i(l,l.next),c=i(c,c.next),r(l,e,n,o,s,a),void r(c,e,n,o,s,a)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function c(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n;var l,u=n,c=n.x,d=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&f(o<d?r:s,o,c,d,o<d?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),_(i,t)&&(l<p||l===p&&(i.x>n.x||i.x===n.x&&h(n,i)))&&(n=i,p=l)),i=i.next}while(i!==u);return n}(t,e),e){var n=w(e,t);i(e,e.next),i(n,n.next)}}function h(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function f(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(_(t,e)&&_(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||y(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,i){var r=b(g(t,e,n)),o=b(g(t,e,i)),s=b(g(n,i,t)),a=b(g(n,i,e));return r!==o&&s!==a||!(0!==r||!x(t,n,e))||!(0!==o||!x(t,i,e))||!(0!==s||!x(n,t,i))||!(0!==a||!x(n,e,i))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function _(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function w(t,e){var n=new M(t.i,t.x,t.y),i=new M(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function S(t,e,n,i){var r=new M(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(T(t,0,o,n));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(T(t,u,c,n))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*n,p=i[a+1]*n,f=i[a+2]*n;h+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},6713:function(t,e,n){var i;!function(r){function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(){for(var t=0;t<T.length;t++)T[t][0](T[t][1]);T=[],x=!1}function a(t,e){T.push([t,e]),x||(x=!0,M(s,0))}function l(t){var e=t.owner,n=e.state_,i=e.data_,r=t[n],o=t.then;if("function"==typeof r){n=w;try{i=r(i)}catch(t){d(o,t)}}u(o,i)||(n===w&&c(o,i),n===S&&d(o,i))}function u(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var i=e.then;if("function"==typeof i)return i.call(e,(function(i){n||(n=!0,e!==i?c(t,i):h(t,i))}),(function(e){n||(n=!0,d(t,e))})),!0}}catch(e){return n||d(t,e),!0}return!1}function c(t,e){t!==e&&u(t,e)||h(t,e)}function h(t,e){t.state_===b&&(t.state_=_,t.data_=e,a(f,t))}function d(t,e){t.state_===b&&(t.state_=_,t.data_=e,a(m,t))}function p(t){var e=t.then_;t.then_=void 0;for(var n=0;n<e.length;n++)l(e[n])}function f(t){t.state_=w,p(t)}function m(t){t.state_=S,p(t)}function g(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof g==0)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function n(t){d(e,t)}try{t((function(t){c(e,t)}),n)}catch(t){n(t)}}(t,this)}var y=r.Promise,v=y&&"resolve"in y&&"reject"in y&&"all"in y&&"race"in y&&function(){var t;return new y((function(e){t=e})),"function"==typeof t}();e?(e.Promise=v?y:g,e.Polyfill=g):void 0===(i=function(){return v?y:g}.call(e,n,e,t))||(t.exports=i);var x,b="pending",_="sealed",w="fulfilled",S="rejected",A=function(){},M="undefined"!=typeof setImmediate?setImmediate:setTimeout,T=[];g.prototype={constructor:g,state_:b,then_:null,data_:void 0,then:function(t,e){var n={owner:this,then:new this.constructor(A),fulfilled:t,rejected:e};return this.state_===w||this.state_===S?a(l,n):this.then_.push(n),n.then},catch:function(t){return this.then(null,t)}},g.all=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.all().");return new this((function(e,n){function i(t){return s++,function(n){o[t]=n,--s||e(o)}}for(var r,o=[],s=0,a=0;a<t.length;a++)(r=t[a])&&"function"==typeof r.then?r.then(i(a),n):o[a]=r;s||e(o)}))},g.race=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.race().");return new this((function(e,n){for(var i,r=0;r<t.length;r++)(i=t[r])&&"function"==typeof i.then?i.then(e,n):e(i)}))},g.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}))},g.reject=function(t){return new this((function(e,n){n(t)}))}}("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:this)},6729:t=>{"use strict";function e(){}function n(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,i,r,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new n(i,r||t,o),l=a?a+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function r(t,n){0==--t._eventsCount?t._events=new e:delete t._events[n]}function o(){this._events=new e,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(e.prototype=Object.create(null),(new e).__proto__||(a=!1)),o.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)s.call(t,e)&&n.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var e=a?a+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,r=n.length,o=new Array(r);i<r;i++)o[i]=n[i].fn;return o},o.prototype.listenerCount=function(t){var e=a?a+t:t,n=this._events[e];return n?n.fn?1:n.length:0},o.prototype.emit=function(t,e,n,i,r,o){var s=a?a+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,r),!0;case 6:return c.fn.call(c.context,e,n,i,r,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},o.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},o.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},o.prototype.removeListener=function(t,e,n,i){var o=a?a+t:t;if(!this._events[o])return this;if(!e)return r(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||n&&s.context!==n||r(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||i&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:r(this,o)}return this},o.prototype.removeAllListeners=function(t){var n;return t?(n=a?a+t:t,this._events[n]&&r(this,n)):(this._events=new e,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=a,o.EventEmitter=o,t.exports=o},2806:t=>{"use strict";t.exports=function(t,e){for(var n={},i=Object.keys(t),r=Array.isArray(e),o=0;o<i.length;o++){var s=i[o],a=t[s];(r?-1!==e.indexOf(s):e(s,a,t))&&(n[s]=a)}return n}},1766:(t,e,n)=>{var i;!function(){"use strict";var r=function(){this.init()};r.prototype={init:function(){var t=this||o;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||o;if(t=parseFloat(t),e.ctx||p(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,o.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),r=0;r<i.length;r++){var s=e._howls[n]._soundById(i[r]);s&&s._node&&(s._node.volume=s._volume*t)}return e}return e._volume},mute:function(t){var e=this||o;e.ctx||p(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,o.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),r=0;r<i.length;r++){var s=e._howls[n]._soundById(i[r]);s&&s._node&&(s._node.muted=!!t||s._muted)}return e},stop:function(){for(var t=this||o,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||o,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,p()),t},codecs:function(t){return(this||o)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||o;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||o,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i=t._navigator?t._navigator.userAgent:"",r=i.match(/OPR\/([0-6].)/g),s=r&&parseInt(r[0].split("/")[1],10)<33,a=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),l=i.match(/Version\/(.*?) /),u=a&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(s||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||o;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,t._releaseHtml5Audio(i)}catch(n){t.noAudio=!0;break}for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var o=t._howls[r]._getSoundIds(),s=0;s<o.length;s++){var a=t._howls[r]._soundById(o[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),t}},_obtainHtml5Audio:function(){var t=this||o;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||o;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&o.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&o.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var o=new r,s=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};s.prototype={init:function(t){var e=this;return o.ctx||p(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=o.usingWebAudio&&!e._html5,void 0!==o.ctx&&o.ctx&&o.autoUnlock&&o._unlockAudio(),o._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(o.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var i,r;if(t._format&&t._format[n])i=t._format[n];else{if("string"!=typeof(r=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(r))||(i=/\.([^.]+)$/.exec(r.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&o.codecs(i)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new a(t),t._webAudio&&u(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,i=null;if("number"==typeof t)i=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var r=0,s=0;s<n._sounds.length;s++)n._sounds[s]._paused&&!n._sounds[s]._ended&&(r++,i=n._sounds[s]._id);1===r?t=null:i=null}}var a=i?n._soundById(i):n._inactiveSound();if(!a)return null;if(i&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var l=a._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(i&&!a._paused)return e||n._loadQueue("play"),a._id;n._webAudio&&o._autoResume();var u=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),c=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-u),h=1e3*c/Math.abs(a._rate),d=n._sprite[t][0]/1e3,p=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var f=function(){a._paused=!1,a._seek=u,a._start=d,a._stop=p,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(u>=p)){var m=a._node;if(n._webAudio){var g=function(){n._playLock=!1,f(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;m.gain.setValueAtTime(t,o.ctx.currentTime),a._playStart=o.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,c):a._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,c),h!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),h)),e||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===o.state&&"interrupted"!==o.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(a._id))}else{var y=function(){m.currentTime=u,m.muted=a._muted||n._muted||o._muted||m.muted,m.volume=a._volume*o.volume(),m.playbackRate=a._rate;try{var i=m.play();if(i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)?(n._playLock=!0,f(),i.then((function(){n._playLock=!1,m._unlocked=!0,e?n._loadQueue():n._emit("play",a._id)})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):e||(n._playLock=!1,f(),n._emit("play",a._id)),m.playbackRate=a._rate,m.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),h):(n._endTimers[a._id]=function(){n._ended(a),m.removeEventListener("ended",n._endTimers[a._id],!1)},m.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var v=window&&window.ejecta||!m.readyState&&o._navigator.isCocoonJS;if(m.readyState>=3||v)y();else{n._playLock=!0,n._state="loading";var x=function(){n._state="loaded",y(),m.removeEventListener(o._canPlayEvent,x,!1)};m.addEventListener(o._canPlayEvent,x,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),i=0;i<n.length;i++){e._clearTimer(n[i]);var r=e._soundById(n[i]);if(r&&!r._paused&&(r._seek=e.seek(n[i]),r._rateSeek=0,r._paused=!0,e._stopFade(n[i]),r._node))if(e._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),e._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||e._emit("pause",r?r._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var i=n._getSoundIds(t),r=0;r<i.length;r++){n._clearTimer(i[r]);var o=n._soundById(i[r]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(i[r]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),e||n._emit("stop",o._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(void 0===e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var i=n._getSoundIds(e),r=0;r<i.length;r++){var s=n._soundById(i[r]);s&&(s._muted=t,s._interval&&n._stopFade(s._id),n._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,o.ctx.currentTime):s._node&&(s._node.muted=!!o._muted||t),n._emit("mute",s._id))}return n},volume:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._volume;1===r.length||2===r.length&&void 0===r[1]?i._getSoundIds().indexOf(r[0])>=0?e=parseInt(r[0],10):t=parseFloat(r[0]):r.length>=2&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(n=e?i._soundById(e):i._sounds[0])?n._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,r)}}),i;void 0===e&&(i._volume=t),e=i._getSoundIds(e);for(var s=0;s<e.length;s++)(n=i._soundById(e[s]))&&(n._volume=t,r[2]||i._stopFade(e[s]),i._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,o.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*o.volume()),i._emit("volume",n._id));return i},fade:function(t,e,n,i){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(t,e,n,i)}}),r;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),r.volume(t,i);for(var s=r._getSoundIds(i),a=0;a<s.length;a++){var l=r._soundById(s[a]);if(l){if(i||r._stopFade(s[a]),r._webAudio&&!l._muted){var u=o.ctx.currentTime,c=u+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,u),l._node.gain.linearRampToValueAtTime(e,c)}r._startFadeInterval(l,t,e,n,s[a],void 0===i)}}return r},_startFadeInterval:function(t,e,n,i,r,o){var s=this,a=e,l=n-e,u=Math.abs(l/.01),c=Math.max(4,u>0?i/u:i),h=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var r=(Date.now()-h)/i;h=Date.now(),a+=l*r,a=Math.round(100*a)/100,a=l<0?Math.max(n,a):Math.min(n,a),s._webAudio?t._volume=a:s.volume(a,t._id,!0),o&&(s._volume=a),(n<e&&a<=n||n>e&&a>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,s.volume(n,t._id),s._emit("fade",t._id))}),c)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(o.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(n=i._soundById(parseInt(r[0],10)))&&n._loop;t=r[0],i._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var o=i._getSoundIds(e),s=0;s<o.length;s++)(n=i._soundById(o[s]))&&(n._loop=t,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(o[s])&&(i.pause(o[s],!0),i.play(o[s],!0)))));return i},rate:function(){var t,e,n,i=this,r=arguments;if(0===r.length)e=i._sounds[0]._id;else if(1===r.length){i._getSoundIds().indexOf(r[0])>=0?e=parseInt(r[0],10):t=parseFloat(r[0])}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if("number"!=typeof t)return(n=i._soundById(e))?n._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,r)}}),i;void 0===e&&(i._rate=t),e=i._getSoundIds(e);for(var s=0;s<e.length;s++)if(n=i._soundById(e[s])){i.playing(e[s])&&(n._rateSeek=i.seek(e[s]),n._playStart=i._webAudio?o.ctx.currentTime:n._playStart),n._rate=t,i._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,o.ctx.currentTime):n._node&&(n._node.playbackRate=t);var a=i.seek(e[s]),l=1e3*((i._sprite[n._sprite][0]+i._sprite[n._sprite][1])/1e3-a)/Math.abs(n._rate);!i._endTimers[e[s]]&&n._paused||(i._clearTimer(e[s]),i._endTimers[e[s]]=setTimeout(i._ended.bind(i,n),l)),i._emit("rate",n._id)}return i},seek:function(){var t,e,n=this,i=arguments;if(0===i.length)n._sounds.length&&(e=n._sounds[0]._id);else if(1===i.length){n._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(i[0]))}else 2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10));if(void 0===e)return 0;if("number"==typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var r=n._soundById(e);if(r){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var s=n.playing(e)?o.ctx.currentTime-r._playStart:0,a=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(a+s*Math.abs(r._rate))}return r._node.currentTime}var l=n.playing(e);l&&n.pause(e,!0),r._seek=t,r._ended=!1,n._clearTimer(e),n._webAudio||!r._node||isNaN(r._node.duration)||(r._node.currentTime=t);var u=function(){l&&n.play(e,!0),n._emit("seek",e)};if(l&&!n._webAudio){var c=function(){n._playLock?setTimeout(c,0):u()};setTimeout(c,0)}else u()}return n},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var i=0;i<e._sounds.length;i++)if(!e._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,i=e._soundById(t);return i&&(n=e._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(o._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),o._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var i=o._howls.indexOf(t);i>=0&&o._howls.splice(i,1);var r=!0;for(n=0;n<o._howls.length;n++)if(o._howls[n]._src===t._src||t._src.indexOf(o._howls[n]._src)>=0){r=!1;break}return l&&r&&delete l[t._src],o.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,i){var r=this["_on"+t];return"function"==typeof e&&r.push(i?{id:n,fn:e,once:i}:{id:n,fn:e}),this},off:function(t,e,n){var i=this,r=i["_on"+t],o=0;if("number"==typeof e&&(n=e,e=null),e||n)for(o=0;o<r.length;o++){var s=n===r[o].id;if(e===r[o].fn&&s||!e&&s){r.splice(o,1);break}}else if(t)i["_on"+t]=[];else{var a=Object.keys(i);for(o=0;o<a.length;o++)0===a[o].indexOf("_on")&&Array.isArray(i[a[o]])&&(i[a[o]]=[])}return i},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var i=this,r=i["_on"+t],o=r.length-1;o>=0;o--)r[o].id&&r[o].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(i,r[o].fn),0),r[o].once&&i.off(t,r[o].fn,r[o].id));return i._loadQueue(t),i},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var i=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&i&&e.stop(t._id,!0).play(t._id),e._webAudio&&i){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=o.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),r)}return e._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),o._autoSuspend()),e._webAudio||i||e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new a(t)},_drain:function(){var t=this,e=t._pool,n=0,i=0;if(!(t._sounds.length<e)){for(i=0;i<t._sounds.length;i++)t._sounds[i]._ended&&n++;for(i=t._sounds.length-1;i>=0;i--){if(n<=e)return;t._sounds[i]._ended&&(t._webAudio&&t._sounds[i]._node&&t._sounds[i]._node.disconnect(0),t._sounds.splice(i,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=o.ctx.createBufferSource(),t._node.bufferSource.buffer=l[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,o.ctx.currentTime),this},_cleanBuffer:function(t){var e=o._navigator&&o._navigator.vendor.indexOf("Apple")>=0;if(o._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=o._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(o._navigator&&o._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++o._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=o._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),t._node.gain.setValueAtTime(n,o.ctx.currentTime),t._node.paused=!0,t._node.connect(o.masterGain)):o.noAudio||(t._node=o._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(o._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*o.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++o._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(o._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var l={},u=function(t){var e=t._src;if(l[e])return t._duration=l[e].duration,void d(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);h(i.buffer,t)}else{var o=new XMLHttpRequest;o.open(t._xhr.method,e,!0),o.withCredentials=t._xhr.withCredentials,o.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){o.setRequestHeader(e,t._xhr.headers[e])})),o.onload=function(){var e=(o.status+"")[0];"0"===e||"2"===e||"3"===e?h(o.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete l[e],t.load())},c(o)}},c=function(t){try{t.send()}catch(e){t.onerror()}},h=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},i=function(t){t&&e._sounds.length>0?(l[e._src]=t,d(e,t)):n()};"undefined"!=typeof Promise&&1===o.ctx.decodeAudioData.length?o.ctx.decodeAudioData(t).then(i).catch(n):o.ctx.decodeAudioData(t,i,n)},d=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},p=function(){if(o.usingWebAudio){try{"undefined"!=typeof AudioContext?o.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?o.ctx=new webkitAudioContext:o.usingWebAudio=!1}catch(t){o.usingWebAudio=!1}o.ctx||(o.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(o._navigator&&o._navigator.platform),e=o._navigator&&o._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var i=/safari/.test(o._navigator&&o._navigator.userAgent.toLowerCase());o._navigator&&!i&&(o.usingWebAudio=!1)}o.usingWebAudio&&(o.masterGain=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),o.masterGain.gain.setValueAtTime(o._muted?0:o._volume,o.ctx.currentTime),o.masterGain.connect(o.ctx.destination)),o._setup()}};void 0===(i=function(){return{Howler:o,Howl:s}}.apply(e,[]))||(t.exports=i),e.Howler=o,e.Howl=s,void 0!==n.g?(n.g.HowlerGlobal=r,n.g.Howler=o,n.g.Howl=s,n.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=r,window.Howler=o,window.Howl=s,window.Sound=a)}(),function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var i=this;return i.ctx&&i.ctx.listener?(e="number"!=typeof e?i._pos[1]:e,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof t?i._pos:(i._pos=[t,e,n],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(t,e,n,i,r,o){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return e="number"!=typeof e?a[1]:e,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,r="number"!=typeof r?a[4]:r,o="number"!=typeof o?a[5]:o,"number"!=typeof t?a:(s._orientation=[t,e,n,i,r,o],void 0!==s.ctx.listener.forwardX?(s.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),s.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),s.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),s.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),s.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),s.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):s.ctx.listener.setOrientation(t,e,n,i,r,o),s)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var o=i._getSoundIds(n),s=0;s<o.length;s++){var a=i._soundById(o[s]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,r),"spatial"===r?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(t,0,0):a._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(t,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(t,n,i,r)}}),o;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===r){if("number"!=typeof t)return o._pos;o._pos=[t,n,i]}for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var l=o._soundById(s[a]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,n,i],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(t,n,i)),o._emit("pos",l._id)}}return o},Howl.prototype.orientation=function(t,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(t,n,i,r)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,i="number"!=typeof i?o._orientation[2]:i,void 0===r){if("number"!=typeof t)return o._orientation;o._orientation=[t,n,i]}for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var l=o._soundById(s[a]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,n,i],l._node&&(l._panner||(l._pos||(l._pos=o._pos||[0,0,-.5]),e(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(t,n,i)),o._emit("orientation",l._id)}}return o},Howl.prototype.pannerAttr=function(){var t,n,i,r=this,o=arguments;if(!r._webAudio)return r;if(0===o.length)return r._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(i=r._soundById(parseInt(o[0],10)))?i._pannerAttr:r._pannerAttr;t=o[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===o.length&&(t=o[0],n=parseInt(o[1],10));for(var s=r._getSoundIds(n),a=0;a<s.length;a++)if(i=r._soundById(s[a])){var l=i._pannerAttr;l={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:l.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:l.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:l.panningModel};var u=i._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(i._pos||(i._pos=r._pos||[0,0,-.5]),e(i,"spatial"))}return r},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()},9842:function(t,e,n){var i;i=function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(i,r,function(e){return t[e]}.bind(null,r));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=20)}([function(t,e){var i={};t.exports=i,function(){i._baseDelta=1e3/60,i._nextId=0,i._seed=0,i._nowStartTime=+new Date,i._warnedOnce={},i._decomp=null,i.extend=function(t,e){var n,r;"boolean"==typeof e?(n=2,r=e):(n=1,r=!0);for(var o=n;o<arguments.length;o++){var s=arguments[o];if(s)for(var a in s)r&&s[a]&&s[a].constructor===Object?t[a]&&t[a].constructor!==Object?t[a]=s[a]:(t[a]=t[a]||{},i.extend(t[a],r,s[a])):t[a]=s[a]}return t},i.clone=function(t,e){return i.extend({},e,t)},i.keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},i.values=function(t){var e=[];if(Object.keys){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(t[n[i]]);return e}for(var r in t)e.push(t[r]);return e},i.get=function(t,e,n,i){e=e.split(".").slice(n,i);for(var r=0;r<e.length;r+=1)t=t[e[r]];return t},i.set=function(t,e,n,r,o){var s=e.split(".").slice(r,o);return i.get(t,e,0,-1)[s[s.length-1]]=n,n},i.shuffle=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(i.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t},i.choose=function(t){return t[Math.floor(i.random()*t.length)]},i.isElement=function(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},i.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isFunction=function(t){return"function"==typeof t},i.isPlainObject=function(t){return"object"==typeof t&&t.constructor===Object},i.isString=function(t){return"[object String]"===toString.call(t)},i.clamp=function(t,e,n){return t<e?e:t>n?n:t},i.sign=function(t){return t<0?-1:1},i.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-i._nowStartTime},i.random=function(e,n){return n=void 0!==n?n:1,(e=void 0!==e?e:0)+t()*(n-e)};var t=function(){return i._seed=(9301*i._seed+49297)%233280,i._seed/233280};i.colorToNumber=function(t){return 3==(t=t.replace("#","")).length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},i.logLevel=1,i.log=function(){console&&i.logLevel>0&&i.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.info=function(){console&&i.logLevel>0&&i.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.warn=function(){console&&i.logLevel>0&&i.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.warnOnce=function(){var t=Array.prototype.slice.call(arguments).join(" ");i._warnedOnce[t]||(i.warn(t),i._warnedOnce[t]=!0)},i.deprecated=function(t,e,n){t[e]=i.chain((function(){i.warnOnce("🔅 deprecated 🔅",n)}),t[e])},i.nextId=function(){return i._nextId++},i.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},i.map=function(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n},i.topologicalSort=function(t){var e=[],n=[],r=[];for(var o in t)n[o]||r[o]||i._topologicalSort(o,n,r,t,e);return e},i._topologicalSort=function(t,e,n,r,o){var s=r[t]||[];n[t]=!0;for(var a=0;a<s.length;a+=1){var l=s[a];n[l]||e[l]||i._topologicalSort(l,e,n,r,o)}n[t]=!1,e[t]=!0,o.push(t)},i.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var n=arguments[e];n._chained?t.push.apply(t,n._chained):t.push(n)}var i=function(){for(var e,n=new Array(arguments.length),i=0,r=arguments.length;i<r;i++)n[i]=arguments[i];for(i=0;i<t.length;i+=1){var o=t[i].apply(e,n);void 0!==o&&(e=o)}return e};return i._chained=t,i},i.chainPathBefore=function(t,e,n){return i.set(t,e,i.chain(n,i.get(t,e)))},i.chainPathAfter=function(t,e,n){return i.set(t,e,i.chain(i.get(t,e),n))},i.setDecomp=function(t){i._decomp=t},i.getDecomp=function(){var t=i._decomp;try{t||"undefined"==typeof window||(t=window.decomp),t||void 0===n.g||(t=n.g.decomp)}catch(e){t=null}return t}}()},function(t,e){var n={};t.exports=n,n.create=function(t){var e={min:{x:0,y:0},max:{x:0,y:0}};return t&&n.update(e,t),e},n.update=function(t,e,n){t.min.x=1/0,t.max.x=-1/0,t.min.y=1/0,t.max.y=-1/0;for(var i=0;i<e.length;i++){var r=e[i];r.x>t.max.x&&(t.max.x=r.x),r.x<t.min.x&&(t.min.x=r.x),r.y>t.max.y&&(t.max.y=r.y),r.y<t.min.y&&(t.min.y=r.y)}n&&(n.x>0?t.max.x+=n.x:t.min.x+=n.x,n.y>0?t.max.y+=n.y:t.min.y+=n.y)},n.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},n.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},n.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},n.shift=function(t,e){var n=t.max.x-t.min.x,i=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+n,t.min.y=e.y,t.max.y=e.y+i}},function(t,e){var n={};t.exports=n,n.create=function(t,e){return{x:t||0,y:e||0}},n.clone=function(t){return{x:t.x,y:t.y}},n.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},n.rotate=function(t,e,n){var i=Math.cos(e),r=Math.sin(e);n||(n={});var o=t.x*i-t.y*r;return n.y=t.x*r+t.y*i,n.x=o,n},n.rotateAbout=function(t,e,n,i){var r=Math.cos(e),o=Math.sin(e);i||(i={});var s=n.x+((t.x-n.x)*r-(t.y-n.y)*o);return i.y=n.y+((t.x-n.x)*o+(t.y-n.y)*r),i.x=s,i},n.normalise=function(t){var e=n.magnitude(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}},n.dot=function(t,e){return t.x*e.x+t.y*e.y},n.cross=function(t,e){return t.x*e.y-t.y*e.x},n.cross3=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},n.add=function(t,e,n){return n||(n={}),n.x=t.x+e.x,n.y=t.y+e.y,n},n.sub=function(t,e,n){return n||(n={}),n.x=t.x-e.x,n.y=t.y-e.y,n},n.mult=function(t,e){return{x:t.x*e,y:t.y*e}},n.div=function(t,e){return{x:t.x/e,y:t.y/e}},n.perp=function(t,e){return{x:(e=!0===e?-1:1)*-t.y,y:e*t.x}},n.neg=function(t){return{x:-t.x,y:-t.y}},n.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(t,e,n){var i={};t.exports=i;var r=n(2),o=n(0);i.create=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],o={x:r.x,y:r.y,index:i,body:e,isInternal:!1};n.push(o)}return n},i.fromPath=function(t,e){var n=[];return t.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(t,e,i){n.push({x:parseFloat(e),y:parseFloat(i)})})),i.create(n,e)},i.centre=function(t){for(var e,n,o,s=i.area(t,!0),a={x:0,y:0},l=0;l<t.length;l++)o=(l+1)%t.length,e=r.cross(t[l],t[o]),n=r.mult(r.add(t[l],t[o]),e),a=r.add(a,n);return r.div(a,6*s)},i.mean=function(t){for(var e={x:0,y:0},n=0;n<t.length;n++)e.x+=t[n].x,e.y+=t[n].y;return r.div(e,t.length)},i.area=function(t,e){for(var n=0,i=t.length-1,r=0;r<t.length;r++)n+=(t[i].x-t[r].x)*(t[i].y+t[r].y),i=r;return e?n/2:Math.abs(n)/2},i.inertia=function(t,e){for(var n,i,o=0,s=0,a=t,l=0;l<a.length;l++)i=(l+1)%a.length,o+=(n=Math.abs(r.cross(a[i],a[l])))*(r.dot(a[i],a[i])+r.dot(a[i],a[l])+r.dot(a[l],a[l])),s+=n;return e/6*(o/s)},i.translate=function(t,e,n){n=void 0!==n?n:1;var i,r=t.length,o=e.x*n,s=e.y*n;for(i=0;i<r;i++)t[i].x+=o,t[i].y+=s;return t},i.rotate=function(t,e,n){if(0!==e){var i,r,o,s,a=Math.cos(e),l=Math.sin(e),u=n.x,c=n.y,h=t.length;for(s=0;s<h;s++)r=(i=t[s]).x-u,o=i.y-c,i.x=u+(r*a-o*l),i.y=c+(r*l+o*a);return t}},i.contains=function(t,e){for(var n,i=e.x,r=e.y,o=t.length,s=t[o-1],a=0;a<o;a++){if(n=t[a],(i-s.x)*(n.y-s.y)+(r-s.y)*(s.x-n.x)>0)return!1;s=n}return!0},i.scale=function(t,e,n,o){if(1===e&&1===n)return t;var s,a;o=o||i.centre(t);for(var l=0;l<t.length;l++)s=t[l],a=r.sub(s,o),t[l].x=o.x+a.x*e,t[l].y=o.y+a.y*n;return t},i.chamfer=function(t,e,n,i,s){e="number"==typeof e?[e]:e||[8],n=void 0!==n?n:-1,i=i||2,s=s||14;for(var a=[],l=0;l<t.length;l++){var u=t[l-1>=0?l-1:t.length-1],c=t[l],h=t[(l+1)%t.length],d=e[l<e.length?l:e.length-1];if(0!==d){var p=r.normalise({x:c.y-u.y,y:u.x-c.x}),f=r.normalise({x:h.y-c.y,y:c.x-h.x}),m=Math.sqrt(2*Math.pow(d,2)),g=r.mult(o.clone(p),d),y=r.normalise(r.mult(r.add(p,f),.5)),v=r.sub(c,r.mult(y,m)),x=n;-1===n&&(x=1.75*Math.pow(d,.32)),(x=o.clamp(x,i,s))%2==1&&(x+=1);for(var b=Math.acos(r.dot(p,f))/x,_=0;_<x;_++)a.push(r.add(r.rotate(g,b*_),v))}else a.push(c)}return a},i.clockwiseSort=function(t){var e=i.mean(t);return t.sort((function(t,n){return r.angle(e,t)-r.angle(e,n)})),t},i.isConvex=function(t){var e,n,i,r,o=0,s=t.length;if(s<3)return null;for(e=0;e<s;e++)if(i=(e+2)%s,r=(t[n=(e+1)%s].x-t[e].x)*(t[i].y-t[n].y),(r-=(t[n].y-t[e].y)*(t[i].x-t[n].x))<0?o|=1:r>0&&(o|=2),3===o)return!1;return 0!==o||null},i.hull=function(t){var e,n,i=[],o=[];for((t=t.slice(0)).sort((function(t,e){var n=t.x-e.x;return 0!==n?n:t.y-e.y})),n=0;n<t.length;n+=1){for(e=t[n];o.length>=2&&r.cross3(o[o.length-2],o[o.length-1],e)<=0;)o.pop();o.push(e)}for(n=t.length-1;n>=0;n-=1){for(e=t[n];i.length>=2&&r.cross3(i[i.length-2],i[i.length-1],e)<=0;)i.pop();i.push(e)}return i.pop(),o.pop(),i.concat(o)}},function(t,e,n){var i={};t.exports=i;var r=n(3),o=n(2),s=n(7),a=n(0),l=n(1),u=n(11);!function(){i._timeCorrection=!0,i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i._baseDelta=1e3/60,i.create=function(e){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:r.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:1e3/60,_original:null},i=a.extend(n,e);return t(i,e),i},i.nextGroup=function(t){return t?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var t=function(t,e){e=e||{},i.set(t,{bounds:t.bounds||l.create(t.vertices),positionPrev:t.positionPrev||o.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),r.rotate(t.vertices,t.angle,t.position),u.rotate(t.axes,t.angle),l.update(t.bounds,t.vertices,t.velocity),i.set(t,{axes:e.axes||t.axes,area:e.area||t.area,mass:e.mass||t.mass,inertia:e.inertia||t.inertia});var n=t.isStatic?"#14151f":a.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),s=t.isStatic?"#555":"#ccc",c=t.isStatic&&null===t.render.fillStyle?1:0;t.render.fillStyle=t.render.fillStyle||n,t.render.strokeStyle=t.render.strokeStyle||s,t.render.lineWidth=t.render.lineWidth||c,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};i.set=function(t,e,n){var r;for(r in"string"==typeof e&&(r=e,(e={})[r]=n),e)if(Object.prototype.hasOwnProperty.call(e,r))switch(n=e[r],r){case"isStatic":i.setStatic(t,n);break;case"isSleeping":s.set(t,n);break;case"mass":i.setMass(t,n);break;case"density":i.setDensity(t,n);break;case"inertia":i.setInertia(t,n);break;case"vertices":i.setVertices(t,n);break;case"position":i.setPosition(t,n);break;case"angle":i.setAngle(t,n);break;case"velocity":i.setVelocity(t,n);break;case"angularVelocity":i.setAngularVelocity(t,n);break;case"speed":i.setSpeed(t,n);break;case"angularSpeed":i.setAngularSpeed(t,n);break;case"parts":i.setParts(t,n);break;case"centre":i.setCentre(t,n);break;default:t[r]=n}},i.setStatic=function(t,e){for(var n=0;n<t.parts.length;n++){var i=t.parts[n];i.isStatic=e,e?(i._original={restitution:i.restitution,friction:i.friction,mass:i.mass,inertia:i.inertia,density:i.density,inverseMass:i.inverseMass,inverseInertia:i.inverseInertia},i.restitution=0,i.friction=1,i.mass=i.inertia=i.density=1/0,i.inverseMass=i.inverseInertia=0,i.positionPrev.x=i.position.x,i.positionPrev.y=i.position.y,i.anglePrev=i.angle,i.angularVelocity=0,i.speed=0,i.angularSpeed=0,i.motion=0):i._original&&(i.restitution=i._original.restitution,i.friction=i._original.friction,i.mass=i._original.mass,i.inertia=i._original.inertia,i.density=i._original.density,i.inverseMass=i._original.inverseMass,i.inverseInertia=i._original.inverseInertia,i._original=null)}},i.setMass=function(t,e){var n=t.inertia/(t.mass/6);t.inertia=n*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},i.setDensity=function(t,e){i.setMass(t,e*t.area),t.density=e},i.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},i.setVertices=function(t,e){e[0].body===t?t.vertices=e:t.vertices=r.create(e,t),t.axes=u.fromVertices(t.vertices),t.area=r.area(t.vertices),i.setMass(t,t.density*t.area);var n=r.centre(t.vertices);r.translate(t.vertices,n,-1),i.setInertia(t,i._inertiaScale*r.inertia(t.vertices,t.mass)),r.translate(t.vertices,t.position),l.update(t.bounds,t.vertices,t.velocity)},i.setParts=function(t,e,n){var o;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,o=0;o<e.length;o++){var s=e[o];s!==t&&(s.parent=t,t.parts.push(s))}if(1!==t.parts.length){if(n=void 0===n||n){var a=[];for(o=0;o<e.length;o++)a=a.concat(e[o].vertices);r.clockwiseSort(a);var l=r.hull(a),u=r.centre(l);i.setVertices(t,l),r.translate(t.vertices,u)}var c=i._totalProperties(t);t.area=c.area,t.parent=t,t.position.x=c.centre.x,t.position.y=c.centre.y,t.positionPrev.x=c.centre.x,t.positionPrev.y=c.centre.y,i.setMass(t,c.mass),i.setInertia(t,c.inertia),i.setPosition(t,c.centre)}},i.setCentre=function(t,e,n){n?(t.positionPrev.x+=e.x,t.positionPrev.y+=e.y,t.position.x+=e.x,t.position.y+=e.y):(t.positionPrev.x=e.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=e.y-(t.position.y-t.positionPrev.y),t.position.x=e.x,t.position.y=e.y)},i.setPosition=function(t,e,n){var i=o.sub(e,t.position);n?(t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.velocity.x=i.x,t.velocity.y=i.y,t.speed=o.magnitude(i)):(t.positionPrev.x+=i.x,t.positionPrev.y+=i.y);for(var s=0;s<t.parts.length;s++){var a=t.parts[s];a.position.x+=i.x,a.position.y+=i.y,r.translate(a.vertices,i),l.update(a.bounds,a.vertices,t.velocity)}},i.setAngle=function(t,e,n){var i=e-t.angle;n?(t.anglePrev=t.angle,t.angularVelocity=i,t.angularSpeed=Math.abs(i)):t.anglePrev+=i;for(var s=0;s<t.parts.length;s++){var a=t.parts[s];a.angle+=i,r.rotate(a.vertices,i,t.position),u.rotate(a.axes,i),l.update(a.bounds,a.vertices,t.velocity),s>0&&o.rotateAbout(a.position,i,t.position,a.position)}},i.setVelocity=function(t,e){var n=t.deltaTime/i._baseDelta;t.positionPrev.x=t.position.x-e.x*n,t.positionPrev.y=t.position.y-e.y*n,t.velocity.x=(t.position.x-t.positionPrev.x)/n,t.velocity.y=(t.position.y-t.positionPrev.y)/n,t.speed=o.magnitude(t.velocity)},i.getVelocity=function(t){var e=i._baseDelta/t.deltaTime;return{x:(t.position.x-t.positionPrev.x)*e,y:(t.position.y-t.positionPrev.y)*e}},i.getSpeed=function(t){return o.magnitude(i.getVelocity(t))},i.setSpeed=function(t,e){i.setVelocity(t,o.mult(o.normalise(i.getVelocity(t)),e))},i.setAngularVelocity=function(t,e){var n=t.deltaTime/i._baseDelta;t.anglePrev=t.angle-e*n,t.angularVelocity=(t.angle-t.anglePrev)/n,t.angularSpeed=Math.abs(t.angularVelocity)},i.getAngularVelocity=function(t){return(t.angle-t.anglePrev)*i._baseDelta/t.deltaTime},i.getAngularSpeed=function(t){return Math.abs(i.getAngularVelocity(t))},i.setAngularSpeed=function(t,e){i.setAngularVelocity(t,a.sign(i.getAngularVelocity(t))*e)},i.translate=function(t,e,n){i.setPosition(t,o.add(t.position,e),n)},i.rotate=function(t,e,n,r){if(n){var o=Math.cos(e),s=Math.sin(e),a=t.position.x-n.x,l=t.position.y-n.y;i.setPosition(t,{x:n.x+(a*o-l*s),y:n.y+(a*s+l*o)},r),i.setAngle(t,t.angle+e,r)}else i.setAngle(t,t.angle+e,r)},i.scale=function(t,e,n,o){var s=0,a=0;o=o||t.position;for(var c=0;c<t.parts.length;c++){var h=t.parts[c];r.scale(h.vertices,e,n,o),h.axes=u.fromVertices(h.vertices),h.area=r.area(h.vertices),i.setMass(h,t.density*h.area),r.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),i.setInertia(h,i._inertiaScale*r.inertia(h.vertices,h.mass)),r.translate(h.vertices,{x:h.position.x,y:h.position.y}),c>0&&(s+=h.area,a+=h.inertia),h.position.x=o.x+(h.position.x-o.x)*e,h.position.y=o.y+(h.position.y-o.y)*n,l.update(h.bounds,h.vertices,t.velocity)}t.parts.length>1&&(t.area=s,t.isStatic||(i.setMass(t,t.density*s),i.setInertia(t,a))),t.circleRadius&&(e===n?t.circleRadius*=e:t.circleRadius=null)},i.update=function(t,e){var n=(e=(void 0!==e?e:1e3/60)*t.timeScale)*e,s=i._timeCorrection?e/(t.deltaTime||e):1,c=1-t.frictionAir*(e/a._baseDelta),h=(t.position.x-t.positionPrev.x)*s,d=(t.position.y-t.positionPrev.y)*s;t.velocity.x=h*c+t.force.x/t.mass*n,t.velocity.y=d*c+t.force.y/t.mass*n,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.deltaTime=e,t.angularVelocity=(t.angle-t.anglePrev)*c*s+t.torque/t.inertia*n,t.anglePrev=t.angle,t.angle+=t.angularVelocity;for(var p=0;p<t.parts.length;p++){var f=t.parts[p];r.translate(f.vertices,t.velocity),p>0&&(f.position.x+=t.velocity.x,f.position.y+=t.velocity.y),0!==t.angularVelocity&&(r.rotate(f.vertices,t.angularVelocity,t.position),u.rotate(f.axes,t.angularVelocity),p>0&&o.rotateAbout(f.position,t.angularVelocity,t.position,f.position)),l.update(f.bounds,f.vertices,t.velocity)}},i.updateVelocities=function(t){var e=i._baseDelta/t.deltaTime,n=t.velocity;n.x=(t.position.x-t.positionPrev.x)*e,n.y=(t.position.y-t.positionPrev.y)*e,t.speed=Math.sqrt(n.x*n.x+n.y*n.y),t.angularVelocity=(t.angle-t.anglePrev)*e,t.angularSpeed=Math.abs(t.angularVelocity)},i.applyForce=function(t,e,n){var i=e.x-t.position.x,r=e.y-t.position.y;t.force.x+=n.x,t.force.y+=n.y,t.torque+=i*n.y-r*n.x},i._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===t.parts.length?0:1;n<t.parts.length;n++){var i=t.parts[n],r=i.mass!==1/0?i.mass:1;e.mass+=r,e.area+=i.area,e.inertia+=i.inertia,e.centre=o.add(e.centre,o.mult(i.position,r))}return e.centre=o.div(e.centre,e.mass),e}}()},function(t,e,n){var i={};t.exports=i;var r=n(0);i.on=function(t,e,n){for(var i,r=e.split(" "),o=0;o<r.length;o++)i=r[o],t.events=t.events||{},t.events[i]=t.events[i]||[],t.events[i].push(n);return n},i.off=function(t,e,n){if(e){"function"==typeof e&&(n=e,e=r.keys(t.events).join(" "));for(var i=e.split(" "),o=0;o<i.length;o++){var s=t.events[i[o]],a=[];if(n&&s)for(var l=0;l<s.length;l++)s[l]!==n&&a.push(s[l]);t.events[i[o]]=a}}else t.events={}},i.trigger=function(t,e,n){var i,o,s,a,l=t.events;if(l&&r.keys(l).length>0){n||(n={}),i=e.split(" ");for(var u=0;u<i.length;u++)if(s=l[o=i[u]]){(a=r.clone(n,!1)).name=o,a.source=t;for(var c=0;c<s.length;c++)s[c].apply(t,[a])}}}},function(t,e,n){var i={};t.exports=i;var r=n(5),o=n(0),s=n(1),a=n(4);i.create=function(t){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},t)},i.setModified=function(t,e,n,r){if(t.isModified=e,e&&t.cache&&(t.cache.allBodies=null,t.cache.allConstraints=null,t.cache.allComposites=null),n&&t.parent&&i.setModified(t.parent,e,n,r),r)for(var o=0;o<t.composites.length;o++){var s=t.composites[o];i.setModified(s,e,n,r)}},i.add=function(t,e){var n=[].concat(e);r.trigger(t,"beforeAdd",{object:e});for(var s=0;s<n.length;s++){var a=n[s];switch(a.type){case"body":if(a.parent!==a){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(t,a);break;case"constraint":i.addConstraint(t,a);break;case"composite":i.addComposite(t,a);break;case"mouseConstraint":i.addConstraint(t,a.constraint)}}return r.trigger(t,"afterAdd",{object:e}),t},i.remove=function(t,e,n){var o=[].concat(e);r.trigger(t,"beforeRemove",{object:e});for(var s=0;s<o.length;s++){var a=o[s];switch(a.type){case"body":i.removeBody(t,a,n);break;case"constraint":i.removeConstraint(t,a,n);break;case"composite":i.removeComposite(t,a,n);break;case"mouseConstraint":i.removeConstraint(t,a.constraint)}}return r.trigger(t,"afterRemove",{object:e}),t},i.addComposite=function(t,e){return t.composites.push(e),e.parent=t,i.setModified(t,!0,!0,!1),t},i.removeComposite=function(t,e,n){var r=o.indexOf(t.composites,e);if(-1!==r&&i.removeCompositeAt(t,r),n)for(var s=0;s<t.composites.length;s++)i.removeComposite(t.composites[s],e,!0);return t},i.removeCompositeAt=function(t,e){return t.composites.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addBody=function(t,e){return t.bodies.push(e),i.setModified(t,!0,!0,!1),t},i.removeBody=function(t,e,n){var r=o.indexOf(t.bodies,e);if(-1!==r&&i.removeBodyAt(t,r),n)for(var s=0;s<t.composites.length;s++)i.removeBody(t.composites[s],e,!0);return t},i.removeBodyAt=function(t,e){return t.bodies.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addConstraint=function(t,e){return t.constraints.push(e),i.setModified(t,!0,!0,!1),t},i.removeConstraint=function(t,e,n){var r=o.indexOf(t.constraints,e);if(-1!==r&&i.removeConstraintAt(t,r),n)for(var s=0;s<t.composites.length;s++)i.removeConstraint(t.composites[s],e,!0);return t},i.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),i.setModified(t,!0,!0,!1),t},i.clear=function(t,e,n){if(n)for(var r=0;r<t.composites.length;r++)i.clear(t.composites[r],e,!0);return e?t.bodies=t.bodies.filter((function(t){return t.isStatic})):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,i.setModified(t,!0,!0,!1),t},i.allBodies=function(t){if(t.cache&&t.cache.allBodies)return t.cache.allBodies;for(var e=[].concat(t.bodies),n=0;n<t.composites.length;n++)e=e.concat(i.allBodies(t.composites[n]));return t.cache&&(t.cache.allBodies=e),e},i.allConstraints=function(t){if(t.cache&&t.cache.allConstraints)return t.cache.allConstraints;for(var e=[].concat(t.constraints),n=0;n<t.composites.length;n++)e=e.concat(i.allConstraints(t.composites[n]));return t.cache&&(t.cache.allConstraints=e),e},i.allComposites=function(t){if(t.cache&&t.cache.allComposites)return t.cache.allComposites;for(var e=[].concat(t.composites),n=0;n<t.composites.length;n++)e=e.concat(i.allComposites(t.composites[n]));return t.cache&&(t.cache.allComposites=e),e},i.get=function(t,e,n){var r,o;switch(n){case"body":r=i.allBodies(t);break;case"constraint":r=i.allConstraints(t);break;case"composite":r=i.allComposites(t).concat(t)}return r?0===(o=r.filter((function(t){return t.id.toString()===e.toString()}))).length?null:o[0]:null},i.move=function(t,e,n){return i.remove(t,e),i.add(n,e),t},i.rebase=function(t){for(var e=i.allBodies(t).concat(i.allConstraints(t)).concat(i.allComposites(t)),n=0;n<e.length;n++)e[n].id=o.nextId();return t},i.translate=function(t,e,n){for(var r=n?i.allBodies(t):t.bodies,o=0;o<r.length;o++)a.translate(r[o],e);return t},i.rotate=function(t,e,n,r){for(var o=Math.cos(e),s=Math.sin(e),l=r?i.allBodies(t):t.bodies,u=0;u<l.length;u++){var c=l[u],h=c.position.x-n.x,d=c.position.y-n.y;a.setPosition(c,{x:n.x+(h*o-d*s),y:n.y+(h*s+d*o)}),a.rotate(c,e)}return t},i.scale=function(t,e,n,r,o){for(var s=o?i.allBodies(t):t.bodies,l=0;l<s.length;l++){var u=s[l],c=u.position.x-r.x,h=u.position.y-r.y;a.setPosition(u,{x:r.x+c*e,y:r.y+h*n}),a.scale(u,e,n)}return t},i.bounds=function(t){for(var e=i.allBodies(t),n=[],r=0;r<e.length;r+=1){var o=e[r];n.push(o.bounds.min,o.bounds.max)}return s.create(n)}},function(t,e,n){var i={};t.exports=i;var r=n(4),o=n(5),s=n(0);i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(t,e){for(var n=e/s._baseDelta,o=i._motionSleepThreshold,a=0;a<t.length;a++){var l=t[a],u=r.getSpeed(l),c=r.getAngularSpeed(l),h=u*u+c*c;if(0===l.force.x&&0===l.force.y){var d=Math.min(l.motion,h),p=Math.max(l.motion,h);l.motion=i._minBias*d+(1-i._minBias)*p,l.sleepThreshold>0&&l.motion<o?(l.sleepCounter+=1,l.sleepCounter>=l.sleepThreshold/n&&i.set(l,!0)):l.sleepCounter>0&&(l.sleepCounter-=1)}else i.set(l,!1)}},i.afterCollisions=function(t){for(var e=i._motionSleepThreshold,n=0;n<t.length;n++){var r=t[n];if(r.isActive){var o=r.collision,s=o.bodyA.parent,a=o.bodyB.parent;if(!(s.isSleeping&&a.isSleeping||s.isStatic||a.isStatic)&&(s.isSleeping||a.isSleeping)){var l=s.isSleeping&&!s.isStatic?s:a,u=l===s?a:s;!l.isStatic&&u.motion>e&&i.set(l,!1)}}}},i.set=function(t,e){var n=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,n||o.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,n&&o.trigger(t,"sleepEnd"))}},function(t,e,n){var i={};t.exports=i;var r,o,s,a=n(3),l=n(9);r=[],o={overlap:0,axis:null},s={overlap:0,axis:null},i.create=function(t,e){return{pair:null,collided:!1,bodyA:t,bodyB:e,parentA:t.parent,parentB:e.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},i.collides=function(t,e,n){if(i._overlapAxes(o,t.vertices,e.vertices,t.axes),o.overlap<=0)return null;if(i._overlapAxes(s,e.vertices,t.vertices,e.axes),s.overlap<=0)return null;var r,u,c=n&&n.table[l.id(t,e)];c?r=c.collision:((r=i.create(t,e)).collided=!0,r.bodyA=t.id<e.id?t:e,r.bodyB=t.id<e.id?e:t,r.parentA=r.bodyA.parent,r.parentB=r.bodyB.parent),t=r.bodyA,e=r.bodyB,u=o.overlap<s.overlap?o:s;var h=r.normal,d=r.supports,p=u.axis,f=p.x,m=p.y;f*(e.position.x-t.position.x)+m*(e.position.y-t.position.y)<0?(h.x=f,h.y=m):(h.x=-f,h.y=-m),r.tangent.x=-h.y,r.tangent.y=h.x,r.depth=u.overlap,r.penetration.x=h.x*r.depth,r.penetration.y=h.y*r.depth;var g=i._findSupports(t,e,h,1),y=0;if(a.contains(t.vertices,g[0])&&(d[y++]=g[0]),a.contains(t.vertices,g[1])&&(d[y++]=g[1]),y<2){var v=i._findSupports(e,t,h,-1);a.contains(e.vertices,v[0])&&(d[y++]=v[0]),y<2&&a.contains(e.vertices,v[1])&&(d[y++]=v[1])}return 0===y&&(d[y++]=g[0]),d.length=y,r},i._overlapAxes=function(t,e,n,i){var r,o,s,a,l,u,c=e.length,h=n.length,d=e[0].x,p=e[0].y,f=n[0].x,m=n[0].y,g=i.length,y=Number.MAX_VALUE,v=0;for(l=0;l<g;l++){var x=i[l],b=x.x,_=x.y,w=d*b+p*_,S=f*b+m*_,A=w,M=S;for(u=1;u<c;u+=1)(a=e[u].x*b+e[u].y*_)>A?A=a:a<w&&(w=a);for(u=1;u<h;u+=1)(a=n[u].x*b+n[u].y*_)>M?M=a:a<S&&(S=a);if((r=(o=A-S)<(s=M-w)?o:s)<y&&(y=r,v=l,r<=0))break}t.axis=i[v],t.overlap=y},i._projectToAxis=function(t,e,n){for(var i=e[0].x*n.x+e[0].y*n.y,r=i,o=1;o<e.length;o+=1){var s=e[o].x*n.x+e[o].y*n.y;s>r?r=s:s<i&&(i=s)}t.min=i,t.max=r},i._findSupports=function(t,e,n,i){var o,s,a,l,u,c=e.vertices,h=c.length,d=t.position.x,p=t.position.y,f=n.x*i,m=n.y*i,g=Number.MAX_VALUE;for(u=0;u<h;u+=1)(l=f*(d-(s=c[u]).x)+m*(p-s.y))<g&&(g=l,o=s);return g=f*(d-(a=c[(h+o.index-1)%h]).x)+m*(p-a.y),f*(d-(s=c[(o.index+1)%h]).x)+m*(p-s.y)<g?(r[0]=o,r[1]=s,r):(r[0]=o,r[1]=a,r)}},function(t,e,n){var i={};t.exports=i;var r=n(16);i.create=function(t,e){var n=t.bodyA,r=t.bodyB,o={id:i.id(n,r),bodyA:n,bodyB:r,collision:t,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||r.isSensor,timeCreated:e,timeUpdated:e,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(o,t,e),o},i.update=function(t,e,n){var i=t.contacts,o=e.supports,s=t.activeContacts,a=e.parentA,l=e.parentB,u=a.vertices.length;t.isActive=!0,t.timeUpdated=n,t.collision=e,t.separation=e.depth,t.inverseMass=a.inverseMass+l.inverseMass,t.friction=a.friction<l.friction?a.friction:l.friction,t.frictionStatic=a.frictionStatic>l.frictionStatic?a.frictionStatic:l.frictionStatic,t.restitution=a.restitution>l.restitution?a.restitution:l.restitution,t.slop=a.slop>l.slop?a.slop:l.slop,e.pair=t,s.length=0;for(var c=0;c<o.length;c++){var h=o[c],d=h.body===a?h.index:u+h.index,p=i[d];p?s.push(p):s.push(i[d]=r.create(h))}},i.setActive=function(t,e,n){e?(t.isActive=!0,t.timeUpdated=n):(t.isActive=!1,t.activeContacts.length=0)},i.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}},function(t,e,n){var i={};t.exports=i;var r=n(3),o=n(2),s=n(7),a=n(1),l=n(11),u=n(0);i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(t){var e=t;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?o.add(e.bodyA.position,e.pointA):e.pointA,i=e.bodyB?o.add(e.bodyB.position,e.pointB):e.pointB,r=o.magnitude(o.sub(n,i));e.length=void 0!==e.length?e.length:r,e.id=e.id||u.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var s={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===e.length&&e.stiffness>.1?(s.type="pin",s.anchors=!1):e.stiffness<.9&&(s.type="spring"),e.render=u.extend(s,e.render),e},i.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var n=t[e],i=n.constraintImpulse;n.isStatic||0===i.x&&0===i.y&&0===i.angle||(n.position.x+=i.x,n.position.y+=i.y,n.angle+=i.angle)}},i.solveAll=function(t,e){for(var n=u.clamp(e/u._baseDelta,0,1),r=0;r<t.length;r+=1){var o=t[r],s=!o.bodyA||o.bodyA&&o.bodyA.isStatic,a=!o.bodyB||o.bodyB&&o.bodyB.isStatic;(s||a)&&i.solve(t[r],n)}for(r=0;r<t.length;r+=1)s=!(o=t[r]).bodyA||o.bodyA&&o.bodyA.isStatic,a=!o.bodyB||o.bodyB&&o.bodyB.isStatic,s||a||i.solve(t[r],n)},i.solve=function(t,e){var n=t.bodyA,r=t.bodyB,s=t.pointA,a=t.pointB;if(n||r){n&&!n.isStatic&&(o.rotate(s,n.angle-t.angleA,s),t.angleA=n.angle),r&&!r.isStatic&&(o.rotate(a,r.angle-t.angleB,a),t.angleB=r.angle);var l=s,u=a;if(n&&(l=o.add(n.position,s)),r&&(u=o.add(r.position,a)),l&&u){var c=o.sub(l,u),h=o.magnitude(c);h<i._minLength&&(h=i._minLength);var d,p,f,m,g,y=(h-t.length)/h,v=t.stiffness>=1||0===t.length?t.stiffness*e:t.stiffness*e*e,x=t.damping*e,b=o.mult(c,y*v),_=(n?n.inverseMass:0)+(r?r.inverseMass:0),w=_+((n?n.inverseInertia:0)+(r?r.inverseInertia:0));if(x>0){var S=o.create();f=o.div(c,h),g=o.sub(r&&o.sub(r.position,r.positionPrev)||S,n&&o.sub(n.position,n.positionPrev)||S),m=o.dot(f,g)}n&&!n.isStatic&&(p=n.inverseMass/_,n.constraintImpulse.x-=b.x*p,n.constraintImpulse.y-=b.y*p,n.position.x-=b.x*p,n.position.y-=b.y*p,x>0&&(n.positionPrev.x-=x*f.x*m*p,n.positionPrev.y-=x*f.y*m*p),d=o.cross(s,b)/w*i._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle-=d,n.angle-=d),r&&!r.isStatic&&(p=r.inverseMass/_,r.constraintImpulse.x+=b.x*p,r.constraintImpulse.y+=b.y*p,r.position.x+=b.x*p,r.position.y+=b.y*p,x>0&&(r.positionPrev.x+=x*f.x*m*p,r.positionPrev.y+=x*f.y*m*p),d=o.cross(a,b)/w*i._torqueDampen*r.inverseInertia*(1-t.angularStiffness),r.constraintImpulse.angle+=d,r.angle+=d)}}},i.postSolveAll=function(t){for(var e=0;e<t.length;e++){var n=t[e],u=n.constraintImpulse;if(!(n.isStatic||0===u.x&&0===u.y&&0===u.angle)){s.set(n,!1);for(var c=0;c<n.parts.length;c++){var h=n.parts[c];r.translate(h.vertices,u),c>0&&(h.position.x+=u.x,h.position.y+=u.y),0!==u.angle&&(r.rotate(h.vertices,u.angle,n.position),l.rotate(h.axes,u.angle),c>0&&o.rotateAbout(h.position,u.angle,n.position,h.position)),a.update(h.bounds,h.vertices,n.velocity)}u.angle*=i._warming,u.x*=i._warming,u.y*=i._warming}}},i.pointAWorld=function(t){return{x:(t.bodyA?t.bodyA.position.x:0)+(t.pointA?t.pointA.x:0),y:(t.bodyA?t.bodyA.position.y:0)+(t.pointA?t.pointA.y:0)}},i.pointBWorld=function(t){return{x:(t.bodyB?t.bodyB.position.x:0)+(t.pointB?t.pointB.x:0),y:(t.bodyB?t.bodyB.position.y:0)+(t.pointB?t.pointB.y:0)}}},function(t,e,n){var i={};t.exports=i;var r=n(2),o=n(0);i.fromVertices=function(t){for(var e={},n=0;n<t.length;n++){var i=(n+1)%t.length,s=r.normalise({x:t[i].y-t[n].y,y:t[n].x-t[i].x}),a=0===s.y?1/0:s.x/s.y;e[a=a.toFixed(3).toString()]=s}return o.values(e)},i.rotate=function(t,e){if(0!==e)for(var n=Math.cos(e),i=Math.sin(e),r=0;r<t.length;r++){var o,s=t[r];o=s.x*n-s.y*i,s.y=s.x*i+s.y*n,s.x=o}}},function(t,e,n){var i={};t.exports=i;var r=n(3),o=n(0),s=n(4),a=n(1),l=n(2);i.rectangle=function(t,e,n,i,a){a=a||{};var l={label:"Rectangle Body",position:{x:t,y:e},vertices:r.fromPath("L 0 0 L "+n+" 0 L "+n+" "+i+" L 0 "+i)};if(a.chamfer){var u=a.chamfer;l.vertices=r.chamfer(l.vertices,u.radius,u.quality,u.qualityMin,u.qualityMax),delete a.chamfer}return s.create(o.extend({},l,a))},i.trapezoid=function(t,e,n,i,a,l){l=l||{};var u,c=n*(a*=.5),h=c+(1-2*a)*n,d=h+c;u=a<.5?"L 0 0 L "+c+" "+-i+" L "+h+" "+-i+" L "+d+" 0":"L 0 0 L "+h+" "+-i+" L "+d+" 0";var p={label:"Trapezoid Body",position:{x:t,y:e},vertices:r.fromPath(u)};if(l.chamfer){var f=l.chamfer;p.vertices=r.chamfer(p.vertices,f.radius,f.quality,f.qualityMin,f.qualityMax),delete l.chamfer}return s.create(o.extend({},p,l))},i.circle=function(t,e,n,r,s){r=r||{};var a={label:"Circle Body",circleRadius:n};s=s||25;var l=Math.ceil(Math.max(10,Math.min(s,n)));return l%2==1&&(l+=1),i.polygon(t,e,l,n,o.extend({},a,r))},i.polygon=function(t,e,n,a,l){if(l=l||{},n<3)return i.circle(t,e,a,l);for(var u=2*Math.PI/n,c="",h=.5*u,d=0;d<n;d+=1){var p=h+d*u,f=Math.cos(p)*a,m=Math.sin(p)*a;c+="L "+f.toFixed(3)+" "+m.toFixed(3)+" "}var g={label:"Polygon Body",position:{x:t,y:e},vertices:r.fromPath(c)};if(l.chamfer){var y=l.chamfer;g.vertices=r.chamfer(g.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete l.chamfer}return s.create(o.extend({},g,l))},i.fromVertices=function(t,e,n,i,u,c,h,d){var p,f,m,g,y,v,x,b,_,w,S=o.getDecomp();for(p=Boolean(S&&S.quickDecomp),i=i||{},m=[],u=void 0!==u&&u,c=void 0!==c?c:.01,h=void 0!==h?h:10,d=void 0!==d?d:.01,o.isArray(n[0])||(n=[n]),_=0;_<n.length;_+=1)if(y=n[_],!(g=r.isConvex(y))&&!p&&o.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),g||!p)y=g?r.clockwiseSort(y):r.hull(y),m.push({position:{x:t,y:e},vertices:y});else{var A=y.map((function(t){return[t.x,t.y]}));S.makeCCW(A),!1!==c&&S.removeCollinearPoints(A,c),!1!==d&&S.removeDuplicatePoints&&S.removeDuplicatePoints(A,d);var M=S.quickDecomp(A);for(v=0;v<M.length;v++){var T=M[v].map((function(t){return{x:t[0],y:t[1]}}));h>0&&r.area(T)<h||m.push({position:r.centre(T),vertices:T})}}for(v=0;v<m.length;v++)m[v]=s.create(o.extend(m[v],i));if(u)for(v=0;v<m.length;v++){var E=m[v];for(x=v+1;x<m.length;x++){var P=m[x];if(a.overlaps(E.bounds,P.bounds)){var C=E.vertices,I=P.vertices;for(b=0;b<E.vertices.length;b++)for(w=0;w<P.vertices.length;w++){var R=l.magnitudeSquared(l.sub(C[(b+1)%C.length],I[w])),O=l.magnitudeSquared(l.sub(C[b],I[(w+1)%I.length]));R<5&&O<5&&(C[b].isInternal=!0,I[w].isInternal=!0)}}}}return m.length>1?(f=s.create(o.extend({parts:m.slice(0)},i)),s.setPosition(f,{x:t,y:e}),f):m[0]}},function(t,e,n){var i={};t.exports=i;var r=n(0),o=n(8);i.create=function(t){return r.extend({bodies:[],pairs:null},t)},i.setBodies=function(t,e){t.bodies=e.slice(0)},i.clear=function(t){t.bodies=[]},i.collisions=function(t){var e,n,r=[],s=t.pairs,a=t.bodies,l=a.length,u=i.canCollide,c=o.collides;for(a.sort(i._compareBoundsX),e=0;e<l;e++){var h=a[e],d=h.bounds,p=h.bounds.max.x,f=h.bounds.max.y,m=h.bounds.min.y,g=h.isStatic||h.isSleeping,y=h.parts.length,v=1===y;for(n=e+1;n<l;n++){var x=a[n];if((E=x.bounds).min.x>p)break;if(!(f<E.min.y||m>E.max.y)&&(!g||!x.isStatic&&!x.isSleeping)&&u(h.collisionFilter,x.collisionFilter)){var b=x.parts.length;if(v&&1===b)(M=c(h,x,s))&&r.push(M);else for(var _=b>1?1:0,w=y>1?1:0;w<y;w++)for(var S=h.parts[w],A=(d=S.bounds,_);A<b;A++){var M,T=x.parts[A],E=T.bounds;d.min.x>E.max.x||d.max.x<E.min.x||d.max.y<E.min.y||d.min.y>E.max.y||(M=c(S,T,s))&&r.push(M)}}}}return r},i.canCollide=function(t,e){return t.group===e.group&&0!==t.group?t.group>0:0!=(t.mask&e.category)&&0!=(e.mask&t.category)},i._compareBoundsX=function(t,e){return t.bounds.min.x-e.bounds.min.x}},function(t,e,n){var i={};t.exports=i;var r=n(0);i.create=function(t){var e={};return t||r.log("Mouse.create: element was undefined, defaulting to document.body","warn"),e.element=t||document.body,e.absolute={x:0,y:0},e.position={x:0,y:0},e.mousedownPosition={x:0,y:0},e.mouseupPosition={x:0,y:0},e.offset={x:0,y:0},e.scale={x:1,y:1},e.wheelDelta=0,e.button=-1,e.pixelRatio=parseInt(e.element.getAttribute("data-pixel-ratio"),10)||1,e.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},e.mousemove=function(t){var n=i._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&(e.button=0,t.preventDefault()),e.absolute.x=n.x,e.absolute.y=n.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.sourceEvents.mousemove=t},e.mousedown=function(t){var n=i._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches?(e.button=0,t.preventDefault()):e.button=t.button,e.absolute.x=n.x,e.absolute.y=n.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mousedownPosition.x=e.position.x,e.mousedownPosition.y=e.position.y,e.sourceEvents.mousedown=t},e.mouseup=function(t){var n=i._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&t.preventDefault(),e.button=-1,e.absolute.x=n.x,e.absolute.y=n.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mouseupPosition.x=e.position.x,e.mouseupPosition.y=e.position.y,e.sourceEvents.mouseup=t},e.mousewheel=function(t){e.wheelDelta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),t.preventDefault()},i.setElement(e,e.element),e},i.setElement=function(t,e){t.element=e,e.addEventListener("mousemove",t.mousemove),e.addEventListener("mousedown",t.mousedown),e.addEventListener("mouseup",t.mouseup),e.addEventListener("mousewheel",t.mousewheel),e.addEventListener("DOMMouseScroll",t.mousewheel),e.addEventListener("touchmove",t.mousemove),e.addEventListener("touchstart",t.mousedown),e.addEventListener("touchend",t.mouseup)},i.clearSourceEvents=function(t){t.sourceEvents.mousemove=null,t.sourceEvents.mousedown=null,t.sourceEvents.mouseup=null,t.sourceEvents.mousewheel=null,t.wheelDelta=0},i.setOffset=function(t,e){t.offset.x=e.x,t.offset.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},i.setScale=function(t,e){t.scale.x=e.x,t.scale.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},i._getRelativeMousePosition=function(t,e,n){var i,r,o=e.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,u=t.changedTouches;return u?(i=u[0].pageX-o.left-a,r=u[0].pageY-o.top-l):(i=t.pageX-o.left-a,r=t.pageY-o.top-l),{x:i/(e.clientWidth/(e.width||e.clientWidth)*n),y:r/(e.clientHeight/(e.height||e.clientHeight)*n)}}},function(t,e,n){var i={};t.exports=i;var r=n(0);i._registry={},i.register=function(t){if(i.isPlugin(t)||r.warn("Plugin.register:",i.toString(t),"does not implement all required fields."),t.name in i._registry){var e=i._registry[t.name],n=i.versionParse(t.version).number,o=i.versionParse(e.version).number;n>o?(r.warn("Plugin.register:",i.toString(e),"was upgraded to",i.toString(t)),i._registry[t.name]=t):n<o?r.warn("Plugin.register:",i.toString(e),"can not be downgraded to",i.toString(t)):t!==e&&r.warn("Plugin.register:",i.toString(t),"is already registered to different plugin object")}else i._registry[t.name]=t;return t},i.resolve=function(t){return i._registry[i.dependencyParse(t).name]},i.toString=function(t){return"string"==typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},i.isPlugin=function(t){return t&&t.name&&t.version&&t.install},i.isUsed=function(t,e){return t.used.indexOf(e)>-1},i.isFor=function(t,e){var n=t.for&&i.dependencyParse(t.for);return!t.for||e.name===n.name&&i.versionSatisfies(e.version,n.range)},i.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0!==t.uses.length){for(var n=i.dependencies(t),o=r.topologicalSort(n),s=[],a=0;a<o.length;a+=1)if(o[a]!==t.name){var l=i.resolve(o[a]);l?i.isUsed(t,l.name)||(i.isFor(l,t)||(r.warn("Plugin.use:",i.toString(l),"is for",l.for,"but installed on",i.toString(t)+"."),l._warned=!0),l.install?l.install(t):(r.warn("Plugin.use:",i.toString(l),"does not specify an install function."),l._warned=!0),l._warned?(s.push("🔶 "+i.toString(l)),delete l._warned):s.push("✅ "+i.toString(l)),t.used.push(l.name)):s.push("❌ "+o[a])}s.length>0&&r.info(s.join("  "))}else r.warn("Plugin.use:",i.toString(t),"does not specify any dependencies to install.")},i.dependencies=function(t,e){var n=i.dependencyParse(t),o=n.name;if(!(o in(e=e||{}))){t=i.resolve(t)||t,e[o]=r.map(t.uses||[],(function(e){i.isPlugin(e)&&i.register(e);var o=i.dependencyParse(e),s=i.resolve(e);return s&&!i.versionSatisfies(s.version,o.range)?(r.warn("Plugin.dependencies:",i.toString(s),"does not satisfy",i.toString(o),"used by",i.toString(n)+"."),s._warned=!0,t._warned=!0):s||(r.warn("Plugin.dependencies:",i.toString(e),"used by",i.toString(n),"could not be resolved."),t._warned=!0),o.name}));for(var s=0;s<e[o].length;s+=1)i.dependencies(e[o][s],e);return e}},i.dependencyParse=function(t){return r.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(t)||r.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},i.versionParse=function(t){var e=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;e.test(t)||r.warn("Plugin.versionParse:",t,"is not a valid version or range.");var n=e.exec(t),i=Number(n[4]),o=Number(n[5]),s=Number(n[6]);return{isRange:Boolean(n[1]||n[2]),version:n[3],range:t,operator:n[1]||n[2]||"",major:i,minor:o,patch:s,parts:[i,o,s],prerelease:n[7],number:1e8*i+1e4*o+s}},i.versionSatisfies=function(t,e){e=e||"*";var n=i.versionParse(e),r=i.versionParse(t);if(n.isRange){if("*"===n.operator||"*"===t)return!0;if(">"===n.operator)return r.number>n.number;if(">="===n.operator)return r.number>=n.number;if("~"===n.operator)return r.major===n.major&&r.minor===n.minor&&r.patch>=n.patch;if("^"===n.operator)return n.major>0?r.major===n.major&&r.number>=n.number:n.minor>0?r.minor===n.minor&&r.patch>=n.patch:r.patch===n.patch}return t===e||"*"===t}},function(t,e){var n={};t.exports=n,n.create=function(t){return{vertex:t,normalImpulse:0,tangentImpulse:0}}},function(t,e,n){var i={};t.exports=i;var r=n(7),o=n(18),s=n(13),a=n(19),l=n(5),u=n(6),c=n(10),h=n(0),d=n(4);i.create=function(t){t=t||{};var e=h.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},t);return e.world=t.world||u.create({label:"World"}),e.pairs=t.pairs||a.create(),e.detector=t.detector||s.create(),e.grid={buckets:[]},e.world.gravity=e.gravity,e.broadphase=e.grid,e.metrics={},e},i.update=function(t,e){var n,d=h.now(),p=t.world,f=t.detector,m=t.pairs,g=t.timing,y=g.timestamp;e=void 0!==e?e:h._baseDelta,e*=g.timeScale,g.timestamp+=e,g.lastDelta=e;var v={timestamp:g.timestamp,delta:e};l.trigger(t,"beforeUpdate",v);var x=u.allBodies(p),b=u.allConstraints(p);for(p.isModified&&(s.setBodies(f,x),u.setModified(p,!1,!1,!0)),t.enableSleeping&&r.update(x,e),i._bodiesApplyGravity(x,t.gravity),e>0&&i._bodiesUpdate(x,e),c.preSolveAll(x),n=0;n<t.constraintIterations;n++)c.solveAll(b,e);c.postSolveAll(x),f.pairs=t.pairs;var _=s.collisions(f);a.update(m,_,y),t.enableSleeping&&r.afterCollisions(m.list),m.collisionStart.length>0&&l.trigger(t,"collisionStart",{pairs:m.collisionStart});var w=h.clamp(20/t.positionIterations,0,1);for(o.preSolvePosition(m.list),n=0;n<t.positionIterations;n++)o.solvePosition(m.list,e,w);for(o.postSolvePosition(x),c.preSolveAll(x),n=0;n<t.constraintIterations;n++)c.solveAll(b,e);for(c.postSolveAll(x),o.preSolveVelocity(m.list),n=0;n<t.velocityIterations;n++)o.solveVelocity(m.list,e);return i._bodiesUpdateVelocities(x),m.collisionActive.length>0&&l.trigger(t,"collisionActive",{pairs:m.collisionActive}),m.collisionEnd.length>0&&l.trigger(t,"collisionEnd",{pairs:m.collisionEnd}),i._bodiesClearForces(x),l.trigger(t,"afterUpdate",v),t.timing.lastElapsed=h.now()-d,t},i.merge=function(t,e){if(h.extend(t,e),e.world){t.world=e.world,i.clear(t);for(var n=u.allBodies(t.world),o=0;o<n.length;o++){var s=n[o];r.set(s,!1),s.id=h.nextId()}}},i.clear=function(t){a.clear(t.pairs),s.clear(t.detector)},i._bodiesClearForces=function(t){for(var e=t.length,n=0;n<e;n++){var i=t[n];i.force.x=0,i.force.y=0,i.torque=0}},i._bodiesApplyGravity=function(t,e){var n=void 0!==e.scale?e.scale:.001,i=t.length;if((0!==e.x||0!==e.y)&&0!==n)for(var r=0;r<i;r++){var o=t[r];o.isStatic||o.isSleeping||(o.force.y+=o.mass*e.y*n,o.force.x+=o.mass*e.x*n)}},i._bodiesUpdate=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];r.isStatic||r.isSleeping||d.update(r,e)}},i._bodiesUpdateVelocities=function(t){for(var e=t.length,n=0;n<e;n++)d.updateVelocities(t[n])}},function(t,e,n){var i={};t.exports=i;var r=n(3),o=n(0),s=n(1);i._restingThresh=2,i._restingThreshTangent=Math.sqrt(6),i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i._frictionMaxStatic=Number.MAX_VALUE,i.preSolvePosition=function(t){var e,n,i,r=t.length;for(e=0;e<r;e++)(n=t[e]).isActive&&(i=n.activeContacts.length,n.collision.parentA.totalContacts+=i,n.collision.parentB.totalContacts+=i)},i.solvePosition=function(t,e,n){var r,s,a,l,u,c,h,d,p=i._positionDampen*(n||1),f=o.clamp(e/o._baseDelta,0,1),m=t.length;for(r=0;r<m;r++)(s=t[r]).isActive&&!s.isSensor&&(l=(a=s.collision).parentA,u=a.parentB,c=a.normal,s.separation=c.x*(u.positionImpulse.x+a.penetration.x-l.positionImpulse.x)+c.y*(u.positionImpulse.y+a.penetration.y-l.positionImpulse.y));for(r=0;r<m;r++)(s=t[r]).isActive&&!s.isSensor&&(l=(a=s.collision).parentA,u=a.parentB,c=a.normal,d=s.separation-s.slop*f,(l.isStatic||u.isStatic)&&(d*=2),l.isStatic||l.isSleeping||(h=p/l.totalContacts,l.positionImpulse.x+=c.x*d*h,l.positionImpulse.y+=c.y*d*h),u.isStatic||u.isSleeping||(h=p/u.totalContacts,u.positionImpulse.x-=c.x*d*h,u.positionImpulse.y-=c.y*d*h))},i.postSolvePosition=function(t){for(var e=i._positionWarming,n=t.length,o=r.translate,a=s.update,l=0;l<n;l++){var u=t[l],c=u.positionImpulse,h=c.x,d=c.y,p=u.velocity;if(u.totalContacts=0,0!==h||0!==d){for(var f=0;f<u.parts.length;f++){var m=u.parts[f];o(m.vertices,c),a(m.bounds,m.vertices,p),m.position.x+=h,m.position.y+=d}u.positionPrev.x+=h,u.positionPrev.y+=d,h*p.x+d*p.y<0?(c.x=0,c.y=0):(c.x*=e,c.y*=e)}}},i.preSolveVelocity=function(t){var e,n,i=t.length;for(e=0;e<i;e++){var r=t[e];if(r.isActive&&!r.isSensor){var o=r.activeContacts,s=o.length,a=r.collision,l=a.parentA,u=a.parentB,c=a.normal,h=a.tangent;for(n=0;n<s;n++){var d=o[n],p=d.vertex,f=d.normalImpulse,m=d.tangentImpulse;if(0!==f||0!==m){var g=c.x*f+h.x*m,y=c.y*f+h.y*m;l.isStatic||l.isSleeping||(l.positionPrev.x+=g*l.inverseMass,l.positionPrev.y+=y*l.inverseMass,l.anglePrev+=l.inverseInertia*((p.x-l.position.x)*y-(p.y-l.position.y)*g)),u.isStatic||u.isSleeping||(u.positionPrev.x-=g*u.inverseMass,u.positionPrev.y-=y*u.inverseMass,u.anglePrev-=u.inverseInertia*((p.x-u.position.x)*y-(p.y-u.position.y)*g))}}}}},i.solveVelocity=function(t,e){var n,r,s,a,l=e/o._baseDelta,u=l*l*l,c=-i._restingThresh*l,h=i._restingThreshTangent,d=i._frictionNormalMultiplier*l,p=i._frictionMaxStatic,f=t.length;for(s=0;s<f;s++){var m=t[s];if(m.isActive&&!m.isSensor){var g=m.collision,y=g.parentA,v=g.parentB,x=y.velocity,b=v.velocity,_=g.normal.x,w=g.normal.y,S=g.tangent.x,A=g.tangent.y,M=m.activeContacts,T=M.length,E=1/T,P=y.inverseMass+v.inverseMass,C=m.friction*m.frictionStatic*d;for(x.x=y.position.x-y.positionPrev.x,x.y=y.position.y-y.positionPrev.y,b.x=v.position.x-v.positionPrev.x,b.y=v.position.y-v.positionPrev.y,y.angularVelocity=y.angle-y.anglePrev,v.angularVelocity=v.angle-v.anglePrev,a=0;a<T;a++){var I=M[a],R=I.vertex,O=R.x-y.position.x,q=R.y-y.position.y,L=R.x-v.position.x,D=R.y-v.position.y,z=x.x-q*y.angularVelocity,k=x.y+O*y.angularVelocity,B=z-(b.x-D*v.angularVelocity),F=k-(b.y+L*v.angularVelocity),V=_*B+w*F,N=S*B+A*F,U=m.separation+V,j=Math.min(U,1),G=(j=U<0?0:j)*C;N<-G||N>G?(r=N>0?N:-N,(n=m.friction*(N>0?1:-1)*u)<-r?n=-r:n>r&&(n=r)):(n=N,r=p);var H=O*w-q*_,W=L*w-D*_,X=E/(P+y.inverseInertia*H*H+v.inverseInertia*W*W),Y=(1+m.restitution)*V*X;if(n*=X,V<c)I.normalImpulse=0;else{var Z=I.normalImpulse;I.normalImpulse+=Y,I.normalImpulse>0&&(I.normalImpulse=0),Y=I.normalImpulse-Z}if(N<-h||N>h)I.tangentImpulse=0;else{var Q=I.tangentImpulse;I.tangentImpulse+=n,I.tangentImpulse<-r&&(I.tangentImpulse=-r),I.tangentImpulse>r&&(I.tangentImpulse=r),n=I.tangentImpulse-Q}var J=_*Y+S*n,K=w*Y+A*n;y.isStatic||y.isSleeping||(y.positionPrev.x+=J*y.inverseMass,y.positionPrev.y+=K*y.inverseMass,y.anglePrev+=(O*K-q*J)*y.inverseInertia),v.isStatic||v.isSleeping||(v.positionPrev.x-=J*v.inverseMass,v.positionPrev.y-=K*v.inverseMass,v.anglePrev-=(L*K-D*J)*v.inverseInertia)}}}}},function(t,e,n){var i={};t.exports=i;var r=n(9),o=n(0);i.create=function(t){return o.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},i.update=function(t,e,n){var i,o,s,a,l=t.list,u=l.length,c=t.table,h=e.length,d=t.collisionStart,p=t.collisionEnd,f=t.collisionActive;for(d.length=0,p.length=0,f.length=0,a=0;a<u;a++)l[a].confirmedActive=!1;for(a=0;a<h;a++)(s=(i=e[a]).pair)?(s.isActive?f.push(s):d.push(s),r.update(s,i,n),s.confirmedActive=!0):(c[(s=r.create(i,n)).id]=s,d.push(s),l.push(s));var m=[];for(u=l.length,a=0;a<u;a++)(s=l[a]).confirmedActive||(r.setActive(s,!1,n),p.push(s),s.collision.bodyA.isSleeping||s.collision.bodyB.isSleeping||m.push(a));for(a=0;a<m.length;a++)s=l[o=m[a]-a],l.splice(o,1),delete c[s.id]},i.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}},function(t,e,n){var i=t.exports=n(21);i.Axes=n(11),i.Bodies=n(12),i.Body=n(4),i.Bounds=n(1),i.Collision=n(8),i.Common=n(0),i.Composite=n(6),i.Composites=n(22),i.Constraint=n(10),i.Contact=n(16),i.Detector=n(13),i.Engine=n(17),i.Events=n(5),i.Grid=n(23),i.Mouse=n(14),i.MouseConstraint=n(24),i.Pair=n(9),i.Pairs=n(19),i.Plugin=n(15),i.Query=n(25),i.Render=n(26),i.Resolver=n(18),i.Runner=n(27),i.SAT=n(28),i.Sleeping=n(7),i.Svg=n(29),i.Vector=n(2),i.Vertices=n(3),i.World=n(30),i.Engine.run=i.Runner.run,i.Common.deprecated(i.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(t,e,n){var i={};t.exports=i;var r=n(15),o=n(0);i.name="matter-js",i.version="0.19.0",i.uses=[],i.used=[],i.use=function(){r.use(i,Array.prototype.slice.call(arguments))},i.before=function(t,e){return t=t.replace(/^Matter./,""),o.chainPathBefore(i,t,e)},i.after=function(t,e){return t=t.replace(/^Matter./,""),o.chainPathAfter(i,t,e)}},function(t,e,n){var i={};t.exports=i;var r=n(6),o=n(10),s=n(0),a=n(4),l=n(12),u=s.deprecated;i.stack=function(t,e,n,i,o,s,l){for(var u,c=r.create({label:"Stack"}),h=t,d=e,p=0,f=0;f<i;f++){for(var m=0,g=0;g<n;g++){var y=l(h,d,g,f,u,p);if(y){var v=y.bounds.max.y-y.bounds.min.y,x=y.bounds.max.x-y.bounds.min.x;v>m&&(m=v),a.translate(y,{x:.5*x,y:.5*v}),h=y.bounds.max.x+o,r.addBody(c,y),u=y,p+=1}else h+=o}d+=m+s,h=t}return c},i.chain=function(t,e,n,i,a,l){for(var u=t.bodies,c=1;c<u.length;c++){var h=u[c-1],d=u[c],p=h.bounds.max.y-h.bounds.min.y,f=h.bounds.max.x-h.bounds.min.x,m=d.bounds.max.y-d.bounds.min.y,g={bodyA:h,pointA:{x:f*e,y:p*n},bodyB:d,pointB:{x:(d.bounds.max.x-d.bounds.min.x)*i,y:m*a}},y=s.extend(g,l);r.addConstraint(t,o.create(y))}return t.label+=" Chain",t},i.mesh=function(t,e,n,i,a){var l,u,c,h,d,p=t.bodies;for(l=0;l<n;l++){for(u=1;u<e;u++)c=p[u-1+l*e],h=p[u+l*e],r.addConstraint(t,o.create(s.extend({bodyA:c,bodyB:h},a)));if(l>0)for(u=0;u<e;u++)c=p[u+(l-1)*e],h=p[u+l*e],r.addConstraint(t,o.create(s.extend({bodyA:c,bodyB:h},a))),i&&u>0&&(d=p[u-1+(l-1)*e],r.addConstraint(t,o.create(s.extend({bodyA:d,bodyB:h},a)))),i&&u<e-1&&(d=p[u+1+(l-1)*e],r.addConstraint(t,o.create(s.extend({bodyA:d,bodyB:h},a))))}return t.label+=" Mesh",t},i.pyramid=function(t,e,n,r,o,s,l){return i.stack(t,e,n,r,o,s,(function(e,i,s,u,c,h){var d=Math.min(r,Math.ceil(n/2)),p=c?c.bounds.max.x-c.bounds.min.x:0;if(!(u>d||s<(u=d-u)||s>n-1-u))return 1===h&&a.translate(c,{x:(s+(n%2==1?1:-1))*p,y:0}),l(t+(c?s*p:0)+s*o,i,s,u,c,h)}))},i.newtonsCradle=function(t,e,n,i,s){for(var a=r.create({label:"Newtons Cradle"}),u=0;u<n;u++){var c=l.circle(t+u*(1.9*i),e+s,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),h=o.create({pointA:{x:t+u*(1.9*i),y:e},bodyB:c});r.addBody(a,c),r.addConstraint(a,h)}return a},u(i,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),i.car=function(t,e,n,i,s){var u=a.nextGroup(!0),c=.5*-n+20,h=.5*n-20,d=r.create({label:"Car"}),p=l.rectangle(t,e,n,i,{collisionFilter:{group:u},chamfer:{radius:.5*i},density:2e-4}),f=l.circle(t+c,e+0,s,{collisionFilter:{group:u},friction:.8}),m=l.circle(t+h,e+0,s,{collisionFilter:{group:u},friction:.8}),g=o.create({bodyB:p,pointB:{x:c,y:0},bodyA:f,stiffness:1,length:0}),y=o.create({bodyB:p,pointB:{x:h,y:0},bodyA:m,stiffness:1,length:0});return r.addBody(d,p),r.addBody(d,f),r.addBody(d,m),r.addConstraint(d,g),r.addConstraint(d,y),d},u(i,"car","Composites.car ➤ moved to car example"),i.softBody=function(t,e,n,r,o,a,u,c,h,d){h=s.extend({inertia:1/0},h),d=s.extend({stiffness:.2,render:{type:"line",anchors:!1}},d);var p=i.stack(t,e,n,r,o,a,(function(t,e){return l.circle(t,e,c,h)}));return i.mesh(p,n,r,u,d),p.label="Soft Body",p},u(i,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function(t,e,n){var i={};t.exports=i;var r=n(9),o=n(0),s=o.deprecated;i.create=function(t){return o.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},t)},i.update=function(t,e,n,r){var o,s,a,l,u,c=n.world,h=t.buckets,d=!1;for(o=0;o<e.length;o++){var p=e[o];if((!p.isSleeping||r)&&(!c.bounds||!(p.bounds.max.x<c.bounds.min.x||p.bounds.min.x>c.bounds.max.x||p.bounds.max.y<c.bounds.min.y||p.bounds.min.y>c.bounds.max.y))){var f=i._getRegion(t,p);if(!p.region||f.id!==p.region.id||r){p.region&&!r||(p.region=f);var m=i._regionUnion(f,p.region);for(s=m.startCol;s<=m.endCol;s++)for(a=m.startRow;a<=m.endRow;a++){l=h[u=i._getBucketId(s,a)];var g=s>=f.startCol&&s<=f.endCol&&a>=f.startRow&&a<=f.endRow,y=s>=p.region.startCol&&s<=p.region.endCol&&a>=p.region.startRow&&a<=p.region.endRow;!g&&y&&y&&l&&i._bucketRemoveBody(t,l,p),(p.region===f||g&&!y||r)&&(l||(l=i._createBucket(h,u)),i._bucketAddBody(t,l,p))}p.region=f,d=!0}}}d&&(t.pairsList=i._createActivePairsList(t))},s(i,"update","Grid.update ➤ replaced by Matter.Detector"),i.clear=function(t){t.buckets={},t.pairs={},t.pairsList=[]},s(i,"clear","Grid.clear ➤ replaced by Matter.Detector"),i._regionUnion=function(t,e){var n=Math.min(t.startCol,e.startCol),r=Math.max(t.endCol,e.endCol),o=Math.min(t.startRow,e.startRow),s=Math.max(t.endRow,e.endRow);return i._createRegion(n,r,o,s)},i._getRegion=function(t,e){var n=e.bounds,r=Math.floor(n.min.x/t.bucketWidth),o=Math.floor(n.max.x/t.bucketWidth),s=Math.floor(n.min.y/t.bucketHeight),a=Math.floor(n.max.y/t.bucketHeight);return i._createRegion(r,o,s,a)},i._createRegion=function(t,e,n,i){return{id:t+","+e+","+n+","+i,startCol:t,endCol:e,startRow:n,endRow:i}},i._getBucketId=function(t,e){return"C"+t+"R"+e},i._createBucket=function(t,e){return t[e]=[]},i._bucketAddBody=function(t,e,n){var i,o=t.pairs,s=r.id,a=e.length;for(i=0;i<a;i++){var l=e[i];if(!(n.id===l.id||n.isStatic&&l.isStatic)){var u=s(n,l),c=o[u];c?c[2]+=1:o[u]=[n,l,1]}}e.push(n)},i._bucketRemoveBody=function(t,e,n){var i,s=t.pairs,a=r.id;e.splice(o.indexOf(e,n),1);var l=e.length;for(i=0;i<l;i++){var u=s[a(n,e[i])];u&&(u[2]-=1)}},i._createActivePairsList=function(t){var e,n,i=t.pairs,r=o.keys(i),s=r.length,a=[];for(n=0;n<s;n++)(e=i[r[n]])[2]>0?a.push(e):delete i[r[n]];return a}},function(t,e,n){var i={};t.exports=i;var r=n(3),o=n(7),s=n(14),a=n(5),l=n(13),u=n(10),c=n(6),h=n(0),d=n(1);i.create=function(t,e){var n=(t?t.mouse:null)||(e?e.mouse:null);n||(t&&t.render&&t.render.canvas?n=s.create(t.render.canvas):e&&e.element?n=s.create(e.element):(n=s.create(),h.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var r={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:u.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},o=h.extend(r,e);return a.on(t,"beforeUpdate",(function(){var e=c.allBodies(t.world);i.update(o,e),i._triggerEvents(o)})),o},i.update=function(t,e){var n=t.mouse,i=t.constraint,s=t.body;if(0===n.button){if(i.bodyB)o.set(i.bodyB,!1),i.pointA=n.position;else for(var u=0;u<e.length;u++)if(s=e[u],d.contains(s.bounds,n.position)&&l.canCollide(s.collisionFilter,t.collisionFilter))for(var c=s.parts.length>1?1:0;c<s.parts.length;c++){var h=s.parts[c];if(r.contains(h.vertices,n.position)){i.pointA=n.position,i.bodyB=t.body=s,i.pointB={x:n.position.x-s.position.x,y:n.position.y-s.position.y},i.angleB=s.angle,o.set(s,!1),a.trigger(t,"startdrag",{mouse:n,body:s});break}}}else i.bodyB=t.body=null,i.pointB=null,s&&a.trigger(t,"enddrag",{mouse:n,body:s})},i._triggerEvents=function(t){var e=t.mouse,n=e.sourceEvents;n.mousemove&&a.trigger(t,"mousemove",{mouse:e}),n.mousedown&&a.trigger(t,"mousedown",{mouse:e}),n.mouseup&&a.trigger(t,"mouseup",{mouse:e}),s.clearSourceEvents(e)}},function(t,e,n){var i={};t.exports=i;var r=n(2),o=n(8),s=n(1),a=n(12),l=n(3);i.collides=function(t,e){for(var n=[],i=e.length,r=t.bounds,a=o.collides,l=s.overlaps,u=0;u<i;u++){var c=e[u],h=c.parts.length,d=1===h?0:1;if(l(c.bounds,r))for(var p=d;p<h;p++){var f=c.parts[p];if(l(f.bounds,r)){var m=a(f,t);if(m){n.push(m);break}}}}return n},i.ray=function(t,e,n,o){o=o||1e-100;for(var s=r.angle(e,n),l=r.magnitude(r.sub(e,n)),u=.5*(n.x+e.x),c=.5*(n.y+e.y),h=a.rectangle(u,c,l,o,{angle:s}),d=i.collides(h,t),p=0;p<d.length;p+=1){var f=d[p];f.body=f.bodyB=f.bodyA}return d},i.region=function(t,e,n){for(var i=[],r=0;r<t.length;r++){var o=t[r],a=s.overlaps(o.bounds,e);(a&&!n||!a&&n)&&i.push(o)}return i},i.point=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];if(s.contains(r.bounds,e))for(var o=1===r.parts.length?0:1;o<r.parts.length;o++){var a=r.parts[o];if(s.contains(a.bounds,e)&&l.contains(a.vertices,e)){n.push(r);break}}}return n}},function(t,e,n){var i={};t.exports=i;var r=n(4),o=n(0),s=n(6),a=n(1),l=n(5),u=n(2),c=n(14);!function(){var t,e;"undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout((function(){t(o.now())}),1e3/60)},e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i._goodFps=30,i._goodDelta=1e3/60,i.create=function(t){var e={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!t.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},n=o.extend(e,t);return n.canvas&&(n.canvas.width=n.options.width||n.canvas.width,n.canvas.height=n.options.height||n.canvas.height),n.mouse=t.mouse,n.engine=t.engine,n.canvas=n.canvas||d(n.options.width,n.options.height),n.context=n.canvas.getContext("2d"),n.textures={},n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.canvas.width,y:n.canvas.height}},n.controller=i,n.options.showBroadphase=!1,1!==n.options.pixelRatio&&i.setPixelRatio(n,n.options.pixelRatio),o.isElement(n.element)&&n.element.appendChild(n.canvas),n},i.run=function(e){!function r(o){e.frameRequestId=t(r),n(e,o),i.world(e,o),(e.options.showStats||e.options.showDebug)&&i.stats(e,e.context,o),(e.options.showPerformance||e.options.showDebug)&&i.performance(e,e.context,o)}()},i.stop=function(t){e(t.frameRequestId)},i.setPixelRatio=function(t,e){var n=t.options,i=t.canvas;"auto"===e&&(e=p(i)),n.pixelRatio=e,i.setAttribute("data-pixel-ratio",e),i.width=n.width*e,i.height=n.height*e,i.style.width=n.width+"px",i.style.height=n.height+"px"},i.lookAt=function(t,e,n,i){i=void 0===i||i,e=o.isArray(e)?e:[e],n=n||{x:0,y:0};for(var r={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},s=0;s<e.length;s+=1){var a=e[s],l=a.bounds?a.bounds.min:a.min||a.position||a,u=a.bounds?a.bounds.max:a.max||a.position||a;l&&u&&(l.x<r.min.x&&(r.min.x=l.x),u.x>r.max.x&&(r.max.x=u.x),l.y<r.min.y&&(r.min.y=l.y),u.y>r.max.y&&(r.max.y=u.y))}var h=r.max.x-r.min.x+2*n.x,d=r.max.y-r.min.y+2*n.y,p=t.canvas.height,f=t.canvas.width/p,m=h/d,g=1,y=1;m>f?y=m/f:g=f/m,t.options.hasBounds=!0,t.bounds.min.x=r.min.x,t.bounds.max.x=r.min.x+h*g,t.bounds.min.y=r.min.y,t.bounds.max.y=r.min.y+d*y,i&&(t.bounds.min.x+=.5*h-h*g*.5,t.bounds.max.x+=.5*h-h*g*.5,t.bounds.min.y+=.5*d-d*y*.5,t.bounds.max.y+=.5*d-d*y*.5),t.bounds.min.x-=n.x,t.bounds.max.x-=n.x,t.bounds.min.y-=n.y,t.bounds.max.y-=n.y,t.mouse&&(c.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.canvas.width,y:(t.bounds.max.y-t.bounds.min.y)/t.canvas.height}),c.setOffset(t.mouse,t.bounds.min))},i.startViewTransform=function(t){var e=t.bounds.max.x-t.bounds.min.x,n=t.bounds.max.y-t.bounds.min.y,i=e/t.options.width,r=n/t.options.height;t.context.setTransform(t.options.pixelRatio/i,0,0,t.options.pixelRatio/r,0,0),t.context.translate(-t.bounds.min.x,-t.bounds.min.y)},i.endViewTransform=function(t){t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0)},i.world=function(t,e){var n,r=o.now(),h=t.engine,d=h.world,p=t.canvas,f=t.context,g=t.options,y=t.timing,v=s.allBodies(d),x=s.allConstraints(d),b=g.wireframes?g.wireframeBackground:g.background,_=[],w=[],S={timestamp:h.timing.timestamp};if(l.trigger(t,"beforeRender",S),t.currentBackground!==b&&m(t,b),f.globalCompositeOperation="source-in",f.fillStyle="transparent",f.fillRect(0,0,p.width,p.height),f.globalCompositeOperation="source-over",g.hasBounds){for(n=0;n<v.length;n++){var A=v[n];a.overlaps(A.bounds,t.bounds)&&_.push(A)}for(n=0;n<x.length;n++){var M=x[n],T=M.bodyA,E=M.bodyB,P=M.pointA,C=M.pointB;T&&(P=u.add(T.position,M.pointA)),E&&(C=u.add(E.position,M.pointB)),P&&C&&(a.contains(t.bounds,P)||a.contains(t.bounds,C))&&w.push(M)}i.startViewTransform(t),t.mouse&&(c.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.options.width,y:(t.bounds.max.y-t.bounds.min.y)/t.options.height}),c.setOffset(t.mouse,t.bounds.min))}else w=x,_=v,1!==t.options.pixelRatio&&t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0);!g.wireframes||h.enableSleeping&&g.showSleeping?i.bodies(t,_,f):(g.showConvexHulls&&i.bodyConvexHulls(t,_,f),i.bodyWireframes(t,_,f)),g.showBounds&&i.bodyBounds(t,_,f),(g.showAxes||g.showAngleIndicator)&&i.bodyAxes(t,_,f),g.showPositions&&i.bodyPositions(t,_,f),g.showVelocity&&i.bodyVelocity(t,_,f),g.showIds&&i.bodyIds(t,_,f),g.showSeparations&&i.separations(t,h.pairs.list,f),g.showCollisions&&i.collisions(t,h.pairs.list,f),g.showVertexNumbers&&i.vertexNumbers(t,_,f),g.showMousePosition&&i.mousePosition(t,t.mouse,f),i.constraints(w,f),g.hasBounds&&i.endViewTransform(t),l.trigger(t,"afterRender",S),y.lastElapsed=o.now()-r},i.stats=function(t,e,n){for(var i=t.engine,r=i.world,o=s.allBodies(r),a=0,l=0,u=0;u<o.length;u+=1)a+=o[u].parts.length;var c={Part:a,Body:o.length,Cons:s.allConstraints(r).length,Comp:s.allComposites(r).length,Pair:i.pairs.list.length};for(var h in e.fillStyle="#0e0f19",e.fillRect(l,0,302.5,44),e.font="12px Arial",e.textBaseline="top",e.textAlign="right",c){var d=c[h];e.fillStyle="#aaa",e.fillText(h,l+55,8),e.fillStyle="#eee",e.fillText(d,l+55,26),l+=55}},i.performance=function(t,e){var n=t.engine,r=t.timing,o=r.deltaHistory,s=r.elapsedHistory,a=r.timestampElapsedHistory,l=r.engineDeltaHistory,u=r.engineElapsedHistory,c=n.timing.lastDelta,d=h(o),p=h(s),f=h(l),m=h(u),g=h(a)/d||0,y=1e3/d||0;e.fillStyle="#0e0f19",e.fillRect(0,50,370,34),i.status(e,10,69,60,4,o.length,Math.round(y)+" fps",y/i._goodFps,(function(t){return o[t]/d-1})),i.status(e,82,69,60,4,l.length,c.toFixed(2)+" dt",i._goodDelta/c,(function(t){return l[t]/f-1})),i.status(e,154,69,60,4,u.length,m.toFixed(2)+" ut",1-m/i._goodFps,(function(t){return u[t]/m-1})),i.status(e,226,69,60,4,s.length,p.toFixed(2)+" rt",1-p/i._goodFps,(function(t){return s[t]/p-1})),i.status(e,298,69,60,4,a.length,g.toFixed(2)+" x",g*g*g,(function(t){return(a[t]/o[t]/g||0)-1}))},i.status=function(t,e,n,i,r,s,a,l,u){t.strokeStyle="#888",t.fillStyle="#444",t.lineWidth=1,t.fillRect(e,n+7,i,1),t.beginPath(),t.moveTo(e,n+7-r*o.clamp(.4*u(0),-2,2));for(var c=0;c<i;c+=1)t.lineTo(e+c,n+7-(c<s?r*o.clamp(.4*u(c),-2,2):0));t.stroke(),t.fillStyle="hsl("+o.clamp(25+95*l,0,120)+",100%,60%)",t.fillRect(e,n-7,4,4),t.font="12px Arial",t.textBaseline="middle",t.textAlign="right",t.fillStyle="#eee",t.fillText(a,e+i,n-5)},i.constraints=function(t,e){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(r.render.visible&&r.pointA&&r.pointB){var s,a,l=r.bodyA,c=r.bodyB;if(s=l?u.add(l.position,r.pointA):r.pointA,"pin"===r.render.type)n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath();else{if(a=c?u.add(c.position,r.pointB):r.pointB,n.beginPath(),n.moveTo(s.x,s.y),"spring"===r.render.type)for(var h,d=u.sub(a,s),p=u.perp(u.normalise(d)),f=Math.ceil(o.clamp(r.length/5,12,20)),m=1;m<f;m+=1)h=m%2==0?1:-1,n.lineTo(s.x+d.x*(m/f)+p.x*h*4,s.y+d.y*(m/f)+p.y*h*4);n.lineTo(a.x,a.y)}r.render.lineWidth&&(n.lineWidth=r.render.lineWidth,n.strokeStyle=r.render.strokeStyle,n.stroke()),r.render.anchors&&(n.fillStyle=r.render.strokeStyle,n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.arc(a.x,a.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},i.bodies=function(t,e,n){var i,r,o,s,a=n,l=(t.engine,t.options),u=l.showInternalEdges||!l.wireframes;for(o=0;o<e.length;o++)if((i=e[o]).render.visible)for(s=i.parts.length>1?1:0;s<i.parts.length;s++)if((r=i.parts[s]).render.visible){if(l.showSleeping&&i.isSleeping?a.globalAlpha=.5*r.render.opacity:1!==r.render.opacity&&(a.globalAlpha=r.render.opacity),r.render.sprite&&r.render.sprite.texture&&!l.wireframes){var c=r.render.sprite,h=f(t,c.texture);a.translate(r.position.x,r.position.y),a.rotate(r.angle),a.drawImage(h,h.width*-c.xOffset*c.xScale,h.height*-c.yOffset*c.yScale,h.width*c.xScale,h.height*c.yScale),a.rotate(-r.angle),a.translate(-r.position.x,-r.position.y)}else{if(r.circleRadius)a.beginPath(),a.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(r.vertices[0].x,r.vertices[0].y);for(var d=1;d<r.vertices.length;d++)!r.vertices[d-1].isInternal||u?a.lineTo(r.vertices[d].x,r.vertices[d].y):a.moveTo(r.vertices[d].x,r.vertices[d].y),r.vertices[d].isInternal&&!u&&a.moveTo(r.vertices[(d+1)%r.vertices.length].x,r.vertices[(d+1)%r.vertices.length].y);a.lineTo(r.vertices[0].x,r.vertices[0].y),a.closePath()}l.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=r.render.fillStyle,r.render.lineWidth&&(a.lineWidth=r.render.lineWidth,a.strokeStyle=r.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},i.bodyWireframes=function(t,e,n){var i,r,o,s,a,l=n,u=t.options.showInternalEdges;for(l.beginPath(),o=0;o<e.length;o++)if((i=e[o]).render.visible)for(a=i.parts.length>1?1:0;a<i.parts.length;a++){for(r=i.parts[a],l.moveTo(r.vertices[0].x,r.vertices[0].y),s=1;s<r.vertices.length;s++)!r.vertices[s-1].isInternal||u?l.lineTo(r.vertices[s].x,r.vertices[s].y):l.moveTo(r.vertices[s].x,r.vertices[s].y),r.vertices[s].isInternal&&!u&&l.moveTo(r.vertices[(s+1)%r.vertices.length].x,r.vertices[(s+1)%r.vertices.length].y);l.lineTo(r.vertices[0].x,r.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},i.bodyConvexHulls=function(t,e,n){var i,r,o,s=n;for(s.beginPath(),r=0;r<e.length;r++)if((i=e[r]).render.visible&&1!==i.parts.length){for(s.moveTo(i.vertices[0].x,i.vertices[0].y),o=1;o<i.vertices.length;o++)s.lineTo(i.vertices[o].x,i.vertices[o].y);s.lineTo(i.vertices[0].x,i.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},i.vertexNumbers=function(t,e,n){var i,r,o,s=n;for(i=0;i<e.length;i++){var a=e[i].parts;for(o=a.length>1?1:0;o<a.length;o++){var l=a[o];for(r=0;r<l.vertices.length;r++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(i+"_"+r,l.position.x+.8*(l.vertices[r].x-l.position.x),l.position.y+.8*(l.vertices[r].y-l.position.y))}}},i.mousePosition=function(t,e,n){var i=n;i.fillStyle="rgba(255,255,255,0.8)",i.fillText(e.position.x+"  "+e.position.y,e.position.x+5,e.position.y-5)},i.bodyBounds=function(t,e,n){var i=n,r=(t.engine,t.options);i.beginPath();for(var o=0;o<e.length;o++)if(e[o].render.visible)for(var s=e[o].parts,a=s.length>1?1:0;a<s.length;a++){var l=s[a];i.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}r.wireframes?i.strokeStyle="rgba(255,255,255,0.08)":i.strokeStyle="rgba(0,0,0,0.1)",i.lineWidth=1,i.stroke()},i.bodyAxes=function(t,e,n){var i,r,o,s,a=n,l=(t.engine,t.options);for(a.beginPath(),r=0;r<e.length;r++){var u=e[r],c=u.parts;if(u.render.visible)if(l.showAxes)for(o=c.length>1?1:0;o<c.length;o++)for(i=c[o],s=0;s<i.axes.length;s++){var h=i.axes[s];a.moveTo(i.position.x,i.position.y),a.lineTo(i.position.x+20*h.x,i.position.y+20*h.y)}else for(o=c.length>1?1:0;o<c.length;o++)for(i=c[o],s=0;s<i.axes.length;s++)a.moveTo(i.position.x,i.position.y),a.lineTo((i.vertices[0].x+i.vertices[i.vertices.length-1].x)/2,(i.vertices[0].y+i.vertices[i.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},i.bodyPositions=function(t,e,n){var i,r,o,s,a=n,l=(t.engine,t.options);for(a.beginPath(),o=0;o<e.length;o++)if((i=e[o]).render.visible)for(s=0;s<i.parts.length;s++)r=i.parts[s],a.arc(r.position.x,r.position.y,3,0,2*Math.PI,!1),a.closePath();for(l.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),o=0;o<e.length;o++)(i=e[o]).render.visible&&(a.arc(i.positionPrev.x,i.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},i.bodyVelocity=function(t,e,n){var i=n;i.beginPath();for(var o=0;o<e.length;o++){var s=e[o];if(s.render.visible){var a=r.getVelocity(s);i.moveTo(s.position.x,s.position.y),i.lineTo(s.position.x+a.x,s.position.y+a.y)}}i.lineWidth=3,i.strokeStyle="cornflowerblue",i.stroke()},i.bodyIds=function(t,e,n){var i,r,o=n;for(i=0;i<e.length;i++)if(e[i].render.visible){var s=e[i].parts;for(r=s.length>1?1:0;r<s.length;r++){var a=s[r];o.font="12px Arial",o.fillStyle="rgba(255,255,255,0.5)",o.fillText(a.id,a.position.x+10,a.position.y-10)}}},i.collisions=function(t,e,n){var i,r,o,s,a=n,l=t.options;for(a.beginPath(),o=0;o<e.length;o++)if((i=e[o]).isActive)for(r=i.collision,s=0;s<i.activeContacts.length;s++){var u=i.activeContacts[s].vertex;a.rect(u.x-1.5,u.y-1.5,3.5,3.5)}for(l.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),o=0;o<e.length;o++)if((i=e[o]).isActive&&(r=i.collision,i.activeContacts.length>0)){var c=i.activeContacts[0].vertex.x,h=i.activeContacts[0].vertex.y;2===i.activeContacts.length&&(c=(i.activeContacts[0].vertex.x+i.activeContacts[1].vertex.x)/2,h=(i.activeContacts[0].vertex.y+i.activeContacts[1].vertex.y)/2),r.bodyB===r.supports[0].body||!0===r.bodyA.isStatic?a.moveTo(c-8*r.normal.x,h-8*r.normal.y):a.moveTo(c+8*r.normal.x,h+8*r.normal.y),a.lineTo(c,h)}l.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},i.separations=function(t,e,n){var i,r,o,s,a,l=n,u=t.options;for(l.beginPath(),a=0;a<e.length;a++)if((i=e[a]).isActive){o=(r=i.collision).bodyA;var c=1;(s=r.bodyB).isStatic||o.isStatic||(c=.5),s.isStatic&&(c=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x-r.penetration.x*c,s.position.y-r.penetration.y*c),c=1,s.isStatic||o.isStatic||(c=.5),o.isStatic&&(c=0),l.moveTo(o.position.x,o.position.y),l.lineTo(o.position.x+r.penetration.x*c,o.position.y+r.penetration.y*c)}u.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},i.inspector=function(t,e){t.engine;var n,i=t.selected,r=t.render,o=r.options;if(o.hasBounds){var s=r.bounds.max.x-r.bounds.min.x,a=r.bounds.max.y-r.bounds.min.y,l=s/r.options.width,u=a/r.options.height;e.scale(1/l,1/u),e.translate(-r.bounds.min.x,-r.bounds.min.y)}for(var c=0;c<i.length;c++){var h=i[c].data;switch(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.9)",e.setLineDash([1,2]),h.type){case"body":n=h.bounds,e.beginPath(),e.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),e.closePath(),e.stroke();break;case"constraint":var d=h.pointA;h.bodyA&&(d=h.pointB),e.beginPath(),e.arc(d.x,d.y,10,0,2*Math.PI),e.closePath(),e.stroke()}e.setLineDash([]),e.translate(-.5,-.5)}null!==t.selectStart&&(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.6)",e.fillStyle="rgba(255,165,0,0.1)",n=t.selectBounds,e.beginPath(),e.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),e.closePath(),e.stroke(),e.fill(),e.translate(-.5,-.5)),o.hasBounds&&e.setTransform(1,0,0,1,0,0)};var n=function(t,e){var n=t.engine,r=t.timing,o=r.historySize,s=n.timing.timestamp;r.delta=e-r.lastTime||i._goodDelta,r.lastTime=e,r.timestampElapsed=s-r.lastTimestamp||0,r.lastTimestamp=s,r.deltaHistory.unshift(r.delta),r.deltaHistory.length=Math.min(r.deltaHistory.length,o),r.engineDeltaHistory.unshift(n.timing.lastDelta),r.engineDeltaHistory.length=Math.min(r.engineDeltaHistory.length,o),r.timestampElapsedHistory.unshift(r.timestampElapsed),r.timestampElapsedHistory.length=Math.min(r.timestampElapsedHistory.length,o),r.engineElapsedHistory.unshift(n.timing.lastElapsed),r.engineElapsedHistory.length=Math.min(r.engineElapsedHistory.length,o),r.elapsedHistory.unshift(r.lastElapsed),r.elapsedHistory.length=Math.min(r.elapsedHistory.length,o)},h=function(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length||0},d=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},p=function(t){var e=t.getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},f=function(t,e){var n=t.textures[e];return n||((n=t.textures[e]=new Image).src=e,n)},m=function(t,e){var n=e;/(jpg|gif|png)$/.test(e)&&(n="url("+e+")"),t.canvas.style.background=n,t.canvas.style.backgroundSize="contain",t.currentBackground=e}}()},function(t,e,n){var i={};t.exports=i;var r,o,s,a=n(5),l=n(17),u=n(0);"undefined"!=typeof window&&(r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r||(r=function(t){s=setTimeout((function(){t(u.now())}),1e3/60)},o=function(){clearTimeout(s)}),i.create=function(t){var e=u.extend({fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},t);return e.delta=e.delta||1e3/e.fps,e.deltaMin=e.deltaMin||1e3/e.fps,e.deltaMax=e.deltaMax||1e3/(.5*e.fps),e.fps=1e3/e.delta,e},i.run=function(t,e){return void 0!==t.positionIterations&&(e=t,t=i.create()),function n(o){t.frameRequestId=r(n),o&&t.enabled&&i.tick(t,e,o)}(),t},i.tick=function(t,e,n){var i,r=e.timing;t.isFixed?i=t.delta:(i=n-t.timePrev||t.delta,t.timePrev=n,t.deltaHistory.push(i),t.deltaHistory=t.deltaHistory.slice(-t.deltaSampleSize),i=(i=(i=Math.min.apply(null,t.deltaHistory))<t.deltaMin?t.deltaMin:i)>t.deltaMax?t.deltaMax:i,t.delta=i);var o={timestamp:r.timestamp};a.trigger(t,"beforeTick",o),t.frameCounter+=1,n-t.counterTimestamp>=1e3&&(t.fps=t.frameCounter*((n-t.counterTimestamp)/1e3),t.counterTimestamp=n,t.frameCounter=0),a.trigger(t,"tick",o),a.trigger(t,"beforeUpdate",o),l.update(e,i),a.trigger(t,"afterUpdate",o),a.trigger(t,"afterTick",o)},i.stop=function(t){o(t.frameRequestId)},i.start=function(t,e){i.run(t,e)}},function(t,e,n){var i={};t.exports=i;var r=n(8),o=n(0).deprecated;i.collides=function(t,e){return r.collides(t,e)},o(i,"collides","SAT.collides ➤ replaced by Collision.collides")},function(t,e,n){var i={};t.exports=i,n(1);var r=n(0);i.pathToVertices=function(t,e){"undefined"==typeof window||"SVGPathSeg"in window||r.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,o,s,a,l,u,c,h,d,p,f,m=[],g=0,y=0,v=0;e=e||15;var x=function(t,e,n){var i=n%2==1&&n>1;if(!d||t!=d.x||e!=d.y){d&&i?(p=d.x,f=d.y):(p=0,f=0);var r={x:p+t,y:f+e};!i&&d||(d=r),m.push(r),y=p+t,v=f+e}},b=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":y=t.x,v=t.y;break;case"H":y=t.x;break;case"V":v=t.y}x(y,v,t.pathSegType)}};for(i._svgPathToAbsolute(t),s=t.getTotalLength(),u=[],n=0;n<t.pathSegList.numberOfItems;n+=1)u.push(t.pathSegList.getItem(n));for(c=u.concat();g<s;){if((l=u[t.getPathSegAtLength(g)])!=h){for(;c.length&&c[0]!=l;)b(c.shift());h=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=t.getPointAtLength(g),x(a.x,a.y,0)}g+=e}for(n=0,o=c.length;n<o;++n)b(c[n]);return m},i._svgPathToAbsolute=function(t){for(var e,n,i,r,o,s,a=t.pathSegList,l=0,u=0,c=a.numberOfItems,h=0;h<c;++h){var d=a.getItem(h),p=d.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(p))"x"in d&&(l=d.x),"y"in d&&(u=d.y);else switch("x1"in d&&(i=l+d.x1),"x2"in d&&(o=l+d.x2),"y1"in d&&(r=u+d.y1),"y2"in d&&(s=u+d.y2),"x"in d&&(l+=d.x),"y"in d&&(u+=d.y),p){case"m":a.replaceItem(t.createSVGPathSegMovetoAbs(l,u),h);break;case"l":a.replaceItem(t.createSVGPathSegLinetoAbs(l,u),h);break;case"h":a.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(l),h);break;case"v":a.replaceItem(t.createSVGPathSegLinetoVerticalAbs(u),h);break;case"c":a.replaceItem(t.createSVGPathSegCurvetoCubicAbs(l,u,i,r,o,s),h);break;case"s":a.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(l,u,o,s),h);break;case"q":a.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(l,u,i,r),h);break;case"t":a.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(l,u),h);break;case"a":a.replaceItem(t.createSVGPathSegArcAbs(l,u,d.r1,d.r2,d.angle,d.largeArcFlag,d.sweepFlag),h);break;case"z":case"Z":l=e,u=n}"M"!=p&&"m"!=p||(e=l,n=u)}}},function(t,e,n){var i={};t.exports=i;var r=n(6);n(0),i.create=r.create,i.add=r.add,i.remove=r.remove,i.clear=r.clear,i.addComposite=r.addComposite,i.addBody=r.addBody,i.addConstraint=r.addConstraint}])},t.exports=i()},2940:(t,e)=>{"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e,i,r){void 0===i&&(i=!1),n(this,t),this._fn=e,this._once=i,this._thisArg=r,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}(),s=function(){function t(){n(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return i(this,new o(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return i(this,new o(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();s.MiniSignalBinding=o,e.default=s,t.exports=e.default},7418:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,r){for(var o,s,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var u in o=Object(arguments[l]))n.call(o,u)&&(a[u]=o[u]);if(e){s=e(o);for(var c=0;c<s.length;c++)i.call(o,s[c])&&(a[s[c]]=o[s[c]])}}return a}},9571:t=>{"use strict";t.exports=function(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[e.strictMode?"strict":"loose"].exec(t),r={},o=14;o--;)r[n.key[o]]=i[o]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,(function(t,e,i){e&&(r[n.q.name][e]=i)})),r}},1513:t=>{function e(t,e,n){n=n||0;var i,r,o,s,a,l,u,c=[0,0];return i=t[1][1]-t[0][1],r=t[0][0]-t[1][0],o=i*t[0][0]+r*t[0][1],s=e[1][1]-e[0][1],a=e[0][0]-e[1][0],l=s*e[0][0]+a*e[0][1],x(u=i*a-s*r,0,n)||(c[0]=(a*o-r*l)/u,c[1]=(i*l-s*o)/u),c}function n(t,e,n,i){var r=e[0]-t[0],o=e[1]-t[1],s=i[0]-n[0],a=i[1]-n[1];if(s*o-a*r==0)return!1;var l=(r*(n[1]-t[1])+o*(t[0]-n[0]))/(s*o-a*r),u=(s*(t[1]-n[1])+a*(n[0]-t[0]))/(a*r-s*o);return l>=0&&l<=1&&u>=0&&u<=1}function i(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function r(t,e,n){return i(t,e,n)>0}function o(t,e,n){return i(t,e,n)>=0}function s(t,e,n){return i(t,e,n)<0}function a(t,e,n){return i(t,e,n)<=0}function l(t,e,n,r){if(r){var o=_,s=w;o[0]=e[0]-t[0],o[1]=e[1]-t[1],s[0]=n[0]-e[0],s[1]=n[1]-e[1];var a=o[0]*s[0]+o[1]*s[1],l=Math.sqrt(o[0]*o[0]+o[1]*o[1]),u=Math.sqrt(s[0]*s[0]+s[1]*s[1]);return Math.acos(a/(l*u))<r}return 0===i(t,e,n)}function u(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function c(t,e){var n=t.length;return t[e<0?e%n+n:e%n]}function h(t,e,n,i){for(var r=n;r<i;r++)t.push(e[r])}function d(t,e){return s(c(t,e-1),c(t,e),c(t,e+1))}function p(t,n,i){var r,s,l=S,h=A;if(o(c(t,n+1),c(t,n),c(t,i))&&a(c(t,n-1),c(t,n),c(t,i)))return!1;s=u(c(t,n),c(t,i));for(var d=0;d!==t.length;++d)if((d+1)%t.length!==n&&d!==n&&o(c(t,n),c(t,i),c(t,d+1))&&a(c(t,n),c(t,i),c(t,d))&&(l[0]=c(t,n),l[1]=c(t,i),h[0]=c(t,d),h[1]=c(t,d+1),r=e(l,h),u(c(t,n),r)<s))return!1;return!0}function f(t,e,i){for(var r=0;r!==t.length;++r)if(r!==e&&r!==i&&(r+1)%t.length!==e&&(r+1)%t.length!==i&&n(c(t,e),c(t,i),c(t,r),c(t,r+1)))return!1;return!0}function m(t,e,n,i){var r=i||[];if(function(t){t.length=0}(r),e<n)for(var o=e;o<=n;o++)r.push(t[o]);else{for(o=0;o<=n;o++)r.push(t[o]);for(o=e;o<t.length;o++)r.push(t[o])}return r}function g(t){for(var e=[],n=[],i=[],r=[],o=Number.MAX_VALUE,s=0;s<t.length;++s)if(d(t,s))for(var a=0;a<t.length;++a)if(p(t,s,a)){n=g(m(t,s,a,r)),i=g(m(t,a,s,r));for(var l=0;l<i.length;l++)n.push(i[l]);n.length<o&&(e=n,o=n.length,e.push([c(t,s),c(t,a)]))}return e}function y(t,e){if(0===e.length)return[t];if(e instanceof Array&&e.length&&e[0]instanceof Array&&2===e[0].length&&e[0][0]instanceof Array){for(var n=[t],i=0;i<e.length;i++)for(var r=e[i],o=0;o<n.length;o++){var s=y(n[o],r);if(s){n.splice(o,1),n.push(s[0],s[1]);break}}return n}return r=e,i=t.indexOf(r[0]),o=t.indexOf(r[1]),-1!==i&&-1!==o&&[m(t,i,o),m(t,o,i)]}function v(t,e,n,i,r){r=r||0;var o=e[1]-t[1],s=t[0]-e[0],a=o*t[0]+s*t[1],l=i[1]-n[1],u=n[0]-i[0],c=l*n[0]+u*n[1],h=o*u-l*s;return x(h,0,r)?[0,0]:[(u*a-s*c)/h,(o*c-l*a)/h]}function x(t,e,n){return n=n||0,Math.abs(t-e)<=n}function b(t,e,n){return x(t[0],e[0],n)&&x(t[1],e[1],n)}t.exports={decomp:function(t){var e=g(t);return e.length>0?y(t,e):[t]},quickDecomp:function t(e,n,i,l,p,m,g){m=m||100,g=g||0,p=p||25,n=void 0!==n?n:[],i=i||[],l=l||[];var y=[0,0],x=[0,0],b=[0,0],_=0,w=0,S=0,A=0,M=0,T=0,E=0,P=[],C=[],I=e,R=e;if(R.length<3)return n;if(++g>m)return console.warn("quickDecomp: max level ("+m+") reached."),n;for(var O=0;O<e.length;++O)if(d(I,O)){i.push(I[O]),_=w=Number.MAX_VALUE;for(var q=0;q<e.length;++q)r(c(I,O-1),c(I,O),c(I,q))&&a(c(I,O-1),c(I,O),c(I,q-1))&&(b=v(c(I,O-1),c(I,O),c(I,q),c(I,q-1)),s(c(I,O+1),c(I,O),b)&&(S=u(I[O],b))<w&&(w=S,x=b,T=q)),r(c(I,O+1),c(I,O),c(I,q+1))&&a(c(I,O+1),c(I,O),c(I,q))&&(b=v(c(I,O+1),c(I,O),c(I,q),c(I,q+1)),r(c(I,O-1),c(I,O),b)&&(S=u(I[O],b))<_&&(_=S,y=b,M=q));if(T===(M+1)%e.length)b[0]=(x[0]+y[0])/2,b[1]=(x[1]+y[1])/2,l.push(b),O<M?(h(P,I,O,M+1),P.push(b),C.push(b),0!==T&&h(C,I,T,I.length),h(C,I,0,O+1)):(0!==O&&h(P,I,O,I.length),h(P,I,0,M+1),P.push(b),C.push(b),h(C,I,T,O+1));else{if(T>M&&(M+=e.length),A=Number.MAX_VALUE,M<T)return n;for(q=T;q<=M;++q)o(c(I,O-1),c(I,O),c(I,q))&&a(c(I,O+1),c(I,O),c(I,q))&&(S=u(c(I,O),c(I,q)))<A&&f(I,O,q)&&(A=S,E=q%e.length);O<E?(h(P,I,O,E+1),0!==E&&h(C,I,E,R.length),h(C,I,0,O+1)):(0!==O&&h(P,I,O,R.length),h(P,I,0,E+1),h(C,I,E,O+1))}return P.length<C.length?(t(P,n,i,l,p,m,g),t(C,n,i,l,p,m,g)):(t(C,n,i,l,p,m,g),t(P,n,i,l,p,m,g)),n}return n.push(e),n},isSimple:function(t){var e,i=t;for(e=0;e<i.length-1;e++)for(var r=0;r<e-1;r++)if(n(i[e],i[e+1],i[r],i[r+1]))return!1;for(e=1;e<i.length-2;e++)if(n(i[0],i[i.length-1],i[e],i[e+1]))return!1;return!0},removeCollinearPoints:function(t,e){for(var n=0,i=t.length-1;t.length>3&&i>=0;--i)l(c(t,i-1),c(t,i),c(t,i+1),e)&&(t.splice(i%t.length,1),n++);return n},removeDuplicatePoints:function(t,e){for(var n=t.length-1;n>=1;--n)for(var i=t[n],r=n-1;r>=0;--r)b(i,t[r],e)&&t.splice(n,1)},makeCCW:function(t){for(var e=0,n=t,i=1;i<t.length;++i)(n[i][1]<n[e][1]||n[i][1]===n[e][1]&&n[i][0]>n[e][0])&&(e=i);return!r(c(t,e-1),c(t,e),c(t,e+1))&&(function(t){for(var e=[],n=t.length,i=0;i!==n;i++)e.push(t.pop());for(i=0;i!==n;i++)t[i]=e[i]}(t),!0)}};var _=[],w=[],S=[],A=[]},2075:function(t){t.exports=function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)}function n(t,e){return n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var r=function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1},o=function(t,e){return[1,0,0,0,1,0,t,e,1]},s=function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],p=e[2],f=e[3],m=e[4],g=e[5],y=e[6],v=e[7],x=e[8];return[n*h+i*f+r*y,n*d+i*m+r*v,n*p+i*g+r*x,o*h+s*f+a*y,o*d+s*m+a*v,o*p+s*g+a*x,l*h+u*f+c*y,l*d+u*m+c*v,l*p+u*g+c*x]},a={createCanvas:function(t,e,n,i){void 0===i&&(i="absolute");var r=document.createElement("canvas");return r.id=t,r.width=e,r.height=n,r.style.opacity=0,r.style.position=i,this.transform(r,-500,-500,0,0),r},createDiv:function(t,e,n){var i=document.createElement("div");return i.id=t,i.style.position="absolute",this.resize(i,e,n),i},resize:function(t,e,n){t.style.width=e+"px",t.style.height=n+"px",t.style.marginLeft=-e/2+"px",t.style.marginTop=-n/2+"px"},transform:function(t,e,n,i,r){t.style.willChange="transform";var o="translate("+e+"px, "+n+"px) scale("+i+") rotate("+r+"deg)";this.css3(t,"transform",o)},transform3d:function(t,e,n,i,r){t.style.willChange="transform";var o="translate3d("+e+"px, "+n+"px, 0) scale("+i+") rotate("+r+"deg)";this.css3(t,"backfaceVisibility","hidden"),this.css3(t,"transform",o)},css3:function(t,e,n){var i=e.charAt(0).toUpperCase()+e.substr(1);t.style["Webkit"+i]=n,t.style["Moz"+i]=n,t.style["O"+i]=n,t.style["ms"+i]=n,t.style[""+e]=n}},l={},u={},c=0,h=function(t,e,n){var i="string"==typeof t?t:t.src;if(l[i])e(l[i],n);else{var r=new Image;r.onload=function(t){l[i]=t.target,e(l[i],n)},r.src=i}},d={initValue:function(t,e){return null!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyArray:function(t){t&&(t.length=0)},toArray:function(t){return this.isArray(t)?t:[t]},sliceArray:function(t,e,n){this.emptyArray(n);for(var i=e;i<t.length;i++)n.push(t[i])},getRandFromArray:function(t){return t?t[Math.floor(t.length*Math.random())]:null},emptyObject:function(t,e){for(var n in void 0===e&&(e=null),t)e&&e.indexOf(n)>-1||delete t[n]},classApply:function(t,e){return void 0===e&&(e=null),e?new(t.bind.apply(t,[null].concat(e))):new t},getImageData:function(t,e,n){return function(t,e,n){t.drawImage(e,n.x,n.y);var i=t.getImageData(n.x,n.y,n.width,n.height);return t.clearRect(n.x,n.y,n.width,n.height),i}(t,e,n)},destroyAll:function(t,e){void 0===e&&(e=null);for(var n=t.length;n--;){try{t[n].destroy(e)}catch(t){}delete t[n]}t.length=0},assign:function(t,e){if("function"!=typeof Object.assign){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return Object.assign(t,e)}},p={},f={_index:0,_cache:{},id:function(t){return void 0!==p[t]&&null!==p[t]||(p[t]=0),t+"_"+p[t]++},getId:function(t){var e=this.getIdFromCache(t);return e||(e="PUID_"+this._index++,this._cache[e]=t,e)},getIdFromCache:function(t){var e,n;for(n in this._cache){if((e=this._cache[n])===t)return n;if(this.isBody(e,t)&&e.src===t.src)return n}return null},isBody:function(t,e){return"object"==typeof t&&"object"==typeof e&&t.isInner&&e.isInner},getTarget:function(t){return this._cache[t]}},m=function(){function t(t){this.total=0,this.cache={}}var e=t.prototype;return e.get=function(t,e,n){var i;return n=n||t.__puid||f.getId(t),(i=this.cache[n]&&this.cache[n].length>0?this.cache[n].pop():this.createOrClone(t,e)).__puid=t.__puid||n,i},e.expire=function(t){return this.getCache(t.__puid).push(t)},e.createOrClone=function(t,e){return this.total++,this.create?this.create(t,e):"function"==typeof t?d.classApply(t,e):t.clone()},e.getCount=function(){var t=0;for(var e in this.cache)t+=this.cache[e].length;return t++},e.destroy=function(){for(var t in this.cache)this.cache[t].length=0,delete this.cache[t]},e.getCache=function(t){return void 0===t&&(t="default"),this.cache[t]||(this.cache[t]=[]),this.cache[t]},t}(),g=function(){function t(t){this.proton=t,this.container=null,this.type=1,this.emitterIndex=0,this.rendererIndex=0}var e=t.prototype;return e.update=function(t,e){this.add(t,e);var n=this.getEmitter(),i=this.getRenderer(),r="";switch(this.type){case 2:r+="emitter:"+this.proton.emitters.length+"<br>",n&&(r+="em speed:"+n.emitSpeed+"<br>"),n&&(r+="pos:"+this.getEmitterPos(n));break;case 3:n&&(r+="initializes:"+n.initializes.length+"<br>"),n&&(r+='<span style="display:inline-block;">'+this.concatArr(n.initializes)+"</span><br>"),n&&(r+="behaviours:"+n.behaviours.length+"<br>"),n&&(r+='<span style="display:inline-block;">'+this.concatArr(n.behaviours)+"</span><br>");break;case 4:i&&(r+=i.name+"<br>"),i&&(r+="body:"+this.getCreatedNumber(i)+"<br>");break;default:r+="particles:"+this.proton.getCount()+"<br>",r+="pool:"+this.proton.pool.getCount()+"<br>",r+="total:"+this.proton.pool.total}this.container.innerHTML=r},e.add=function(t,e){var n=this;if(!this.container){var i,r;switch(this.type=1,this.container=document.createElement("div"),this.container.style.cssText=["position:absolute;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;font-family:Helvetica,Arial,sans-serif;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this.container.addEventListener("click",(function(t){n.type++,n.type>4&&(n.type=1)}),!1),t){case 2:i="#201",r="#f08";break;case 3:i="#020",r="#0f0";break;default:i="#002",r="#0ff"}this.container.style["background-color"]=i,this.container.style.color=r}this.container.parentNode||(e=e||this.body||document.body).appendChild(this.container)},e.getEmitter=function(){return this.proton.emitters[this.emitterIndex]},e.getRenderer=function(){return this.proton.renderers[this.rendererIndex]},e.concatArr=function(t){var e="";if(!t||!t.length)return e;for(var n=0;n<t.length;n++)e+=(t[n].name||"").substr(0,1)+".";return e},e.getCreatedNumber=function(t){return t.pool.total||t.cpool&&t.cpool.total||0},e.getEmitterPos=function(t){return Math.round(t.p.x)+","+Math.round(t.p.y)},e.destroy=function(){this.container&&this.container.parentNode&&(this.body||document.body).removeChild(this.container),this.proton=null,this.container=null},t}(),y=function(){function t(){this._listeners=null}t.bind=function(e){e.prototype.dispatchEvent=t.prototype.dispatchEvent,e.prototype.hasEventListener=t.prototype.hasEventListener,e.prototype.addEventListener=t.prototype.addEventListener,e.prototype.removeEventListener=t.prototype.removeEventListener,e.prototype.removeAllEventListeners=t.prototype.removeAllEventListeners};var e=t.prototype;return e.addEventListener=function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e},e.removeEventListener=function(t,e){if(this._listeners&&this._listeners[t])for(var n=this._listeners[t],i=n.length,r=0;r<i;r++)if(n[r]===e){1===i?delete this._listeners[t]:n.splice(r,1);break}},e.removeAllEventListeners=function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null},e.dispatchEvent=function(t,e){var n=!1,i=this._listeners;if(t&&i){var r,o=i[t];if(!o)return n;for(var s=o.length;s--;)r=o[s],n=n||r(e)}return!!n},e.hasEventListener=function(t){var e=this._listeners;return!(!e||!e[t])},t}(),v=3.1415926,x={PI:v,PIx2:2*v,PI_2:v/2,PI_180:v/180,N180_PI:180/v,Infinity:-999,isInfinity:function(t){return t===this.Infinity||1/0===t},randomAToB:function(t,e,n){return void 0===n&&(n=!1),n?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,n){return this.randomAToB(t-e,t+e,n)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},randomZone:function(t){},floor:function(t,e){void 0===e&&(e=4);var n=Math.pow(10,e);return Math.floor(t*n)/n},degreeTransform:function(t){return t*v/180},toColor16:function(t){return"#"+t.toString(16)}},b=function(){function t(t){this.type=t}var e=t.prototype;return e.calculate=function(t,e,n){this.eulerIntegrate(t,e,n)},e.eulerIntegrate=function(t,e,n){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.multiplyScalar(1/t.mass),t.v.add(t.a.multiplyScalar(e)),t.p.add(t.old.v.multiplyScalar(e)),n&&t.v.multiplyScalar(n),t.a.clear())},t}(),_=function(){function e(t){this.emitters=[],this.renderers=[],this.time=0,this.now=0,this.then=0,this.elapsed=0,this.stats=new g(this),this.pool=new m(80),this.integrationType=d.initValue(t,e.EULER),this.integrator=new b(this.integrationType),this._fps="auto",this._interval=e.DEFAULT_INTERVAL}var n,i,r=e.prototype;return r.addRenderer=function(t){t.init(this),this.renderers.push(t)},r.removeRenderer=function(t){var e=this.renderers.indexOf(t);this.renderers.splice(e,1),t.remove(this)},r.addEmitter=function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent(e.EMITTER_ADDED,t)},r.removeEmitter=function(t){var n=this.emitters.indexOf(t);this.emitters.splice(n,1),t.parent=null,this.dispatchEvent(e.EMITTER_REMOVED,t)},r.update=function(){"auto"===this._fps?(this.dispatchEvent(e.PROTON_UPDATE),e.USE_CLOCK?(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.amendChangeTabsBug(),this.elapsed>0&&this.emittersUpdate(this.elapsed),this.then=this.now):this.emittersUpdate(e.DEFAULT_INTERVAL),this.dispatchEvent(e.PROTON_UPDATE_AFTER)):(this.then||(this.then=(new Date).getTime()),this.now=(new Date).getTime(),this.elapsed=.001*(this.now-this.then),this.elapsed>this._interval&&(this.dispatchEvent(e.PROTON_UPDATE),this.emittersUpdate(this._interval),this.then=this.now-this.elapsed%this._interval*1e3,this.dispatchEvent(e.PROTON_UPDATE_AFTER)))},r.emittersUpdate=function(t){for(var e=this.emitters.length;e--;)this.emitters[e].update(t)},r.amendChangeTabsBug=function(){e.amendChangeTabsBug&&this.elapsed>.5&&(this.then=(new Date).getTime(),this.elapsed=0)},r.getCount=function(){for(var t=0,e=this.emitters.length;e--;)t+=this.emitters[e].particles.length;return t},r.getAllParticles=function(){for(var t=[],e=this.emitters.length;e--;)t=t.concat(this.emitters[e].particles);return t},r.destroyAllEmitters=function(){d.destroyAll(this.emitters)},r.destroy=function(t){var e=this;void 0===t&&(t=!1);var n=function(){e.time=0,e.then=0,e.pool.destroy(),e.stats.destroy(),d.destroyAll(e.emitters),d.destroyAll(e.renderers,e.getAllParticles()),e.integrator=null,e.renderers=null,e.emitters=null,e.stats=null,e.pool=null};t?setTimeout(n,200):n()},n=e,(i=[{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._interval="auto"===t?e.DEFAULT_INTERVAL:x.floor(1/t,7)}}])&&t(n.prototype,i),e}();_.USE_CLOCK=!1,_.MEASURE=100,_.EULER="euler",_.RK2="runge-kutta2",_.PARTICLE_CREATED="PARTICLE_CREATED",_.PARTICLE_UPDATE="PARTICLE_UPDATE",_.PARTICLE_SLEEP="PARTICLE_SLEEP",_.PARTICLE_DEAD="PARTICLE_DEAD",_.EMITTER_ADDED="EMITTER_ADDED",_.EMITTER_REMOVED="EMITTER_REMOVED",_.PROTON_UPDATE="PROTON_UPDATE",_.PROTON_UPDATE_AFTER="PROTON_UPDATE_AFTER",_.DEFAULT_INTERVAL=.0167,_.amendChangeTabsBug=!0,y.bind(_);var w=function(){function t(t,e,n){void 0===t&&(t=255),void 0===e&&(e=255),void 0===n&&(n=255),this.r=t,this.g=e,this.b=n}return t.prototype.reset=function(){this.r=255,this.g=255,this.b=255},t}(),S={hasProp:function(t,e){return!!t&&void 0!==t[e]},setProp:function(t,e){for(var n in e)t.hasOwnProperty(n)&&(t[n]=Span.getSpanValue(e[n]));return t},setVectorVal:function(t,e){void 0===e&&(e=null),e&&(this.hasProp(e,"x")&&(t.p.x=e.x),this.hasProp(e,"y")&&(t.p.y=e.y),this.hasProp(e,"vx")&&(t.v.x=e.vx),this.hasProp(e,"vy")&&(t.v.y=e.vy),this.hasProp(e,"ax")&&(t.a.x=e.ax),this.hasProp(e,"ay")&&(t.a.y=e.ay),this.hasProp(e,"p")&&t.p.copy(e.p),this.hasProp(e,"v")&&t.v.copy(e.v),this.hasProp(e,"a")&&t.a.copy(e.a),this.hasProp(e,"position")&&t.p.copy(e.position),this.hasProp(e,"velocity")&&t.v.copy(e.velocity),this.hasProp(e,"accelerate")&&t.a.copy(e.accelerate))}},A={easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return 1-Math.cos(t*x.PI_2)},easeOutSine:function(t){return Math.sin(t*x.PI_2)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},getEasing:function(t){return"function"==typeof t?t:this[t]||this.easeLinear}},M=function(){function t(t,e){this.x=t||0,this.y=e||0}var e=t.prototype;return e.set=function(t,e){return this.x=t,this.y=e,this},e.setX=function(t){return this.x=t,this},e.setY=function(t){return this.y=t,this},e.getGradient=function(){return 0!==this.x?Math.atan2(this.y,this.x):this.y>0?x.PI_2:this.y<0?-x.PI_2:void 0},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.add=function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},e.addXY=function(t,e){return this.x+=t,this.y+=e,this},e.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},e.sub=function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},e.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},e.divideScalar=function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},e.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.negate=function(){return this.multiplyScalar(-1)},e.dot=function(t){return this.x*t.x+this.y*t.y},e.lengthSq=function(){return this.x*this.x+this.y*this.y},e.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.normalize=function(){return this.divideScalar(this.length())},e.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},e.rotate=function(t){var e=this.x,n=this.y;return this.x=e*Math.cos(t)+n*Math.sin(t),this.y=-e*Math.sin(t)+n*Math.cos(t),this},e.distanceToSquared=function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},e.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},e.equals=function(t){return t.x===this.x&&t.y===this.y},e.clear=function(){return this.x=0,this.y=0,this},e.clone=function(){return new t(this.x,this.y)},t}(),T=function(){function t(t){this.id="",this.old=null,this.data=null,this.behaviours=null,this.p=null,this.v=null,this.a=null,this.rgb=null,this.name="Particle",this.id=f.id(this.name),this.old={},this.data={},this.behaviours=[],this.p=new M,this.v=new M,this.a=new M,this.old.p=new M,this.old.v=new M,this.old.a=new M,this.rgb=new w,this.reset(),t&&S.setProp(this,t)}var e=t.prototype;return e.getDirection=function(){return Math.atan2(this.v.x,-this.v.y)*x.N180_PI},e.reset=function(){return this.life=1/0,this.age=0,this.dead=!1,this.sleep=!1,this.body=null,this.sprite=null,this.parent=null,this.energy=1,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.rotation=0,this.color=null,this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.easing=A.easeLinear,this.rgb.reset(),d.emptyObject(this.data),this.removeAllBehaviours(),this},e.update=function(t,e){if(this.sleep||(this.age+=t,this.applyBehaviours(t,e)),this.age<this.life){var n=this.easing(this.age/this.life);this.energy=Math.max(1-n,0)}else this.destroy()},e.applyBehaviours=function(t,e){var n,i=this.behaviours.length;for(n=0;n<i;n++)this.behaviours[n]&&this.behaviours[n].applyBehaviour(this,t,e)},e.addBehaviour=function(t){this.behaviours.push(t),t.hasOwnProperty("parents")&&t.parents.push(this),t.initialize(this)},e.addBehaviours=function(t){var e,n=t.length;for(e=0;e<n;e++)this.addBehaviour(t[e])},e.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);e>-1&&(this.behaviours.splice(e,1).parents=null)},e.removeAllBehaviours=function(){d.emptyArray(this.behaviours)},e.destroy=function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null},t}(),E={hexToRgb:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t;return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16)}},rgbToHex:function(t){return"rgb("+t.r+", "+t.g+", "+t.b+")"},getHex16FromParticle:function(t){return 65536*Number(t.rgb.r)+256*Number(t.rgb.g)+Number(t.rgb.b)}},P=function(){function t(t,e){this.r=Math.abs(t)||0,this.tha=e||0}var e=t.prototype;return e.set=function(t,e){return this.r=t,this.tha=e,this},e.setR=function(t){return this.r=t,this},e.setTha=function(t){return this.tha=t,this},e.copy=function(t){return this.r=t.r,this.tha=t.tha,this},e.toVector=function(){return new M(this.getX(),this.getY())},e.getX=function(){return this.r*Math.sin(this.tha)},e.getY=function(){return-this.r*Math.cos(this.tha)},e.normalize=function(){return this.r=1,this},e.equals=function(t){return t.r===this.r&&t.tha===this.tha},e.clear=function(){return this.r=0,this.tha=0,this},e.clone=function(){return new t(this.r,this.tha)},t}(),C={create:function(t){var e=new Float32Array(9);return t&&this.set(t,e),e},set:function(t,e){for(var n=0;n<9;n++)e[n]=t[n];return e},multiply:function(t,e,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[6],u=t[7],c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],m=e[6],g=e[7];return n[0]=c*i+h*s,n[1]=c*r+h*a,n[2]=o*d,n[3]=p*i+f*s,n[4]=p*r+f*a,n[6]=m*i+g*s+l,n[7]=m*r+g*a+u,n},inverse:function(t,e){var n,i=t[0],r=t[1],o=t[3],s=t[4],a=t[6],l=t[7],u=s,c=-o,h=l*o-s*a;return n=1/(i*u+r*c),e[0]=u*n,e[1]=-r*n,e[3]=c*n,e[4]=i*n,e[6]=h*n,e[7]=(-l*i+r*a)*n,e},multiplyVec2:function(t,e,n){var i=e[0],r=e[1];return n[0]=i*t[0]+r*t[3]+t[6],n[1]=i*t[1]+r*t[4]+t[7],n}},I=function(){function t(t,e,n){d.isArray(t)?(this.isArray=!0,this.a=t):(this.isArray=!1,this.a=d.initValue(t,1),this.b=d.initValue(e,this.a),this.center=d.initValue(n,!1))}return t.prototype.getValue=function(t){return void 0===t&&(t=!1),this.isArray?d.getRandFromArray(this.a):this.center?x.randomFloating(this.a,this.b,t):x.randomAToB(this.a,this.b,t)},t.setSpanValue=function(e,n,i){return e instanceof t?e:void 0===n?new t(e):void 0===i?new t(e,n):new t(e,n,i)},t.getSpanValue=function(e){return e instanceof t?e.getValue():e},t}(),R=function(t){function n(e){var n;return(n=t.call(this)||this)._arr=d.toArray(e),n}return e(n,t),n.prototype.getValue=function(){var t=d.getRandFromArray(this._arr);return"random"===t||"Random"===t?x.randomColor():t},n.createArraySpan=function(t){return t?t instanceof n?t:new n(t):null},n}(I),O=function(){function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i,this.bottom=this.y+this.height,this.right=this.x+this.width}return t.prototype.contains=function(t,e){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y},t}(),q=function(){function t(t,e){this.numPan=I.setSpanValue(d.initValue(t,1)),this.timePan=I.setSpanValue(d.initValue(e,1)),this.startTime=0,this.nextTime=0,this.init()}var e=t.prototype;return e.init=function(){this.startTime=0,this.nextTime=this.timePan.getValue()},e.getValue=function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.startTime=0,this.nextTime=this.timePan.getValue(),1===this.numPan.b?this.numPan.getValue(!1)>.5?1:0:this.numPan.getValue(!0)):0},t}(),L=function(){function t(){}var e=t.prototype;return e.reset=function(){},e.init=function(t,e){e?this.initialize(e):this.initialize(t)},e.initialize=function(t){},t}(),D=function(t){function n(e,n,i){var r;return(r=t.call(this)||this).lifePan=I.setSpanValue(e,n,i),r.name="Life",r}return e(n,t),n.prototype.initialize=function(t){this.lifePan.a===1/0?t.life=1/0:t.life=this.lifePan.getValue()},n}(L),z=function(){function t(){this.vector=new M(0,0),this.random=0,this.crossType="dead",this.alert=!0}var e=t.prototype;return e.getPosition=function(){},e.crossing=function(t){},e.destroy=function(){this.vector=null},t}(),k=function(t){function n(e,n){var i;return(i=t.call(this)||this).x=e,i.y=n,i}e(n,t);var i=n.prototype;return i.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector},i.crossing=function(t){this.alert&&(console.error("Sorry, PointZone does not support crossing method!"),this.alert=!1)},n}(z),B=function(t){function n(e){var n;return(n=t.call(this)||this).zone=d.initValue(e,new k),n.name="Position",n}e(n,t);var i=n.prototype;return i.reset=function(t){this.zone=d.initValue(t,new k)},i.initialize=function(t){this.zone.getPosition(),t.p.x=this.zone.vector.x,t.p.y=this.zone.vector.y},n}(L),F=function(t){function n(e,n,i){var r;return(r=t.call(this)||this).rPan=I.setSpanValue(e),r.thaPan=I.setSpanValue(n),r.type=d.initValue(i,"vector"),r.name="Velocity",r}e(n,t);var i=n.prototype;return i.reset=function(t,e,n){this.rPan=I.setSpanValue(t),this.thaPan=I.setSpanValue(e),this.type=d.initValue(n,"vector")},i.normalizeVelocity=function(t){return t*_.MEASURE},i.initialize=function(t){if("p"===this.type||"P"===this.type||"polar"===this.type){var e=new P(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*x.PI_180);t.v.x=e.getX(),t.v.y=e.getY()}else t.v.x=this.normalizeVelocity(this.rPan.getValue()),t.v.y=this.normalizeVelocity(this.thaPan.getValue())},n}(L),V=function(t){function n(e,n,i){var r;return(r=t.call(this)||this).massPan=I.setSpanValue(e,n,i),r.name="Mass",r}return e(n,t),n.prototype.initialize=function(t){t.mass=this.massPan.getValue()},n}(L),N=function(t){function n(e,n,i){var r;return(r=t.call(this)||this).radius=I.setSpanValue(e,n,i),r.name="Radius",r}e(n,t);var i=n.prototype;return i.reset=function(t,e,n){this.radius=I.setSpanValue(t,e,n)},i.initialize=function(t){t.radius=this.radius.getValue(),t.data.oldRadius=t.radius},n}(L),U=function(t){function n(e,n,i){var r;return(r=t.call(this)||this).image=r.setSpanValue(e),r.w=d.initValue(n,20),r.h=d.initValue(i,r.w),r.name="Body",r}e(n,t);var i=n.prototype;return i.initialize=function(t){var e=this.image.getValue();t.body="string"==typeof e?{width:this.w,height:this.h,src:e,isInner:!0,inner:!0}:e},i.setSpanValue=function(t){return t instanceof R?t:new R(t)},n}(L),j=function(){function t(e,n){this.life=d.initValue(e,1/0),this.easing=A.getEasing(n),this.age=0,this.energy=1,this.dead=!1,this.parents=[],this.id="Behaviour_"+t.id++,this.name="Behaviour"}var e=t.prototype;return e.reset=function(t,e){this.life=d.initValue(t,1/0),this.easing=A.getEasing(e)},e.normalizeForce=function(t){return t.multiplyScalar(_.MEASURE)},e.normalizeValue=function(t){return t*_.MEASURE},e.initialize=function(t){},e.calculate=function(t,e,n){if(this.age+=e,this.age>=this.life||this.dead)this.energy=0,this.dead=!0,this.destroy();else{var i=this.easing(t.age/t.life);this.energy=Math.max(1-i,0)}},e.applyBehaviour=function(t,e,n){this.calculate(t,e,n)},e.destroy=function(){for(var t=this.parents.length;t--;)this.parents[t].removeBehaviour(this);this.parents.length=0},t}();j.id=0;var G=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).force=o.normalizeForce(new M(e,n)),o.name="Force",o}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r){this.force=this.normalizeForce(new M(e,n)),i&&t.prototype.reset.call(this,i,r)},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),t.a.add(this.force)},n}(j),H=function(t){function n(e,n,i,r,o){var s;return(s=t.call(this,r,o)||this).targetPosition=d.initValue(e,new M),s.radius=d.initValue(i,1e3),s.force=d.initValue(s.normalizeValue(n),100),s.radiusSq=s.radius*s.radius,s.attractionForce=new M,s.lengthSq=0,s.name="Attraction",s}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r,o){this.targetPosition=d.initValue(e,new M),this.radius=d.initValue(i,1e3),this.force=d.initValue(this.normalizeValue(n),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new M,this.lengthSq=0,r&&t.prototype.reset.call(this,r,o)},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-5&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),t.a.add(this.attractionForce))},n}(j),W=function(t){function n(e,n,i,r,o){var s;return(s=t.call(this,r,o)||this).reset(e,n,i),s.time=0,s.name="RandomDrift",s}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r,o){this.panFoce=new M(e,n),this.panFoce=this.normalizeForce(this.panFoce),this.delay=i,r&&t.prototype.reset.call(this,r,o)},i.initialize=function(t){t.data.time=0},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),t.data.time+=e,t.data.time>=this.delay&&(t.a.addXY(x.randomAToB(-this.panFoce.x,this.panFoce.x),x.randomAToB(-this.panFoce.y,this.panFoce.y)),t.data.time=0)},n}(j),X=function(t){function n(e,n,i){var r;return(r=t.call(this,0,e,n,i)||this).name="Gravity",r}return e(n,t),n.prototype.reset=function(e,n,i){t.prototype.reset.call(this,0,e,n,i)},n}(G),Y=function(t){function n(e,n,i,r,o){var s;return(s=t.call(this,r,o)||this).reset(e,n,i),s.newPool=[],s.pool=[],s.name="Collision",s}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r,o){this.emitter=d.initValue(e,null),this.mass=d.initValue(n,!0),this.callback=d.initValue(i,null),this.collisionPool=[],this.delta=new M,r&&t.prototype.reset.call(this,r,o)},i.applyBehaviour=function(t,e,n){this.emitter?d.sliceArray(this.emitter.particles,n,this.newPool):d.sliceArray(this.pool,n,this.newPool);var i,r,o,s,a,l,u,c=this.newPool.length;for(u=0;u<c;u++)if((i=this.newPool[u])!==t){this.delta.copy(i.p),this.delta.sub(t.p),r=this.delta.lengthSq();var h=t.radius+i.radius;r<=h*h&&(o=h-Math.sqrt(r),o+=.5,s=t.mass+i.mass,a=this.mass?i.mass/s:.5,l=this.mass?t.mass/s:.5,t.p.add(this.delta.clone().normalize().multiplyScalar(o*-a)),i.p.add(this.delta.normalize().multiplyScalar(o*l)),this.callback&&this.callback(t,i))}},n}(j),Z=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).reset(e,n),o.name="CrossZone",o}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r){this.zone=e,this.zone.crossType=d.initValue(n,"dead"),i&&t.prototype.reset.call(this,i,r)},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),this.zone.crossing(t)},n}(j),Q=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).reset(e,n),o.name="Alpha",o}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r){this.same=null==n,this.a=I.setSpanValue(d.initValue(e,1)),this.b=I.setSpanValue(n),i&&t.prototype.reset.call(this,i,r)},i.initialize=function(t){t.data.alphaA=this.a.getValue(),this.same?t.data.alphaB=t.data.alphaA:t.data.alphaB=this.b.getValue()},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),t.alpha=t.data.alphaB+(t.data.alphaA-t.data.alphaB)*this.energy,t.alpha<.001&&(t.alpha=0)},n}(j),J=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).reset(e,n),o.name="Scale",o}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r){this.same=null==n,this.a=I.setSpanValue(d.initValue(e,1)),this.b=I.setSpanValue(n),i&&t.prototype.reset.call(this,i,r)},i.initialize=function(t){t.data.scaleA=this.a.getValue(),t.data.oldRadius=t.radius,t.data.scaleB=this.same?t.data.scaleA:this.b.getValue()},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),t.scale=t.data.scaleB+(t.data.scaleA-t.data.scaleB)*this.energy,t.scale<1e-4&&(t.scale=0),t.radius=t.data.oldRadius*t.scale},n}(j),K=function(t){function n(e,n,i,r,o){var s;return(s=t.call(this,r,o)||this).reset(e,n,i),s.name="Rotate",s}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r,o){this.same=null==n,this.a=I.setSpanValue(d.initValue(e,"Velocity")),this.b=I.setSpanValue(d.initValue(n,0)),this.style=d.initValue(i,"to"),r&&t.prototype.reset.call(this,r,o)},i.initialize=function(t){t.rotation=this.a.getValue(),t.data.rotationA=this.a.getValue(),this.same||(t.data.rotationB=this.b.getValue())},i.applyBehaviour=function(t,e,n){this.calculate(t,e,n),this.same?"V"!==this.a.a&&"Velocity"!==this.a.a&&"v"!==this.a.a||(t.rotation=t.getDirection()):"to"===this.style||"TO"===this.style||"_"===this.style?t.rotation+=t.data.rotationB+(t.data.rotationA-t.data.rotationB)*this.energy:t.rotation+=t.data.rotationB},n}(j),$=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).reset(e,n),o.name="Color",o}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r){this.a=R.createArraySpan(e),this.b=R.createArraySpan(n),i&&t.prototype.reset.call(this,i,r)},i.initialize=function(t){t.color=this.a.getValue(),t.data.colorA=E.hexToRgb(t.color),this.b&&(t.data.colorB=E.hexToRgb(this.b.getValue()))},i.applyBehaviour=function(t,e,n){this.b?(this.calculate(t,e,n),t.rgb.r=t.data.colorB.r+(t.data.colorA.r-t.data.colorB.r)*this.energy,t.rgb.g=t.data.colorB.g+(t.data.colorA.g-t.data.colorB.g)*this.energy,t.rgb.b=t.data.colorB.b+(t.data.colorA.b-t.data.colorB.b)*this.energy,t.rgb.r=t.rgb.r<<0,t.rgb.g=t.rgb.g<<0,t.rgb.b=t.rgb.b<<0):(t.rgb.r=t.data.colorA.r,t.rgb.g=t.data.colorA.g,t.rgb.b=t.data.colorA.b)},n}(j),tt="changing",et=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).setAngleAndForce(e,n),o.name="Cyclone",o}e(n,t);var i=n.prototype;return i.setAngleAndForce=function(t,e){this.force=tt,this.angle=x.PI/2,"right"===t?this.angle=x.PI/2:"left"===t?this.angle=-x.PI/2:"random"===t?this.angle="random":t instanceof I?(this.angle="span",this.span=t):t&&(this.angle=t),"changing"===String(e).toLowerCase()||"chang"===String(e).toLowerCase()||"auto"===String(e).toLowerCase()?this.force=tt:e&&(this.force=e)},i.reset=function(e,n,i,r){this.angle=x.PI/2,this.setAngleAndForce(e,n),i&&t.prototype.reset.call(this,i,r)},i.initialize=function(t){"random"===this.angle?t.data.cangle=x.randomAToB(-x.PI,x.PI):"span"===this.angle&&(t.data.cangle=this.span.getValue()),t.data.cyclone=new M(0,0)},i.applyBehaviour=function(t,e,n){var i;this.calculate(t,e,n);var r=t.v.getGradient();"random"===this.angle||"span"===this.angle?r+=t.data.cangle:r+=this.angle,i=this.force===tt?t.v.length()/100:this.force,t.data.cyclone.x=i*Math.cos(r),t.data.cyclone.y=i*Math.sin(r),t.data.cyclone=this.normalizeForce(t.data.cyclone),t.a.add(t.data.cyclone)},n}(j),nt=function(t){function n(e,n,i,r,o){var s;return(s=t.call(this,e,n,i,r,o)||this).force*=-1,s.name="Repulsion",s}return e(n,t),n.prototype.reset=function(e,n,i,r,o){t.prototype.reset.call(this,e,n,i,r,o),this.force*=-1},n}(H),it=function(t){function n(e,n,i,r){var o;return(o=t.call(this,i,r)||this).distanceVec=new M,o.centerPoint=d.initValue(e,new M),o.force=d.initValue(o.normalizeValue(n),100),o.name="GravityWell",o}e(n,t);var i=n.prototype;return i.reset=function(e,n,i,r){this.distanceVec=new M,this.centerPoint=d.initValue(e,new M),this.force=d.initValue(this.normalizeValue(n),100),i&&t.prototype.reset.call(this,i,r)},i.initialize=function(t){},i.applyBehaviour=function(t,e,n){this.distanceVec.set(this.centerPoint.x-t.p.x,this.centerPoint.y-t.p.y);var i=this.distanceVec.lengthSq();if(0!==i){var r=this.distanceVec.length(),o=this.force*e/(i*r);t.v.x+=o*this.distanceVec.x,t.v.y+=o*this.distanceVec.y}},n}(j),rt={initialize:function(t,e,n){var i,r=n.length;for(i=0;i<r;i++)n[i]instanceof L?n[i].init(t,e):this.init(t,e,n[i]);this.bindEmitter(t,e)},init:function(t,e,n){S.setProp(e,n),S.setVectorVal(e,n)},bindEmitter:function(t,e){t.bindEmitter&&(e.p.add(t.p),e.v.add(t.v),e.a.add(t.a),e.v.rotate(x.degreeTransform(t.rotation)))}},ot=function(t){function n(e){var n;return void 0===e&&(e={}),(n=t.call(this,e)||this).particles=[],n.behaviours=[],n.initializes=[],n.emitTime=0,n.emitSpeed=0,n.totalTime=-1,n.damping=.006,n.bindEmitter=!0,n.rate=new q(1,.1),n.name="Emitter",n.id=f.id(n.name),n}e(n,t);var i=n.prototype;return i.emit=function(t,e){this.stoped=!1,this.emitTime=0,this.totalTime=d.initValue(t,1/0),!0===e||"life"===e||"destroy"===e?this.life="once"===t?1:this.totalTime:isNaN(e)||(this.life=e),this.rate.init()},i.stop=function(){this.totalTime=-1,this.emitTime=0,this.stoped=!0},i.preEmit=function(t){var e=this.stoped,n=this.emitTime,i=this.totalTime;this.stoped=!1,this.emitTime=0,this.totalTime=t,this.rate.init();for(var r=.0167;t>r;)t-=r,this.update(r);this.stoped=e,this.emitTime=n+Math.max(t,0),this.totalTime=i},i.removeAllParticles=function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0},i.addSelfInitialize=function(t){t.init&&t.init(this)},i.addInitialize=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=e.length;i--;)this.initializes.push(e[i])},i.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},i.removeAllInitializers=function(){d.emptyArray(this.initializes)},i.addBehaviour=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=arguments.length;i--;){var r=e[i];this.behaviours.push(r),r.parents&&r.parents.push(this)}},i.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);return this.behaviours.splice(e,1),t.parents&&(e=t.parents.indexOf(t),t.parents.splice(e,1)),e},i.removeAllBehaviours=function(){d.emptyArray(this.behaviours)},i.update=function(t){this.age+=t,(this.age>=this.life||this.dead)&&this.destroy(),this.emitting(t),this.integrate(t)},i.integrate=function(t){if(this.parent){var e,n,i=1-this.damping;for(this.parent.integrator.calculate(this,t,i),e=this.particles.length-1;e>=0;e--)(n=this.particles[e]).update(t,e),this.parent.integrator.calculate(n,t,i),this.dispatch("PARTICLE_UPDATE",n),n.dead&&(this.dispatch("PARTICLE_DEAD",n),this.parent.pool.expire(n),this.particles.splice(e,1))}},i.dispatch=function(t,e){this.parent&&this.parent.dispatchEvent(t,e),this.bindEvent&&this.dispatchEvent(t,e)},i.emitting=function(t){if("once"===this.totalTime){var e,n=this.rate.getValue(99999);for(n>0&&(this.emitSpeed=n),e=0;e<n;e++)this.createParticle();this.totalTime="none"}else if(this.emitTime+=t,this.emitTime<this.totalTime){var i,r=this.rate.getValue(t);for(r>0&&(this.emitSpeed=r),i=0;i<r;i++)this.createParticle()}},i.createParticle=function(t,e){var n=this.parent.pool.get(T);return this.setupParticle(n,t,e),this.dispatch("PARTICLE_CREATED",n),n},i.setupParticle=function(t,e,n){var i=this.initializes,r=this.behaviours;e&&(i=d.toArray(e)),n&&(r=d.toArray(n)),t.reset(),rt.initialize(this,t,i),t.addBehaviours(r),t.parent=this,this.particles.push(t)},i.remove=function(){this.stop(),d.destroyAll(this.particles)},i.destroy=function(){this.dead=!0,this.remove(),this.removeAllInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this),this.rate=null,this.old=null,this.rgb=null,this.v=null,this.a=null,this.p=null},n}(T);y.bind(ot);var st,at=function(t){function n(e){var n;return(n=t.call(this,e)||this).selfBehaviours=[],n}e(n,t);var i=n.prototype;return i.addSelfBehaviour=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i,r=e.length;for(i=0;i<r;i++){var o=e[i];this.selfBehaviours.push(o),o.initialize(this)}},i.removeSelfBehaviour=function(t){var e=this.selfBehaviours.indexOf(t);e>-1&&this.selfBehaviours.splice(e,1)},i.update=function(e){if(t.prototype.update.call(this,e),!this.sleep){var n,i=this.selfBehaviours.length;for(n=0;n<i;n++)this.selfBehaviours[n].applyBehaviour(this,e,n)}},n}(ot),lt=function(t){function n(e,n,i){var r;return(r=t.call(this,i)||this).mouseTarget=d.initValue(e,window),r.ease=d.initValue(n,.7),r._allowEmitting=!1,r.initEventHandler(),r}e(n,t);var i=n.prototype;return i.initEventHandler=function(){var t=this;this.mousemoveHandler=function(e){return t.mousemove.call(t,e)},this.mousedownHandler=function(e){return t.mousedown.call(t,e)},this.mouseupHandler=function(e){return t.mouseup.call(t,e)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},i.emit=function(){this._allowEmitting=!0},i.stop=function(){this._allowEmitting=!1},i.mousemove=function(e){e.layerX||0===e.layerX?(this.p.x+=(e.layerX-this.p.x)*this.ease,this.p.y+=(e.layerY-this.p.y)*this.ease):(e.offsetX||0===e.offsetX)&&(this.p.x+=(e.offsetX-this.p.x)*this.ease,this.p.y+=(e.offsetY-this.p.y)*this.ease),this._allowEmitting&&t.prototype.emit.call(this,"once")},i.destroy=function(){t.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},n}(ot),ut=function(t){if(!t)return!1;if(t.__isImage)return!0;var e=(""+t.tagName).toUpperCase();return("IMG"===(""+t.nodeName).toUpperCase()||"IMG"===e)&&(t.__isImage=!0,!0)},ct=function(t){return"string"==typeof t},ht=function(){function t(t,e){this.pool=new m,this.element=t,this.stroke=e,this.circleConf={isCircle:!0},this.initEventHandler(),this.name="BaseRenderer"}var e=t.prototype;return e.setStroke=function(t,e){void 0===t&&(t="#000000"),void 0===e&&(e=1),this.stroke={color:t,thinkness:e}},e.initEventHandler=function(){var t=this;this._protonUpdateHandler=function(){t.onProtonUpdate.call(t)},this._protonUpdateAfterHandler=function(){t.onProtonUpdateAfter.call(t)},this._emitterAddedHandler=function(e){t.onEmitterAdded.call(t,e)},this._emitterRemovedHandler=function(e){t.onEmitterRemoved.call(t,e)},this._particleCreatedHandler=function(e){t.onParticleCreated.call(t,e)},this._particleUpdateHandler=function(e){t.onParticleUpdate.call(t,e)},this._particleDeadHandler=function(e){t.onParticleDead.call(t,e)}},e.init=function(t){this.parent=t,t.addEventListener("PROTON_UPDATE",this._protonUpdateHandler),t.addEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),t.addEventListener("EMITTER_ADDED",this._emitterAddedHandler),t.addEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),t.addEventListener("PARTICLE_CREATED",this._particleCreatedHandler),t.addEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),t.addEventListener("PARTICLE_DEAD",this._particleDeadHandler)},e.resize=function(t,e){},e.destroy=function(){this.remove(),this.pool.destroy(),this.pool=null,this.element=null,this.stroke=null},e.remove=function(t){this.parent.removeEventListener("PROTON_UPDATE",this._protonUpdateHandler),this.parent.removeEventListener("PROTON_UPDATE_AFTER",this._protonUpdateAfterHandler),this.parent.removeEventListener("EMITTER_ADDED",this._emitterAddedHandler),this.parent.removeEventListener("EMITTER_REMOVED",this._emitterRemovedHandler),this.parent.removeEventListener("PARTICLE_CREATED",this._particleCreatedHandler),this.parent.removeEventListener("PARTICLE_UPDATE",this._particleUpdateHandler),this.parent.removeEventListener("PARTICLE_DEAD",this._particleDeadHandler),this.parent=null},e.onProtonUpdate=function(){},e.onProtonUpdateAfter=function(){},e.onEmitterAdded=function(t){},e.onEmitterRemoved=function(t){},e.onParticleCreated=function(t){},e.onParticleUpdate=function(t){},e.onParticleDead=function(t){},t}(),dt=function(t){function n(e){var n;return(n=t.call(this,e)||this).stroke=null,n.context=n.element.getContext("2d"),n.bufferCache={},n.name="CanvasRenderer",n}e(n,t);var i=n.prototype;return i.resize=function(t,e){this.element.width=t,this.element.height=e},i.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},i.onParticleCreated=function(t){t.body?h(t.body,this.addImg2Body,t):t.color=t.color||"#ff0000"},i.onParticleUpdate=function(t){t.body?ut(t.body)&&this.drawImage(t):this.drawCircle(t)},i.onParticleDead=function(t){t.body=null},i.addImg2Body=function(t,e){e.body=t},i.drawImage=function(t){var e=t.body.width*t.scale|0,n=t.body.height*t.scale|0,i=t.p.x-e/2,r=t.p.y-n/2;if(t.color){t.data.buffer||(t.data.buffer=this.createBuffer(t.body));var o=t.data.buffer.getContext("2d");o.clearRect(0,0,t.data.buffer.width,t.data.buffer.height),o.globalAlpha=t.alpha,o.drawImage(t.body,0,0),o.globalCompositeOperation="source-atop",o.fillStyle=E.rgbToHex(t.rgb),o.fillRect(0,0,t.data.buffer.width,t.data.buffer.height),o.globalCompositeOperation="source-over",o.globalAlpha=1,this.context.drawImage(t.data.buffer,0,0,t.data.buffer.width,t.data.buffer.height,i,r,e,n)}else this.context.save(),this.context.globalAlpha=t.alpha,this.context.translate(t.p.x,t.p.y),this.context.rotate(x.degreeTransform(t.rotation)),this.context.translate(-t.p.x,-t.p.y),this.context.drawImage(t.body,0,0,t.body.width,t.body.height,i,r,e,n),this.context.globalAlpha=1,this.context.restore()},i.drawCircle=function(t){t.rgb?this.context.fillStyle="rgba("+t.rgb.r+","+t.rgb.g+","+t.rgb.b+","+t.alpha+")":this.context.fillStyle=t.color,this.context.beginPath(),this.context.arc(t.p.x,t.p.y,t.radius,0,2*Math.PI,!0),this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke()),this.context.closePath(),this.context.fill()},i.createBuffer=function(t){if(ut(t)){var e=t.width+"_"+t.height,n=this.bufferCache[e];return n||((n=document.createElement("canvas")).width=t.width,n.height=t.height,this.bufferCache[e]=n),n}},i.destroy=function(){t.prototype.destroy.call(this),this.stroke=null,this.context=null,this.bufferCache=null},n}(ht),pt=function(t){function n(e){var n;return(n=t.call(this,e)||this).stroke=null,n.transform3d=!1,n.pool.create=function(t,e){return n.createBody(t,e)},n.addImg2Body=n.addImg2Body.bind(i(n)),n.name="DomRenderer",n}e(n,t);var r=n.prototype;return r.onParticleCreated=function(t){t.body?h(t.body,this.addImg2Body,t):(t.body=this.pool.get(this.circleConf,t),this.element.appendChild(t.body))},r.onParticleUpdate=function(t){this.bodyReady(t)&&(this.transform3d?a.transform3d(t.body,t.p.x,t.p.y,t.scale,t.rotation):a.transform(t.body,t.p.x,t.p.y,t.scale,t.rotation),t.body.style.opacity=t.alpha,t.body.isCircle&&(t.body.style.backgroundColor=t.color||"#ff0000"))},r.onParticleDead=function(t){this.bodyReady(t)&&(this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null)},r.bodyReady=function(t){return"object"==typeof t.body&&t.body&&!t.body.isInner},r.addImg2Body=function(t,e){e.dead||(e.body=this.pool.get(t,e),a.resize(e.body,t.width,t.height),this.element.appendChild(e.body))},r.createBody=function(t,e){return t.isCircle?this.createCircle(e):this.createSprite(t,e)},r.createCircle=function(t){var e=a.createDiv(t.id+"_dom",2*t.radius,2*t.radius);return e.style.borderRadius=t.radius+"px",this.stroke&&(e.style.borderColor=this.stroke.color,e.style.borderWidth=this.stroke.thinkness+"px"),e.isCircle=!0,e},r.createSprite=function(t,e){var n="string"==typeof t?t:t.src,i=a.createDiv(e.id+"_dom",t.width,t.height);return i.style.backgroundImage="url("+n+")",i},r.destroy=function(){t.prototype.destroy.call(this),this.stroke=null},n}(ht),ft=function(t){function n(e,n){var i;return(i=t.call(this,e)||this).stroke=n,i.name="EaselRenderer",i}e(n,t);var i=n.prototype;return i.onParticleCreated=function(t){t.body?this.createSprite(t):this.createCircle(t),this.element.addChild(t.body)},i.onParticleUpdate=function(t){t.body&&(t.body.x=t.p.x,t.body.y=t.p.y,t.body.alpha=t.alpha,t.body.scaleX=t.body.scaleY=t.scale,t.body.rotation=t.rotation)},i.onParticleDead=function(t){t.body&&(t.body.parent&&t.body.parent.removeChild(t.body),this.pool.expire(t.body),t.body=null),t.graphics&&this.pool.expire(t.graphics)},i.createSprite=function(t){t.body=this.pool.get(t.body),t.body.parent||t.body.image&&(t.body.regX=t.body.image.width/2,t.body.regY=t.body.image.height/2)},i.createCircle=function(t){var e=this.pool.get(createjs.Graphics);this.stroke&&(ct(this.stroke)?e.beginStroke(this.stroke):e.beginStroke("#000000")),e.beginFill(t.color||"#ff0000").drawCircle(0,0,t.radius);var n=this.pool.get(createjs.Shape,[e]);t.body=n,t.graphics=e},i.destroy=function(){t.prototype.destroy.call(this),this.stroke=null},n}(ht),mt=function(t){function n(e,n){var i;return(i=t.call(this,e)||this).context=i.element.getContext("2d"),i.imageData=null,i.rectangle=n,i.createImageData(n),i.name="PixelRenderer",i}e(n,t);var i=n.prototype;return i.resize=function(t,e){this.element.width=t,this.element.height=e},i.createImageData=function(t){this.rectangle=t||new O(0,0,this.element.width,this.element.height),this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height),this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},i.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)},i.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)},i.onParticleCreated=function(t){},i.onParticleUpdate=function(t){this.imageData&&this.setPixel(this.imageData,t.p.x-this.rectangle.x>>0,t.p.y-this.rectangle.y>>0,t)},i.setPixel=function(t,e,n,i){var r=i.rgb;if(!(e<0||e>this.element.width||n<0||n>this.element.height)){var o=4*((n>>0)*t.width+(e>>0));t.data[o]=r.r,t.data[o+1]=r.g,t.data[o+2]=r.b,t.data[o+3]=255*i.alpha}},i.onParticleDead=function(t){},i.destroy=function(){t.prototype.destroy.call(this),this.stroke=null,this.context=null,this.imageData=null,this.rectangle=null},n}(ht),gt=function(t){function n(e,n){var i;return(i=t.call(this,e)||this).stroke=n,i.color=!1,i.setColor=!1,i.blendMode=null,i.pool.create=function(t,e){return i.createBody(t,e)},i.setPIXI(window.PIXI),i.name="PixiRenderer",i}e(n,t);var i=n.prototype;return i.setPIXI=function(t){try{st=t||{Sprite:{}},this.createFromImage=st.Sprite.from||st.Sprite.fromImage}catch(t){}},i.onProtonUpdate=function(){},i.onParticleCreated=function(t){t.body?t.body=this.pool.get(t.body,t):t.body=this.pool.get(this.circleConf,t),this.blendMode&&(t.body.blendMode=this.blendMode),this.element.addChild(t.body)},i.onParticleUpdate=function(t){this.transform(t,t.body),!0!==this.setColor&&!0!==this.color||(t.body.tint=E.getHex16FromParticle(t))},i.onParticleDead=function(t){this.element.removeChild(t.body),this.pool.expire(t.body),t.body=null},i.transform=function(t,e){e.x=t.p.x,e.y=t.p.y,e.alpha=t.alpha,e.scale.x=t.scale,e.scale.y=t.scale,e.rotation=t.rotation*x.PI_180},i.createBody=function(t,e){return t.isCircle?this.createCircle(e):this.createSprite(t)},i.createSprite=function(t){var e=t.isInner?this.createFromImage(t.src):new st.Sprite(t);return e.anchor.x=.5,e.anchor.y=.5,e},i.createCircle=function(t){var e=new st.Graphics;if(this.stroke){var n=ct(this.stroke)?this.stroke:0;e.beginStroke(n)}return e.beginFill(t.color||36077),e.drawCircle(0,0,t.radius),e.endFill(),e},i.destroy=function(e){t.prototype.destroy.call(this);for(var n=e.length;n--;){var i=e[n];i.body&&this.element.removeChild(i.body)}},n}(ht),yt=function(){function t(){this.mats=[],this.size=0;for(var t=0;t<20;t++)this.mats.push(C.create([0,0,0,0,0,0,0,0,0]))}var e=t.prototype;return e.set=function(t,e){0===e?C.set(t,this.mats[0]):C.multiply(this.mats[e-1],t,this.mats[e]),this.size=Math.max(this.size,e+1)},e.push=function(t){0===this.size?C.set(t,this.mats[0]):C.multiply(this.mats[this.size-1],t,this.mats[this.size]),this.size++},e.pop=function(){this.size>0&&this.size--},e.top=function(){return this.mats[this.size-1]},t}(),vt=function(t){function n(e){var n;return(n=t.call(this,e)||this).gl=n.element.getContext("experimental-webgl",{antialias:!0,stencil:!1,depth:!1}),n.gl||alert("Sorry your browser do not suppest WebGL!"),n.initVar(),n.setMaxRadius(),n.initShaders(),n.initBuffers(),n.gl.blendEquation(n.gl.FUNC_ADD),n.gl.blendFunc(n.gl.SRC_ALPHA,n.gl.ONE_MINUS_SRC_ALPHA),n.gl.enable(n.gl.BLEND),n.addImg2Body=n.addImg2Body.bind(i(n)),n.name="WebGLRenderer",n}e(n,t);var l=n.prototype;return l.init=function(e){t.prototype.init.call(this,e),this.resize(this.element.width,this.element.height)},l.resize=function(t,e){this.umat[4]=-2,this.umat[7]=1,this.smat[0]=1/t,this.smat[4]=1/e,this.mstack.set(this.umat,0),this.mstack.set(this.smat,1),this.gl.viewport(0,0,t,e),this.element.width=t,this.element.height=e},l.setMaxRadius=function(t){this.circleCanvasURL=this.createCircle(t)},l.getVertexShader=function(){return["uniform vec2 viewport;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 tMat;","varying vec2 vTextureCoord;","varying float alpha;","void main() {","vec3 v = tMat * vec3(aVertexPosition, 1.0);","gl_Position = vec4(v.x, v.y, 0, 1);","vTextureCoord = aTextureCoord;","alpha = tMat[0][2];","}"].join("\n")},l.getFragmentShader=function(){return["precision mediump float;","varying vec2 vTextureCoord;","varying float alpha;","uniform sampler2D uSampler;","uniform vec4 color;","uniform bool useTexture;","uniform vec3 uColor;","void main() {","vec4 textureColor = texture2D(uSampler, vTextureCoord);","gl_FragColor = textureColor * vec4(uColor, 1.0);","gl_FragColor.w *= alpha;","}"].join("\n")},l.initVar=function(){this.mstack=new yt,this.umat=C.create([2,0,1,0,-2,0,-1,1,1]),this.smat=C.create([.01,0,1,0,.01,0,0,0,1]),this.texturebuffers={}},l.blendEquation=function(t){this.gl.blendEquation(this.gl[t])},l.blendFunc=function(t,e){this.gl.blendFunc(this.gl[t],this.gl[e])},l.getShader=function(t,e,n){var i=n?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert(t.getShaderInfoLog(i)),null)},l.initShaders=function(){var t=this.getShader(this.gl,this.getFragmentShader(),!0),e=this.getShader(this.gl,this.getVertexShader(),!1);this.sprogram=this.gl.createProgram(),this.gl.attachShader(this.sprogram,e),this.gl.attachShader(this.sprogram,t),this.gl.linkProgram(this.sprogram),this.gl.getProgramParameter(this.sprogram,this.gl.LINK_STATUS)||alert("Could not initialise shaders"),this.gl.useProgram(this.sprogram),this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition"),this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord"),this.gl.enableVertexAttribArray(this.sprogram.tca),this.gl.enableVertexAttribArray(this.sprogram.vpa),this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat"),this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler"),this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture"),this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor"),this.gl.uniform1i(this.sprogram.useTex,1)},l.initBuffers=function(){var t,e;this.unitIBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,3,1,0,2,3]),this.gl.STATIC_DRAW);var n=[];for(e=0;e<100;e++)n.push(e);for(t=new Uint16Array(n),this.unitI33=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW),n=[],e=0;e<100;e++)n.push(e,e+1,e+2);t=new Uint16Array(n),this.stripBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW)},l.createCircle=function(t){this.circleCanvasRadius=r(d.initValue(t,32));var e=a.createCanvas("circle_canvas",2*this.circleCanvasRadius,2*this.circleCanvasRadius),n=e.getContext("2d");return n.beginPath(),n.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,2*Math.PI,!0),n.closePath(),n.fillStyle="#FFF",n.fill(),e.toDataURL()},l.drawImg2Canvas=function(t){var e=t.body.width,n=t.body.height,i=r(t.body.width),o=r(t.body.height),s=t.body.width/i,a=t.body.height/o;this.texturebuffers[t.data.src]||(this.texturebuffers[t.data.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]),t.data.texture=this.texturebuffers[t.data.src][0],t.data.vcBuffer=this.texturebuffers[t.data.src][1],t.data.tcBuffer=this.texturebuffers[t.data.src][2],this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,s,0,0,a,a,a]),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,e,0,0,n,e,n]),this.gl.STATIC_DRAW);var l=t.data.canvas.getContext("2d").getImageData(0,0,i,o);this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,l),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST),this.gl.generateMipmap(this.gl.TEXTURE_2D),t.data.textureLoaded=!0,t.data.textureWidth=e,t.data.textureHeight=n},l.onProtonUpdate=function(){},l.onParticleCreated=function(t){t.data.textureLoaded=!1,t.data.tmat=C.create(),t.data.tmat[8]=1,t.data.imat=C.create(),t.data.imat[8]=1,t.body?h(t.body,this.addImg2Body,t):(h(this.circleCanvasURL,this.addImg2Body,t),t.data.oldScale=t.radius/this.circleCanvasRadius)},l.addImg2Body=function(t,e){e.dead||(e.body=t,e.data.src=t.src,e.data.canvas=function(t,e,n){var i=t.src;if(!u[i]){var o=r(t.width),s=r(t.height),l=a.createCanvas("proton_canvas_cache_"+ ++c,o,s);l.getContext("2d").drawImage(t,0,0,t.width,t.height),u[i]=l}return e&&e(u[i],n),u[i]}(t),e.data.oldScale=1,this.drawImg2Canvas(e))},l.onParticleUpdate=function(t){t.data.textureLoaded&&(this.updateMatrix(t),this.gl.uniform3f(this.sprogram.color,t.rgb.r/255,t.rgb.g/255,t.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,!1,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.data.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,t.data.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())},l.onParticleDead=function(t){},l.updateMatrix=function(t){var e=o(-t.data.textureWidth/2,-t.data.textureHeight/2),n=o(t.p.x,t.p.y),i=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,-n,0,n,e,0,0,0,1]}(t.rotation*x.PI_180),r=t.scale*t.data.oldScale,a=function(t,e){return[t,0,0,0,e,0,0,0,1]}(r,r),l=s(e,a);l=s(l,i),l=s(l,n),C.inverse(l,t.data.imat),l[2]=t.alpha,this.mstack.push(l)},l.destroy=function(){t.prototype.destroy.call(this),this.gl=null,this.mstack=null,this.umat=null,this.smat=null,this.texturebuffers=null},n}(ht),xt=function(t){function n(e){var n;return(n=t.call(this,e)||this).name="CustomRenderer",n}return e(n,t),n}(ht),bt=function(t){function n(e,n,i,r,o){var s;return s=t.call(this)||this,i-e>=0?(s.x1=e,s.y1=n,s.x2=i,s.y2=r):(s.x1=i,s.y1=r,s.x2=e,s.y2=n),s.dx=s.x2-s.x1,s.dy=s.y2-s.y1,s.minx=Math.min(s.x1,s.x2),s.miny=Math.min(s.y1,s.y2),s.maxx=Math.max(s.x1,s.x2),s.maxy=Math.max(s.y1,s.y2),s.dot=s.x2*s.y1-s.x1*s.y2,s.xxyy=s.dx*s.dx+s.dy*s.dy,s.gradient=s.getGradient(),s.length=s.getLength(),s.direction=d.initValue(o,">"),s}e(n,t);var i=n.prototype;return i.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient),this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient),this.vector},i.getDirection=function(t,e){var n=this.dy,i=-this.dx;return(n*t+i*e+this.dot)*(0===i?1:i)>0},i.getDistance=function(t,e){return(this.dy*t+-this.dx*e+this.dot)/Math.sqrt(this.xxyy)},i.getSymmetric=function(t){var e=t.getGradient(),n=2*(this.getGradient()-e),i=t.x,r=t.y;return t.x=i*Math.cos(n)-r*Math.sin(n),t.y=i*Math.sin(n)+r*Math.cos(n),t},i.getGradient=function(){return Math.atan2(this.dy,this.dx)},i.rangeOut=function(t){if(Math.abs(this.getGradient())<=x.PI/4){if(t.p.x<=this.maxx&&t.p.x>=this.minx)return!0}else if(t.p.y<=this.maxy&&t.p.y>=this.miny)return!0;return!1},i.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},i.crossing=function(t){if("dead"===this.crossType)if(">"===this.direction||"R"===this.direction||"right"===this.direction||"down"===this.direction){if(!this.rangeOut(t))return;this.getDirection(t.p.x,t.p.y)&&(t.dead=!0)}else{if(!this.rangeOut(t))return;this.getDirection(t.p.x,t.p.y)||(t.dead=!0)}else if("bound"===this.crossType){if(!this.rangeOut(t))return;this.getDistance(t.p.x,t.p.y)<=t.radius&&(0===this.dx?t.v.x*=-1:0===this.dy?t.v.y*=-1:this.getSymmetric(t.v))}else"cross"===this.crossType&&this.alert&&(console.error("Sorry, LineZone does not support cross method!"),this.alert=!1)},n}(z),_t=function(t){function n(e,n,i){var r;return(r=t.call(this)||this).x=e,r.y=n,r.radius=i,r.angle=0,r.center={x:e,y:n},r}e(n,t);var i=n.prototype;return i.getPosition=function(){return this.angle=x.PIx2*Math.random(),this.randomRadius=Math.random()*this.radius,this.vector.x=this.x+this.randomRadius*Math.cos(this.angle),this.vector.y=this.y+this.randomRadius*Math.sin(this.angle),this.vector},i.setCenter=function(t,e){this.center.x=t,this.center.y=e},i.crossing=function(t){var e=t.p.distanceTo(this.center);"dead"===this.crossType?e-t.radius>this.radius&&(t.dead=!0):"bound"===this.crossType?e+t.radius>=this.radius&&this.getSymmetric(t):"cross"===this.crossType&&this.alert&&(console.error("Sorry, CircleZone does not support cross method!"),this.alert=!1)},i.getSymmetric=function(t){var e=t.v.getGradient(),n=2*(this.getGradient(t)-e),i=t.v.x,r=t.v.y;t.v.x=i*Math.cos(n)-r*Math.sin(n),t.v.y=i*Math.sin(n)+r*Math.cos(n)},i.getGradient=function(t){return-x.PI_2+Math.atan2(t.p.y-this.center.y,t.p.x-this.center.x)},n}(z),wt=function(t){function n(e,n,i,r){var o;return(o=t.call(this)||this).x=e,o.y=n,o.width=i,o.height=r,o}e(n,t);var i=n.prototype;return i.getPosition=function(){return this.vector.x=this.x+Math.random()*this.width,this.vector.y=this.y+Math.random()*this.height,this.vector},i.crossing=function(t){"dead"===this.crossType?((t.p.x+t.radius<this.x||t.p.x-t.radius>this.x+this.width)&&(t.dead=!0),(t.p.y+t.radius<this.y||t.p.y-t.radius>this.y+this.height)&&(t.dead=!0)):"bound"===this.crossType?(t.p.x-t.radius<this.x?(t.p.x=this.x+t.radius,t.v.x*=-1):t.p.x+t.radius>this.x+this.width&&(t.p.x=this.x+this.width-t.radius,t.v.x*=-1),t.p.y-t.radius<this.y?(t.p.y=this.y+t.radius,t.v.y*=-1):t.p.y+t.radius>this.y+this.height&&(t.p.y=this.y+this.height-t.radius,t.v.y*=-1)):"cross"===this.crossType&&(t.p.x+t.radius<this.x&&t.v.x<=0?t.p.x=this.x+this.width+t.radius:t.p.x-t.radius>this.x+this.width&&t.v.x>=0&&(t.p.x=this.x-t.radius),t.p.y+t.radius<this.y&&t.v.y<=0?t.p.y=this.y+this.height+t.radius:t.p.y-t.radius>this.y+this.height&&t.v.y>=0&&(t.p.y=this.y-t.radius))},n}(z),St=function(t){function n(e,n,i,r){var o;return(o=t.call(this)||this).reset(e,n,i,r),o}e(n,t);var i=n.prototype;return i.reset=function(t,e,n,i){this.imageData=t,this.x=d.initValue(e,0),this.y=d.initValue(n,0),this.d=d.initValue(i,2),this.vectors=[],this.setVectors()},i.setVectors=function(){var t,e,n=this.imageData.width,i=this.imageData.height;for(t=0;t<n;t+=this.d)for(e=0;e<i;e+=this.d){var r=4*((e>>0)*n+(t>>0));this.imageData.data[r+3]>0&&this.vectors.push({x:t+this.x,y:e+this.y})}return this.vector},i.getBound=function(t,e){var n=4*((e>>0)*this.imageData.width+(t>>0));return this.imageData.data[n+3]>0},i.getPosition=function(){var t=d.getRandFromArray(this.vectors);return this.vector.copy(t)},i.getColor=function(t,e){t-=this.x;var n=4*(((e-=this.y)>>0)*this.imageData.width+(t>>0));return{r:this.imageData.data[n],g:this.imageData.data[n+1],b:this.imageData.data[n+2],a:this.imageData.data[n+3]}},i.crossing=function(t){"dead"===this.crossType?this.getBound(t.p.x-this.x,t.p.y-this.y)?t.dead=!0:t.dead=!1:"bound"===this.crossType&&(this.getBound(t.p.x-this.x,t.p.y-this.y)||t.v.negate())},i.destroy=function(){t.prototype.destroy.call(this),this.imageData=null},n}(z),At={addEventListener:function(t,e){t.addEventListener("PROTON_UPDATE_AFTER",(function(){return e()}))},getStyle:function(t){void 0===t&&(t="#ff0000");var e=E.hexToRgb(t);return"rgba("+e.r+", "+e.g+", "+e.b+", 0.5)"},drawZone:function(t,e,n,i){var r=e.getContext("2d"),o=this.getStyle();this.addEventListener(t,(function(){i&&r.clearRect(0,0,e.width,e.height),n instanceof k?(r.beginPath(),r.fillStyle=o,r.arc(n.x,n.y,10,0,2*Math.PI,!0),r.fill(),r.closePath()):n instanceof bt?(r.beginPath(),r.strokeStyle=o,r.moveTo(n.x1,n.y1),r.lineTo(n.x2,n.y2),r.stroke(),r.closePath()):n instanceof wt?(r.beginPath(),r.strokeStyle=o,r.drawRect(n.x,n.y,n.width,n.height),r.stroke(),r.closePath()):n instanceof _t&&(r.beginPath(),r.strokeStyle=o,r.arc(n.x,n.y,n.radius,0,2*Math.PI,!0),r.stroke(),r.closePath())}))},drawEmitter:function(t,e,n,i){var r=e.getContext("2d"),o=this.getStyle();this.addEventListener(t,(function(){i&&r.clearRect(0,0,e.width,e.height),r.beginPath(),r.fillStyle=o,r.arc(n.p.x,n.p.y,10,0,2*Math.PI,!0),r.fill(),r.closePath()}))}};return _.Particle=T,_.Pool=m,_.Util=d,_.ColorUtil=E,_.MathUtil=x,_.Vector2D=_.Vector=M,_.Polar2D=_.Polar=P,_.ArraySpan=R,_.Rectangle=O,_.Rate=q,_.ease=A,_.Span=I,_.Mat3=C,_.getSpan=function(t,e,n){return new I(t,e,n)},_.createArraySpan=R.createArraySpan,_.Initialize=_.Init=L,_.Life=_.L=D,_.Position=_.P=B,_.Velocity=_.V=F,_.Mass=_.M=V,_.Radius=_.R=N,_.Body=_.B=U,_.Behaviour=j,_.Force=_.F=G,_.Attraction=_.A=H,_.RandomDrift=_.RD=W,_.Gravity=_.G=X,_.Collision=Y,_.CrossZone=Z,_.Alpha=Q,_.Scale=_.S=J,_.Rotate=K,_.Color=$,_.Repulsion=nt,_.Cyclone=et,_.GravityWell=it,_.Emitter=ot,_.BehaviourEmitter=at,_.FollowEmitter=lt,_.Zone=z,_.LineZone=bt,_.CircleZone=_t,_.PointZone=k,_.RectZone=wt,_.ImageZone=St,_.CanvasRenderer=dt,_.DomRenderer=pt,_.EaselRenderer=ft,_.PixiRenderer=gt,_.PixelRenderer=mt,_.WebGLRenderer=_.WebGlRenderer=vt,_.CustomRenderer=xt,_.Debug=At,d.assign(_,A),_}()},7563:(t,e,n)=>{"use strict";function i(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function r(t,e){return e.encode?e.strict?h(t):encodeURIComponent(t):t}function o(t,e){return e.decode?d(t):t}function s(t){return Array.isArray(t)?t.sort():"object"==typeof t?s(Object.keys(t)).sort(((t,e)=>Number(t)-Number(e))).map((e=>t[e])):t}function a(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function l(t){const e=(t=a(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function u(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function c(t,e){i((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const n=function(t){let e;switch(t.arrayFormat){case"index":return(t,n,i)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===i[t]&&(i[t]={}),i[t][e[1]]=n):i[t]=n};case"bracket":return(t,n,i)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==i[t]?i[t]=[].concat(i[t],n):i[t]=[n]:i[t]=n};case"colon-list-separator":return(t,n,i)=>{e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),e?void 0!==i[t]?i[t]=[].concat(i[t],n):i[t]=[n]:i[t]=n};case"comma":case"separator":return(e,n,i)=>{const r="string"==typeof n&&n.includes(t.arrayFormatSeparator),s="string"==typeof n&&!r&&o(n,t).includes(t.arrayFormatSeparator);n=s?o(n,t):n;const a=r||s?n.split(t.arrayFormatSeparator).map((e=>o(e,t))):null===n?n:o(n,t);i[e]=a};case"bracket-separator":return(e,n,i)=>{const r=/(\[\])$/.test(e);if(e=e.replace(/\[\]$/,""),!r)return void(i[e]=n?o(n,t):n);const s=null===n?[]:n.split(t.arrayFormatSeparator).map((e=>o(e,t)));void 0!==i[e]?i[e]=[].concat(i[e],s):i[e]=s};default:return(t,e,n)=>{void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e),r=Object.create(null);if("string"!=typeof t)return r;if(!(t=t.trim().replace(/^[?#&]/,"")))return r;for(const i of t.split("&")){if(""===i)continue;let[t,s]=p(e.decode?i.replace(/\+/g," "):i,"=");s=void 0===s?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?s:o(s,e),n(o(t,e),s,r)}for(const t of Object.keys(r)){const n=r[t];if("object"==typeof n&&null!==n)for(const t of Object.keys(n))n[t]=u(n[t],e);else r[t]=u(n,e)}return!1===e.sort?r:(!0===e.sort?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce(((t,e)=>{const n=r[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?t[e]=s(n):t[e]=n,t}),Object.create(null))}const h=n(610),d=n(4020),p=n(500),f=n(2806),m=Symbol("encodeFragmentIdentifier");e.extract=l,e.parse=c,e.stringify=(t,e)=>{if(!t)return"";i((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const n=n=>e.skipNull&&null==t[n]||e.skipEmptyString&&""===t[n],o=function(t){switch(t.arrayFormat){case"index":return e=>(n,i)=>{const o=n.length;return void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[r(e,t),"[",o,"]"].join("")]:[...n,[r(e,t),"[",r(o,t),"]=",r(i,t)].join("")]};case"bracket":return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[r(e,t),"[]"].join("")]:[...n,[r(e,t),"[]=",r(i,t)].join("")];case"colon-list-separator":return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,[r(e,t),":list="].join("")]:[...n,[r(e,t),":list=",r(i,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e="bracket-separator"===t.arrayFormat?"[]=":"=";return n=>(i,o)=>void 0===o||t.skipNull&&null===o||t.skipEmptyString&&""===o?i:(o=null===o?"":o,0===i.length?[[r(n,t),e,r(o,t)].join("")]:[[i,r(o,t)].join(t.arrayFormatSeparator)])}default:return e=>(n,i)=>void 0===i||t.skipNull&&null===i||t.skipEmptyString&&""===i?n:null===i?[...n,r(e,t)]:[...n,[r(e,t),"=",r(i,t)].join("")]}}(e),s={};for(const e of Object.keys(t))n(e)||(s[e]=t[e]);const a=Object.keys(s);return!1!==e.sort&&a.sort(e.sort),a.map((n=>{const i=t[n];return void 0===i?"":null===i?r(n,e):Array.isArray(i)?0===i.length&&"bracket-separator"===e.arrayFormat?r(n,e)+"[]":i.reduce(o(n),[]).join("&"):r(n,e)+"="+r(i,e)})).filter((t=>t.length>0)).join("&")},e.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);const[n,i]=p(t,"#");return Object.assign({url:n.split("?")[0]||"",query:c(l(t),e)},e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:o(i,e)}:{})},e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0,[m]:!0},n);const i=a(t.url).split("?")[0]||"",o=e.extract(t.url),s=e.parse(o,{sort:!1}),l=Object.assign(s,t.query);let u=e.stringify(l,n);u&&(u=`?${u}`);let c=function(t){let e="";const n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url);return t.fragmentIdentifier&&(c=`#${n[m]?r(t.fragmentIdentifier,n):t.fragmentIdentifier}`),`${i}${u}${c}`},e.pick=(t,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0,[m]:!1},i);const{url:r,query:o,fragmentIdentifier:s}=e.parseUrl(t,i);return e.stringifyUrl({url:r,query:f(o,n),fragmentIdentifier:s},i)},e.exclude=(t,n,i)=>{const r=Array.isArray(n)?t=>!n.includes(t):(t,e)=>!n(t,e);return e.pick(t,r,i)}},2587:t=>{"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,i,r){n=n||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(n);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var l=t.length;a>0&&l>a&&(l=a);for(var u=0;u<l;++u){var c,h,d,p,f=t[u].replace(s,"%20"),m=f.indexOf(i);m>=0?(c=f.substr(0,m),h=f.substr(m+1)):(c=f,h=""),d=decodeURIComponent(c),p=decodeURIComponent(h),e(o,d)?Array.isArray(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o}},2361:t=>{"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,i,r){return n=n||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(r){var o=encodeURIComponent(e(r))+i;return Array.isArray(t[r])?t[r].map((function(t){return o+encodeURIComponent(e(t))})).join(n):o+encodeURIComponent(e(t[r]))})).join(n):r?encodeURIComponent(e(r))+i+encodeURIComponent(e(t)):""}},7673:(t,e,n)=>{"use strict";e.decode=e.parse=n(2587),e.encode=e.stringify=n(2361)},500:t=>{"use strict";t.exports=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]}},610:t=>{"use strict";t.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,(t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`))},6624:function(t,e,n){t.exports=function(t){function e(t,n,i,r){e._super_.call(this),this.camera=t,this.renderer=n,this.dis=i||20,r=r||"1234";for(var o=1;o<5;o++)this["d"+o]=r.indexOf(o+"")>=0;this.name="ScreenZone"}function n(t,e,i,r,o,s){var a,l,u,c,h;n._super_.call(this),j.Util.isUndefined(e,i,r,o,s)?(a=l=u=0,c=h=r=t||100):j.Util.isUndefined(r,o,s)?(a=l=u=0,c=t,h=e,r=i):(a=t,l=e,u=i,c=r,h=o,r=s),this.x=a,this.y=l,this.z=u,this.width=c,this.height=h,this.depth=r,this.friction=.85,this.max=6}function i(t,e,n){var r,o,s;i._super_.call(this),j.Util.isUndefined(t,e,n)?r=o=s=0:(r=t,o=e,s=n),this.x=r,this.y=o,this.z=s}function r(e,n){r._super_.call(this),e instanceof t.Geometry?this.geometry=e:this.geometry=e.geometry,this.scale=n||1}function o(t,e,n,i){var r,s;o._super_.call(this),j.Util.isUndefined(e,n,i)?(r=0,s=t||100):(r=t,s=i),this.x=r,this.y=r,this.z=r,this.radius=s,this.tha=this.phi=0}function s(t,e,n,i,r,o){s._super_.call(this),t instanceof j.Vector3D?(this.x1=t.x,this.y1=t.y,this.z1=t.z,this.x2=i.x,this.y2=i.y,this.z2=i.z):(this.x1=t,this.y1=e,this.z1=n,this.x2=i,this.y2=r,this.z2=o)}function a(){this.vector=new j.Vector3D(0,0,0),this.random=0,this.crossType="dead",this.log=!0}function l(){l._super_.call(this),this.targetPool=new j.Pool,this.materialPool=new j.Pool,this.name="CustomRender"}function u(e){u._super_.call(this,e),this._body=new t.Sprite(new t.SpriteMaterial({color:16777215})),this.name="SpriteRender"}function c(t){c._super_.call(this),this.points=t,this.name="PointsRender"}function h(e){h._super_.call(this),this.container=e,this._targetPool=new j.Pool,this._materialPool=new j.Pool,this._body=new t.Mesh(new t.BoxGeometry(50,50,50),new t.MeshLambertMaterial({color:"#ff0000"})),this.name="MeshRender"}function d(){this.name="BaseRender"}function p(t,e,n){this.mouseTarget=j.Util.initValue(t,window),this.ease=j.Util.initValue(e,.7),this._allowEmitting=!1,this.mouse=new j.Vector3D,this.initEventHandler(),p._super_.call(this,n)}function f(t){this.selfBehaviours=[],f._super_.call(this,t)}function m(t){this.initializes=[],this.particles=[],this.behaviours=[],this.currentEmitTime=0,this.totalEmitTimes=-1,this.damping=.006,this.bindEmitter=!0,this.rate=new j.Rate(1,.1),m._super_.call(this,t),this.id="emitter_"+m.ID++,this.cID=0,this.name="Emitter"}function g(t,e,n,i,r,o,s){g._super_.call(this,o,s),g.prototype.reset(t,e,n,i,r),this.name="Spring"}function y(t,e,n,i){y._super_.call(this,n,i),this.reset(t,e),this.name="Color"}function v(t,e,n,i,r){v._super_.call(this,i,r),this.reset(t,e,n),this.name="Rotate"}function x(t,e,n,i){x._super_.call(this,n,i),this.reset(t,e),this.name="Scale"}function b(t,e,n,i){b._super_.call(this,n,i),this.reset(t,e),this.name="Alpha"}function _(t,e,n,i){_._super_.call(this,n,i),this.reset(t,e),this.name="CrossZone"}function w(t,e,n,i,r){w._super_.call(this,i,r),this.reset(t,e,n),this.name="Collision"}function S(t,e,n){S._super_.call(this,0,-t,0,e,n),this.name="Gravity"}function A(t,e,n,i,r){A._super_.call(this,t,e,n,i,r),this.force*=-1,this.name="Repulsion"}function M(t,e,n,i,r,o){M._super_.call(this,r,o),this.reset(t,e,n,i),this.time=0,this.name="RandomDrift"}function T(t,e,n,i,r){T._super_.call(this,i,r),this.targetPosition=j.Util.initValue(t,new j.Vector3D),this.radius=j.Util.initValue(n,1e3),this.force=j.Util.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new j.Vector3D,this.lengthSq=0,this.name="Attraction"}function E(t,e,n,i,r){E._super_.call(this,i,r),E.prototype.reset.call(this,t,e,n),this.name="Force"}function P(t,e,n){P._super_.call(this),this.body=j.createArraySpan(t),this.w=e,this.h=j.Util.initValue(n,this.w)}function C(t,e,n){C._super_.call(this),this.radius=j.createSpan(t,e,n)}function I(t,e,n){I._super_.call(this),this.massPan=j.createSpan(t,e,n)}function R(t,e,n){R._super_.call(this),this.reset(t,e,n),this.dirVec=new j.Vector3D(0,0,0),this.name="Velocity"}function O(){O._super_.call(this),this.reset.apply(this,arguments)}function q(t,e,n){q._super_.call(this),this.lifePan=j.createSpan(t,e,n)}function L(){this.name="Initialize"}function D(t,e){this.numPan=j.createSpan(j.Util.initValue(t,1)),this.timePan=j.createSpan(j.Util.initValue(e,1)),this.startTime=0,this.nextTime=0,this.init()}function z(t,e){this.id="Behaviour_"+z.id++,this.life=j.Util.initValue(t,1/0),this.easing=j.Util.initValue(e,j.ease.setEasingByName(j.ease.easeLinear)),this.age=0,this.energy=1,this.dead=!1,this.name="Behaviour"}function k(t,e,n,i,r,o){this.x=t,this.y=e,this.z=n,this.width=i,this.height=r,this.depth=o,this.bottom=this.y+this.height,this.right=this.x+this.width,this.right=this.x+this.width}function B(t){this._arr=j.Util.isArray(t)?t:[t]}function F(t,e,n){this._isArray=!1,j.Util.isArray(t)?(this._isArray=!0,this.a=t):(this.a=j.Util.initValue(t,1),this.b=j.Util.initValue(e,this.a),this._center=j.Util.initValue(n,!1))}function V(){this.cID=0,this.list={}}function N(t){this.id="particle_"+N.ID++,this.name="Particle",this.reset("init"),j.Util.setPrototypeByObj(this,t)}function U(){this.initialize()}function j(t,e){this.preParticles=j.Util.initValue(t,j.POOL_MAX),this.integrationType=j.Util.initValue(e,j.EULER),this.emitters=[],this.renderers=[],this.pool=new j.Pool,j.integrator=new j.Integration(this.integrationType)}j.POOL_MAX=500,j.TIME_STEP=60,j.PI=3.142,j.DR=j.PI/180,j.MEASURE=100,j.EULER="euler",j.RK2="runge-kutta2",j.RK4="runge-kutta4",j.VERLET="verlet",j.PARTICLE_CREATED="partilcleCreated",j.PARTICLE_UPDATE="partilcleUpdate",j.PARTICLE_SLEEP="particleSleep",j.PARTICLE_DEAD="partilcleDead",j.PROTON_UPDATE="protonUpdate",j.PROTON_UPDATE_AFTER="protonUpdateAfter",j.EMITTER_ADDED="emitterAdded",j.EMITTER_REMOVED="emitterRemoved",j.bindEmtterEvent=!1,j.prototype={addRender:function(t){this.renderers.push(t),t.init(this)},removeRender:function(t){this.renderers.splice(this.renderers.indexOf(t),1),t.remove(this)},addEmitter:function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent("EMITTER_ADDED",t)},removeEmitter:function(t){t.parent==this&&(this.emitters.splice(this.emitters.indexOf(t),1),t.parent=null,this.dispatchEvent("EMITTER_REMOVED",t))},update:function(t){this.dispatchEvent("PROTON_UPDATE",this);var e=t||.0167;if(e>0)for(var n=this.emitters.length;n--;)this.emitters[n].update(e);this.dispatchEvent("PROTON_UPDATE_AFTER",this)},getCount:function(){var t,e=0,n=this.emitters.length;for(t=0;t<n;t++)e+=this.emitters[t].particles.length;return e},destroy:function(){for(var t=0,e=this.emitters.length;t<e;t++)this.emitters[t].destroy(),delete this.emitters[t];this.emitters.length=0,this.pool.destroy()}},U.initialize=function(t){t.addEventListener=G.addEventListener,t.removeEventListener=G.removeEventListener,t.removeAllEventListeners=G.removeAllEventListeners,t.hasEventListener=G.hasEventListener,t.dispatchEvent=G.dispatchEvent};var G=U.prototype;G._listeners=null,G.initialize=function(){},G.addEventListener=function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e},G.removeEventListener=function(t,e){if(this._listeners){if(!this._listeners[t])return;for(var n=this._listeners[t],i=0,r=n.length;i<r;i++)if(n[i]==e){1==r?delete this._listeners[t]:n.splice(i,1);break}}},G.removeAllEventListeners=function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null},G.dispatchEvent=function(t,e){var n=!1,i=this._listeners;if(t&&i){var r=i[t];if(!r)return n;for(var o=(r=r.slice()).length;o--;){var s=r[o];n=n||s(e)}}return!!n},G.hasEventListener=function(t){var e=this._listeners;return!!e&&!!e[t]},U.initialize(j.prototype),j.EventDispatcher=U;var H=H||{initValue:function(t,e){return null!=t&&null!=t?t:e},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},destroyArray:function(t){t.length=0},destroyObject:function(t){for(var e in t)delete t[e]},isUndefined:function(){for(var t in arguments)if(void 0!==arguments[t])return!1;return!0},setVectorByObj:function(t,e){void 0!==e.x&&(t.p.x=e.x),void 0!==e.y&&(t.p.y=e.y),void 0!==e.z&&(t.p.z=e.z),void 0!==e.vx&&(t.v.x=e.vx),void 0!==e.vy&&(t.v.y=e.vy),void 0!==e.vz&&(t.v.z=e.vz),void 0!==e.ax&&(t.a.x=e.ax),void 0!==e.ay&&(t.a.y=e.ay),void 0!==e.az&&(t.a.z=e.az),void 0!==e.p&&t.p.copy(e.p),void 0!==e.v&&t.v.copy(e.v),void 0!==e.a&&t.a.copy(e.a),void 0!==e.position&&t.p.copy(e.position),void 0!==e.velocity&&t.v.copy(e.velocity),void 0!==e.accelerate&&t.a.copy(e.accelerate)},setPrototypeByObj:function(t,e,n){for(var i in e)t.hasOwnProperty(i)&&(n?n.indexOf(i)<0&&(t[i]=H._getValue(e[i])):t[i]=H._getValue(e[i]));return t},_getValue:function(t){return t instanceof F?t.getValue():t},inherits:function(t,e){if(t._super_=e,Object.create)t.prototype=Object.create(e.prototype,{constructor:{value:t}});else{var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}};j.Util=H;var W=W||{getRGB:function(e){var n={};if("number"==typeof e)r=Math.floor(e),n.r=(e>>16&255)/255,n.g=(e>>8&255)/255,n.b=(255&e)/255;else if("string"==typeof e){var i;if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))n.r=Math.min(255,parseInt(i[1],10))/255,n.g=Math.min(255,parseInt(i[2],10))/255,n.b=Math.min(255,parseInt(i[3],10))/255;else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var r=i[1];n.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,n.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,n.b=parseInt(r.charAt(4)+r.charAt(5),16)/255}}else e instanceof t.Color&&(n.r=e.r,n.g=e.g,n.b=e.b);return n}};j.ColorUtil=W;var X={toScreenPos:function(){var e=new t.Vector3;return function(t,n,i){return e.copy(t),e.project(n),e.x=Math.round((e.x+1)*i.width/2),e.y=Math.round((1-e.y)*i.height/2),e.z=0,e}}(),toSpacePos:function(){var e,n=new t.Vector3,i=new t.Vector3;return function(t,r,o){return n.set(t.x/o.width*2-1,-t.y/o.height*2+1,.5),n.unproject(r),i.copy(n.sub(r.position).normalize()),e=-r.position.z/i.z,n.copy(r.position),n.add(i.multiplyScalar(e)),n}}(),getTexture:function(){var e={};return function(n){if(n instanceof t.Texture)return n;if("string"==typeof n){var i=j.PUID.hash(n);return e[i]||(e[i]=new t.Texture(n)),e[i]}return n instanceof Image?(i=j.PUID.hash(n.src),e[i]||(e[i]=new t.Texture(n)),e[i]):void 0}}()};j.THREEUtil=X;var Y=Y||{_id:0,_uids:{},id:function(t){for(var e in this._uids)if(this._uids[e]==t)return e;var n="PUID_"+this._id++;return this._uids[n]=t,n},hash:function(t){}};j.PUID=Y,N.ID=0,N.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/j.PI)},reset:function(t){return this.life=1/0,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.body=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.useColor=!1,this.useAlpha=!1,this.easing=j.ease.setEasingByName(j.ease.easeLinear),t?(this.p=new j.Vector3D,this.v=new j.Vector3D,this.a=new j.Vector3D,this.old={},this.old.p=this.p.clone(),this.old.v=this.v.clone(),this.old.a=this.a.clone(),this.behaviours=[],this.transform={},this.color={r:0,g:0,b:0},this.rotation=new j.Vector3D):(this.p.set(0,0,0),this.v.set(0,0,0),this.a.set(0,0,0),this.old.p.set(0,0,0),this.old.v.set(0,0,0),this.old.a.set(0,0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.rotation.clear(),j.Util.destroyObject(this.transform),this.removeAllBehaviours()),this},update:function(t,e){if(!this.sleep){this.age+=t;for(var n=this.behaviours.length;n--;)this.behaviours[n]&&this.behaviours[n].applyBehaviour(this,t,e)}if(this.age>=this.life)this.destroy();else{var i=this.easing(this.age/this.life);this.energy=Math.max(1-i,0)}},addBehaviour:function(t){this.behaviours.push(t),t.initialize(this)},addBehaviours:function(t){for(var e=t.length;e--;)this.addBehaviour(t[e])},removeBehaviour:function(t){var e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)},removeAllBehaviours:function(){j.Util.destroyArray(this.behaviours)},destroy:function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}},j.Particle=N,V.prototype={create:function(t){return this.cID++,"function"==typeof t?new t:t.clone()},getCount:function(){var t=0;for(var e in this.list)t+=this.list[e].length;return t++},get:function(t){var e,n=t.__puid||j.PUID.id(t);return(e=this.list[n]&&this.list[n].length>0?this.list[n].pop():this.create(t)).__puid=t.__puid||n,e},expire:function(t){return this._getList(t.__puid).push(t)},destroy:function(){for(var t in this.list)this.list[t].length=0,delete this.list[t]},_getList:function(t){return t=t||"default",this.list[t]||(this.list[t]=[]),this.list[t]}},j.Pool=V;var Z={randomAToB:function(t,e,n){return n?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,n){return Z.randomAToB(t-e,t+e,n)},randomZone:function(t){},degreeTransform:function(t){return t*j.PI/180},toColor16:function(t){return"#"+t.toString(16)},randomColor:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},lerp:function(t,e,n){return e+(t-e)*n},getNormal:function(t,e){return 0==t.x&&0==t.y?0==t.z?e.set(1,0,1):e.set(1,1,-t.y/t.z):0==t.x?e.set(1,0,1):e.set(-t.y/t.x,1,1),e.normalize()},axisRotate:function(t,e,n,i){var r=Math.cos(i),o=Math.sin(i),s=n.dot(e)*(1-r);t.copy(n),t.cross(e).scalar(o),t.addValue(e.x*r,e.y*r,e.z*r),t.addValue(n.x*s,n.y*s,n.z*s)}};j.MathUtils=Z;var Q=function(t){this.type=j.Util.initValue(t,j.EULER)};Q.prototype={integrate:function(t,e,n){this.euler(t,e,n)},euler:function(t,e,n){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.scalar(1/t.mass),t.v.add(t.a.scalar(e)),t.p.add(t.old.v.scalar(e)),n&&t.v.scalar(n),t.a.clear())}},j.Integration=Q;var J=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0};J.prototype={set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},getGradient:function(){return 0!=this.x?Math.atan2(this.y,this.x):this.y>0?j.PI/2:this.y<0?-j.PI/2:void 0},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addValue:function(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},scalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t):this.set(0,0,0),this},negate:function(){return this.scalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z;return this.x=n*t.z-i*t.y,this.y=i*t.x-e*t.z,this.z=e*t.y-n*t.x,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,s=e.y,a=e.z;return this.x=i*a-r*s,this.y=r*o-n*a,this.z=n*s-i*o,this},eulerFromDir:function(t){},applyEuler:function(){var t;return function(e){return void 0===t&&(t=new j.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new j.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,n)),this}}(),applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=t.w,l=a*e+o*i-s*n,u=a*n+s*e-r*i,c=a*i+r*n-o*e,h=-r*e-o*n-s*i;return this.x=l*a+h*-r+u*-s-c*-o,this.y=u*a+h*-o+c*-r-l*-s,this.z=c*a+h*-s+l*-o-u*-r,this},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},clear:function(){return this.x=0,this.y=0,this.z=0,this},clone:function(){return new j.Vector3D(this.x,this.y,this.z)},toString:function(){return"x:"+this.x+"y:"+this.y+"z:"+this.z}},j.Vector3D=J;var K=function(t,e,n){this.radius=t||1,this.phi=n||0,this.theta=e||0};K.prototype={set:function(t,e,n){return this.radius=t||1,this.phi=n||0,this.theta=e||0,this},setRadius:function(t){return this.radius=t,this},setPhi:function(t){return this.phi=t,this},setTheta:function(t){return this.theta=t,this},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},toVector3D:function(){return new j.Vector3D(this.getX(),this.getY(),this.getZ())},getX:function(){return this.radius*Math.sin(this.theta)*Math.cos(this.phi)},getY:function(){return-this.radius*Math.sin(this.theta)*Math.sin(this.phi)},getZ:function(){return this.radius*Math.cos(this.theta)},normalize:function(){return this.radius=1,this},equals:function(t){return t.radius===this.radius&&t.phi===this.phi&&t.theta===this.theta},clear:function(){return this.radius=0,this.phi=0,this.theta=0,this},clone:function(){return new K(this.radius,this.phi,this.theta)}},j.Polar3D=K,F.prototype={getValue:function(t){return this._isArray?this.a[this.a.length*Math.random()>>0]:this._center?j.MathUtils.randomFloating(this.a,this.b,t):j.MathUtils.randomAToB(this.a,this.b,t)}},j.createSpan=function(t,e,n){return t instanceof F?t:void 0===e?new F(t):void 0===n?new F(t,e):new F(t,e,n)},j.Span=F,j.Util.inherits(B,j.Span),B.prototype.getValue=function(){var t=this._arr[this._arr.length*Math.random()>>0];return"random"==t||"Random"==t?j.MathUtils.randomColor():t},j.createArraySpan=function(t){return t?t instanceof j.ArraySpan?t:new j.ArraySpan(t):null},j.ArraySpan=B;var $=function(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1};$.prototype={set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},clone:function(){return new j.Quaternion(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEuler:function(t){var e=Math.cos(t.x/2),n=Math.cos(t.y/2),i=Math.cos(t.z/2),r=Math.sin(t.x/2),o=Math.sin(t.y/2),s=Math.sin(t.z/2);return this.x=r*n*i+e*o*s,this.y=e*o*i-r*n*s,this.z=e*n*s+r*o*i,this.w=e*n*i-r*o*s,this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=Math.cos(n),this},normalize:function(){var t=this.length();return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},j.Quaternion=$,k.prototype={contains:function(t,e,n){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y&&n<=this.depth&&n>=this.z}},j.Box=k,z.id=0,z.prototype={reset:function(t,e){this.life=j.Util.initValue(t,1/0),this.easing=j.Util.initValue(e,j.ease.setEasingByName(j.ease.easeLinear))},normalizeForce:function(t){return t.scalar(j.MEASURE)},normalizeValue:function(t){return t*j.MEASURE},initialize:function(t){},applyBehaviour:function(t,e,n){if(!this.dead){if(this.age+=e,this.age>=this.life)return this.energy=0,void(this.dead=!0);var i=this.easing(t.age/t.life);this.energy=Math.max(1-i,0)}},destroy:function(){}},j.Behaviour=z,D.prototype={init:function(){this.startTime=0,this.nextTime=this.timePan.getValue()},getValue:function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.init(),1==this.numPan.b?this.numPan.getValue("Float")>.5?1:0:this.numPan.getValue("Int")):0}},j.Rate=D,L.prototype.reset=function(){},L.prototype.init=function(t,e){e?this.initialize(e):this.initialize(t)},L.prototype.initialize=function(t){},j.Initialize=L;var tt={initialize:function(t,e,n){for(var i=n.length;i--;){var r=n[i];r instanceof j.Initialize?r.init(t,e):tt.init(t,e,r)}tt.bindEmitter(t,e)},init:function(t,e,n){j.Util.setPrototypeByObj(e,n),j.Util.setVectorByObj(e,n)},bindEmitter:function(t,e){t.bindEmitter&&(e.p.add(t.p),e.v.add(t.v),e.a.add(t.a),e.v.applyEuler(t.rotation))}};j.InitializeUtil=tt,j.Util.inherits(q,j.Initialize),q.prototype.initialize=function(t){this.lifePan.a==1/0||"infi"==this.lifePan.a?t.life=1/0:t.life=this.lifePan.getValue()},j.Life=q,j.Util.inherits(O,j.Initialize),O.prototype.reset=function(){this.zones?this.zones.length=0:this.zones=[];var t=Array.prototype.slice.call(arguments);this.zones=this.zones.concat(t)},O.prototype.addZone=function(){var t=Array.prototype.slice.call(arguments);this.zones=this.zones.concat(t)},O.prototype.initialize=function(t){var e=this.zones[Math.random()*this.zones.length>>0];e.getPosition(),t.p.x=e.vector.x,t.p.y=e.vector.y,t.p.z=e.vector.z},j.Position=O,j.P=O,j.Util.inherits(R,j.Initialize),R.prototype.reset=function(t,e,n){t instanceof j.Vector3D?(this.radiusPan=j.createSpan(1),this.dir=t.clone(),this.tha=e*j.DR,this._useV=!0):t instanceof j.Polar3D?(this.tha=e*j.DR,this.dirVec=t.toVector3D(),this._useV=!1):(this.radiusPan=j.createSpan(t),this.dir=e.clone().normalize(),this.tha=n*j.DR,this._useV=!0)},R.prototype.normalize=function(t){return t*j.MEASURE},R.prototype.initialize=function(){var t,e=new j.Vector3D(0,0,1),n=new j.Vector3D(0,0,0);return function(i){return t=this.tha*Math.random(),this._useV&&this.dirVec.copy(this.dir).scalar(this.radiusPan.getValue()),j.MathUtils.getNormal(this.dirVec,e),n.copy(this.dirVec).applyAxisAngle(e,t),n.applyAxisAngle(this.dirVec.normalize(),Math.random()*j.PI*2),i.v.copy(n),this}}(),j.Velocity=R,j.V=R,j.Util.inherits(I,j.Initialize),I.prototype.initialize=function(t){t.mass=this.massPan.getValue()},j.Mass=I,j.Util.inherits(C,j.Initialize),C.prototype.reset=function(t,e,n){this.radius=j.createSpan(t,e,n)},C.prototype.initialize=function(t){t.radius=this.radius.getValue(),t.transform.oldRadius=t.radius},j.Radius=C,j.Util.inherits(P,j.Initialize),P.prototype.initialize=function(t){var e=this.body.getValue();this.w?t.body={width:this.w,height:this.h,body:e}:t.body=e},j.Body=P,j.Util.inherits(E,j.Behaviour),E.prototype.reset=function(t,e,n){this.force=this.normalizeForce(new j.Vector3D(t,e,n)),this.force.id=Math.random()},E.prototype.applyBehaviour=function(t,e,n){E._super_.prototype.applyBehaviour.call(this,t,e,n),t.a.add(this.force)},j.F=j.Force=E,j.Util.inherits(T,j.Behaviour),T.prototype.reset=function(t,e,n,i,r){this.targetPosition=j.Util.initValue(t,new j.Vector3D),this.radius=j.Util.initValue(n,1e3),this.force=j.Util.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new j.Vector3D,this.lengthSq=0,i&&T._super_.prototype.reset.call(this,i,r)},T.prototype.applyBehaviour=function(t,e,n){T._super_.prototype.applyBehaviour.call(this,t,e,n),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.scalar(1-this.lengthSq/this.radiusSq),this.attractionForce.scalar(this.force),t.a.add(this.attractionForce))},j.Attraction=T,j.Util.inherits(M,j.Behaviour),M.prototype.reset=function(t,e,n,i,r,o){this.randomFoce=this.normalizeForce(new j.Vector3D(t,e,n)),this.delayPan=j.createSpan(i||.03),this.time=0,r&&M._super_.prototype.reset.call(this,r,o)},M.prototype.applyBehaviour=function(t,e,n){if(M._super_.prototype.applyBehaviour.call(this,t,e,n),this.time+=e,this.time>=this.delayPan.getValue()){var i=j.MathUtils.randomAToB(-this.randomFoce.x,this.randomFoce.x),r=j.MathUtils.randomAToB(-this.randomFoce.y,this.randomFoce.y),o=j.MathUtils.randomAToB(-this.randomFoce.z,this.randomFoce.z);t.a.addValue(i,r,o),this.time=0}},j.RandomDrift=M,j.Util.inherits(A,j.Attraction),A.prototype.reset=function(t,e,n,i,r){A._super_.prototype.reset.call(this,t,e,n,i,r),this.force*=-1},j.Repulsion=A,j.Util.inherits(S,j.Force),S.prototype.reset=function(t,e,n){S._super_.prototype.reset.call(this,0,-t,0,e,n)},j.Gravity=S,j.G=S,j.Util.inherits(w,j.Behaviour),w.prototype.reset=function(t,e,n,i,r){this.emitter=t,this.useMass=e,this.callback=n,this.particles=[],this.delta=new j.Vector3D,i&&w._super_.prototype.reset.call(this,i,r)},w.prototype.applyBehaviour=function(t,e,n){for(var i,r,o,s,a,l,u=this.emitter?this.emitter.particles.slice(n):this.particles.slice(n),c=u.length;c--;)(i=u[c])!=t&&(this.delta.copy(i.p).sub(t.p),(r=this.delta.lengthSq())<=(s=t.radius+i.radius)*s&&(o=s-Math.sqrt(r),o+=.5,a=this._getAverageMass(t,i),l=this._getAverageMass(i,t),t.p.add(this.delta.clone().normalize().scalar(o*-a)),i.p.add(this.delta.normalize().scalar(o*l)),this.callback&&this.callback(t,i)))},w.prototype._getAverageMass=function(t,e){return this.useMass?e.mass/(t.mass+e.mass):.5},j.Collision=w,j.Util.inherits(_,j.Behaviour),_.prototype.reset=function(t,e,n,i){var r,o;"string"==typeof t?(o=t,r=e):(o=e,r=t),this.zone=r,this.zone.crossType=j.Util.initValue(o,"dead"),n&&_._super_.prototype.reset.call(this,n,i)},_.prototype.applyBehaviour=function(t,e,n){_._super_.prototype.applyBehaviour.call(this,t,e,n),this.zone.crossing.call(this.zone,t)},j.CrossZone=_,j.Util.inherits(b,j.Behaviour),b.prototype.reset=function(t,e,n,i){this._same=null==e||null==e,this.a=j.createSpan(j.Util.initValue(t,1)),this.b=j.createSpan(e),n&&b._super_.prototype.reset.call(this,n,i)},b.prototype.initialize=function(t){t.useAlpha=!0,t.transform.alphaA=this.a.getValue(),this._same?t.transform.alphaB=t.transform.alphaA:t.transform.alphaB=this.b.getValue()},b.prototype.applyBehaviour=function(t,e,n){b._super_.prototype.applyBehaviour.call(this,t,e,n),t.alpha=j.MathUtils.lerp(t.transform.alphaA,t.transform.alphaB,this.energy),t.alpha<.002&&(t.alpha=0)},j.Alpha=b,j.Util.inherits(x,j.Behaviour),x.prototype.reset=function(t,e,n,i){this._same=null==e||null==e,this.a=j.createSpan(j.Util.initValue(t,1)),this.b=j.createSpan(e),n&&x._super_.prototype.reset.call(this,n,i)},x.prototype.initialize=function(t){t.transform.scaleA=this.a.getValue(),t.transform.oldRadius=t.radius,this._same?t.transform.scaleB=t.transform.scaleA:t.transform.scaleB=this.b.getValue()},x.prototype.applyBehaviour=function(t,e,n){x._super_.prototype.applyBehaviour.call(this,t,e,n),t.scale=j.MathUtils.lerp(t.transform.scaleA,t.transform.scaleB,this.energy),t.scale<5e-4&&(t.scale=0),t.radius=t.transform.oldRadius*t.scale},j.Scale=x,j.Util.inherits(v,j.Behaviour),v.prototype.reset=function(t,e,n,i,r){this.a=t||0,this.b=e||0,this.c=n||0,void 0===t||"same"==t?this._type="same":null==e?this._type="set":void 0===n?this._type="to":(this._type="add",this.a=j.createSpan(this.a*j.DR),this.b=j.createSpan(this.b*j.DR),this.c=j.createSpan(this.c*j.DR)),i&&v._super_.prototype.reset.call(this,i,r)},v.prototype.initialize=function(t){switch(this._type){case"same":break;case"set":this._setRotation(t.rotation,this.a);break;case"to":t.transform.fR=t.transform.fR||new j.Vector3D,t.transform.tR=t.transform.tR||new j.Vector3D,this._setRotation(t.transform.fR,this.a),this._setRotation(t.transform.tR,this.b);break;case"add":t.transform.addR=new j.Vector3D(this.a.getValue(),this.b.getValue(),this.c.getValue())}},v.prototype._setRotation=function(t,e){if(t=t||new j.Vector3D,"random"==e){var n=j.MathUtils.randomAToB(-j.PI,j.PI),i=j.MathUtils.randomAToB(-j.PI,j.PI),r=j.MathUtils.randomAToB(-j.PI,j.PI);t.set(n,i,r)}else e instanceof j.Vector3D&&t.copy(e)},v.prototype.applyBehaviour=function(t,e,n){switch(v._super_.prototype.applyBehaviour.call(this,t,e,n),this._type){case"same":t.rotation||(t.rotation=new j.Vector3D),t.rotation.eulerFromDir(t.v);break;case"set":break;case"to":t.rotation.x=j.MathUtils.lerp(t.transform.fR.x,t.transform.tR.x,this.energy),t.rotation.y=j.MathUtils.lerp(t.transform.fR.y,t.transform.tR.y,this.energy),t.rotation.z=j.MathUtils.lerp(t.transform.fR.z,t.transform.tR.z,this.energy);break;case"add":t.rotation.add(t.transform.addR)}},j.Rotate=v,j.Util.inherits(y,j.Behaviour),y.prototype.reset=function(t,e,n,i){this._same=null==e||null==e,this.a=j.createArraySpan(t),this.b=j.createArraySpan(e),n&&y._super_.prototype.reset.call(this,n,i)},y.prototype.initialize=function(t){t.transform.colorA=j.ColorUtil.getRGB(this.a.getValue()),t.useColor=!0,this._same?t.transform.colorB=t.transform.colorA:t.transform.colorB=j.ColorUtil.getRGB(this.b.getValue())},y.prototype.applyBehaviour=function(t,e,n){y._super_.prototype.applyBehaviour.call(this,t,e,n),this._same?(t.color.r=t.transform.colorA.r,t.color.g=t.transform.colorA.g,t.color.b=t.transform.colorA.b):(t.color.r=j.MathUtils.lerp(t.transform.colorA.r,t.transform.colorB.r,this.energy),t.color.g=j.MathUtils.lerp(t.transform.colorA.g,t.transform.colorB.g,this.energy),t.color.b=j.MathUtils.lerp(t.transform.colorA.b,t.transform.colorB.b,this.energy))},j.Color=y,j.Util.inherits(g,j.Behaviour),g.prototype.reset=function(t,e,n,i,r){this.pos?this.pos.set(t,e,n):this.pos=new j.Vector3D(t,e,n),this.spring=i||.1,this.friction=r||.98},g.prototype.applyBehaviour=function(t,e,n){g._super_.prototype.applyBehaviour.call(this,t,e,n),t.v.x+=(this.pos.x-t.p.x)*this.spring,t.v.y+=(this.pos.y-t.p.y)*this.spring,t.v.z+=(this.pos.z-t.p.z)*this.spring},j.Spring=g,m.ID=0,j.Util.inherits(m,j.Particle),j.EventDispatcher.initialize(m.prototype),m.prototype.emit=function(t,e){this.currentEmitTime=0,this.totalEmitTimes=j.Util.initValue(t,1/0),1==e||"life"==e||"destroy"==e?this.life="once"==t?1:this.totalEmitTimes:isNaN(e)||(this.life=e),this.rate.init()},m.prototype.stopEmit=function(){this.totalEmitTimes=-1,this.currentEmitTime=0},m.prototype.removeAllParticles=function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0},m.prototype.createParticle=function(t,e){var n=this.parent.pool.get(j.Particle);return this.setupParticle(n,t,e),this.parent&&this.parent.dispatchEvent("PARTICLE_CREATED",n),j.bindEmtterEvent&&this.dispatchEvent("PARTICLE_CREATED",n),n},m.prototype.addSelfInitialize=function(t){t.init?t.init(this):this.initAll()},m.prototype.addInitialize=function(){for(var t=arguments.length;t--;)this.initializes.push(arguments[t])},m.prototype.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},m.prototype.removeInitializers=function(){j.Util.destroyArray(this.initializes)},m.prototype.addBehaviour=function(){for(var t=arguments.length;t--;)this.behaviours.push(arguments[t])},m.prototype.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)},m.prototype.removeAllBehaviours=function(){j.Util.destroyArray(this.behaviours)},m.prototype.integrate=function(t){var e=1-this.damping;j.integrator.integrate(this,t,e);for(var n=this.particles.length;n--;){var i=this.particles[n];i.update(t,n),j.integrator.integrate(i,t,e),this.parent&&this.parent.dispatchEvent("PARTICLE_UPDATE",i),j.bindEmtterEvent&&this.dispatchEvent("PARTICLE_UPDATE",i)}},m.prototype.emitting=function(t){if("once"==this.totalEmitTimes){for((e=this.rate.getValue(99999))>0&&(this.cID=e);e--;)this.createParticle();this.totalEmitTimes="none"}else if(!isNaN(this.totalEmitTimes)){var e;if(this.currentEmitTime+=t,this.currentEmitTime<this.totalEmitTimes)for((e=this.rate.getValue(t))>0&&(this.cID=e);e--;)this.createParticle()}},m.prototype.update=function(t){this.age+=t,(this.dead||this.age>=this.life)&&this.destroy(),this.emitting(t),this.integrate(t);for(var e,n=this.particles.length;n--;)(e=this.particles[n]).dead&&(this.parent&&this.parent.dispatchEvent("PARTICLE_DEAD",e),j.bindEmtterEvent&&this.dispatchEvent("PARTICLE_DEAD",e),this.parent.pool.expire(e.reset()),this.particles.splice(n,1))},m.prototype.setupParticle=function(t,e,n){var i=this.initializes,r=this.behaviours;e&&(i=j.Util.isArray(e)?e:[e]),n&&(r=j.Util.isArray(n)?n:[n]),j.InitializeUtil.initialize(this,t,i),t.addBehaviours(r),t.parent=this,this.particles.push(t)},m.prototype.destroy=function(){this.dead=!0,this.energy=0,this.totalEmitTimes=-1,0==this.particles.length&&(this.removeInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this))},j.Emitter=m,j.Util.inherits(f,j.Emitter),f.prototype.addSelfBehaviour=function(){var t,e=arguments.length;for(t=0;t<e;t++)this.selfBehaviours.push(arguments[t])},f.prototype.removeSelfBehaviour=function(t){var e=this.selfBehaviours.indexOf(t);e>-1&&this.selfBehaviours.splice(e,1)},f.prototype.update=function(t){if(f._super_.prototype.update.call(this,t),!this.sleep){var e,n=this.selfBehaviours.length;for(e=0;e<n;e++)this.selfBehaviours[e].applyBehaviour(this,t,e)}},j.BehaviourEmitter=f,j.Util.inherits(p,j.Emitter),p.prototype.initEventHandler=function(){var t=this;this.mousemoveHandler=function(e){t.mousemove.call(t,e)},this.mousedownHandler=function(e){t.mousedown.call(t,e)},this.mouseupHandler=function(e){t.mouseup.call(t,e)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},p.prototype.emit=function(){this._allowEmitting=!0},p.prototype.stopEmit=function(){this._allowEmitting=!1},p.prototype.setCameraAndCanvas=function(t,e){this.camera=t,this.canvas=e},p.prototype.setCameraAndRenderer=function(t,e){this.camera=t,this.renderer=e,this.canvas=e.domElement},p.prototype.mousemove=function(t){var e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top,r=this.renderer?this.renderer.getPixelRatio():1;n*=r,i*=r,this.mouse.x+=(n-this.mouse.x)*this.ease,this.mouse.y+=(i-this.mouse.y)*this.ease,this.p.copy(j.THREEUtil.toSpacePos(this.mouse,this.camera,this.canvas,this.renderer)),this._allowEmitting&&p._super_.prototype.emit.call(this,"once")},p.prototype.destroy=function(){p._super_.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},j.FollowEmitter=p;var et=et||{easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return 1-Math.cos(t*(j.PI/2))},easeOutSine:function(t){return Math.sin(t*(j.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(j.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*((1+(e*=1.525))*t-e):.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},setEasingByName:function(t){return et[t]?et[t]:et.easeLinear}};for(var nt in et)"setEasingByName"!=nt&&(j[nt]=et[nt]);j.ease=et,d.prototype={init:function(t){var e=this;this.proton=t,this.proton.addEventListener("PROTON_UPDATE",(function(t){e.onProtonUpdate.call(e,t)})),this.proton.addEventListener("PARTICLE_CREATED",(function(t){e.onParticleCreated.call(e,t)})),this.proton.addEventListener("PARTICLE_UPDATE",(function(t){e.onParticleUpdate.call(e,t)})),this.proton.addEventListener("PARTICLE_DEAD",(function(t){e.onParticleDead.call(e,t)}))},remove:function(t){this.proton=null},onParticleCreated:function(t){},onParticleUpdate:function(t){},onParticleDead:function(t){},onProtonUpdate:function(t){}},j.BaseRender=d,j.Util.inherits(h,j.BaseRender),h.prototype.onProtonUpdate=function(){},h.prototype.onParticleCreated=function(t){t.target||(t.body||(t.body=this._body),t.target=this._targetPool.get(t.body),(t.useAlpha||t.useColor)&&(t.target.material.__puid=j.PUID.id(t.body.material),t.target.material=this._materialPool.get(t.target.material))),t.target&&(t.target.position.copy(t.p),this.container.add(t.target))},h.prototype.onParticleUpdate=function(t){t.target&&(t.target.position.copy(t.p),t.target.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),this.scale(t),t.useAlpha&&(t.target.material.opacity=t.alpha,t.target.material.transparent=!0),t.useColor&&t.target.material.color.copy(t.color))},h.prototype.scale=function(t){t.target.scale.set(t.scale,t.scale,t.scale)},h.prototype.onParticleDead=function(t){t.target&&((t.useAlpha||t.useColor)&&this._materialPool.expire(t.target.material),this._targetPool.expire(t.target),this.container.remove(t.target),t.target=null)},j.MeshRender=h,j.Util.inherits(c,j.BaseRender),c.prototype.onProtonUpdate=function(){},c.prototype.onParticleCreated=function(e){e.target||(e.target=new t.Vector3),e.target.copy(e.p),this.points.geometry.vertices.push(e.target)},c.prototype.onParticleUpdate=function(t){t.target&&t.target.copy(t.p)},c.prototype.onParticleDead=function(t){if(t.target){var e=this.points.geometry.vertices.indexOf(t.target);e>-1&&this.points.geometry.vertices.splice(e,1),t.target=null}},j.PointsRender=c,j.Util.inherits(u,j.MeshRender),u.prototype.scale=function(t){t.target.scale.set(t.scale*t.radius,t.scale*t.radius,1)},j.SpriteRender=u,j.Util.inherits(l,j.BaseRender),l.prototype.onProtonUpdate=function(){},l.prototype.onParticleCreated=function(t){},l.prototype.onParticleUpdate=function(t){},l.prototype.onParticleDead=function(t){},j.CustomRender=l,a.prototype={getPosition:function(){return null},crossing:function(t){switch(this.crossType){case"bound":this._bound(t);break;case"cross":this._cross(t);break;case"dead":this._dead(t)}},_dead:function(t){},_bound:function(t){},_cross:function(t){}},j.Zone=a,j.Util.inherits(s,j.Zone),s.prototype.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*(this.x2-this.x1),this.vector.y=this.y1+this.random*(this.y2-this.y1),this.vector.z=this.z1+this.random*(this.z2-this.z1),this.vector},s.prototype.crossing=function(t){this.log&&(console.error("Sorry LineZone does not support crossing method"),this.log=!1)},j.LineZone=s,j.Util.inherits(o,j.Zone),o.prototype.getPosition=function(){var t,e,n;return function(){return this.random=Math.random(),n=this.random*this.radius,t=j.PI*Math.random(),e=2*j.PI*Math.random(),this.vector.x=this.x+n*Math.sin(t)*Math.cos(e),this.vector.y=this.y+n*Math.sin(e)*Math.sin(t),this.vector.z=this.z+n*Math.cos(t),this.vector}}(),o.prototype._dead=function(t){t.p.distanceTo(this)-t.radius>this.radius&&(t.dead=!0)},o.prototype._bound=function(){var t,e=new j.Vector3D,n=new j.Vector3D;return function(i){i.p.distanceTo(this)+i.radius>=this.radius&&(e.copy(i.p).sub(this).normalize(),n.copy(i.v),t=2*n.dot(e),i.v.sub(e.scalar(t)))}}(),o.prototype._cross=function(t){this.log&&(console.error("Sorry SphereZone does not support _cross method"),this.log=!1)},j.SphereZone=o,j.Util.inherits(r,j.Zone),r.prototype.getPosition=function(){var t=this.geometry.vertices,e=t[t.length*Math.random()>>0];return this.vector.x=e.x*this.scale,this.vector.y=e.y*this.scale,this.vector.z=e.z*this.scale,this.vector},r.prototype.crossing=function(t){this.log&&(console.error("Sorry MeshZone does not support crossing method"),this.log=!1)},j.MeshZone=r,j.Util.inherits(i,j.Zone),i.prototype.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector.z=this.z,this.vector},i.prototype.crossing=function(t){this.log&&(console.error("Sorry PointZone does not support crossing method"),this.log=!1)},j.PointZone=i,j.Util.inherits(n,j.Zone),n.prototype.getPosition=function(){return this.vector.x=this.x+j.MathUtils.randomAToB(-.5,.5)*this.width,this.vector.y=this.y+j.MathUtils.randomAToB(-.5,.5)*this.height,this.vector.z=this.z+j.MathUtils.randomAToB(-.5,.5)*this.depth,this.vector},n.prototype._dead=function(t){(t.p.x+t.radius<this.x-this.width/2||t.p.x-t.radius>this.x+this.width/2)&&(t.dead=!0),(t.p.y+t.radius<this.y-this.height/2||t.p.y-t.radius>this.y+this.height/2)&&(t.dead=!0),(t.p.z+t.radius<this.z-this.depth/2||t.p.z-t.radius>this.z+this.depth/2)&&(t.dead=!0)},n.prototype._bound=function(t){t.p.x-t.radius<this.x-this.width/2?(t.p.x=this.x-this.width/2+t.radius,t.v.x*=-this.friction,this._static(t,"x")):t.p.x+t.radius>this.x+this.width/2&&(t.p.x=this.x+this.width/2-t.radius,t.v.x*=-this.friction,this._static(t,"x")),t.p.y-t.radius<this.y-this.height/2?(t.p.y=this.y-this.height/2+t.radius,t.v.y*=-this.friction,this._static(t,"y")):t.p.y+t.radius>this.y+this.height/2&&(t.p.y=this.y+this.height/2-t.radius,t.v.y*=-this.friction,this._static(t,"y")),t.p.z-t.radius<this.z-this.depth/2?(t.p.z=this.z-this.depth/2+t.radius,t.v.z*=-this.friction,this._static(t,"z")):t.p.z+t.radius>this.z+this.depth/2&&(t.p.z=this.z+this.depth/2-t.radius,t.v.z*=-this.friction,this._static(t,"z"))},n.prototype._static=function(t,e){t.v[e]*t.a[e]>0||Math.abs(t.v[e])<.0167*Math.abs(t.a[e])*this.max&&(t.v[e]=0,t.a[e]=0)},n.prototype._cross=function(t){t.p.x+t.radius<this.x-this.width/2&&t.v.x<=0?t.p.x=this.x+this.width/2+t.radius:t.p.x-t.radius>this.x+this.width/2&&t.v.x>=0&&(t.p.x=this.x-this.width/2-t.radius),t.p.y+t.radius<this.y-this.height/2&&t.v.y<=0?t.p.y=this.y+this.height/2+t.radius:t.p.y-t.radius>this.y+this.height/2&&t.v.y>=0&&(t.p.y=this.y-this.height/2-t.radius),t.p.z+t.radius<this.z-this.depth/2&&t.v.z<=0?t.p.z=this.z+this.depth/2+t.radius:t.p.z-t.radius>this.z+this.depth/2&&t.v.z>=0&&(t.p.z=this.z-this.depth/2-t.radius)},j.BoxZone=n,j.Util.inherits(e,j.Zone),e.prototype.getPosition=function(){var t,e=new j.Vector3D;return function(){return t=this.renderer.domElement,e.x=Math.random()*t.width,e.y=Math.random()*t.height,this.vector.copy(j.THREEUtil.toSpacePos(e,this.camera,t)),this.vector}}(),e.prototype._dead=function(t){var e=j.THREEUtil.toScreenPos(t.p,this.camera,this.renderer.domElement),n=this.renderer.domElement;(e.y+t.radius<-this.dis&&this.d1||e.y-t.radius>n.height+this.dis&&this.d3)&&(t.dead=!0),(e.x+t.radius<-this.dis&&this.d4||e.x-t.radius>n.width+this.dis&&this.d2)&&(t.dead=!0)},e.prototype._cross=function(){var t=new j.Vector3D;return function(e){var n=j.THREEUtil.toScreenPos(e.p,this.camera,this.renderer.domElement),i=this.renderer.domElement;n.y+e.radius<-this.dis?(t.x=n.x,t.y=i.height+this.dis+e.radius,e.p.y=j.THREEUtil.toSpacePos(t,this.camera,i).y):n.y-e.radius>i.height+this.dis&&(t.x=n.x,t.y=-this.dis-e.radius,e.p.y=j.THREEUtil.toSpacePos(t,this.camera,i).y),n.x+e.radius<-this.dis?(t.y=n.y,t.x=i.width+this.dis+e.radius,e.p.x=j.THREEUtil.toSpacePos(t,this.camera,i).x):n.x-e.radius>i.width+this.dis&&(t.y=n.y,t.x=-this.dis-e.radius,e.p.x=j.THREEUtil.toSpacePos(t,this.camera,i).x)}}(),e.prototype._bound=function(t){var e=j.THREEUtil.toScreenPos(t.p,this.camera,this.renderer.domElement),n=this.renderer.domElement;(e.y+t.radius<-this.dis||e.y-t.radius>n.height+this.dis)&&(t.v.y*=-1),(e.x+t.radius<-this.dis||e.x-t.radius>n.width+this.dis)&&(t.v.y*=-1)},j.ScreenZone=e;var it=function(){if(window.console&&window.console.trace){var t=Array.prototype.slice.call(arguments);if(0==(arguments[0]+"").indexOf("+")){var e=parseInt(arguments[0]);it.once<e&&(t.shift(),console.trace.apply(console,t),it.once++)}else t.unshift("+15"),it.apply(console,t)}};it.once=0,j.log=it;var rt=rt||{addEventListener:function(t,e){t.addEventListener("PROTON_UPDATE",(function(t){e(t)}))},drawZone:function(e,n,i){var r,o,s;i instanceof j.PointZone?r=new t.SphereGeometry(15):i instanceof j.LineZone||(i instanceof j.BoxZone?r=new t.BoxGeometry(i.width,i.height,i.depth):i instanceof j.SphereZone?r=new t.SphereGeometry(i.radius,10,10):i instanceof j.MeshZone&&(r=i.geometry instanceof t.Geometry?i.geometry:i.geometry.geometry,r=new t.SphereGeometry(i.radius,10,10))),o=new t.MeshBasicMaterial({color:"#2194ce",wireframe:!0}),s=new t.Mesh(r,o),n.add(s),this.addEventListener(e,(function(t){s.position.set(i.x,i.y,i.z)}))},drawEmitter:function(e,n,i,r){var o=new t.OctahedronGeometry(15),s=new t.MeshBasicMaterial({color:r||"#aaa",wireframe:!0}),a=new t.Mesh(o,s);n.add(a),this.addEventListener(e,(function(){a.position.copy(i.p),a.rotation.set(i.rotation.x,i.rotation.y,i.rotation.z)}))},renderInfo:function(){function t(t,e){var n="material"==e?"_materialPool":"_targetPool";return t.renderers[0][n].cID}return function(e,n){this.addInfo(n);var i="";switch(this._infoType){case 2:i+="emitter:"+e.emitters.length+"<br>",i+="em speed:"+e.emitters[0].cID+"<br>",i+="pos:"+function(t){var e=t.emitters[0];return Math.round(e.p.x)+","+Math.round(e.p.y)+","+Math.round(e.p.z)}(e);break;case 3:i+=e.renderers[0].name+"<br>",i+="target:"+t(e,"target")+"<br>",i+="material:"+t(e,"material");break;default:i+="particles:"+e.getCount()+"<br>",i+="pool:"+e.pool.getCount()+"<br>",i+="total:"+(e.getCount()+e.pool.getCount())}this._infoCon.innerHTML=i}}(),addInfo:function(t){var e=this;if(!this._infoCon){var n,i;switch(this._infoCon=document.createElement("div"),this._infoCon.style.cssText=["position:fixed;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this._infoType=1,this._infoCon.addEventListener("click",(function(t){e._infoType++,e._infoType>3&&(e._infoType=1)}),!1),t){case 2:n="#201",i="#f08";break;case 3:n="#020",i="#0f0";break;default:n="#002",i="#0ff"}this._infoCon.style["background-color"]=n,this._infoCon.style.color=i}this._infoCon.parentNode||document.body.appendChild(this._infoCon)}};return j.Debug=rt,j}(n(9477))},2511:function(t,e,n){var i;t=n.nmd(t),function(r){function o(t){throw RangeError(_[t])}function s(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function a(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+s((t=t.replace(b,".")).split("."),e).join(".")}function l(t){for(var e,n,i=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}function u(t){return s(t,(function(t){var e="";return t>65535&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+S(t)})).join("")}function c(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function h(t,e,n){var i=0;for(t=n?w(t/700):t>>1,t+=w(t/e);t>455;i+=y)t=w(t/35);return w(i+36*t/(t+38))}function d(t){var e,n,i,r,s,a,l,c,d,p,f,m=[],v=t.length,x=0,b=128,_=72;for((n=t.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&o("not-basic"),m.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<v;){for(s=x,a=1,l=y;r>=v&&o("invalid-input"),((c=(f=t.charCodeAt(r++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:y)>=y||c>w((g-x)/a))&&o("overflow"),x+=c*a,!(c<(d=l<=_?1:l>=_+26?26:l-_));l+=y)a>w(g/(p=y-d))&&o("overflow"),a*=p;_=h(x-s,e=m.length+1,0==s),w(x/e)>g-b&&o("overflow"),b+=w(x/e),x%=e,m.splice(x++,0,b)}return u(m)}function p(t){var e,n,i,r,s,a,u,d,p,f,m,v,x,b,_,A=[];for(v=(t=l(t)).length,e=128,n=0,s=72,a=0;a<v;++a)(m=t[a])<128&&A.push(S(m));for(i=r=A.length,r&&A.push("-");i<v;){for(u=g,a=0;a<v;++a)(m=t[a])>=e&&m<u&&(u=m);for(u-e>w((g-n)/(x=i+1))&&o("overflow"),n+=(u-e)*x,e=u,a=0;a<v;++a)if((m=t[a])<e&&++n>g&&o("overflow"),m==e){for(d=n,p=y;!(d<(f=p<=s?1:p>=s+26?26:p-s));p+=y)_=d-f,b=y-f,A.push(S(c(f+_%b,0))),d=w(_/b);A.push(S(c(d,0))),s=h(n,x,i==r),n=0,++i}++n,++e}return A.join("")}e&&e.nodeType,t&&t.nodeType;var f="object"==typeof n.g&&n.g;f.global!==f&&f.window!==f&&f.self;var m,g=2147483647,y=36,v=/^xn--/,x=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=Math.floor,S=String.fromCharCode;m={version:"1.3.2",ucs2:{decode:l,encode:u},decode:d,encode:p,toASCII:function(t){return a(t,(function(t){return x.test(t)?"xn--"+p(t):t}))},toUnicode:function(t){return a(t,(function(t){return v.test(t)?d(t.slice(4).toLowerCase()):t}))}},void 0===(i=function(){return m}.call(e,n,e,t))||(t.exports=i)}()},8575:(t,e,n)=>{"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(t,e,n){if(t&&s.isObject(t)&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}var o=n(2511),s=n(2502);e.parse=r,e.resolve=function(t,e){return r(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?r(t,!1,!0).resolveObject(e):e},e.format=function(t){return s.isString(t)&&(t=r(t)),t instanceof i?t.format():i.prototype.format.call(t)},e.Url=i;var a=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(c),d=["%","/","?",";","#"].concat(h),p=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},x=n(7673);i.prototype.parse=function(t,e,n){if(!s.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),r=-1!==i&&i<t.indexOf("#")?"?":"#",l=t.split(r);l[0]=l[0].replace(/\\/g,"/");var c=t=l.join(r);if(c=c.trim(),!n&&1===t.split("#").length){var b=u.exec(c);if(b)return this.path=c,this.href=c,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?x.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var _=a.exec(c);if(_){var w=(_=_[0]).toLowerCase();this.protocol=w,c=c.substr(_.length)}if(n||_||c.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===c.substr(0,2);!S||_&&y[_]||(c=c.substr(2),this.slashes=!0)}if(!y[_]&&(S||_&&!v[_])){for(var A,M,T=-1,E=0;E<3;E++)-1!==(P=c.indexOf(p[E]))&&(-1===T||P<T)&&(T=P);for(-1!==(M=-1===T?c.lastIndexOf("@"):c.lastIndexOf("@",T))&&(A=c.slice(0,M),c=c.slice(M+1),this.auth=decodeURIComponent(A)),T=-1,E=0;E<d.length;E++){var P;-1!==(P=c.indexOf(d[E]))&&(-1===T||P<T)&&(T=P)}-1===T&&(T=c.length),this.host=c.slice(0,T),c=c.slice(T),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var I=this.hostname.split(/\./),R=(E=0,I.length);E<R;E++){var O=I[E];if(O&&!O.match(f)){for(var q="",L=0,D=O.length;L<D;L++)O.charCodeAt(L)>127?q+="x":q+=O[L];if(!q.match(f)){var z=I.slice(0,E),k=I.slice(E+1),B=O.match(m);B&&(z.push(B[1]),k.unshift(B[2])),k.length&&(c="/"+k.join(".")+c),this.hostname=z.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=o.toASCII(this.hostname));var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==c[0]&&(c="/"+c))}if(!g[w])for(E=0,R=h.length;E<R;E++){var N=h[E];if(-1!==c.indexOf(N)){var U=encodeURIComponent(N);U===N&&(U=escape(N)),c=c.split(N).join(U)}}var j=c.indexOf("#");-1!==j&&(this.hash=c.substr(j),c=c.slice(0,j));var G=c.indexOf("?");if(-1!==G?(this.search=c.substr(G),this.query=c.substr(G+1),e&&(this.query=x.parse(this.query)),c=c.slice(0,G)):e&&(this.search="",this.query={}),c&&(this.pathname=c),v[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var H=this.search||"";this.path=F+H}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(o=x.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||v[e])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),e+r+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+i},i.prototype.resolve=function(t){return this.resolveObject(r(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(s.isString(t)){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var l=Object.keys(t),u=0;u<l.length;u++){var c=l[u];"protocol"!==c&&(n[c]=t[c])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!v[t.protocol]){for(var h=Object.keys(t),d=0;d<h.length;d++){var p=h[d];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||y[t.protocol])n.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",g=n.search||"";n.path=m+g}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var x=n.pathname&&"/"===n.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),_=b||x||n.host&&t.pathname,w=_,S=n.pathname&&n.pathname.split("/")||[],A=(f=t.pathname&&t.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),_=_&&(""===f[0]||""===S[0])),b)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,S=f;else if(f.length)S||(S=[]),S.pop(),S=S.concat(f),n.search=t.search,n.query=t.query;else if(!s.isNullOrUndefined(t.search))return A&&(n.hostname=n.host=S.shift(),(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift())),n.search=t.search,n.query=t.query,s.isNull(n.pathname)&&s.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=S.slice(-1)[0],T=(n.host||t.host||S.length>1)&&("."===M||".."===M)||""===M,E=0,P=S.length;P>=0;P--)"."===(M=S[P])?S.splice(P,1):".."===M?(S.splice(P,1),E++):E&&(S.splice(P,1),E--);if(!_&&!w)for(;E--;E)S.unshift("..");!_||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),T&&"/"!==S.join("/").substr(-1)&&S.push("");var C,I=""===S[0]||S[0]&&"/"===S[0].charAt(0);return A&&(n.hostname=n.host=I?"":S.length?S.shift():"",(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift())),(_=_||n.host&&S.length)&&!I&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),s.isNull(n.pathname)&&s.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=l.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},2502:t=>{"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},9477:(t,e,n)=>{"use strict";function i(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(fo[255&t]+fo[t>>8&255]+fo[t>>16&255]+fo[t>>24&255]+"-"+fo[255&e]+fo[e>>8&255]+"-"+fo[e>>16&15|64]+fo[e>>24&255]+"-"+fo[63&n|128]+fo[n>>8&255]+"-"+fo[n>>16&255]+fo[n>>24&255]+fo[255&i]+fo[i>>8&255]+fo[i>>16&255]+fo[i>>24&255]).toLowerCase()}function r(t,e,n){return Math.max(e,Math.min(n,t))}function o(t,e){return(t%e+e)%e}function s(t,e,n){return(1-n)*t+n*e}function a(t){return 0==(t&t-1)&&0!==t}function l(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function u(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function c(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}function h(t,e){return new _o[t](e)}function d(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function p(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function f(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function m(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function g(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}function y(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Io.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}function v(t,e,n,i,r){for(let o=0,s=t.length-3;o<=s;o+=3){rs.fromArray(t,o);const s=r.x*Math.abs(rs.x)+r.y*Math.abs(rs.y)+r.z*Math.abs(rs.z),a=e.dot(rs),l=n.dot(rs),u=i.dot(rs);if(Math.max(-Math.max(a,l,u),Math.min(a,l,u))>s)return!1}return!0}function x(t,e,n,i,r,o,s,a,l,u,c,h){Pa.fromBufferAttribute(r,u),Ca.fromBufferAttribute(r,c),Ia.fromBufferAttribute(r,h);const d=t.morphTargetInfluences;if(o&&d){La.set(0,0,0),Da.set(0,0,0),za.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=d[t],n=o[t];0!==e&&(Ra.fromBufferAttribute(n,u),Oa.fromBufferAttribute(n,c),qa.fromBufferAttribute(n,h),s?(La.addScaledVector(Ra,e),Da.addScaledVector(Oa,e),za.addScaledVector(qa,e)):(La.addScaledVector(Ra.sub(Pa),e),Da.addScaledVector(Oa.sub(Ca),e),za.addScaledVector(qa.sub(Ia),e)))}Pa.add(La),Ca.add(Da),Ia.add(za)}t.isSkinnedMesh&&(t.boneTransform(u,Pa),t.boneTransform(c,Ca),t.boneTransform(h,Ia));const p=function(t,e,n,i,r,o,s,a){let l;if(l=e.side===dn?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,e.side!==pn,a),null===l)return null;Na.copy(a),Na.applyMatrix4(t.matrixWorld);const u=n.ray.origin.distanceTo(Na);return u<n.near||u>n.far?null:{distance:u,point:Na.clone(),object:t}}(t,e,n,i,Pa,Ca,Ia,Va);if(p){a&&(ka.fromBufferAttribute(a,u),Ba.fromBufferAttribute(a,c),Fa.fromBufferAttribute(a,h),p.uv=ta.getUV(Va,Pa,Ca,Ia,ka,Ba,Fa,new xo)),l&&(ka.fromBufferAttribute(l,u),Ba.fromBufferAttribute(l,c),Fa.fromBufferAttribute(l,h),p.uv2=ta.getUV(Va,Pa,Ca,Ia,ka,Ba,Fa,new xo));const t={a:u,b:c,c:h,normal:new Uo,materialIndex:0};ta.getNormal(Pa,Ca,Ia,t.normal),p.face=t}return p}function b(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function _(t){const e={};for(let n=0;n<t.length;n++){const i=b(t[n]);for(const t in i)e[t]=i[t]}return e}function w(){function t(n,o){i(n,o),r=e.requestAnimationFrame(t)}let e=null,n=!1,i=null,r=null;return{start:function(){!0!==n&&null!==i&&(r=e.requestAnimationFrame(t),n=!0)},stop:function(){e.cancelAnimationFrame(r),n=!1},setAnimationLoop:function(t){i=t},setContext:function(t){e=t}}}function S(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const o=i.get(e);void 0===o?i.set(e,function(e,i){const r=e.array,o=e.usage,s=t.createBuffer();let a;if(t.bindBuffer(i,s),t.bufferData(i,r,o),e.onUploadCallback(),r instanceof Float32Array)a=5126;else if(r instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(r instanceof Int16Array)a=5122;else if(r instanceof Uint32Array)a=5125;else if(r instanceof Int32Array)a=5124;else if(r instanceof Int8Array)a=5120;else if(r instanceof Uint8Array)a=5121;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);a=5121}return{buffer:s,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):o.version<e.version&&(function(e,i,r){const o=i.array,s=i.updateRange;t.bindBuffer(r,e),-1===s.count?t.bufferSubData(r,0,o):(n?t.bufferSubData(r,s.offset*o.BYTES_PER_ELEMENT,o,s.offset,s.count):t.bufferSubData(r,s.offset*o.BYTES_PER_ELEMENT,o.subarray(s.offset,s.offset+s.count)),s.count=-1)}(o.buffer,e,r),o.version=e.version)}}}function A(t,e,n,i,r,o){function s(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,o)}const a=new Po(0);let l,u,c=!0===r?0:1,h=null,d=0,p=null;return{getClearColor:function(){return a},setClearColor:function(t,e=1){a.set(t),c=e,s(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,s(a,c)},render:function(n,r){let o=!1,f=!0===r.isScene?r.background:null;f&&f.isTexture&&(f=e.get(f));const m=t.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(f=null),null===f?s(a,c):f&&f.isColor&&(s(f,1),o=!0),(t.autoClear||o)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&(f.isCubeTexture||f.mapping===si)?(void 0===u&&(u=new Ua(new ja(1,1,1),new Ha({name:"BackgroundCubeMaterial",uniforms:b(ll.cube.uniforms),vertexShader:ll.cube.vertexShader,fragmentShader:ll.cube.fragmentShader,side:dn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=f,u.material.uniforms.flipEnvMap.value=f.isCubeTexture&&!1===f.isRenderTargetTexture?-1:1,h===f&&d===f.version&&p===t.toneMapping||(u.material.needsUpdate=!0,h=f,d=f.version,p=t.toneMapping),u.layers.enableAll(),n.unshift(u,u.geometry,u.material,0,0,null)):f&&f.isTexture&&(void 0===l&&(l=new Ua(new ol(2,2),new Ha({name:"BackgroundMaterial",uniforms:b(ll.background.uniforms),vertexShader:ll.background.vertexShader,fragmentShader:ll.background.fragmentShader,side:hn,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),l.material.uniforms.uvTransform.value.copy(f.matrix),h===f&&d===f.version&&p===t.toneMapping||(l.material.needsUpdate=!0,h=f,d=f.version,p=t.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null))}}}function M(t,e,n,i){function r(e){return i.isWebGL2?t.bindVertexArray(e):m.bindVertexArrayOES(e)}function o(e){return i.isWebGL2?t.deleteVertexArray(e):m.deleteVertexArrayOES(e)}function s(t){const e=[],n=[],i=[];for(let t=0;t<f;t++)e[t]=0,n[t]=0,i[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function a(){const t=x.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function l(t){u(t,0)}function u(n,r){const o=x.newAttributes,s=x.enabledAttributes,a=x.attributeDivisors;o[n]=1,0===s[n]&&(t.enableVertexAttribArray(n),s[n]=1),a[n]!==r&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),a[n]=r)}function c(){const e=x.newAttributes,n=x.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function h(e,n,r,o,s,a){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,o,s,a):t.vertexAttribIPointer(e,n,r,s,a)}function d(){p(),b=!0,x!==v&&(x=v,r(x.object))}function p(){v.geometry=null,v.program=null,v.wireframe=!1}const f=t.getParameter(34921),m=i.isWebGL2?null:e.get("OES_vertex_array_object"),g=i.isWebGL2||null!==m,y={},v=s(null);let x=v,b=!1;return{setup:function(o,d,p,f,v){let _=!1;if(g){const e=function(e,n,r){const o=!0===r.wireframe;let a=y[e.id];void 0===a&&(a={},y[e.id]=a);let l=a[n.id];void 0===l&&(l={},a[n.id]=l);let u=l[o];return void 0===u&&(u=s(i.isWebGL2?t.createVertexArray():m.createVertexArrayOES()),l[o]=u),u}(f,p,d);x!==e&&(x=e,r(x.object)),_=function(t,e,n,i){const r=x.attributes,o=e.attributes;let s=0;const a=n.getAttributes();for(const e in a)if(a[e].location>=0){const n=r[e];let i=o[e];if(void 0===i&&("instanceMatrix"===e&&t.instanceMatrix&&(i=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(i=t.instanceColor)),void 0===n)return!0;if(n.attribute!==i)return!0;if(i&&n.data!==i.data)return!0;s++}return x.attributesNum!==s||x.index!==i}(o,f,p,v),_&&function(t,e,n,i){const r={},o=e.attributes;let s=0;const a=n.getAttributes();for(const e in a)if(a[e].location>=0){let n=o[e];void 0===n&&("instanceMatrix"===e&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(n=t.instanceColor));const i={};i.attribute=n,n&&n.data&&(i.data=n.data),r[e]=i,s++}x.attributes=r,x.attributesNum=s,x.index=i}(o,f,p,v)}else{const t=!0===d.wireframe;x.geometry===f.id&&x.program===p.id&&x.wireframe===t||(x.geometry=f.id,x.program=p.id,x.wireframe=t,_=!0)}null!==v&&n.update(v,34963),(_||b)&&(b=!1,function(r,o,s,d){if(!1===i.isWebGL2&&(r.isInstancedMesh||d.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;a();const p=d.attributes,f=s.getAttributes(),m=o.defaultAttributeValues;for(const e in f){const i=f[e];if(i.location>=0){let o=p[e];if(void 0===o&&("instanceMatrix"===e&&r.instanceMatrix&&(o=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(o=r.instanceColor)),void 0!==o){const e=o.normalized,s=o.itemSize,a=n.get(o);if(void 0===a)continue;const c=a.buffer,p=a.type,f=a.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,a=n.stride,m=o.offset;if(n.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)u(i.location+t,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===d._maxInstanceCount&&(d._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<i.locationSize;t++)l(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)h(i.location+t,s/i.locationSize,p,e,a*f,(m+s/i.locationSize*t)*f)}else{if(o.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)u(i.location+t,o.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===d._maxInstanceCount&&(d._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let t=0;t<i.locationSize;t++)l(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)h(i.location+t,s/i.locationSize,p,e,s*f,s/i.locationSize*t*f)}}else if(void 0!==m){const n=m[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(i.location,n);break;case 3:t.vertexAttrib3fv(i.location,n);break;case 4:t.vertexAttrib4fv(i.location,n);break;default:t.vertexAttrib1fv(i.location,n)}}}}c()}(o,d,p,f),null!==v&&t.bindBuffer(34963,n.get(v).buffer))},reset:d,resetDefaultState:p,dispose:function(){d();for(const t in y){const e=y[t];for(const t in e){const n=e[t];for(const t in n)o(n[t].object),delete n[t];delete e[t]}delete y[t]}},releaseStatesOfGeometry:function(t){if(void 0===y[t.id])return;const e=y[t.id];for(const t in e){const n=e[t];for(const t in n)o(n[t].object),delete n[t];delete e[t]}delete y[t.id]},releaseStatesOfProgram:function(t){for(const e in y){const n=y[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)o(i[t].object),delete i[t];delete n[t.id]}},initAttributes:a,enableAttribute:l,disableUnusedAttributes:c}}function T(t,e,n,i){const r=i.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,i){t.drawArrays(o,e,i),n.update(i,o,1)},this.renderInstances=function(i,s,a){if(0===a)return;let l,u;if(r)l=t,u="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](o,i,s,a),n.update(s,o,a)}}function E(t,e,n){function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let r;const o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=o||e.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),m=t.getParameter(36347),g=t.getParameter(36348),y=t.getParameter(36349),v=h>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:x,floatVertexTextures:v&&x,maxSamples:o?t.getParameter(36183):0}}function P(t){function e(){c.value!==r&&(c.value=r,c.needsUpdate=o>0),i.numPlanes=o,i.numIntersection=0}function n(t,e,n,r){const o=null!==t?t.length:0;let s=null;if(0!==o){if(s=c.value,!0!==r||null===s){const i=n+4*o,r=e.matrixWorldInverse;u.getNormalMatrix(r),(null===s||s.length<i)&&(s=new Float32Array(i));for(let e=0,i=n;e!==o;++e,i+=4)l.copy(t[e]).applyMatrix4(r,u),l.normal.toArray(s,i),s[i+3]=l.constant}c.value=s,c.needsUpdate=!0}return i.numPlanes=o,i.numIntersection=0,s}const i=this;let r=null,o=0,s=!1,a=!1;const l=new el,u=new bo,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,i){const a=0!==t.length||e||0!==o||s;return s=e,r=n(t,i,0),o=t.length,a},this.beginShadows=function(){a=!0,n(null)},this.endShadows=function(){a=!1,e()},this.setState=function(i,l,u){const h=i.clippingPlanes,d=i.clipIntersection,p=i.clipShadows,f=t.get(i);if(!s||null===h||0===h.length||a&&!p)a?n(null):e();else{const t=a?0:o,e=4*t;let i=f.clippingState||null;c.value=i,i=n(h,l,e,u);for(let t=0;t!==e;++t)i[t]=r[t];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function C(t){function e(t,e){return e===ri?t.mapping=ni:e===oi&&(t.mapping=ii),t}function n(t){const e=t.target;e.removeEventListener("dispose",n);const r=i.get(e);void 0!==r&&(i.delete(e),r.dispose())}let i=new WeakMap;return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const o=r.mapping;if(o===ri||o===oi){if(i.has(r))return e(i.get(r).texture,r.mapping);{const o=r.image;if(o&&o.height>0){const s=new Ja(o.height/2);return s.fromEquirectangularTexture(t,r),i.set(r,s),r.addEventListener("dispose",n),e(s.texture,r.mapping)}return null}}}return r},dispose:function(){i=new WeakMap}}}function I(t,e,n){const i=new Do(t,e,n);return i.texture.mapping=si,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function R(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function O(){return new Ha({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:gn,depthTest:!1,depthWrite:!1})}function q(){return new Ha({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:gn,depthTest:!1,depthWrite:!1})}function L(t){function e(t){const i=t.target;i.removeEventListener("dispose",e);const r=n.get(i);void 0!==r&&(n.delete(i),r.dispose())}let n=new WeakMap,i=null;return{get:function(r){if(r&&r.isTexture){const o=r.mapping,s=o===ri||o===oi,a=o===ni||o===ii;if(s||a){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let e=n.get(r);return null===i&&(i=new yl(t)),e=s?i.fromEquirectangular(r,e):i.fromCubemap(r,e),n.set(r,e),e.texture}if(n.has(r))return n.get(r).texture;{const o=r.image;if(s&&o&&o.height>0||a&&o&&function(t){let e=0;for(let n=0;n<6;n++)void 0!==t[n]&&e++;return 6===e}(o)){null===i&&(i=new yl(t));const o=s?i.fromEquirectangular(r):i.fromCubemap(r);return n.set(r,o),r.addEventListener("dispose",e),o.texture}return null}}}return r},dispose:function(){n=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function D(t){function e(e){if(void 0!==n[e])return n[e];let i;switch(e){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(e)}return n[e]=i,i}const n={};return{has:function(t){return null!==e(t)},init:function(t){t.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture")},get:function(t){const n=e(t);return null===n&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),n}}}function z(t,e,n,i){function r(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const t in o.attributes)e.remove(o.attributes[t]);o.removeEventListener("dispose",r),delete s[o.id];const l=a.get(o);l&&(e.remove(l),a.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(t){const n=[],i=t.index,r=t.attributes.position;let o=0;if(null!==i){const t=i.array;o=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],o=t[e+2];n.push(i,r,r,o,o,i)}}else{const t=r.array;o=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}const s=new(c(n)?pa:ha)(n,1);s.version=o;const l=a.get(t);l&&e.remove(l),a.set(t,s)}const s={},a=new WeakMap;return{get:function(t,e){return!0===s[e.id]||(e.addEventListener("dispose",r),s[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const t in n)e.update(n[t],34962);const i=t.morphAttributes;for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t++)e.update(n[t],34962)}},getWireframeAttribute:function(t){const e=a.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return a.get(t)}}}function k(t,e,n,i){const r=i.isWebGL2;let o,s,a;this.setMode=function(t){o=t},this.setIndex=function(t){s=t.type,a=t.bytesPerElement},this.render=function(e,i){t.drawElements(o,i,s,e*a),n.update(i,o,1)},this.renderInstances=function(i,l,u){if(0===u)return;let c,h;if(r)c=t,h="drawElementsInstanced";else if(c=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===c)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](o,l,s,i*a,u),n.update(l,o,u)}}function B(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function F(t,e){return t[0]-e[0]}function V(t,e){return Math.abs(e[1])-Math.abs(t[1])}function N(t,e){let n=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),t.divideScalar(n)}function U(t,e,n){const i={},r=new Float32Array(8),o=new WeakMap,s=new Lo,a=[];for(let t=0;t<8;t++)a[t]=[t,0];return{update:function(l,u,c,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,f=void 0!==p?p.length:0;let m=o.get(u);if(void 0===m||m.count!==f){void 0!==m&&m.texture.dispose();const v=void 0!==u.morphAttributes.position,x=void 0!==u.morphAttributes.normal,b=void 0!==u.morphAttributes.color,_=u.morphAttributes.position||[],w=u.morphAttributes.normal||[],S=u.morphAttributes.color||[];let A=0;!0===v&&(A=1),!0===x&&(A=2),!0===b&&(A=3);let M=u.attributes.position.count*A,T=1;M>e.maxTextureSize&&(T=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const E=new Float32Array(M*T*4*f),P=new zo(E,M,T,f);P.type=Ti,P.needsUpdate=!0;const C=4*A;for(let R=0;R<f;R++){const O=_[R],q=w[R],L=S[R],D=M*T*4*R;for(let z=0;z<O.count;z++){const k=z*C;!0===v&&(s.fromBufferAttribute(O,z),!0===O.normalized&&N(s,O),E[D+k+0]=s.x,E[D+k+1]=s.y,E[D+k+2]=s.z,E[D+k+3]=0),!0===x&&(s.fromBufferAttribute(q,z),!0===q.normalized&&N(s,q),E[D+k+4]=s.x,E[D+k+5]=s.y,E[D+k+6]=s.z,E[D+k+7]=0),!0===b&&(s.fromBufferAttribute(L,z),!0===L.normalized&&N(s,L),E[D+k+8]=s.x,E[D+k+9]=s.y,E[D+k+10]=s.z,E[D+k+11]=4===L.itemSize?s.w:1)}}function I(){P.dispose(),o.delete(u),u.removeEventListener("dispose",I)}m={count:f,texture:P,size:new xo(M,T)},o.set(u,m),u.addEventListener("dispose",I)}let g=0;for(let B=0;B<d.length;B++)g+=d[B];const y=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(t,"morphTargetBaseInfluence",y),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",m.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",m.size)}else{const U=void 0===d?0:d.length;let j=i[u.id];if(void 0===j||j.length!==U){j=[];for(let Y=0;Y<U;Y++)j[Y]=[Y,0];i[u.id]=j}for(let Z=0;Z<U;Z++){const Q=j[Z];Q[0]=Z,Q[1]=d[Z]}j.sort(V);for(let J=0;J<8;J++)J<U&&j[J][1]?(a[J][0]=j[J][0],a[J][1]=j[J][1]):(a[J][0]=Number.MAX_SAFE_INTEGER,a[J][1]=0);a.sort(F);const G=u.morphAttributes.position,H=u.morphAttributes.normal;let W=0;for(let K=0;K<8;K++){const $=a[K],tt=$[0],et=$[1];tt!==Number.MAX_SAFE_INTEGER&&et?(G&&u.getAttribute("morphTarget"+K)!==G[tt]&&u.setAttribute("morphTarget"+K,G[tt]),H&&u.getAttribute("morphNormal"+K)!==H[tt]&&u.setAttribute("morphNormal"+K,H[tt]),r[K]=et,W+=et):(G&&!0===u.hasAttribute("morphTarget"+K)&&u.deleteAttribute("morphTarget"+K),H&&!0===u.hasAttribute("morphNormal"+K)&&u.deleteAttribute("morphNormal"+K),r[K]=0)}const X=u.morphTargetsRelative?1:1-W;h.getUniforms().setValue(t,"morphTargetBaseInfluence",X),h.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function j(t,e,n,i){function r(t){const e=t.target;e.removeEventListener("dispose",r),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}let o=new WeakMap;return{update:function(t){const s=i.render.frame,a=t.geometry,l=e.get(t,a);return o.get(l)!==s&&(e.update(l),o.set(l,s)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",r)&&t.addEventListener("dispose",r),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){o=new WeakMap}}}function G(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let o=wl[r];if(void 0===o&&(o=new Float32Array(r),wl[r]=o),0!==e){i.toArray(o,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(o,r)}return o}function H(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function W(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function X(t,e){let n=Sl[e];void 0===n&&(n=new Int32Array(e),Sl[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Y(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Z(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(H(n,e))return;t.uniform2fv(this.addr,e),W(n,e)}}function Q(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(H(n,e))return;t.uniform3fv(this.addr,e),W(n,e)}}function J(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(H(n,e))return;t.uniform4fv(this.addr,e),W(n,e)}}function K(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(H(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),W(n,e)}else{if(H(n,i))return;Tl.set(i),t.uniformMatrix2fv(this.addr,!1,Tl),W(n,i)}}function $(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(H(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),W(n,e)}else{if(H(n,i))return;Ml.set(i),t.uniformMatrix3fv(this.addr,!1,Ml),W(n,i)}}function tt(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(H(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),W(n,e)}else{if(H(n,i))return;Al.set(i),t.uniformMatrix4fv(this.addr,!1,Al),W(n,i)}}function et(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function nt(t,e){const n=this.cache;H(n,e)||(t.uniform2iv(this.addr,e),W(n,e))}function it(t,e){const n=this.cache;H(n,e)||(t.uniform3iv(this.addr,e),W(n,e))}function rt(t,e){const n=this.cache;H(n,e)||(t.uniform4iv(this.addr,e),W(n,e))}function ot(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function st(t,e){const n=this.cache;H(n,e)||(t.uniform2uiv(this.addr,e),W(n,e))}function at(t,e){const n=this.cache;H(n,e)||(t.uniform3uiv(this.addr,e),W(n,e))}function lt(t,e){const n=this.cache;H(n,e)||(t.uniform4uiv(this.addr,e),W(n,e))}function ut(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||vl,r)}function ct(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||bl,r)}function ht(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||_l,r)}function dt(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||xl,r)}function pt(t,e){t.uniform1fv(this.addr,e)}function ft(t,e){const n=G(e,this.size,2);t.uniform2fv(this.addr,n)}function mt(t,e){const n=G(e,this.size,3);t.uniform3fv(this.addr,n)}function gt(t,e){const n=G(e,this.size,4);t.uniform4fv(this.addr,n)}function yt(t,e){const n=G(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function vt(t,e){const n=G(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function xt(t,e){const n=G(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function bt(t,e){t.uniform1iv(this.addr,e)}function _t(t,e){t.uniform2iv(this.addr,e)}function wt(t,e){t.uniform3iv(this.addr,e)}function St(t,e){t.uniform4iv(this.addr,e)}function At(t,e){t.uniform1uiv(this.addr,e)}function Mt(t,e){t.uniform2uiv(this.addr,e)}function Tt(t,e){t.uniform3uiv(this.addr,e)}function Et(t,e){t.uniform4uiv(this.addr,e)}function Pt(t,e,n){const i=e.length,r=X(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture2D(e[t]||vl,r[t])}function Ct(t,e,n){const i=e.length,r=X(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture3D(e[t]||bl,r[t])}function It(t,e,n){const i=e.length,r=X(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTextureCube(e[t]||_l,r[t])}function Rt(t,e,n){const i=e.length,r=X(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture2DArray(e[t]||xl,r[t])}function Ot(t,e){t.seq.push(e),t.map[e.id]=e}function qt(t,e,n){const i=t.name,r=i.length;for(Il.lastIndex=0;;){const o=Il.exec(i),s=Il.lastIndex;let a=o[1];const l="]"===o[2],u=o[3];if(l&&(a|=0),void 0===u||"["===u&&s+2===r){Ot(n,void 0===u?new El(a,t,e):new Pl(a,t,e));break}{let t=n.map[a];void 0===t&&(t=new Cl(a),Ot(n,t)),n=t}}}function Lt(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function Dt(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&""===r)return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const i=parseInt(o[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){const n=t.split("\n"),i=[],r=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let t=r;t<o;t++){const r=t+1;i.push(`${r===e?">":" "} ${r}: ${n[t]}`)}return i.join("\n")}(t.getShaderSource(e),i)}return r}function zt(t,e){const n=function(t){switch(t){case Cr:return["Linear","( value )"];case Ir:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function kt(t,e){let n;switch(e){case Qn:n="Linear";break;case Jn:n="Reinhard";break;case Kn:n="OptimizedCineon";break;case $n:n="ACESFilmic";break;case ti:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Bt(t){return""!==t}function Ft(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Vt(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Nt(t){return t.replace(ql,Ut)}function Ut(t,e){const n=sl[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Nt(n)}function jt(t){return t.replace(Dl,Ht).replace(Ll,Gt)}function Gt(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ht(t,e,n,i)}function Ht(t,e,n,i){let r="";for(let t=parseInt(e);t<parseInt(n);t++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function Wt(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Xt(t,e,n,i){const r=t.getContext(),o=n.defines;let s=n.vertexShader,a=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===ln?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===un?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===cn&&(e="SHADOWMAP_TYPE_VSM"),e}(n),u=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ni:case ii:e="ENVMAP_TYPE_CUBE";break;case si:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),c=function(t){let e="ENVMAP_MODE_REFLECTION";return t.envMap&&t.envMapMode===ii&&(e="ENVMAP_MODE_REFRACTION"),e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Wn:e="ENVMAP_BLENDING_MULTIPLY";break;case Xn:e="ENVMAP_BLENDING_MIX";break;case Yn:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),p=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Bt).join("\n")}(n),f=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(o),m=r.createProgram();let g,y,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=[f].filter(Bt).join("\n"),g.length>0&&(g+="\n"),y=[p,f].filter(Bt).join("\n"),y.length>0&&(y+="\n")):(g=[Wt(n),"#define SHADER_NAME "+n.shaderName,f,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Bt).join("\n"),y=[p,Wt(n),"#define SHADER_NAME "+n.shaderName,f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Zn?"#define TONE_MAPPING":"",n.toneMapping!==Zn?sl.tonemapping_pars_fragment:"",n.toneMapping!==Zn?kt("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",sl.encodings_pars_fragment,zt("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Bt).join("\n")),s=Nt(s),s=Ft(s,n),s=Vt(s,n),a=Nt(a),a=Ft(a,n),a=Vt(a,n),s=jt(s),a=jt(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in",n.glslVersion===co?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===co?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const x=v+y+a,b=Lt(r,35633,v+g+s),_=Lt(r,35632,x);if(r.attachShader(m,b),r.attachShader(m,_),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(m).trim(),e=r.getShaderInfoLog(b).trim(),n=r.getShaderInfoLog(_).trim();let i=!0,o=!0;if(!1===r.getProgramParameter(m,35714)){i=!1;const e=Dt(r,b,"vertex"),n=Dt(r,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+n)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==n||(o=!1);o&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:y}})}let w,S;return r.deleteShader(b),r.deleteShader(_),this.getUniforms=function(){return void 0===w&&(w=new Rl(r,m)),w},this.getAttributes=function(){return void 0===S&&(S=function(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),o=i.name;let s=1;35674===i.type&&(s=2),35675===i.type&&(s=3),35676===i.type&&(s=4),n[o]={type:i.type,location:t.getAttribLocation(e,o),locationSize:s}}return n}(r,m)),S},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=Ol++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=_,this}function Yt(t,e,n,i,r,o,s){const a=new Cs,l=new kl,u=[],c=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,a,u,m,g){const y=m.fog,v=g.geometry,x=o.isMeshStandardMaterial?m.environment:null,b=(o.isMeshStandardMaterial?n:e).get(o.envMap||x),_=b&&b.mapping===si?b.image.height:null,w=f[o.type];null!==o.precision&&(p=r.getMaxPrecision(o.precision),p!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",p,"instead."));const S=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,A=void 0!==S?S.length:0;let M,T,E,P,C=0;if(void 0!==v.morphAttributes.position&&(C=1),void 0!==v.morphAttributes.normal&&(C=2),void 0!==v.morphAttributes.color&&(C=3),w){const t=ll[w];M=t.vertexShader,T=t.fragmentShader}else M=o.vertexShader,T=o.fragmentShader,l.update(o),E=l.getVertexShaderID(o),P=l.getFragmentShaderID(o);const I=t.getRenderTarget(),R=o.alphaTest>0,O=o.clearcoat>0,q=o.iridescence>0;return{isWebGL2:c,shaderID:w,shaderName:o.type,vertexShader:M,fragmentShader:T,defines:o.defines,customVertexShaderID:E,customFragmentShaderID:P,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:p,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:d,outputEncoding:null===I?t.outputEncoding:!0===I.isXRRenderTarget?I.texture.encoding:Cr,map:!!o.map,matcap:!!o.matcap,envMap:!!b,envMapMode:b&&b.mapping,envMapCubeUVHeight:_,lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===Lr,tangentSpaceNormalMap:o.normalMapType===qr,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===Ir,clearcoat:O,clearcoatMap:O&&!!o.clearcoatMap,clearcoatRoughnessMap:O&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!o.clearcoatNormalMap,iridescence:q,iridescenceMap:q&&!!o.iridescenceMap,iridescenceThicknessMap:q&&!!o.iridescenceThicknessMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,opaque:!1===o.transparent&&o.blending===yn,alphaMap:!!o.alphaMap,alphaTest:R,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!v.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!v.attributes.color&&4===v.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.iridescenceMap||o.iridescenceThicknessMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheenColorMap||o.sheenRoughnessMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.iridescenceMap||o.iridescenceThicknessMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap||!o.displacementMap),fog:!!y,useFog:!0===o.fog,fogExp2:y&&y.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==v.morphAttributes.position,morphNormals:void 0!==v.morphAttributes.normal,morphColors:void 0!==v.morphAttributes.color,morphTargetsCount:A,morphTextureStride:C,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:Zn,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===pn,flipSided:o.side===dn,useDepthPacking:!!o.depthPacking,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||i.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){a.disableAll(),e.isWebGL2&&a.enable(0),e.supportsVertexTextures&&a.enable(1),e.instancing&&a.enable(2),e.instancingColor&&a.enable(3),e.map&&a.enable(4),e.matcap&&a.enable(5),e.envMap&&a.enable(6),e.lightMap&&a.enable(7),e.aoMap&&a.enable(8),e.emissiveMap&&a.enable(9),e.bumpMap&&a.enable(10),e.normalMap&&a.enable(11),e.objectSpaceNormalMap&&a.enable(12),e.tangentSpaceNormalMap&&a.enable(13),e.clearcoat&&a.enable(14),e.clearcoatMap&&a.enable(15),e.clearcoatRoughnessMap&&a.enable(16),e.clearcoatNormalMap&&a.enable(17),e.iridescence&&a.enable(18),e.iridescenceMap&&a.enable(19),e.iridescenceThicknessMap&&a.enable(20),e.displacementMap&&a.enable(21),e.specularMap&&a.enable(22),e.roughnessMap&&a.enable(23),e.metalnessMap&&a.enable(24),e.gradientMap&&a.enable(25),e.alphaMap&&a.enable(26),e.alphaTest&&a.enable(27),e.vertexColors&&a.enable(28),e.vertexAlphas&&a.enable(29),e.vertexUvs&&a.enable(30),e.vertexTangents&&a.enable(31),e.uvsVertexOnly&&a.enable(32),e.fog&&a.enable(33),t.push(a.mask),a.disableAll(),e.useFog&&a.enable(0),e.flatShading&&a.enable(1),e.logarithmicDepthBuffer&&a.enable(2),e.skinning&&a.enable(3),e.morphTargets&&a.enable(4),e.morphNormals&&a.enable(5),e.morphColors&&a.enable(6),e.premultipliedAlpha&&a.enable(7),e.shadowMapEnabled&&a.enable(8),e.physicallyCorrectLights&&a.enable(9),e.doubleSided&&a.enable(10),e.flipSided&&a.enable(11),e.useDepthPacking&&a.enable(12),e.dithering&&a.enable(13),e.specularIntensityMap&&a.enable(14),e.specularColorMap&&a.enable(15),e.transmission&&a.enable(16),e.transmissionMap&&a.enable(17),e.thicknessMap&&a.enable(18),e.sheen&&a.enable(19),e.sheenColorMap&&a.enable(20),e.sheenRoughnessMap&&a.enable(21),e.decodeVideoTexture&&a.enable(22),e.opaque&&a.enable(23),t.push(a.mask)}(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=f[t.type];let n;if(e){const t=ll[e];n=Ga.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,e=u.length;t<e;t++){const e=u[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new Xt(t,n,e,o),u.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:u,dispose:function(){l.dispose()}}}function Zt(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function Qt(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Jt(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Kt(){function t(t,i,r,o,s,a){let l=e[n];return void 0===l?(l={id:t.id,object:t,geometry:i,material:r,groupOrder:o,renderOrder:t.renderOrder,z:s,group:a},e[n]=l):(l.id=t.id,l.object=t,l.geometry=i,l.material=r,l.groupOrder=o,l.renderOrder=t.renderOrder,l.z=s,l.group=a),n++,l}const e=[];let n=0;const i=[],r=[],o=[];return{opaque:i,transmissive:r,transparent:o,init:function(){n=0,i.length=0,r.length=0,o.length=0},push:function(e,n,s,a,l,u){const c=t(e,n,s,a,l,u);s.transmission>0?r.push(c):!0===s.transparent?o.push(c):i.push(c)},unshift:function(e,n,s,a,l,u){const c=t(e,n,s,a,l,u);s.transmission>0?r.unshift(c):!0===s.transparent?o.unshift(c):i.unshift(c)},finish:function(){for(let t=n,i=e.length;t<i;t++){const n=e[t];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.group=null}},sort:function(t,e){i.length>1&&i.sort(t||Qt),r.length>1&&r.sort(e||Jt),o.length>1&&o.sort(e||Jt)}}}function $t(){let t=new WeakMap;return{get:function(e,n){let i;return!1===t.has(e)?(i=new Kt,t.set(e,[i])):n>=t.get(e).length?(i=new Kt,t.get(e).push(i)):i=t.get(e)[n],i},dispose:function(){t=new WeakMap}}}function te(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Uo,color:new Po};break;case"SpotLight":n={position:new Uo,direction:new Uo,color:new Po,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Uo,color:new Po,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Uo,skyColor:new Po,groundColor:new Po};break;case"RectAreaLight":n={color:new Po,position:new Uo,halfWidth:new Uo,halfHeight:new Uo}}return t[e.id]=n,n}}}function ee(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function ne(t,e){const n=new te,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xo};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xo,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)r.probe.push(new Uo);const o=new Uo,s=new vs,a=new vs;return{setup:function(o,s){let a=0,l=0,u=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let c=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0;o.sort(ee);const v=!0!==s?Math.PI:1;for(let t=0,e=o.length;t<e;t++){const e=o[t],s=e.color,x=e.intensity,b=e.distance,_=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)a+=s.r*x*v,l+=s.g*x*v,u+=s.b*x*v;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],x);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*v),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[c]=n,r.directionalShadowMap[c]=_,r.directionalShadowMatrix[c]=e.shadow.matrix,m++}r.directional[c]=t,c++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(s).multiplyScalar(x*v),t.distance=b,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.spotShadow[d]=n,r.spotShadowMap[d]=_,r.spotShadowMatrix[d]=e.shadow.matrix,y++}r.spot[d]=t,d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(s).multiplyScalar(x),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[p]=t,p++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*v),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[h]=n,r.pointShadowMap[h]=_,r.pointShadowMatrix[h]=e.shadow.matrix,g++}r.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(x*v),t.groundColor.copy(e.groundColor).multiplyScalar(x*v),r.hemi[f]=t,f++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=al.LTC_FLOAT_1,r.rectAreaLTC2=al.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=al.LTC_HALF_1,r.rectAreaLTC2=al.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=a,r.ambient[1]=l,r.ambient[2]=u;const x=r.hash;x.directionalLength===c&&x.pointLength===h&&x.spotLength===d&&x.rectAreaLength===p&&x.hemiLength===f&&x.numDirectionalShadows===m&&x.numPointShadows===g&&x.numSpotShadows===y||(r.directional.length=c,r.spot.length=d,r.rectArea.length=p,r.point.length=h,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=y,r.spotShadowMap.length=y,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotShadowMatrix.length=y,x.directionalLength=c,x.pointLength=h,x.spotLength=d,x.rectAreaLength=p,x.hemiLength=f,x.numDirectionalShadows=m,x.numPointShadows=g,x.numSpotShadows=y,r.version=Fl++)},setupView:function(t,e){let n=0,i=0,l=0,u=0,c=0;const h=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),n++}else if(d.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const t=r.rectArea[u];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),a.identity(),s.copy(d.matrixWorld),s.premultiply(h),a.extractRotation(s),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),u++}else if(d.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),i++}else if(d.isHemisphereLight){const t=r.hemi[c];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(h),c++}}},state:r}}function ie(t,e){const n=new ne(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(t){n.setup(i,t)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function re(t,e){let n=new WeakMap;return{get:function(i,r=0){let o;return!1===n.has(i)?(o=new ie(t,e),n.set(i,[o])):r>=n.get(i).length?(o=new ie(t,e),n.get(i).push(o)):o=n.get(i)[r],o},dispose:function(){n=new WeakMap}}}function oe(t,e,n){function i(n,i){const r=e.update(v);m.defines.VSM_SAMPLES!==n.blurSamples&&(m.defines.VSM_SAMPLES=n.blurSamples,g.defines.VSM_SAMPLES=n.blurSamples,m.needsUpdate=!0,g.needsUpdate=!0),m.uniforms.shadow_pass.value=n.map.texture,m.uniforms.resolution.value=n.mapSize,m.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,m,v,null),g.uniforms.shadow_pass.value=n.mapPass.texture,g.uniforms.resolution.value=n.mapSize,g.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,g,v,null)}function r(e,n,i,r,o,s){let a=null;const l=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(a=void 0!==l?l:!0===i.isPointLight?h:c,t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){const t=a.uuid,e=n.uuid;let i=d[t];void 0===i&&(i={},d[t]=i);let r=i[e];void 0===r&&(r=a.clone(),i[e]=r),a=r}return a.visible=n.visible,a.wireframe=n.wireframe,a.side=s===cn?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:f[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===i.isPointLight&&!0===a.isMeshDistanceMaterial&&(a.referencePosition.setFromMatrixPosition(i.matrixWorld),a.nearDistance=r,a.farDistance=o),a}function o(n,i,a,l,u){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&u===cn)&&(!n.frustumCulled||s.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const i=e.update(n),o=n.material;if(Array.isArray(o)){const e=i.groups;for(let s=0,c=e.length;s<c;s++){const c=e[s],h=o[c.materialIndex];if(h&&h.visible){const e=r(n,h,l,a.near,a.far,u);t.renderBufferDirect(a,null,i,e,n,c)}}}else if(o.visible){const e=r(n,o,l,a.near,a.far,u);t.renderBufferDirect(a,null,i,e,n,null)}}const c=n.children;for(let t=0,e=c.length;t<e;t++)o(c[t],i,a,l,u)}let s=new rl;const a=new xo,l=new xo,u=new Lo,c=new Vl({depthPacking:Or}),h=new Nl,d={},p=n.maxTextureSize,f={0:dn,1:hn,2:pn},m=new Ha({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new xo},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),g=m.clone();g.defines.HORIZONTAL_PASS=1;const y=new Aa;y.setAttribute("position",new sa(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Ua(y,m),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ln,this.render=function(e,n,r){if(!1===x.enabled)return;if(!1===x.autoUpdate&&!1===x.needsUpdate)return;if(0===e.length)return;const c=t.getRenderTarget(),h=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),f=t.state;f.setBlending(gn),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(let c=0,h=e.length;c<h;c++){const h=e[c],d=h.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",h,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;a.copy(d.mapSize);const m=d.getFrameExtents();if(a.multiply(m),l.copy(d.mapSize),(a.x>p||a.y>p)&&(a.x>p&&(l.x=Math.floor(p/m.x),a.x=l.x*m.x,d.mapSize.x=l.x),a.y>p&&(l.y=Math.floor(p/m.y),a.y=l.y*m.y,d.mapSize.y=l.y)),null!==d.map||d.isPointLightShadow||this.type!==cn||(d.map=new Do(a.x,a.y),d.map.texture.name=h.name+".shadowMap",d.mapPass=new Do(a.x,a.y),d.camera.updateProjectionMatrix()),null===d.map){const t={minFilter:ci,magFilter:ci,format:qi};d.map=new Do(a.x,a.y,t),d.map.texture.name=h.name+".shadowMap",d.camera.updateProjectionMatrix()}t.setRenderTarget(d.map),t.clear();const g=d.getViewportCount();for(let t=0;t<g;t++){const e=d.getViewport(t);u.set(l.x*e.x,l.y*e.y,l.x*e.z,l.y*e.w),f.viewport(u),d.updateMatrices(h,t),s=d.getFrustum(),o(n,r,d.camera,h,this.type)}d.isPointLightShadow||this.type!==cn||i(d,r),d.needsUpdate=!1}x.needsUpdate=!1,t.setRenderTarget(c,h,d)}}function se(t,e,n){function i(e,n,i){const r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<i;e++)t.texImage2D(n+e,0,6408,1,1,0,6408,5121,r);return o}function r(e){!0!==m[e]&&(t.enable(e),m[e]=!0)}function o(e){!1!==m[e]&&(t.disable(e),m[e]=!1)}function s(e,n,i,s,a,l,u,c){if(e!==gn){if(!1===b&&(r(3042),b=!0),e===_n)a=a||n,l=l||i,u=u||s,n===w&&a===M||(t.blendEquationSeparate(H[n],H[a]),w=n,M=a),i===S&&s===A&&l===T&&u===E||(t.blendFuncSeparate(W[i],W[s],W[l],W[u]),S=i,A=s,T=l,E=u),_=e,P=null;else if(e!==_||c!==P){if(w===wn&&M===wn||(t.blendEquation(32774),w=wn,M=wn),c)switch(e){case yn:t.blendFuncSeparate(1,771,1,771);break;case vn:t.blendFunc(1,1);break;case xn:t.blendFuncSeparate(0,769,0,1);break;case bn:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case yn:t.blendFuncSeparate(770,771,1,771);break;case vn:t.blendFunc(770,1);break;case xn:t.blendFuncSeparate(0,769,0,1);break;case bn:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}S=null,A=null,T=null,E=null,_=e,P=c}}else!0===b&&(o(3042),b=!1)}function a(e){C!==e&&(e?t.frontFace(2304):t.frontFace(2305),C=e)}function l(e){e!==nn?(r(2884),e!==I&&(e===rn?t.cullFace(1029):e===on?t.cullFace(1028):t.cullFace(1032))):o(2884),I=e}function u(e,n,i){e?(r(32823),O===n&&q===i||(t.polygonOffset(n,i),O=n,q=i)):o(32823)}function c(e){void 0===e&&(e=33984+L-1),B!==e&&(t.activeTexture(e),B=e)}const h=n.isWebGL2,d=new function(){let e=!1;const n=new Lo;let i=null;const r=new Lo(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,o,s,a){!0===a&&(e*=s,i*=s,o*=s),n.set(e,i,o,s),!1===r.equals(n)&&(t.clearColor(e,i,o,s),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},p=new function(){let e=!1,n=null,i=null,s=null;return{setTest:function(t){t?r(2929):o(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case Bn:t.depthFunc(512);break;case Fn:t.depthFunc(519);break;case Vn:t.depthFunc(513);break;case Nn:t.depthFunc(515);break;case Un:t.depthFunc(514);break;case jn:t.depthFunc(518);break;case Gn:t.depthFunc(516);break;case Hn:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){s!==e&&(t.clearDepth(e),s=e)},reset:function(){e=!1,n=null,i=null,s=null}}},f=new function(){let e=!1,n=null,i=null,s=null,a=null,l=null,u=null,c=null,h=null;return{setTest:function(t){e||(t?r(2960):o(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,r){i===e&&s===n&&a===r||(t.stencilFunc(e,n,r),i=e,s=n,a=r)},setOp:function(e,n,i){l===e&&u===n&&c===i||(t.stencilOp(e,n,i),l=e,u=n,c=i)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,n=null,i=null,s=null,a=null,l=null,u=null,c=null,h=null}}};let m={},g={},y=new WeakMap,v=[],x=null,b=!1,_=null,w=null,S=null,A=null,M=null,T=null,E=null,P=!1,C=null,I=null,R=null,O=null,q=null;const L=t.getParameter(35661);let D=!1,z=0;const k=t.getParameter(7938);-1!==k.indexOf("WebGL")?(z=parseFloat(/^WebGL (\d)/.exec(k)[1]),D=z>=1):-1!==k.indexOf("OpenGL ES")&&(z=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),D=z>=2);let B=null,F={};const V=t.getParameter(3088),N=t.getParameter(2978),U=(new Lo).fromArray(V),j=(new Lo).fromArray(N),G={};G[3553]=i(3553,3553,1),G[34067]=i(34067,34069,6),d.setClear(0,0,0,1),p.setClear(1),f.setClear(0),r(2929),p.setFunc(Nn),a(!1),l(rn),r(2884),s(gn);const H={[wn]:32774,[Sn]:32778,[An]:32779};if(h)H[Mn]=32775,H[Tn]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(H[Mn]=t.MIN_EXT,H[Tn]=t.MAX_EXT)}const W={[En]:0,[Pn]:1,[Cn]:768,[Rn]:770,[kn]:776,[Dn]:774,[qn]:772,[In]:769,[On]:771,[zn]:775,[Ln]:773};return{buffers:{color:d,depth:p,stencil:f},enable:r,disable:o,bindFramebuffer:function(e,n){return g[e]!==n&&(t.bindFramebuffer(e,n),g[e]=n,h&&(36009===e&&(g[36160]=n),36160===e&&(g[36009]=n)),!0)},drawBuffers:function(i,r){let o=v,s=!1;if(i)if(o=y.get(r),void 0===o&&(o=[],y.set(r,o)),i.isWebGLMultipleRenderTargets){const t=i.texture;if(o.length!==t.length||36064!==o[0]){for(let e=0,n=t.length;e<n;e++)o[e]=36064+e;o.length=t.length,s=!0}}else 36064!==o[0]&&(o[0]=36064,s=!0);else 1029!==o[0]&&(o[0]=1029,s=!0);s&&(n.isWebGL2?t.drawBuffers(o):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(o))},useProgram:function(e){return x!==e&&(t.useProgram(e),x=e,!0)},setBlending:s,setMaterial:function(t,e){t.side===pn?o(2884):r(2884);let n=t.side===dn;e&&(n=!n),a(n),t.blending===yn&&!1===t.transparent?s(gn):s(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),p.setFunc(t.depthFunc),p.setTest(t.depthTest),p.setMask(t.depthWrite),d.setMask(t.colorWrite);const i=t.stencilWrite;f.setTest(i),i&&(f.setMask(t.stencilWriteMask),f.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),f.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),u(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?r(32926):o(32926)},setFlipSided:a,setCullFace:l,setLineWidth:function(e){e!==R&&(D&&t.lineWidth(e),R=e)},setPolygonOffset:u,setScissorTest:function(t){t?r(3089):o(3089)},activeTexture:c,bindTexture:function(e,n){null===B&&c();let i=F[B];void 0===i&&(i={type:void 0,texture:void 0},F[B]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||G[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=F[B];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===U.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),U.copy(e))},viewport:function(e){!1===j.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),j.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===h&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),m={},B=null,F={},g={},y=new WeakMap,v=[],x=null,b=!1,_=null,w=null,S=null,A=null,M=null,T=null,E=null,P=!1,C=null,I=null,R=null,O=null,q=null,U.set(0,0,t.canvas.width,t.canvas.height),j.set(0,0,t.canvas.width,t.canvas.height),d.reset(),p.reset(),f.reset()}}}function ae(t,e,n,i,r,o,s){function l(t,e){return N?new OffscreenCanvas(t,e):d("canvas")}function c(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?u:Math.floor,o=i(r*t.width),s=i(r*t.height);void 0===F&&(F=l(o,s));const a=n?l(o,s):F;return a.width=o,a.height=s,a.getContext("2d").drawImage(t,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+s+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function h(t){return a(t.width)&&a(t.height)}function p(t,e){return t.generateMipmaps&&e&&t.minFilter!==ci&&t.minFilter!==mi}function f(e){t.generateMipmap(e)}function m(n,i,r,o,s=!1){if(!1===R)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=i;return 6403===i&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),33319===i&&(5126===r&&(a=33328),5131===r&&(a=33327),5121===r&&(a=33323)),6408===i&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=o===Ir&&!1===s?35907:32856),32819===r&&(a=32854),32820===r&&(a=32855)),33325!==a&&33326!==a&&33327!==a&&33328!==a&&34842!==a&&34836!==a||e.get("EXT_color_buffer_float"),a}function g(t,e,n){return!0===p(t,n)||t.isFramebufferTexture&&t.minFilter!==ci&&t.minFilter!==mi?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function y(t){return t===ci||t===hi||t===pi?9728:9729}function v(t){const e=t.target;e.removeEventListener("dispose",v),function(t){const e=i.get(t);if(void 0===e.__webglInit)return;const n=t.source,r=V.get(n);if(r){const i=r[e.__cacheKey];i.usedTimes--,0===i.usedTimes&&b(t),0===Object.keys(r).length&&V.delete(n)}i.remove(t)}(e),e.isVideoTexture&&B.delete(e)}function x(e){const n=e.target;n.removeEventListener("dispose",x),function(e){const n=e.texture,r=i.get(e),o=i.get(n);if(void 0!==o.__webglTexture&&(t.deleteTexture(o.__webglTexture),s.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e]);else{if(t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let e=0;e<r.__webglColorRenderbuffer.length;e++)r.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(r.__webglColorRenderbuffer[e]);r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),s.memory.textures--),i.remove(n[e])}i.remove(n),i.remove(e)}(n)}function b(e){const n=i.get(e);t.deleteTexture(n.__webglTexture);const r=e.source;delete V.get(r)[n.__cacheKey],s.memory.textures--}function _(t,e){const r=i.get(t);if(t.isVideoTexture&&function(t){const e=s.render.frame;B.get(t)!==e&&(B.set(t,e),t.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&r.__version!==t.version){const n=t.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void A(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function w(n,o,s){if(s?(t.texParameteri(n,10242,j[o.wrapS]),t.texParameteri(n,10243,j[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,j[o.wrapR]),t.texParameteri(n,10240,G[o.magFilter]),t.texParameteri(n,10241,G[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS===li&&o.wrapT===li||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,y(o.magFilter)),t.texParameteri(n,10241,y(o.minFilter)),o.minFilter!==ci&&o.minFilter!==mi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const s=e.get("EXT_texture_filter_anisotropic");if(o.type===Ti&&!1===e.has("OES_texture_float_linear"))return;if(!1===R&&o.type===Ei&&!1===e.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||i.get(o).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),i.get(o).__currentAnisotropy=o.anisotropy)}}function S(e,n){let i=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",v));const r=n.source;let o=V.get(r);void 0===o&&(o={},V.set(r,o));const a=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.encoding),e.join()}(n);if(a!==e.__cacheKey){void 0===o[a]&&(o[a]={texture:t.createTexture(),usedTimes:0},s.memory.textures++,i=!0),o[a].usedTimes++;const r=o[e.__cacheKey];void 0!==r&&(o[e.__cacheKey].usedTimes--,0===r.usedTimes&&b(n)),e.__cacheKey=a,e.__webglTexture=o[a].texture}return i}function A(e,i,r){let s=3553;i.isDataArrayTexture&&(s=35866),i.isData3DTexture&&(s=32879);const a=S(e,i),l=i.source;if(n.activeTexture(33984+r),n.bindTexture(s,e.__webglTexture),l.version!==l.__currentVersion||!0===a){t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const e=function(t){return!R&&(t.wrapS!==li||t.wrapT!==li||t.minFilter!==ci&&t.minFilter!==mi)}(i)&&!1===h(i.image);let r=c(i.image,e,!1,L);r=I(i,r);const u=h(r)||R,d=o.convert(i.format,i.encoding);let y,v=o.convert(i.type),x=m(i.internalFormat,d,v,i.encoding,i.isVideoTexture);w(s,i,u);const b=i.mipmaps,_=R&&!0!==i.isVideoTexture,S=void 0===l.__currentVersion||!0===a,A=g(i,r,u);if(i.isDepthTexture)x=6402,R?x=i.type===Ti?36012:i.type===Mi?33190:i.type===Ii?35056:33189:i.type===Ti&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===zi&&6402===x&&i.type!==Si&&i.type!==Mi&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Mi,v=o.convert(i.type)),i.format===ki&&6402===x&&(x=34041,i.type!==Ii&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Ii,v=o.convert(i.type))),S&&(_?n.texStorage2D(3553,1,x,r.width,r.height):n.texImage2D(3553,0,x,r.width,r.height,0,d,v,null));else if(i.isDataTexture)if(b.length>0&&u){_&&S&&n.texStorage2D(3553,A,x,b[0].width,b[0].height);for(let t=0,e=b.length;t<e;t++)y=b[t],_?n.texSubImage2D(3553,t,0,0,y.width,y.height,d,v,y.data):n.texImage2D(3553,t,x,y.width,y.height,0,d,v,y.data);i.generateMipmaps=!1}else _?(S&&n.texStorage2D(3553,A,x,r.width,r.height),n.texSubImage2D(3553,0,0,0,r.width,r.height,d,v,r.data)):n.texImage2D(3553,0,x,r.width,r.height,0,d,v,r.data);else if(i.isCompressedTexture){_&&S&&n.texStorage2D(3553,A,x,b[0].width,b[0].height);for(let t=0,e=b.length;t<e;t++)y=b[t],i.format!==qi?null!==d?_?n.compressedTexSubImage2D(3553,t,0,0,y.width,y.height,d,y.data):n.compressedTexImage2D(3553,t,x,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_?n.texSubImage2D(3553,t,0,0,y.width,y.height,d,v,y.data):n.texImage2D(3553,t,x,y.width,y.height,0,d,v,y.data)}else if(i.isDataArrayTexture)_?(S&&n.texStorage3D(35866,A,x,r.width,r.height,r.depth),n.texSubImage3D(35866,0,0,0,0,r.width,r.height,r.depth,d,v,r.data)):n.texImage3D(35866,0,x,r.width,r.height,r.depth,0,d,v,r.data);else if(i.isData3DTexture)_?(S&&n.texStorage3D(32879,A,x,r.width,r.height,r.depth),n.texSubImage3D(32879,0,0,0,0,r.width,r.height,r.depth,d,v,r.data)):n.texImage3D(32879,0,x,r.width,r.height,r.depth,0,d,v,r.data);else if(i.isFramebufferTexture){if(S)if(_)n.texStorage2D(3553,A,x,r.width,r.height);else{let t=r.width,e=r.height;for(let i=0;i<A;i++)n.texImage2D(3553,i,x,t,e,0,d,v,null),t>>=1,e>>=1}}else if(b.length>0&&u){_&&S&&n.texStorage2D(3553,A,x,b[0].width,b[0].height);for(let t=0,e=b.length;t<e;t++)y=b[t],_?n.texSubImage2D(3553,t,0,0,d,v,y):n.texImage2D(3553,t,x,d,v,y);i.generateMipmaps=!1}else _?(S&&n.texStorage2D(3553,A,x,r.width,r.height),n.texSubImage2D(3553,0,0,0,d,v,r)):n.texImage2D(3553,0,x,d,v,r);p(i,u)&&f(s),l.__currentVersion=l.version,i.onUpdate&&i.onUpdate(i)}e.__version=i.version}function M(e,r,s,a,l){const u=o.convert(s.format,s.encoding),c=o.convert(s.type),h=m(s.internalFormat,u,c,s.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,u,c,null):n.texImage2D(l,0,h,r.width,r.height,0,u,c,null)),n.bindFramebuffer(36160,e),C(r)?z.framebufferTexture2DMultisampleEXT(36160,a,l,i.get(s).__webglTexture,0,P(r)):t.framebufferTexture2D(36160,a,l,i.get(s).__webglTexture,0),n.bindFramebuffer(36160,null)}function T(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||C(n)){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===Ti?r=36012:e.type===Mi&&(r=33190));const i=P(n);C(n)?z.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):t.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){const r=P(n);i&&!1===C(n)?t.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):C(n)?z.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let r=0;r<e.length;r++){const s=e[r],a=o.convert(s.format,s.encoding),l=o.convert(s.type),u=m(s.internalFormat,a,l,s.encoding),c=P(n);i&&!1===C(n)?t.renderbufferStorageMultisample(36161,c,u,n.width,n.height):C(n)?z.renderbufferStorageMultisampleEXT(36161,c,u,n.width,n.height):t.renderbufferStorage(36161,u,n.width,n.height)}}t.bindRenderbuffer(36161,null)}function E(e){const r=i.get(e),o=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),_(r.depthTexture,0);const o=i.get(r.depthTexture).__webglTexture,s=P(r);if(r.depthTexture.format===zi)C(r)?z.framebufferTexture2DMultisampleEXT(36160,36096,3553,o,0,s):t.framebufferTexture2D(36160,36096,3553,o,0);else{if(r.depthTexture.format!==ki)throw new Error("Unknown depthTexture format");C(r)?z.framebufferTexture2DMultisampleEXT(36160,33306,3553,o,0,s):t.framebufferTexture2D(36160,33306,3553,o,0)}}(r.__webglFramebuffer,e)}else if(o){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=t.createRenderbuffer(),T(r.__webglDepthbuffer[i],e,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),T(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function P(t){return Math.min(D,t.samples)}function C(t){const n=i.get(t);return R&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function I(t,n){const i=t.encoding,r=t.format,o=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===ho||i!==Cr&&(i===Ir?!1===R?!0===e.has("EXT_sRGB")&&r===qi?(t.format=ho,t.minFilter=mi,t.generateMipmaps=!1):n=Io.sRGBToLinear(n):r===qi&&o===bi||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),n}const R=r.isWebGL2,O=r.maxTextures,q=r.maxCubemapSize,L=r.maxTextureSize,D=r.maxSamples,z=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,k=/OculusBrowser/g.test(navigator.userAgent),B=new WeakMap;let F;const V=new WeakMap;let N=!1;try{N="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}let U=0;const j={[ai]:10497,[li]:33071,[ui]:33648},G={[ci]:9728,[hi]:9984,[pi]:9986,[mi]:9729,[gi]:9985,[vi]:9987};this.allocateTextureUnit=function(){const t=U;return t>=O&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+O),U+=1,t},this.resetTextureUnits=function(){U=0},this.setTexture2D=_,this.setTexture2DArray=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?A(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?A(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=function(e,r){const s=i.get(e);e.version>0&&s.__version!==e.version?function(e,i,r){if(6!==i.image.length)return;const s=S(e,i),a=i.source;if(n.activeTexture(33984+r),n.bindTexture(34067,e.__webglTexture),a.version!==a.__currentVersion||!0===s){t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const e=i.isCompressedTexture||i.image[0].isCompressedTexture,r=i.image[0]&&i.image[0].isDataTexture,l=[];for(let t=0;t<6;t++)l[t]=e||r?r?i.image[t].image:i.image[t]:c(i.image[t],!1,!0,q),l[t]=I(i,l[t]);const u=l[0],d=h(u)||R,y=o.convert(i.format,i.encoding),v=o.convert(i.type),x=m(i.internalFormat,y,v,i.encoding),b=R&&!0!==i.isVideoTexture,_=void 0===a.__currentVersion||!0===s;let S,A=g(i,u,d);if(w(34067,i,d),e){b&&_&&n.texStorage2D(34067,A,x,u.width,u.height);for(let t=0;t<6;t++){S=l[t].mipmaps;for(let e=0;e<S.length;e++){const r=S[e];i.format!==qi?null!==y?b?n.compressedTexSubImage2D(34069+t,e,0,0,r.width,r.height,y,r.data):n.compressedTexImage2D(34069+t,e,x,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):b?n.texSubImage2D(34069+t,e,0,0,r.width,r.height,y,v,r.data):n.texImage2D(34069+t,e,x,r.width,r.height,0,y,v,r.data)}}}else{S=i.mipmaps,b&&_&&(S.length>0&&A++,n.texStorage2D(34067,A,x,l[0].width,l[0].height));for(let t=0;t<6;t++)if(r){b?n.texSubImage2D(34069+t,0,0,0,l[t].width,l[t].height,y,v,l[t].data):n.texImage2D(34069+t,0,x,l[t].width,l[t].height,0,y,v,l[t].data);for(let e=0;e<S.length;e++){const i=S[e].image[t].image;b?n.texSubImage2D(34069+t,e+1,0,0,i.width,i.height,y,v,i.data):n.texImage2D(34069+t,e+1,x,i.width,i.height,0,y,v,i.data)}}else{b?n.texSubImage2D(34069+t,0,0,0,y,v,l[t]):n.texImage2D(34069+t,0,x,y,v,l[t]);for(let e=0;e<S.length;e++){const i=S[e];b?n.texSubImage2D(34069+t,e+1,0,0,y,v,i.image[t]):n.texImage2D(34069+t,e+1,x,y,v,i.image[t])}}}p(i,d)&&f(34067),a.__currentVersion=a.version,i.onUpdate&&i.onUpdate(i)}e.__version=i.version}(s,e,r):(n.activeTexture(33984+r),n.bindTexture(34067,s.__webglTexture))},this.rebindTextures=function(t,e,n){const r=i.get(t);void 0!==e&&M(r.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&E(t)},this.setupRenderTarget=function(e){const a=e.texture,l=i.get(e),u=i.get(a);e.addEventListener("dispose",x),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=a.version,s.memory.textures++);const c=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,g=h(e)||R;if(c){l.__webglFramebuffer=[];for(let e=0;e<6;e++)l.__webglFramebuffer[e]=t.createFramebuffer()}else{if(l.__webglFramebuffer=t.createFramebuffer(),d)if(r.drawBuffers){const n=e.texture;for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(R&&e.samples>0&&!1===C(e)){const i=d?a:[a];l.__webglMultisampledFramebuffer=t.createFramebuffer(),l.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,l.__webglMultisampledFramebuffer);for(let n=0;n<i.length;n++){const r=i[n];l.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(36161,l.__webglColorRenderbuffer[n]);const s=o.convert(r.format,r.encoding),a=o.convert(r.type),u=m(r.internalFormat,s,a,r.encoding),c=P(e);t.renderbufferStorageMultisample(36161,c,u,e.width,e.height),t.framebufferRenderbuffer(36160,36064+n,36161,l.__webglColorRenderbuffer[n])}t.bindRenderbuffer(36161,null),e.depthBuffer&&(l.__webglDepthRenderbuffer=t.createRenderbuffer(),T(l.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}}if(c){n.bindTexture(34067,u.__webglTexture),w(34067,a,g);for(let t=0;t<6;t++)M(l.__webglFramebuffer[t],e,a,36064,34069+t);p(a,g)&&f(34067),n.unbindTexture()}else if(d){const t=e.texture;for(let r=0,o=t.length;r<o;r++){const o=t[r],s=i.get(o);n.bindTexture(3553,s.__webglTexture),w(3553,o,g),M(l.__webglFramebuffer,e,o,36064+r,3553),p(o,g)&&f(3553)}n.unbindTexture()}else{let t=3553;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(R?t=e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(t,u.__webglTexture),w(t,a,g),M(l.__webglFramebuffer,e,a,36064,t),p(a,g)&&f(t),n.unbindTexture()}e.depthBuffer&&E(e)},this.updateRenderTargetMipmap=function(t){const e=h(t)||R,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let o=0,s=r.length;o<s;o++){const s=r[o];if(p(s,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,r=i.get(s).__webglTexture;n.bindTexture(e,r),f(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(R&&e.samples>0&&!1===C(e)){const r=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],o=e.width,s=e.height;let a=16384;const l=[],u=e.stencilBuffer?33306:36096,c=i.get(e),h=!0===e.isWebGLMultipleRenderTargets;if(h)for(let e=0;e<r.length;e++)n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+e,36161,null),n.bindFramebuffer(36160,c.__webglFramebuffer),t.framebufferTexture2D(36009,36064+e,3553,null,0);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer);for(let n=0;n<r.length;n++){l.push(36064+n),e.depthBuffer&&l.push(u);const d=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===d&&(e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024)),h&&t.framebufferRenderbuffer(36008,36064,36161,c.__webglColorRenderbuffer[n]),!0===d&&(t.invalidateFramebuffer(36008,[u]),t.invalidateFramebuffer(36009,[u])),h){const e=i.get(r[n]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,e,0)}t.blitFramebuffer(0,0,o,s,0,0,o,s,a,9728),k&&t.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),h)for(let e=0;e<r.length;e++){n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+e,36161,c.__webglColorRenderbuffer[e]);const o=i.get(r[e]).__webglTexture;n.bindFramebuffer(36160,c.__webglFramebuffer),t.framebufferTexture2D(36009,36064+e,3553,o,0)}n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=E,this.setupFrameBufferTexture=M,this.useMultisampledRTT=C}function le(t,e,n){const i=n.isWebGL2;return{convert:function(n,r=null){let o;if(n===bi)return 5121;if(n===Pi)return 32819;if(n===Ci)return 32820;if(n===_i)return 5120;if(n===wi)return 5122;if(n===Si)return 5123;if(n===Ai)return 5124;if(n===Mi)return 5125;if(n===Ti)return 5126;if(n===Ei)return i?5131:(o=e.get("OES_texture_half_float"),null!==o?o.HALF_FLOAT_OES:null);if(n===Ri)return 6406;if(n===qi)return 6408;if(n===Li)return 6409;if(n===Di)return 6410;if(n===zi)return 6402;if(n===ki)return 34041;if(n===Bi)return 6403;if(n===Oi)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(n===ho)return o=e.get("EXT_sRGB"),null!==o?o.SRGB_ALPHA_EXT:null;if(n===Fi)return 36244;if(n===Vi)return 33319;if(n===Ni)return 33320;if(n===Ui)return 36249;if(n===ji||n===Gi||n===Hi||n===Wi)if(r===Ir){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(n===ji)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Gi)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Hi)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Wi)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(n===ji)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Gi)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Hi)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Wi)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Xi||n===Yi||n===Zi||n===Qi){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(n===Xi)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Yi)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Zi)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Qi)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Ji)return o=e.get("WEBGL_compressed_texture_etc1"),null!==o?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===Ki||n===$i){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(n===Ki)return r===Ir?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===$i)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(n===tr||n===er||n===nr||n===ir||n===rr||n===or||n===sr||n===ar||n===lr||n===ur||n===cr||n===hr||n===dr||n===pr){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(n===tr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===er)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===nr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===ir)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===rr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===or)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===sr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===ar)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===lr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===ur)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===cr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===hr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===dr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===pr)return r===Ir?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===fr){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(n===fr)return r===Ir?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}return n===Ii?i?34042:(o=e.get("WEBGL_depth_texture"),null!==o?o.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[n]?t[n]:null}}}function ue(t,e){function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,i.side===dn&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),i.side===dn&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);const r=e.get(i).envMap;if(r&&(n.envMap.value=r,n.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;const e=!0!==t.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*e}let o,s;i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?o=i.map:i.specularMap?o=i.specularMap:i.displacementMap?o=i.displacementMap:i.normalMap?o=i.normalMap:i.bumpMap?o=i.bumpMap:i.roughnessMap?o=i.roughnessMap:i.metalnessMap?o=i.metalnessMap:i.alphaMap?o=i.alphaMap:i.emissiveMap?o=i.emissiveMap:i.clearcoatMap?o=i.clearcoatMap:i.clearcoatNormalMap?o=i.clearcoatNormalMap:i.clearcoatRoughnessMap?o=i.clearcoatRoughnessMap:i.iridescenceMap?o=i.iridescenceMap:i.iridescenceThicknessMap?o=i.iridescenceThicknessMap:i.specularIntensityMap?o=i.specularIntensityMap:i.specularColorMap?o=i.specularColorMap:i.transmissionMap?o=i.transmissionMap:i.thicknessMap?o=i.thicknessMap:i.sheenColorMap?o=i.sheenColorMap:i.sheenRoughnessMap&&(o=i.sheenRoughnessMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uvTransform.value.copy(o.matrix)),i.aoMap?s=i.aoMap:i.lightMap&&(s=i.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uv2Transform.value.copy(s.matrix))}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,i,r,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(t,i):i.isMeshToonMaterial?(n(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,i)):i.isMeshPhongMaterial?(n(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,i)):i.isMeshStandardMaterial?(n(t,i),function(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap);e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}(t,i),i.isMeshPhysicalMaterial&&function(t,e,n){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap)),e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===dn&&t.clearcoatNormalScale.value.negate())),e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap)),e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)),t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,i,s)):i.isMeshMatcapMaterial?(n(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,i)):i.isMeshDepthMaterial?n(t,i):i.isMeshDistanceMaterial?(n(t,i),function(t,e){t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?n(t,i):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){let r;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?r=e.map:e.alphaMap&&(r=e.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i,r,o):i.isSpriteMaterial?function(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function ce(t={}){function e(){return null===J?ot:1}function n(t,e){for(let n=0;n<t.length;n++){const i=t[n],r=v.getContext(i,e);if(null!==r)return r}return null}function i(){xt=new D(Ut),bt=new E(Ut,xt,t),xt.init(bt),Vt=new le(Ut,xt,bt),_t=new se(Ut,xt,bt),wt=new B(Ut),St=new Zt,At=new ae(Ut,xt,_t,St,bt,Vt,wt),Mt=new C(X),Tt=new L(X),Et=new S(Ut,bt),Nt=new M(Ut,xt,Et,bt),Pt=new z(Ut,Et,wt,Nt),Ct=new j(Ut,Pt,Et,wt),kt=new U(Ut,bt,At),Lt=new P(St),It=new Yt(X,Mt,Tt,xt,bt,Nt,Lt),Rt=new ue(X,St),Ot=new $t,qt=new re(xt,bt),zt=new A(X,Mt,_t,Ct,V,R),Dt=new oe(X,Ct,bt),Bt=new T(Ut,xt,wt,bt),Ft=new k(Ut,xt,wt,bt),wt.programs=It.programs,X.capabilities=bt,X.extensions=xt,X.properties=St,X.renderLists=Ot,X.shadowMap=Dt,X.state=_t,X.info=wt}function r(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Y=!0}function o(){console.log("THREE.WebGLRenderer: Context Restored."),Y=!1;const t=wt.autoReset,e=Dt.enabled,n=Dt.autoUpdate,r=Dt.needsUpdate,o=Dt.type;i(),wt.autoReset=t,Dt.enabled=e,Dt.autoUpdate=n,Dt.needsUpdate=r,Dt.type=o}function s(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function a(t){const e=t.target;e.removeEventListener("dispose",a),function(t){(function(t){const e=St.get(t).programs;void 0!==e&&(e.forEach((function(t){It.releaseProgram(t)})),t.isShaderMaterial&&It.releaseShaderCache(t))})(t),St.remove(t)}(e)}function l(){Ht.stop()}function c(){Ht.start()}function h(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)G.pushLight(t),t.castShadow&&G.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||ht.intersectsSprite(t)){i&&yt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(mt);const e=Ct.update(t),r=t.material;r.visible&&N.push(t,e,r,n,yt.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==wt.render.frame&&(t.skeleton.update(),t.skeleton.frame=wt.render.frame),!t.frustumCulled||ht.intersectsObject(t))){i&&yt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(mt);const e=Ct.update(t),r=t.material;if(Array.isArray(r)){const i=e.groups;for(let o=0,s=i.length;o<s;o++){const s=i[o],a=r[s.materialIndex];a&&a.visible&&N.push(t,e,a,n,yt.z,s)}}else r.visible&&N.push(t,e,r,n,yt.z,null)}const r=t.children;for(let t=0,o=r.length;t<o;t++)h(r[t],e,n,i)}function p(t,e,n,i){const r=t.opaque,o=t.transmissive,s=t.transparent;G.setupLightsView(n),o.length>0&&function(t,e,n){const i=bt.isWebGL2;null===ft&&(ft=new Do(1,1,{generateMipmaps:!0,type:xt.has("EXT_color_buffer_half_float")?Ei:bi,minFilter:vi,samples:i&&!0===I?4:0})),X.getDrawingBufferSize(gt),i?ft.setSize(gt.x,gt.y):ft.setSize(u(gt.x),u(gt.y));const r=X.getRenderTarget();X.setRenderTarget(ft),X.clear();const o=X.toneMapping;X.toneMapping=Zn,f(t,e,n),X.toneMapping=o,At.updateMultisampleRenderTarget(ft),At.updateRenderTargetMipmap(ft),X.setRenderTarget(r)}(r,e,n),i&&_t.viewport(tt.copy(i)),r.length>0&&f(r,e,n),o.length>0&&f(o,e,n),s.length>0&&f(s,e,n),_t.buffers.depth.setTest(!0),_t.buffers.depth.setMask(!0),_t.buffers.color.setMask(!0),_t.setPolygonOffset(!1)}function f(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.object,a=o.geometry,l=null===i?o.material:i,u=o.group;s.layers.test(n.layers)&&m(s,e,n,a,l,u)}}function m(t,e,n,i,r,o){t.onBeforeRender(X,e,n,i,r,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(X,e,n,i,t,o),!0===r.transparent&&r.side===pn?(r.side=dn,r.needsUpdate=!0,X.renderBufferDirect(n,e,i,r,t,o),r.side=hn,r.needsUpdate=!0,X.renderBufferDirect(n,e,i,r,t,o),r.side=pn):X.renderBufferDirect(n,e,i,r,t,o),t.onAfterRender(X,e,n,i,r,o)}function g(t,e,n){!0!==e.isScene&&(e=vt);const i=St.get(t),r=G.state.lights,o=G.state.shadowsArray,s=r.state.version,l=It.getParameters(t,r.state,o,e,n),u=It.getProgramCacheKey(l);let c=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?Tt:Mt).get(t.envMap||i.environment),void 0===c&&(t.addEventListener("dispose",a),c=new Map,i.programs=c);let h=c.get(u);if(void 0!==h){if(i.currentProgram===h&&i.lightsStateVersion===s)return y(t,l),h}else l.uniforms=It.getUniforms(t),t.onBuild(n,l,X),t.onBeforeCompile(l,X),h=It.acquireProgram(l,u),c.set(u,h),i.uniforms=l.uniforms;const d=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(d.clippingPlanes=Lt.uniform),y(t,l),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=s,i.needsLights&&(d.ambientLightColor.value=r.state.ambient,d.lightProbe.value=r.state.probe,d.directionalLights.value=r.state.directional,d.directionalLightShadows.value=r.state.directionalShadow,d.spotLights.value=r.state.spot,d.spotLightShadows.value=r.state.spotShadow,d.rectAreaLights.value=r.state.rectArea,d.ltc_1.value=r.state.rectAreaLTC1,d.ltc_2.value=r.state.rectAreaLTC2,d.pointLights.value=r.state.point,d.pointLightShadows.value=r.state.pointShadow,d.hemisphereLights.value=r.state.hemi,d.directionalShadowMap.value=r.state.directionalShadowMap,d.directionalShadowMatrix.value=r.state.directionalShadowMatrix,d.spotShadowMap.value=r.state.spotShadowMap,d.spotShadowMatrix.value=r.state.spotShadowMatrix,d.pointShadowMap.value=r.state.pointShadowMap,d.pointShadowMatrix.value=r.state.pointShadowMatrix);const p=h.getUniforms(),f=Rl.seqWithValue(p.seq,d);return i.currentProgram=h,i.uniformsList=f,h}function y(t,e){const n=St.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}this.isWebGLRenderer=!0;const v=void 0!==t.canvas?t.canvas:function(){const t=d("canvas");return t.style.display="block",t}(),x=void 0!==t.context?t.context:null,b=void 0===t.depth||t.depth,_=void 0===t.stencil||t.stencil,I=void 0!==t.antialias&&t.antialias,R=void 0===t.premultipliedAlpha||t.premultipliedAlpha,O=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,q=void 0!==t.powerPreference?t.powerPreference:"default",F=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let V;V=null!==x?x.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let N=null,G=null;const H=[],W=[];this.domElement=v,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Cr,this.physicallyCorrectLights=!1,this.toneMapping=Zn,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const X=this;let Y=!1,Z=0,Q=0,J=null,K=-1,$=null;const tt=new Lo,et=new Lo;let nt=null,it=v.width,rt=v.height,ot=1,st=null,at=null;const lt=new Lo(0,0,it,rt),ut=new Lo(0,0,it,rt);let ct=!1;const ht=new rl;let dt=!1,pt=!1,ft=null;const mt=new vs,gt=new xo,yt=new Uo,vt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let xt,bt,_t,wt,St,At,Mt,Tt,Et,Pt,Ct,It,Rt,Ot,qt,Lt,Dt,zt,kt,Bt,Ft,Vt,Nt,Ut=x;try{const t={alpha:!0,depth:b,stencil:_,antialias:I,premultipliedAlpha:R,preserveDrawingBuffer:O,powerPreference:q,failIfMajorPerformanceCaveat:F};if("setAttribute"in v&&v.setAttribute("data-engine",`three.js r${$e}`),v.addEventListener("webglcontextlost",r,!1),v.addEventListener("webglcontextrestored",o,!1),v.addEventListener("webglcontextcreationerror",s,!1),null===Ut){const e=["webgl2","webgl","experimental-webgl"];if(!0===X.isWebGL1Renderer&&e.shift(),Ut=n(e,t),null===Ut)throw n(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ut.getShaderPrecisionFormat&&(Ut.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}i();const jt=new Xl(X,Ut);this.xr=jt,this.getContext=function(){return Ut},this.getContextAttributes=function(){return Ut.getContextAttributes()},this.forceContextLoss=function(){const t=xt.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=xt.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return ot},this.setPixelRatio=function(t){void 0!==t&&(ot=t,this.setSize(it,rt,!1))},this.getSize=function(t){return t.set(it,rt)},this.setSize=function(t,e,n){jt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(it=t,rt=e,v.width=Math.floor(t*ot),v.height=Math.floor(e*ot),!1!==n&&(v.style.width=t+"px",v.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return t.set(it*ot,rt*ot).floor()},this.setDrawingBufferSize=function(t,e,n){it=t,rt=e,ot=n,v.width=Math.floor(t*n),v.height=Math.floor(e*n),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return t.copy(tt)},this.getViewport=function(t){return t.copy(lt)},this.setViewport=function(t,e,n,i){t.isVector4?lt.set(t.x,t.y,t.z,t.w):lt.set(t,e,n,i),_t.viewport(tt.copy(lt).multiplyScalar(ot).floor())},this.getScissor=function(t){return t.copy(ut)},this.setScissor=function(t,e,n,i){t.isVector4?ut.set(t.x,t.y,t.z,t.w):ut.set(t,e,n,i),_t.scissor(et.copy(ut).multiplyScalar(ot).floor())},this.getScissorTest=function(){return ct},this.setScissorTest=function(t){_t.setScissorTest(ct=t)},this.setOpaqueSort=function(t){st=t},this.setTransparentSort=function(t){at=t},this.getClearColor=function(t){return t.copy(zt.getClearColor())},this.setClearColor=function(){zt.setClearColor.apply(zt,arguments)},this.getClearAlpha=function(){return zt.getClearAlpha()},this.setClearAlpha=function(){zt.setClearAlpha.apply(zt,arguments)},this.clear=function(t=!0,e=!0,n=!0){let i=0;t&&(i|=16384),e&&(i|=256),n&&(i|=1024),Ut.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){v.removeEventListener("webglcontextlost",r,!1),v.removeEventListener("webglcontextrestored",o,!1),v.removeEventListener("webglcontextcreationerror",s,!1),Ot.dispose(),qt.dispose(),St.dispose(),Mt.dispose(),Tt.dispose(),Ct.dispose(),Nt.dispose(),It.dispose(),jt.dispose(),jt.removeEventListener("sessionstart",l),jt.removeEventListener("sessionend",c),ft&&(ft.dispose(),ft=null),Ht.stop()},this.renderBufferDirect=function(t,n,i,r,o,s){null===n&&(n=vt);const a=o.isMesh&&o.matrixWorld.determinant()<0,l=function(t,e,n,i,r){!0!==e.isScene&&(e=vt),At.resetTextureUnits();const o=e.fog,s=i.isMeshStandardMaterial?e.environment:null,a=null===J?X.outputEncoding:!0===J.isXRRenderTarget?J.texture.encoding:Cr,l=(i.isMeshStandardMaterial?Tt:Mt).get(i.envMap||s),u=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!i.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,f=i.toneMapped?X.toneMapping:Zn,m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,y=void 0!==m?m.length:0,v=St.get(i),x=G.state.lights;if(!0===dt&&(!0===pt||t!==$)){const e=t===$&&i.id===K;Lt.setState(i,t,e)}let b=!1;i.version===v.__version?v.needsLights&&v.lightsStateVersion!==x.state.version||v.outputEncoding!==a||r.isInstancedMesh&&!1===v.instancing?b=!0:r.isInstancedMesh||!0!==v.instancing?r.isSkinnedMesh&&!1===v.skinning?b=!0:r.isSkinnedMesh||!0!==v.skinning?v.envMap!==l||!0===i.fog&&v.fog!==o?b=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===Lt.numPlanes&&v.numIntersection===Lt.numIntersection?(v.vertexAlphas!==u||v.vertexTangents!==c||v.morphTargets!==h||v.morphNormals!==d||v.morphColors!==p||v.toneMapping!==f||!0===bt.isWebGL2&&v.morphTargetsCount!==y)&&(b=!0):b=!0:b=!0:b=!0:(b=!0,v.__version=i.version);let _=v.currentProgram;!0===b&&(_=g(i,e,r));let w=!1,S=!1,A=!1;const M=_.getUniforms(),T=v.uniforms;if(_t.useProgram(_.program)&&(w=!0,S=!0,A=!0),i.id!==K&&(K=i.id,S=!0),w||$!==t){if(M.setValue(Ut,"projectionMatrix",t.projectionMatrix),bt.logarithmicDepthBuffer&&M.setValue(Ut,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),$!==t&&($=t,S=!0,A=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const e=M.map.cameraPosition;void 0!==e&&e.setValue(Ut,yt.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&M.setValue(Ut,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&M.setValue(Ut,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){M.setOptional(Ut,r,"bindMatrix"),M.setOptional(Ut,r,"bindMatrixInverse");const t=r.skeleton;t&&(bt.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),M.setValue(Ut,"boneTexture",t.boneTexture,At),M.setValue(Ut,"boneTextureSize",t.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const E=n.morphAttributes;var P,C;return(void 0!==E.position||void 0!==E.normal||void 0!==E.color&&!0===bt.isWebGL2)&&kt.update(r,n,i,_),(S||v.receiveShadow!==r.receiveShadow)&&(v.receiveShadow=r.receiveShadow,M.setValue(Ut,"receiveShadow",r.receiveShadow)),S&&(M.setValue(Ut,"toneMappingExposure",X.toneMappingExposure),v.needsLights&&(C=A,(P=T).ambientLightColor.needsUpdate=C,P.lightProbe.needsUpdate=C,P.directionalLights.needsUpdate=C,P.directionalLightShadows.needsUpdate=C,P.pointLights.needsUpdate=C,P.pointLightShadows.needsUpdate=C,P.spotLights.needsUpdate=C,P.spotLightShadows.needsUpdate=C,P.rectAreaLights.needsUpdate=C,P.hemisphereLights.needsUpdate=C),o&&!0===i.fog&&Rt.refreshFogUniforms(T,o),Rt.refreshMaterialUniforms(T,i,ot,rt,ft),Rl.upload(Ut,v.uniformsList,T,At)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Rl.upload(Ut,v.uniformsList,T,At),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&M.setValue(Ut,"center",r.center),M.setValue(Ut,"modelViewMatrix",r.modelViewMatrix),M.setValue(Ut,"normalMatrix",r.normalMatrix),M.setValue(Ut,"modelMatrix",r.matrixWorld),_}(t,n,i,r,o);_t.setMaterial(r,a);let u=i.index;const c=i.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;let h,d=1;!0===r.wireframe&&(u=Pt.getWireframeAttribute(i),d=2),Nt.setup(o,r,l,i,u);let p=Bt;null!==u&&(h=Et.get(u),p=Ft,p.setIndex(h));const f=null!==u?u.count:c.count,m=i.drawRange.start*d,y=i.drawRange.count*d,v=null!==s?s.start*d:0,x=null!==s?s.count*d:1/0,b=Math.max(m,v),_=Math.min(f,m+y,v+x)-1,w=Math.max(0,_-b+1);if(0!==w){if(o.isMesh)!0===r.wireframe?(_t.setLineWidth(r.wireframeLinewidth*e()),p.setMode(1)):p.setMode(4);else if(o.isLine){let t=r.linewidth;void 0===t&&(t=1),_t.setLineWidth(t*e()),o.isLineSegments?p.setMode(1):o.isLineLoop?p.setMode(2):p.setMode(3)}else o.isPoints?p.setMode(0):o.isSprite&&p.setMode(4);if(o.isInstancedMesh)p.renderInstances(b,w,o.count);else if(i.isInstancedBufferGeometry){const t=Math.min(i.instanceCount,i._maxInstanceCount);p.renderInstances(b,w,t)}else p.render(b,w)}},this.compile=function(t,e){G=qt.get(t),G.init(),W.push(G),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(G.pushLight(t),t.castShadow&&G.pushShadow(t))})),G.setupLights(X.physicallyCorrectLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++)g(n[i],t,e);else g(n,t,e)})),W.pop(),G=null};let Gt=null;const Ht=new w;Ht.setAnimationLoop((function(t){Gt&&Gt(t)})),"undefined"!=typeof self&&Ht.setContext(self),this.setAnimationLoop=function(t){Gt=t,jt.setAnimationLoop(t),null===t?Ht.stop():Ht.start()},jt.addEventListener("sessionstart",l),jt.addEventListener("sessionend",c),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===Y)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===jt.enabled&&!0===jt.isPresenting&&(!0===jt.cameraAutoUpdate&&jt.updateCamera(e),e=jt.getCamera()),!0===t.isScene&&t.onBeforeRender(X,t,e,J),G=qt.get(t,W.length),G.init(),W.push(G),mt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ht.setFromProjectionMatrix(mt),pt=this.localClippingEnabled,dt=Lt.init(this.clippingPlanes,pt,e),N=Ot.get(t,H.length),N.init(),H.push(N),h(t,e,0,X.sortObjects),N.finish(),!0===X.sortObjects&&N.sort(st,at),!0===dt&&Lt.beginShadows();const n=G.state.shadowsArray;if(Dt.render(n,t,e),!0===dt&&Lt.endShadows(),!0===this.info.autoReset&&this.info.reset(),zt.render(N,t),G.setupLights(X.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,i=n.length;e<i;e++){const i=n[e];p(N,t,i,i.viewport)}}else p(N,t,e);null!==J&&(At.updateMultisampleRenderTarget(J),At.updateRenderTargetMipmap(J)),!0===t.isScene&&t.onAfterRender(X,t,e),Nt.resetDefaultState(),K=-1,$=null,W.pop(),G=W.length>0?W[W.length-1]:null,H.pop(),N=H.length>0?H[H.length-1]:null},this.getActiveCubeFace=function(){return Z},this.getActiveMipmapLevel=function(){return Q},this.getRenderTarget=function(){return J},this.setRenderTargetTextures=function(t,e,n){St.get(t.texture).__webglTexture=e,St.get(t.depthTexture).__webglTexture=n;const i=St.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===xt.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const n=St.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){J=t,Z=e,Q=n;let i=!0;if(t){const e=St.get(t);void 0!==e.__useDefaultFramebuffer?(_t.bindFramebuffer(36160,null),i=!1):void 0===e.__webglFramebuffer?At.setupRenderTarget(t):e.__hasExternalTextures&&At.rebindTextures(t,St.get(t.texture).__webglTexture,St.get(t.depthTexture).__webglTexture)}let r=null,o=!1,s=!1;if(t){const n=t.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(s=!0);const i=St.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=i[e],o=!0):r=bt.isWebGL2&&t.samples>0&&!1===At.useMultisampledRTT(t)?St.get(t).__webglMultisampledFramebuffer:i,tt.copy(t.viewport),et.copy(t.scissor),nt=t.scissorTest}else tt.copy(lt).multiplyScalar(ot).floor(),et.copy(ut).multiplyScalar(ot).floor(),nt=ct;if(_t.bindFramebuffer(36160,r)&&bt.drawBuffers&&i&&_t.drawBuffers(t,r),_t.viewport(tt),_t.scissor(et),_t.setScissorTest(nt),o){const i=St.get(t.texture);Ut.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,n)}else if(s){const i=St.get(t.texture),r=e||0;Ut.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}K=-1},this.readRenderTargetPixels=function(t,e,n,i,r,o,s){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=St.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){_t.bindFramebuffer(36160,a);try{const s=t.texture,a=s.format,l=s.type;if(a!==qi&&Vt.convert(a)!==Ut.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const u=l===Ei&&(xt.has("EXT_color_buffer_half_float")||bt.isWebGL2&&xt.has("EXT_color_buffer_float"));if(!(l===bi||Vt.convert(l)===Ut.getParameter(35738)||l===Ti&&(bt.isWebGL2||xt.has("OES_texture_float")||xt.has("WEBGL_color_buffer_float"))||u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&Ut.readPixels(e,n,i,r,Vt.convert(a),Vt.convert(l),o)}finally{const t=null!==J?St.get(J).__webglFramebuffer:null;_t.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),o=Math.floor(e.image.height*i);At.setTexture2D(e,0),Ut.copyTexSubImage2D(3553,n,0,0,t.x,t.y,r,o),_t.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,o=e.image.height,s=Vt.convert(n.format),a=Vt.convert(n.type);At.setTexture2D(n,0),Ut.pixelStorei(37440,n.flipY),Ut.pixelStorei(37441,n.premultiplyAlpha),Ut.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?Ut.texSubImage2D(3553,i,t.x,t.y,r,o,s,a,e.image.data):e.isCompressedTexture?Ut.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,s,e.mipmaps[0].data):Ut.texSubImage2D(3553,i,t.x,t.y,s,a,e.image),0===i&&n.generateMipmaps&&Ut.generateMipmap(3553),_t.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i,r=0){if(X.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const o=t.max.x-t.min.x+1,s=t.max.y-t.min.y+1,a=t.max.z-t.min.z+1,l=Vt.convert(i.format),u=Vt.convert(i.type);let c;if(i.isData3DTexture)At.setTexture3D(i,0),c=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");At.setTexture2DArray(i,0),c=35866}Ut.pixelStorei(37440,i.flipY),Ut.pixelStorei(37441,i.premultiplyAlpha),Ut.pixelStorei(3317,i.unpackAlignment);const h=Ut.getParameter(3314),d=Ut.getParameter(32878),p=Ut.getParameter(3316),f=Ut.getParameter(3315),m=Ut.getParameter(32877),g=n.isCompressedTexture?n.mipmaps[0]:n.image;Ut.pixelStorei(3314,g.width),Ut.pixelStorei(32878,g.height),Ut.pixelStorei(3316,t.min.x),Ut.pixelStorei(3315,t.min.y),Ut.pixelStorei(32877,t.min.z),n.isDataTexture||n.isData3DTexture?Ut.texSubImage3D(c,r,e.x,e.y,e.z,o,s,a,l,u,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ut.compressedTexSubImage3D(c,r,e.x,e.y,e.z,o,s,a,l,g.data)):Ut.texSubImage3D(c,r,e.x,e.y,e.z,o,s,a,l,u,g),Ut.pixelStorei(3314,h),Ut.pixelStorei(32878,d),Ut.pixelStorei(3316,p),Ut.pixelStorei(3315,f),Ut.pixelStorei(32877,m),0===r&&i.generateMipmaps&&Ut.generateMipmap(c),_t.unbindTexture()},this.initTexture=function(t){At.setTexture2D(t,0),_t.unbindTexture()},this.resetState=function(){Z=0,Q=0,J=null,_t.reset(),Nt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function he(t,e,n,i,r,o){su.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(au.x=o*su.x-r*su.y,au.y=r*su.x+o*su.y):au.copy(su),t.copy(e),t.x+=au.x,t.y+=au.y,t.applyMatrix4(lu)}function de(t,e,n,i,r,o,s){const a=Zu.distanceSqToPoint(t);if(a<n){const n=new Uo;Zu.closestPointToPoint(t,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:s})}}function pe(){function t(t,o,s,a){e=t,n=s,i=-3*t+3*o-2*s-a,r=2*t-2*o+s+a}let e=0,n=0,i=0,r=0;return{initCatmullRom:function(e,n,i,r,o){t(n,i,o*(i-e),o*(r-n))},initNonuniformCatmullRom:function(e,n,i,r,o,s,a){let l=(n-e)/o-(i-e)/(o+s)+(i-n)/s,u=(i-n)/s-(r-n)/(s+a)+(r-i)/a;l*=s,u*=s,t(n,i,l,u)},calc:function(t){const o=t*t;return e+n*t+i*o+r*(o*t)}}}function fe(t,e,n,i,r){const o=.5*(i-e),s=.5*(r-n),a=t*t;return(2*n-2*i+o+s)*(t*a)+(-3*n+3*i-2*o-s)*a+o*t+n}function me(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function ge(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}function ye(t,e,n,i,r){let o,s;if(r===function(t,e,n,i){let r=0;for(let o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}(t,e,n,i)>0)for(o=e;o<n;o+=i)s=Be(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=Be(o,t[o],t[o+1],s);return s&&Oe(s,s.next)&&(Fe(s),s=s.next),s}function ve(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!Oe(i,i.next)&&0!==Re(i.prev,i,i.next))i=i.next;else{if(Fe(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function xe(t,e,n,i,r,o,s){if(!t)return;!s&&o&&function(t,e,n,i){let r=t;do{null===r.z&&(r.z=Ee(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ,i);e++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(t,i,r,o);let a,l,u=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,o?_e(t,i,r,o):be(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),Fe(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?xe(t=we(ve(t),e,n),e,n,i,r,o,2):2===s&&Se(t,e,n,i,r,o):xe(ve(t),e,n,i,r,o,1);break}}function be(t){const e=t.prev,n=t,i=t.next;if(Re(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(Ce(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Re(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function _e(t,e,n,i){const r=t.prev,o=t,s=t.next;if(Re(r,o,s)>=0)return!1;const a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=Ee(a,l,e,n,i),d=Ee(u,c,e,n,i);let p=t.prevZ,f=t.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&Ce(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Re(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&Ce(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Re(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&Ce(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Re(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&Ce(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Re(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function we(t,e,n){let i=t;do{const r=i.prev,o=i.next.next;!Oe(r,o)&&qe(r,i,i.next,o)&&ze(r,o)&&ze(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Fe(i),Fe(i.next),i=t=o),i=i.next}while(i!==t);return ve(i)}function Se(t,e,n,i,r,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&Ie(s,t)){let a=ke(s,t);return s=ve(s,s.next),a=ve(a,a.next),xe(s,e,n,i,r,o),void xe(a,e,n,i,r,o)}t=t.next}s=s.next}while(s!==t)}function Ae(t,e){return t.x-e.x}function Me(t,e){if(e=function(t,e){let n=e;const i=t.x,r=t.y;let o,s=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>s){if(s=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(i===s)return o;const a=o,l=o.x,u=o.y;let c,h=1/0;n=o;do{i>=n.x&&n.x>=l&&i!==n.x&&Ce(r<u?i:s,r,l,u,r<u?s:i,r,n.x,n.y)&&(c=Math.abs(r-n.y)/(i-n.x),ze(n,t)&&(c<h||c===h&&(n.x>o.x||n.x===o.x&&Te(o,n)))&&(o=n,h=c)),n=n.next}while(n!==a);return o}(t,e),e){const n=ke(e,t);ve(e,e.next),ve(n,n.next)}}function Te(t,e){return Re(t.prev,t,e.prev)<0&&Re(e.next,t,t.next)<0}function Ee(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Pe(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Ce(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function Ie(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&qe(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(ze(t,e)&&ze(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Re(t.prev,t,e.prev)||Re(t,e.prev,e))||Oe(t,e)&&Re(t.prev,t,t.next)>0&&Re(e.prev,e,e.next)>0)}function Re(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Oe(t,e){return t.x===e.x&&t.y===e.y}function qe(t,e,n,i){const r=De(Re(t,e,n)),o=De(Re(t,e,i)),s=De(Re(n,i,t)),a=De(Re(n,i,e));return r!==o&&s!==a||!(0!==r||!Le(t,n,e))||!(0!==o||!Le(t,i,e))||!(0!==s||!Le(n,t,i))||!(0!==a||!Le(n,e,i))}function Le(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function De(t){return t>0?1:t<0?-1:0}function ze(t,e){return Re(t.prev,t,t.next)<0?Re(t,e,t.next)>=0&&Re(t,t.prev,e)>=0:Re(t,e,t.prev)<0||Re(t,t.next,e)<0}function ke(t,e){const n=new Ve(t.i,t.x,t.y),i=new Ve(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Be(t,e,n,i){const r=new Ve(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Fe(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ve(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ne(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Ue(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function je(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}function Ge(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ph;case"vector":case"vector2":case"vector3":case"vector4":return yh;case"color":return dh;case"quaternion":return mh;case"bool":case"boolean":return hh;case"string":return gh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];oh.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function He(){return("undefined"==typeof performance?Date:performance).now()}function We(t,e){return t.distance-e.distance}function Xe(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i){const i=t.children;for(let t=0,r=i.length;t<r;t++)Xe(i[t],e,n,!0)}}function Ye(t){const e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,Ye(t.children[n]));return e}function Ze(t,e,n,i,r,o,s){yp.set(r,o,s).unproject(i);const a=e[t];if(void 0!==a){const t=n.getAttribute("position");for(let e=0,n=a.length;e<n;e++)t.setXYZ(a[e],yp.x,yp.y,yp.z)}}function Qe(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function Je(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function Ke(){console.error("THREE.ImmediateRenderObject has been removed.")}n.r(e),n.d(e,{ACESFilmicToneMapping:()=>$n,AddEquation:()=>wn,AddOperation:()=>Yn,AdditiveAnimationBlendMode:()=>Mr,AdditiveBlending:()=>vn,AlphaFormat:()=>Ri,AlwaysDepth:()=>Fn,AlwaysStencilFunc:()=>$r,AmbientLight:()=>Wh,AmbientLightProbe:()=>ud,AnimationClip:()=>vh,AnimationLoader:()=>Mh,AnimationMixer:()=>Ud,AnimationObjectGroup:()=>Fd,AnimationUtils:()=>oh,ArcCurve:()=>oc,ArrayCamera:()=>Ul,ArrowHelper:()=>Ep,Audio:()=>bd,AudioAnalyser:()=>Td,AudioContext:()=>sd,AudioListener:()=>xd,AudioLoader:()=>ad,AxesHelper:()=>Pp,BackSide:()=>dn,BasicDepthPacking:()=>Rr,BasicShadowMap:()=>an,Bone:()=>Mu,BooleanKeyframeTrack:()=>hh,Box2:()=>Qd,Box3:()=>Ho,Box3Helper:()=>wp,BoxBufferGeometry:()=>ja,BoxGeometry:()=>ja,BoxHelper:()=>_p,BufferAttribute:()=>sa,BufferGeometry:()=>Aa,BufferGeometryLoader:()=>$h,ByteType:()=>_i,Cache:()=>xh,Camera:()=>Wa,CameraHelper:()=>xp,CanvasTexture:()=>nc,CapsuleBufferGeometry:()=>wc,CapsuleGeometry:()=>wc,CatmullRomCurve3:()=>cc,CineonToneMapping:()=>Kn,CircleBufferGeometry:()=>Sc,CircleGeometry:()=>Sc,ClampToEdgeWrapping:()=>li,Clock:()=>fd,Color:()=>Po,ColorKeyframeTrack:()=>dh,ColorManagement:()=>So,CompressedTexture:()=>ec,CompressedTextureLoader:()=>Th,ConeBufferGeometry:()=>Mc,ConeGeometry:()=>Mc,CubeCamera:()=>Za,CubeReflectionMapping:()=>ni,CubeRefractionMapping:()=>ii,CubeTexture:()=>Qa,CubeTextureLoader:()=>Ph,CubeUVReflectionMapping:()=>si,CubicBezierCurve:()=>hc,CubicBezierCurve3:()=>dc,CubicInterpolant:()=>ah,CullFaceBack:()=>rn,CullFaceFront:()=>on,CullFaceFrontBack:()=>sn,CullFaceNone:()=>nn,Curve:()=>ic,CurvePath:()=>xc,CustomBlending:()=>_n,CustomToneMapping:()=>ti,CylinderBufferGeometry:()=>Ac,CylinderGeometry:()=>Ac,Cylindrical:()=>Yd,Data3DTexture:()=>Bo,DataArrayTexture:()=>zo,DataTexture:()=>Tu,DataTexture2DArray:()=>Up,DataTexture3D:()=>jp,DataTextureLoader:()=>Ch,DataUtils:()=>Ip,DecrementStencilOp:()=>Ur,DecrementWrapStencilOp:()=>Gr,DefaultLoadingManager:()=>_h,DepthFormat:()=>zi,DepthStencilFormat:()=>ki,DepthTexture:()=>Wl,DirectionalLight:()=>Hh,DirectionalLightHelper:()=>gp,DiscreteInterpolant:()=>uh,DodecahedronBufferGeometry:()=>Ec,DodecahedronGeometry:()=>Ec,DoubleSide:()=>pn,DstAlphaFactor:()=>qn,DstColorFactor:()=>Dn,DynamicCopyUsage:()=>ao,DynamicDrawUsage:()=>eo,DynamicReadUsage:()=>ro,EdgesGeometry:()=>Oc,EllipseCurve:()=>rc,EqualDepth:()=>Un,EqualStencilFunc:()=>Yr,EquirectangularReflectionMapping:()=>ri,EquirectangularRefractionMapping:()=>oi,Euler:()=>Ps,EventDispatcher:()=>po,ExtrudeBufferGeometry:()=>Dc,ExtrudeGeometry:()=>Dc,FileLoader:()=>Ah,FlatShading:()=>fn,Float16BufferAttribute:()=>fa,Float32BufferAttribute:()=>ma,Float64BufferAttribute:()=>ga,FloatType:()=>Ti,Fog:()=>Ql,FogExp2:()=>Zl,Font:()=>Je,FontLoader:()=>Qe,FramebufferTexture:()=>tc,FrontSide:()=>hn,Frustum:()=>rl,GLBufferAttribute:()=>Hd,GLSL1:()=>uo,GLSL3:()=>co,GreaterDepth:()=>Gn,GreaterEqualDepth:()=>jn,GreaterEqualStencilFunc:()=>Kr,GreaterStencilFunc:()=>Qr,GridHelper:()=>hp,Group:()=>jl,HalfFloatType:()=>Ei,HemisphereLight:()=>Oh,HemisphereLightHelper:()=>cp,HemisphereLightProbe:()=>ld,IcosahedronBufferGeometry:()=>kc,IcosahedronGeometry:()=>kc,ImageBitmapLoader:()=>rd,ImageLoader:()=>Eh,ImageUtils:()=>Io,ImmediateRenderObject:()=>Ke,IncrementStencilOp:()=>Nr,IncrementWrapStencilOp:()=>jr,InstancedBufferAttribute:()=>Iu,InstancedBufferGeometry:()=>Kh,InstancedInterleavedBuffer:()=>Gd,InstancedMesh:()=>Du,Int16BufferAttribute:()=>ca,Int32BufferAttribute:()=>da,Int8BufferAttribute:()=>aa,IntType:()=>Ai,InterleavedBuffer:()=>Kl,InterleavedBufferAttribute:()=>tu,Interpolant:()=>sh,InterpolateDiscrete:()=>vr,InterpolateLinear:()=>xr,InterpolateSmooth:()=>br,InvertStencilOp:()=>Hr,KeepStencilOp:()=>Fr,KeyframeTrack:()=>ch,LOD:()=>vu,LatheBufferGeometry:()=>_c,LatheGeometry:()=>_c,Layers:()=>Cs,LessDepth:()=>Vn,LessEqualDepth:()=>Nn,LessEqualStencilFunc:()=>Zr,LessStencilFunc:()=>Xr,Light:()=>Rh,LightProbe:()=>Zh,Line:()=>Uu,Line3:()=>$d,LineBasicMaterial:()=>zu,LineCurve:()=>pc,LineCurve3:()=>fc,LineDashedMaterial:()=>ih,LineLoop:()=>Wu,LineSegments:()=>Hu,LinearEncoding:()=>Cr,LinearFilter:()=>mi,LinearInterpolant:()=>lh,LinearMipMapLinearFilter:()=>xi,LinearMipMapNearestFilter:()=>yi,LinearMipmapLinearFilter:()=>vi,LinearMipmapNearestFilter:()=>gi,LinearSRGBColorSpace:()=>kr,LinearToneMapping:()=>Qn,Loader:()=>wh,LoaderUtils:()=>Jh,LoadingManager:()=>bh,LoopOnce:()=>mr,LoopPingPong:()=>yr,LoopRepeat:()=>gr,LuminanceAlphaFormat:()=>Di,LuminanceFormat:()=>Li,MOUSE:()=>tn,Material:()=>na,MaterialLoader:()=>Qh,MathUtils:()=>vo,Matrix3:()=>bo,Matrix4:()=>vs,MaxEquation:()=>Tn,Mesh:()=>Ua,MeshBasicMaterial:()=>ia,MeshDepthMaterial:()=>Vl,MeshDistanceMaterial:()=>Nl,MeshLambertMaterial:()=>eh,MeshMatcapMaterial:()=>nh,MeshNormalMaterial:()=>th,MeshPhongMaterial:()=>Kc,MeshPhysicalMaterial:()=>Jc,MeshStandardMaterial:()=>Qc,MeshToonMaterial:()=>$c,MinEquation:()=>Mn,MirroredRepeatWrapping:()=>ui,MixOperation:()=>Xn,MultiplyBlending:()=>bn,MultiplyOperation:()=>Wn,NearestFilter:()=>ci,NearestMipMapLinearFilter:()=>fi,NearestMipMapNearestFilter:()=>di,NearestMipmapLinearFilter:()=>pi,NearestMipmapNearestFilter:()=>hi,NeverDepth:()=>Bn,NeverStencilFunc:()=>Wr,NoBlending:()=>gn,NoColorSpace:()=>Dr,NoToneMapping:()=>Zn,NormalAnimationBlendMode:()=>Ar,NormalBlending:()=>yn,NotEqualDepth:()=>Hn,NotEqualStencilFunc:()=>Jr,NumberKeyframeTrack:()=>ph,Object3D:()=>js,ObjectLoader:()=>td,ObjectSpaceNormalMap:()=>Lr,OctahedronBufferGeometry:()=>Bc,OctahedronGeometry:()=>Bc,OneFactor:()=>Pn,OneMinusDstAlphaFactor:()=>Ln,OneMinusDstColorFactor:()=>zn,OneMinusSrcAlphaFactor:()=>On,OneMinusSrcColorFactor:()=>In,OrthographicCamera:()=>ul,PCFShadowMap:()=>ln,PCFSoftShadowMap:()=>un,PMREMGenerator:()=>yl,ParametricGeometry:()=>Fp,Path:()=>bc,PerspectiveCamera:()=>Xa,Plane:()=>el,PlaneBufferGeometry:()=>ol,PlaneGeometry:()=>ol,PlaneHelper:()=>Sp,PointLight:()=>jh,PointLightHelper:()=>sp,Points:()=>Ku,PointsMaterial:()=>Xu,PolarGridHelper:()=>dp,PolyhedronBufferGeometry:()=>Tc,PolyhedronGeometry:()=>Tc,PositionalAudio:()=>Md,PropertyBinding:()=>Bd,PropertyMixer:()=>Ed,QuadraticBezierCurve:()=>mc,QuadraticBezierCurve3:()=>gc,Quaternion:()=>No,QuaternionKeyframeTrack:()=>mh,QuaternionLinearInterpolant:()=>fh,REVISION:()=>$e,RGBADepthPacking:()=>Or,RGBAFormat:()=>qi,RGBAIntegerFormat:()=>Ui,RGBA_ASTC_10x10_Format:()=>hr,RGBA_ASTC_10x5_Format:()=>lr,RGBA_ASTC_10x6_Format:()=>ur,RGBA_ASTC_10x8_Format:()=>cr,RGBA_ASTC_12x10_Format:()=>dr,RGBA_ASTC_12x12_Format:()=>pr,RGBA_ASTC_4x4_Format:()=>tr,RGBA_ASTC_5x4_Format:()=>er,RGBA_ASTC_5x5_Format:()=>nr,RGBA_ASTC_6x5_Format:()=>ir,RGBA_ASTC_6x6_Format:()=>rr,RGBA_ASTC_8x5_Format:()=>or,RGBA_ASTC_8x6_Format:()=>sr,RGBA_ASTC_8x8_Format:()=>ar,RGBA_BPTC_Format:()=>fr,RGBA_ETC2_EAC_Format:()=>$i,RGBA_PVRTC_2BPPV1_Format:()=>Qi,RGBA_PVRTC_4BPPV1_Format:()=>Zi,RGBA_S3TC_DXT1_Format:()=>Gi,RGBA_S3TC_DXT3_Format:()=>Hi,RGBA_S3TC_DXT5_Format:()=>Wi,RGBFormat:()=>Oi,RGB_ETC1_Format:()=>Ji,RGB_ETC2_Format:()=>Ki,RGB_PVRTC_2BPPV1_Format:()=>Yi,RGB_PVRTC_4BPPV1_Format:()=>Xi,RGB_S3TC_DXT1_Format:()=>ji,RGFormat:()=>Vi,RGIntegerFormat:()=>Ni,RawShaderMaterial:()=>Zc,Ray:()=>ys,Raycaster:()=>Wd,RectAreaLight:()=>Xh,RedFormat:()=>Bi,RedIntegerFormat:()=>Fi,ReinhardToneMapping:()=>Jn,RepeatWrapping:()=>ai,ReplaceStencilOp:()=>Vr,ReverseSubtractEquation:()=>An,RingBufferGeometry:()=>Fc,RingGeometry:()=>Fc,SRGBColorSpace:()=>zr,Scene:()=>Jl,ShaderChunk:()=>sl,ShaderLib:()=>ll,ShaderMaterial:()=>Ha,ShadowMaterial:()=>Yc,Shape:()=>qc,ShapeBufferGeometry:()=>Vc,ShapeGeometry:()=>Vc,ShapePath:()=>Cp,ShapeUtils:()=>Lc,ShortType:()=>wi,Skeleton:()=>Cu,SkeletonHelper:()=>op,SkinnedMesh:()=>Au,SmoothShading:()=>mn,Source:()=>Ro,Sphere:()=>us,SphereBufferGeometry:()=>Nc,SphereGeometry:()=>Nc,Spherical:()=>Xd,SphericalHarmonics3:()=>Yh,SplineCurve:()=>yc,SpotLight:()=>Bh,SpotLightHelper:()=>ep,Sprite:()=>mu,SpriteMaterial:()=>eu,SrcAlphaFactor:()=>Rn,SrcAlphaSaturateFactor:()=>kn,SrcColorFactor:()=>Cn,StaticCopyUsage:()=>so,StaticDrawUsage:()=>to,StaticReadUsage:()=>io,StereoCamera:()=>pd,StreamCopyUsage:()=>lo,StreamDrawUsage:()=>no,StreamReadUsage:()=>oo,StringKeyframeTrack:()=>gh,SubtractEquation:()=>Sn,SubtractiveBlending:()=>xn,TOUCH:()=>en,TangentSpaceNormalMap:()=>qr,TetrahedronBufferGeometry:()=>Uc,TetrahedronGeometry:()=>Uc,TextGeometry:()=>Vp,Texture:()=>qo,TextureLoader:()=>Ih,TorusBufferGeometry:()=>jc,TorusGeometry:()=>jc,TorusKnotBufferGeometry:()=>Gc,TorusKnotGeometry:()=>Gc,Triangle:()=>ta,TriangleFanDrawMode:()=>Pr,TriangleStripDrawMode:()=>Er,TrianglesDrawMode:()=>Tr,TubeBufferGeometry:()=>Hc,TubeGeometry:()=>Hc,UVMapping:()=>ei,Uint16BufferAttribute:()=>ha,Uint32BufferAttribute:()=>pa,Uint8BufferAttribute:()=>la,Uint8ClampedBufferAttribute:()=>ua,Uniform:()=>jd,UniformsLib:()=>al,UniformsUtils:()=>Ga,UnsignedByteType:()=>bi,UnsignedInt248Type:()=>Ii,UnsignedIntType:()=>Mi,UnsignedShort4444Type:()=>Pi,UnsignedShort5551Type:()=>Ci,UnsignedShortType:()=>Si,VSMShadowMap:()=>cn,Vector2:()=>xo,Vector3:()=>Uo,Vector4:()=>Lo,VectorKeyframeTrack:()=>yh,VideoTexture:()=>$u,WebGL1Renderer:()=>Yl,WebGL3DRenderTarget:()=>Fo,WebGLArrayRenderTarget:()=>ko,WebGLCubeRenderTarget:()=>Ja,WebGLMultipleRenderTargets:()=>Vo,WebGLMultisampleRenderTarget:()=>Np,WebGLRenderTarget:()=>Do,WebGLRenderer:()=>ce,WebGLUtils:()=>le,WireframeGeometry:()=>Wc,WrapAroundEnding:()=>Sr,ZeroCurvatureEnding:()=>_r,ZeroFactor:()=>En,ZeroSlopeEnding:()=>wr,ZeroStencilOp:()=>Br,_SRGBAFormat:()=>ho,sRGBEncoding:()=>Ir});const $e="141",tn={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},en={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},nn=0,rn=1,on=2,sn=3,an=0,ln=1,un=2,cn=3,hn=0,dn=1,pn=2,fn=1,mn=2,gn=0,yn=1,vn=2,xn=3,bn=4,_n=5,wn=100,Sn=101,An=102,Mn=103,Tn=104,En=200,Pn=201,Cn=202,In=203,Rn=204,On=205,qn=206,Ln=207,Dn=208,zn=209,kn=210,Bn=0,Fn=1,Vn=2,Nn=3,Un=4,jn=5,Gn=6,Hn=7,Wn=0,Xn=1,Yn=2,Zn=0,Qn=1,Jn=2,Kn=3,$n=4,ti=5,ei=300,ni=301,ii=302,ri=303,oi=304,si=306,ai=1e3,li=1001,ui=1002,ci=1003,hi=1004,di=1004,pi=1005,fi=1005,mi=1006,gi=1007,yi=1007,vi=1008,xi=1008,bi=1009,_i=1010,wi=1011,Si=1012,Ai=1013,Mi=1014,Ti=1015,Ei=1016,Pi=1017,Ci=1018,Ii=1020,Ri=1021,Oi=1022,qi=1023,Li=1024,Di=1025,zi=1026,ki=1027,Bi=1028,Fi=1029,Vi=1030,Ni=1031,Ui=1033,ji=33776,Gi=33777,Hi=33778,Wi=33779,Xi=35840,Yi=35841,Zi=35842,Qi=35843,Ji=36196,Ki=37492,$i=37496,tr=37808,er=37809,nr=37810,ir=37811,rr=37812,or=37813,sr=37814,ar=37815,lr=37816,ur=37817,cr=37818,hr=37819,dr=37820,pr=37821,fr=36492,mr=2200,gr=2201,yr=2202,vr=2300,xr=2301,br=2302,_r=2400,wr=2401,Sr=2402,Ar=2500,Mr=2501,Tr=0,Er=1,Pr=2,Cr=3e3,Ir=3001,Rr=3200,Or=3201,qr=0,Lr=1,Dr="",zr="srgb",kr="srgb-linear",Br=0,Fr=7680,Vr=7681,Nr=7682,Ur=7683,jr=34055,Gr=34056,Hr=5386,Wr=512,Xr=513,Yr=514,Zr=515,Qr=516,Jr=517,Kr=518,$r=519,to=35044,eo=35048,no=35040,io=35045,ro=35049,oo=35041,so=35046,ao=35050,lo=35042,uo="100",co="300 es",ho=1035;class po{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}const fo=[];for(let t=0;t<256;t++)fo[t]=(t<16?"0":"")+t.toString(16);let mo=1234567;const go=Math.PI/180,yo=180/Math.PI;var vo=Object.freeze({__proto__:null,DEG2RAD:go,RAD2DEG:yo,generateUUID:i,clamp:r,euclideanModulo:o,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:s,damp:function(t,e,n,i){return s(t,e,1-Math.exp(-n*i))},pingpong:function(t,e=1){return e-Math.abs(o(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(mo=t);let e=mo+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*go},radToDeg:function(t){return t*yo},isPowerOfTwo:a,ceilPowerOfTwo:l,floorPowerOfTwo:u,setQuaternionFromProperEuler:function(t,e,n,i,r){const o=Math.cos,s=Math.sin,a=o(n/2),l=s(n/2),u=o((e+i)/2),c=s((e+i)/2),h=o((e-i)/2),d=s((e-i)/2),p=o((i-e)/2),f=s((i-e)/2);switch(r){case"XYX":t.set(a*c,l*h,l*d,a*u);break;case"YZY":t.set(l*d,a*c,l*h,a*u);break;case"ZXZ":t.set(l*h,l*d,a*c,a*u);break;case"XZX":t.set(a*c,l*f,l*p,a*u);break;case"YXY":t.set(l*p,a*c,l*f,a*u);break;case"ZYZ":t.set(l*f,l*p,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}},denormalize:function(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}});class xo{constructor(t=0,e=0){this.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class bo{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,o,s,a,l){const u=this.elements;return u[0]=t,u[1]=i,u[2]=s,u[3]=e,u[4]=r,u[5]=a,u[6]=n,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],y=i[1],v=i[4],x=i[7],b=i[2],_=i[5],w=i[8];return r[0]=o*f+s*y+a*b,r[3]=o*m+s*v+a*_,r[6]=o*g+s*x+a*w,r[1]=l*f+u*y+c*b,r[4]=l*m+u*v+c*_,r[7]=l*g+u*x+c*w,r[2]=h*f+d*y+p*b,r[5]=h*m+d*v+p*_,r[8]=h*g+d*x+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8];return e*o*u-e*s*l-n*r*u+n*s*a+i*r*l-i*o*a}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=u*o-s*l,h=s*a-u*r,d=l*r-o*a,p=e*c+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=c*f,t[1]=(i*l-u*n)*f,t[2]=(s*n-i*o)*f,t[3]=h*f,t[4]=(u*e-i*a)*f,t[5]=(i*r-s*e)*f,t[6]=d*f,t[7]=(n*a-l*e)*f,t[8]=(o*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,o,s){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*o+l*s)+o+t,-i*l,i*a,-i*(-l*o+a*s)+s+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],o=i[3],s=i[6],a=i[1],l=i[4],u=i[7];return i[0]=e*r+n*a,i[3]=e*o+n*l,i[6]=e*s+n*u,i[1]=-n*r+e*a,i[4]=-n*o+e*l,i[7]=-n*s+e*u,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const _o={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array},wo={[zr]:{[kr]:p},[kr]:{[zr]:f}},So={legacyMode:!0,get workingColorSpace(){return kr},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(wo[e]&&void 0!==wo[e][n]){const i=wo[e][n];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},Ao={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Mo={r:0,g:0,b:0},To={h:0,s:0,l:0},Eo={h:0,s:0,l:0};class Po{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=zr){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,So.toWorkingColorSpace(this,e),this}setRGB(t,e,n,i=kr){return this.r=t,this.g=e,this.b=n,So.toWorkingColorSpace(this,i),this}setHSL(t,e,n,i=kr){if(t=o(t,1),e=r(e,0,1),n=r(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=m(r,i,t+1/3),this.g=m(r,i,t),this.b=m(r,i,t-1/3)}return So.toWorkingColorSpace(this,i),this}setStyle(t,e=zr){function n(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=i[1],o=i[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,So.toWorkingColorSpace(this,e),n(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,So.toWorkingColorSpace(this,e),n(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const i=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,o=parseInt(t[3],10)/100;return n(t[4]),this.setHSL(i,r,o,e)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],n=t.length;if(3===n)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,So.toWorkingColorSpace(this,e),this;if(6===n)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,So.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=zr){const n=Ao[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=p(t.r),this.g=p(t.g),this.b=p(t.b),this}copyLinearToSRGB(t){return this.r=f(t.r),this.g=f(t.g),this.b=f(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=zr){return So.fromWorkingColorSpace(g(this,Mo),t),r(255*Mo.r,0,255)<<16^r(255*Mo.g,0,255)<<8^r(255*Mo.b,0,255)<<0}getHexString(t=zr){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=kr){So.fromWorkingColorSpace(g(this,Mo),e);const n=Mo.r,i=Mo.g,r=Mo.b,o=Math.max(n,i,r),s=Math.min(n,i,r);let a,l;const u=(s+o)/2;if(s===o)a=0,l=0;else{const t=o-s;switch(l=u<=.5?t/(o+s):t/(2-o-s),o){case n:a=(i-r)/t+(i<r?6:0);break;case i:a=(r-n)/t+2;break;case r:a=(n-i)/t+4}a/=6}return t.h=a,t.s=l,t.l=u,t}getRGB(t,e=kr){return So.fromWorkingColorSpace(g(this,Mo),e),t.r=Mo.r,t.g=Mo.g,t.b=Mo.b,t}getStyle(t=zr){return So.fromWorkingColorSpace(g(this,Mo),t),t!==zr?`color(${t} ${Mo.r} ${Mo.g} ${Mo.b})`:`rgb(${255*Mo.r|0},${255*Mo.g|0},${255*Mo.b|0})`}offsetHSL(t,e,n){return this.getHSL(To),To.h+=t,To.s+=e,To.l+=n,this.setHSL(To.h,To.s,To.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(To),t.getHSL(Eo);const n=s(To.h,Eo.h,e),i=s(To.s,Eo.s,e),r=s(To.l,Eo.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let Co;Po.NAMES=Ao;class Io{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Co&&(Co=d("canvas")),Co.width=t.width,Co.height=t.height;const n=Co.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Co}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=d("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*p(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*p(e[t]/255)):e[t]=p(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}class Ro{constructor(t=null){this.isSource=!0,this.uuid=i(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(y(i[e].image)):t.push(y(i[e]))}else t=y(i);n.url=t}return e||(t.images[this.uuid]=n),n}}let Oo=0;class qo extends po{constructor(t=qo.DEFAULT_IMAGE,e=qo.DEFAULT_MAPPING,n=li,r=li,o=mi,s=vi,a=qi,l=bi,u=1,c=Cr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Oo++}),this.uuid=i(),this.name="",this.source=new Ro(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=s,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new xo(0,0),this.repeat=new xo(1,1),this.center=new xo(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new bo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==ei)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ai:t.x=t.x-Math.floor(t.x);break;case li:t.x=t.x<0?0:1;break;case ui:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case ai:t.y=t.y-Math.floor(t.y);break;case li:t.y=t.y<0?0:1;break;case ui:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}qo.DEFAULT_IMAGE=null,qo.DEFAULT_MAPPING=ei;class Lo{constructor(t=0,e=0,n=0,i=1){this.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const o=.01,s=.1,a=t.elements,l=a[0],u=a[4],c=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(u-h)<o&&Math.abs(c-f)<o&&Math.abs(p-m)<o){if(Math.abs(u+h)<s&&Math.abs(c+f)<s&&Math.abs(p+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,y=(g+1)/2,v=(u+h)/4,x=(c+f)/4,b=(p+m)/4;return t>a&&t>y?t<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=v/n,r=x/n):a>y?a<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=v/i,r=b/i):y<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(y),n=x/r,i=b/r),this.set(n,i,r,e),this}let y=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(h-u)*(h-u));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(c-f)/y,this.z=(h-u)/y,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Do extends po{constructor(t,e,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Lo(0,0,t,e),this.scissorTest=!1,this.viewport=new Lo(0,0,t,e);const i={width:t,height:e,depth:1};this.texture=new qo(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:mi,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new Ro(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class zo extends qo{constructor(t=null,e=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=ci,this.minFilter=ci,this.wrapR=li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ko extends Do{constructor(t,e,n){super(t,e),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new zo(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class Bo extends qo{constructor(t=null,e=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=ci,this.minFilter=ci,this.wrapR=li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Fo extends Do{constructor(t,e,n){super(t,e),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Bo(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class Vo extends Do{constructor(t,e,n,i={}){super(t,e,i),this.isWebGLMultipleRenderTargets=!0;const r=this.texture;this.texture=[];for(let t=0;t<n;t++)this.texture[t]=r.clone(),this.texture[t].isRenderTargetTexture=!0}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}}class No{constructor(t=0,e=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,o,s){let a=n[i+0],l=n[i+1],u=n[i+2],c=n[i+3];const h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(0===s)return t[e+0]=a,t[e+1]=l,t[e+2]=u,void(t[e+3]=c);if(1===s)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(c!==f||a!==h||l!==d||u!==p){let t=1-s;const e=a*h+l*d+u*p+c*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),o=Math.atan2(r,e*n);t=Math.sin(t*o)/r,s=Math.sin(s*o)/r}const r=s*n;if(a=a*t+h*r,l=l*t+d*r,u=u*t+p*r,c=c*t+f*r,t===1-s){const t=1/Math.sqrt(a*a+l*l+u*u+c*c);a*=t,l*=t,u*=t,c*=t}}t[e]=a,t[e+1]=l,t[e+2]=u,t[e+3]=c}static multiplyQuaternionsFlat(t,e,n,i,r,o){const s=n[i],a=n[i+1],l=n[i+2],u=n[i+3],c=r[o],h=r[o+1],d=r[o+2],p=r[o+3];return t[e]=s*p+u*c+a*d-l*h,t[e+1]=a*p+u*h+l*c-s*d,t[e+2]=l*p+u*d+s*h-a*c,t[e+3]=u*p-s*c-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,r=t._z,o=t._order,s=Math.cos,a=Math.sin,l=s(n/2),u=s(i/2),c=s(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(o){case"XYZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"YXZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"ZXY":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"ZYX":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"YZX":this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p;break;case"XZY":this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],o=e[1],s=e[5],a=e[9],l=e[2],u=e[6],c=e[10],h=n+s+c;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(u-a)*t,this._y=(r-l)*t,this._z=(o-i)*t}else if(n>s&&n>c){const t=2*Math.sqrt(1+n-s-c);this._w=(u-a)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(r+l)/t}else if(s>c){const t=2*Math.sqrt(1+s-n-c);this._w=(r-l)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(a+u)/t}else{const t=2*Math.sqrt(1+c-n-s);this._w=(o-i)/t,this._x=(r+l)/t,this._y=(a+u)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(r(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,o=t._w,s=e._x,a=e._y,l=e._z,u=e._w;return this._x=n*u+o*s+i*l-r*a,this._y=i*u+o*a+r*s-n*l,this._z=r*u+o*l+n*a-i*s,this._w=o*u-n*s-i*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,o=this._w;let s=o*t._w+n*t._x+i*t._y+r*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;const a=1-s*s;if(a<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),u=Math.atan2(l,s),c=Math.sin((1-e)*u)/l,h=Math.sin(e*u)/l;return this._w=o*c+this._w*h,this._x=n*c+this._x*h,this._y=i*c+this._y*h,this._z=r*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Uo{constructor(t=0,e=0,n=0){this.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Go.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Go.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=t.w,l=a*e+o*i-s*n,u=a*n+s*e-r*i,c=a*i+r*n-o*e,h=-r*e-o*n-s*i;return this.x=l*a+h*-r+u*-s-c*-o,this.y=u*a+h*-o+c*-r-l*-s,this.z=c*a+h*-s+l*-o-u*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,o=e.x,s=e.y,a=e.z;return this.x=i*a-r*s,this.y=r*o-n*a,this.z=n*s-i*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return jo.copy(this).projectOnVector(t),this.sub(jo)}reflect(t){return this.sub(jo.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(r(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const jo=new Uo,Go=new No;class Ho{constructor(t=new Uo(1/0,1/0,1/0),e=new Uo(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],u=t[a+1],c=t[a+2];l<e&&(e=l),u<n&&(n=u),c<i&&(i=c),l>r&&(r=l),u>o&&(o=u),c>s&&(s=c)}return this.min.set(e,n,i),this.max.set(r,o,s),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),u=t.getY(a),c=t.getZ(a);l<e&&(e=l),u<n&&(n=u),c<i&&(i=c),l>r&&(r=l),u>o&&(o=u),c>s&&(s=c)}return this.min.set(e,n,i),this.max.set(r,o,s),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Xo.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,i=e.count;n<i;n++)Xo.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(Xo)}else null===n.boundingBox&&n.computeBoundingBox(),Yo.copy(n.boundingBox),Yo.applyMatrix4(t.matrixWorld),this.union(Yo);const i=t.children;for(let t=0,n=i.length;t<n;t++)this.expandByObject(i[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Xo),Xo.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(es),ns.subVectors(this.max,es),Zo.subVectors(t.a,es),Qo.subVectors(t.b,es),Jo.subVectors(t.c,es),Ko.subVectors(Qo,Zo),$o.subVectors(Jo,Qo),ts.subVectors(Zo,Jo);let e=[0,-Ko.z,Ko.y,0,-$o.z,$o.y,0,-ts.z,ts.y,Ko.z,0,-Ko.x,$o.z,0,-$o.x,ts.z,0,-ts.x,-Ko.y,Ko.x,0,-$o.y,$o.x,0,-ts.y,ts.x,0];return!!v(e,Zo,Qo,Jo,ns)&&(e=[1,0,0,0,1,0,0,0,1],!!v(e,Zo,Qo,Jo,ns)&&(is.crossVectors(Ko,$o),e=[is.x,is.y,is.z],v(e,Zo,Qo,Jo,ns)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Xo.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Xo).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Wo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Wo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Wo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Wo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Wo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Wo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Wo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Wo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Wo)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Wo=[new Uo,new Uo,new Uo,new Uo,new Uo,new Uo,new Uo,new Uo],Xo=new Uo,Yo=new Ho,Zo=new Uo,Qo=new Uo,Jo=new Uo,Ko=new Uo,$o=new Uo,ts=new Uo,es=new Uo,ns=new Uo,is=new Uo,rs=new Uo,os=new Ho,ss=new Uo,as=new Uo,ls=new Uo;class us{constructor(t=new Uo,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):os.setFromPoints(t).getCenter(n);let i=0;for(let e=0,r=t.length;e<r;e++)i=Math.max(i,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){ls.subVectors(t,this.center);const e=ls.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(ls.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return!0===this.center.equals(t.center)?as.set(0,0,1).multiplyScalar(t.radius):as.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(ss.copy(t.center).add(as)),this.expandByPoint(ss.copy(t.center).sub(as)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const cs=new Uo,hs=new Uo,ds=new Uo,ps=new Uo,fs=new Uo,ms=new Uo,gs=new Uo;class ys{constructor(t=new Uo,e=new Uo(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,cs)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=cs.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(cs.copy(this.direction).multiplyScalar(e).add(this.origin),cs.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){hs.copy(t).add(e).multiplyScalar(.5),ds.copy(e).sub(t).normalize(),ps.copy(this.origin).sub(hs);const r=.5*t.distanceTo(e),o=-this.direction.dot(ds),s=ps.dot(this.direction),a=-ps.dot(ds),l=ps.lengthSq(),u=Math.abs(1-o*o);let c,h,d,p;if(u>0)if(c=o*a-s,h=o*s-a,p=r*u,c>=0)if(h>=-p)if(h<=p){const t=1/u;c*=t,h*=t,d=c*(c+o*h+2*s)+h*(o*c+h+2*a)+l}else h=r,c=Math.max(0,-(o*h+s)),d=-c*c+h*(h+2*a)+l;else h=-r,c=Math.max(0,-(o*h+s)),d=-c*c+h*(h+2*a)+l;else h<=-p?(c=Math.max(0,-(-o*r+s)),h=c>0?-r:Math.min(Math.max(-r,-a),r),d=-c*c+h*(h+2*a)+l):h<=p?(c=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(c=Math.max(0,-(o*r+s)),h=c>0?r:Math.min(Math.max(-r,-a),r),d=-c*c+h*(h+2*a)+l);else h=o>0?-r:r,c=Math.max(0,-(o*h+s)),d=-c*c+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),i&&i.copy(ds).multiplyScalar(h).add(hs),d}intersectSphere(t,e){cs.subVectors(t.center,this.origin);const n=cs.dot(this.direction),i=cs.dot(cs)-n*n,r=t.radius*t.radius;if(i>r)return null;const o=Math.sqrt(r-i),s=n-o,a=n+o;return s<0&&a<0?null:s<0?this.at(a,e):this.at(s,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,o,s,a;const l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),u>=0?(r=(t.min.y-h.y)*u,o=(t.max.y-h.y)*u):(r=(t.max.y-h.y)*u,o=(t.min.y-h.y)*u),n>o||r>i?null:((r>n||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),c>=0?(s=(t.min.z-h.z)*c,a=(t.max.z-h.z)*c):(s=(t.max.z-h.z)*c,a=(t.min.z-h.z)*c),n>a||s>i?null:((s>n||n!=n)&&(n=s),(a<i||i!=i)&&(i=a),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,cs)}intersectTriangle(t,e,n,i,r){fs.subVectors(e,t),ms.subVectors(n,t),gs.crossVectors(fs,ms);let o,s=this.direction.dot(gs);if(s>0){if(i)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}ps.subVectors(this.origin,t);const a=o*this.direction.dot(ms.crossVectors(ps,ms));if(a<0)return null;const l=o*this.direction.dot(fs.cross(ps));if(l<0)return null;if(a+l>s)return null;const u=-o*ps.dot(gs);return u<0?null:this.at(u/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class vs{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,o,s,a,l,u,c,h,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new vs).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/xs.setFromMatrixColumn(t,0).length(),r=1/xs.setFromMatrixColumn(t,1).length(),o=1/xs.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(i),l=Math.sin(i),u=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){const t=o*u,n=o*c,i=s*u,r=s*c;e[0]=a*u,e[4]=-a*c,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-s*a,e[2]=r-t*l,e[6]=i+n*l,e[10]=o*a}else if("YXZ"===t.order){const t=a*u,n=a*c,i=l*u,r=l*c;e[0]=t+r*s,e[4]=i*s-n,e[8]=o*l,e[1]=o*c,e[5]=o*u,e[9]=-s,e[2]=n*s-i,e[6]=r+t*s,e[10]=o*a}else if("ZXY"===t.order){const t=a*u,n=a*c,i=l*u,r=l*c;e[0]=t-r*s,e[4]=-o*c,e[8]=i+n*s,e[1]=n+i*s,e[5]=o*u,e[9]=r-t*s,e[2]=-o*l,e[6]=s,e[10]=o*a}else if("ZYX"===t.order){const t=o*u,n=o*c,i=s*u,r=s*c;e[0]=a*u,e[4]=i*l-n,e[8]=t*l+r,e[1]=a*c,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=s*a,e[10]=o*a}else if("YZX"===t.order){const t=o*a,n=o*l,i=s*a,r=s*l;e[0]=a*u,e[4]=r-t*c,e[8]=i*c+n,e[1]=c,e[5]=o*u,e[9]=-s*u,e[2]=-l*u,e[6]=n*c+i,e[10]=t-r*c}else if("XZY"===t.order){const t=o*a,n=o*l,i=s*a,r=s*l;e[0]=a*u,e[4]=-c,e[8]=l*u,e[1]=t*c+r,e[5]=o*u,e[9]=n*c-i,e[2]=i*c-n,e[6]=s*u,e[10]=r*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(_s,t,ws)}lookAt(t,e,n){const i=this.elements;return Ms.subVectors(t,e),0===Ms.lengthSq()&&(Ms.z=1),Ms.normalize(),Ss.crossVectors(n,Ms),0===Ss.lengthSq()&&(1===Math.abs(n.z)?Ms.x+=1e-4:Ms.z+=1e-4,Ms.normalize(),Ss.crossVectors(n,Ms)),Ss.normalize(),As.crossVectors(Ms,Ss),i[0]=Ss.x,i[4]=As.x,i[8]=Ms.x,i[1]=Ss.y,i[5]=As.y,i[9]=Ms.y,i[2]=Ss.z,i[6]=As.z,i[10]=Ms.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],y=n[3],v=n[7],x=n[11],b=n[15],_=i[0],w=i[4],S=i[8],A=i[12],M=i[1],T=i[5],E=i[9],P=i[13],C=i[2],I=i[6],R=i[10],O=i[14],q=i[3],L=i[7],D=i[11],z=i[15];return r[0]=o*_+s*M+a*C+l*q,r[4]=o*w+s*T+a*I+l*L,r[8]=o*S+s*E+a*R+l*D,r[12]=o*A+s*P+a*O+l*z,r[1]=u*_+c*M+h*C+d*q,r[5]=u*w+c*T+h*I+d*L,r[9]=u*S+c*E+h*R+d*D,r[13]=u*A+c*P+h*O+d*z,r[2]=p*_+f*M+m*C+g*q,r[6]=p*w+f*T+m*I+g*L,r[10]=p*S+f*E+m*R+g*D,r[14]=p*A+f*P+m*O+g*z,r[3]=y*_+v*M+x*C+b*q,r[7]=y*w+v*T+x*I+b*L,r[11]=y*S+v*E+x*R+b*D,r[15]=y*A+v*P+x*O+b*z,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],s=t[5],a=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+r*a*c-i*l*c-r*s*h+n*l*h+i*s*d-n*a*d)+t[7]*(+e*a*d-e*l*h+r*o*h-i*o*d+i*l*u-r*a*u)+t[11]*(+e*l*c-e*s*d-r*o*c+n*o*d+r*s*u-n*l*u)+t[15]*(-i*s*u-e*a*c+e*s*h+i*o*c-n*o*h+n*a*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],y=c*m*l-f*h*l+f*a*d-s*m*d-c*a*g+s*h*g,v=p*h*l-u*m*l-p*a*d+o*m*d+u*a*g-o*h*g,x=u*f*l-p*c*l+p*s*d-o*f*d-u*s*g+o*c*g,b=p*c*a-u*f*a-p*s*h+o*f*h+u*s*m-o*c*m,_=e*y+n*v+i*x+r*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return t[0]=y*w,t[1]=(f*h*r-c*m*r-f*i*d+n*m*d+c*i*g-n*h*g)*w,t[2]=(s*m*r-f*a*r+f*i*l-n*m*l-s*i*g+n*a*g)*w,t[3]=(c*a*r-s*h*r-c*i*l+n*h*l+s*i*d-n*a*d)*w,t[4]=v*w,t[5]=(u*m*r-p*h*r+p*i*d-e*m*d-u*i*g+e*h*g)*w,t[6]=(p*a*r-o*m*r-p*i*l+e*m*l+o*i*g-e*a*g)*w,t[7]=(o*h*r-u*a*r+u*i*l-e*h*l-o*i*d+e*a*d)*w,t[8]=x*w,t[9]=(p*c*r-u*f*r-p*n*d+e*f*d+u*n*g-e*c*g)*w,t[10]=(o*f*r-p*s*r+p*n*l-e*f*l-o*n*g+e*s*g)*w,t[11]=(u*s*r-o*c*r-u*n*l+e*c*l+o*n*d-e*s*d)*w,t[12]=b*w,t[13]=(u*f*i-p*c*i+p*n*h-e*f*h-u*n*m+e*c*m)*w,t[14]=(p*s*i-o*f*i-p*n*a+e*f*a+o*n*m-e*s*m)*w,t[15]=(o*c*i-u*s*i+u*n*a-e*c*a-o*n*h+e*s*h)*w,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,s=t.y,a=t.z,l=r*o,u=r*s;return this.set(l*o+n,l*s-i*a,l*a+i*s,0,l*s+i*a,u*s+n,u*a-i*o,0,l*a-i*s,u*a+i*o,r*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,o){return this.set(1,n,r,0,t,1,o,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,o=e._y,s=e._z,a=e._w,l=r+r,u=o+o,c=s+s,h=r*l,d=r*u,p=r*c,f=o*u,m=o*c,g=s*c,y=a*l,v=a*u,x=a*c,b=n.x,_=n.y,w=n.z;return i[0]=(1-(f+g))*b,i[1]=(d+x)*b,i[2]=(p-v)*b,i[3]=0,i[4]=(d-x)*_,i[5]=(1-(h+g))*_,i[6]=(m+y)*_,i[7]=0,i[8]=(p+v)*w,i[9]=(m-y)*w,i[10]=(1-(h+f))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=xs.set(i[0],i[1],i[2]).length();const o=xs.set(i[4],i[5],i[6]).length(),s=xs.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],bs.copy(this);const a=1/r,l=1/o,u=1/s;return bs.elements[0]*=a,bs.elements[1]*=a,bs.elements[2]*=a,bs.elements[4]*=l,bs.elements[5]*=l,bs.elements[6]*=l,bs.elements[8]*=u,bs.elements[9]*=u,bs.elements[10]*=u,e.setFromRotationMatrix(bs),n.x=r,n.y=o,n.z=s,this}makePerspective(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const s=this.elements,a=2*r/(e-t),l=2*r/(n-i),u=(e+t)/(e-t),c=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return s[0]=a,s[4]=0,s[8]=u,s[12]=0,s[1]=0,s[5]=l,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,n,i,r,o){const s=this.elements,a=1/(e-t),l=1/(n-i),u=1/(o-r),c=(e+t)*a,h=(n+i)*l,d=(o+r)*u;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*u,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const xs=new Uo,bs=new vs,_s=new Uo(0,0,0),ws=new Uo(1,1,1),Ss=new Uo,As=new Uo,Ms=new Uo,Ts=new vs,Es=new No;class Ps{constructor(t=0,e=0,n=0,i=Ps.DefaultOrder){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,o=i[0],s=i[4],a=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],p=i[10];switch(e){case"XYZ":this._y=Math.asin(r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Ts.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Ts,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Es.setFromEuler(this),this.setFromQuaternion(Es,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Ps.DefaultOrder="XYZ",Ps.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Cs{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Is=0;const Rs=new Uo,Os=new No,qs=new vs,Ls=new Uo,Ds=new Uo,zs=new Uo,ks=new No,Bs=new Uo(1,0,0),Fs=new Uo(0,1,0),Vs=new Uo(0,0,1),Ns={type:"added"},Us={type:"removed"};class js extends po{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Is++}),this.uuid=i(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=js.DefaultUp.clone();const t=new Uo,e=new Ps,n=new No,r=new Uo(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new vs},normalMatrix:{value:new bo}}),this.matrix=new vs,this.matrixWorld=new vs,this.matrixAutoUpdate=js.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Cs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Os.setFromAxisAngle(t,e),this.quaternion.multiply(Os),this}rotateOnWorldAxis(t,e){return Os.setFromAxisAngle(t,e),this.quaternion.premultiply(Os),this}rotateX(t){return this.rotateOnAxis(Bs,t)}rotateY(t){return this.rotateOnAxis(Fs,t)}rotateZ(t){return this.rotateOnAxis(Vs,t)}translateOnAxis(t,e){return Rs.copy(t).applyQuaternion(this.quaternion),this.position.add(Rs.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Bs,t)}translateY(t){return this.translateOnAxis(Fs,t)}translateZ(t){return this.translateOnAxis(Vs,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(qs.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Ls.copy(t):Ls.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ds.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qs.lookAt(Ds,Ls,this.up):qs.lookAt(Ls,Ds,this.up),this.quaternion.setFromRotationMatrix(qs),i&&(qs.extractRotation(i.matrixWorld),Os.setFromRotationMatrix(qs),this.quaternion.premultiply(Os.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Ns)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Us)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Us)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),qs.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),qs.multiply(t.parent.matrixWorld)),t.applyMatrix4(qs),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ds,t,zs),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ds,ks,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){function e(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}function n(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=e(t.geometries,this.geometry);const n=this.geometry.parameters;if(void 0!==n&&void 0!==n.shapes){const i=n.shapes;if(Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const r=i[n];e(t.shapes,r)}else e(t.shapes,i)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(e(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const n=[];for(let i=0,r=this.material.length;i<r;i++)n.push(e(t.materials,this.material[i]));o.material=n}else o.material=e(t.materials,this.material);if(this.children.length>0){o.children=[];for(let e=0;e<this.children.length;e++)o.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let n=0;n<this.animations.length;n++){const i=this.animations[n];o.animations.push(e(t.animations,i))}}if(i){const e=n(t.geometries),i=n(t.materials),o=n(t.textures),s=n(t.images),a=n(t.shapes),l=n(t.skeletons),u=n(t.animations),c=n(t.nodes);e.length>0&&(r.geometries=e),i.length>0&&(r.materials=i),o.length>0&&(r.textures=o),s.length>0&&(r.images=s),a.length>0&&(r.shapes=a),l.length>0&&(r.skeletons=l),u.length>0&&(r.animations=u),c.length>0&&(r.nodes=c)}return r.object=o,r}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}}js.DefaultUp=new Uo(0,1,0),js.DefaultMatrixAutoUpdate=!0;const Gs=new Uo,Hs=new Uo,Ws=new Uo,Xs=new Uo,Ys=new Uo,Zs=new Uo,Qs=new Uo,Js=new Uo,Ks=new Uo,$s=new Uo;class ta{constructor(t=new Uo,e=new Uo,n=new Uo){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),Gs.subVectors(t,e),i.cross(Gs);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){Gs.subVectors(i,e),Hs.subVectors(n,e),Ws.subVectors(t,e);const o=Gs.dot(Gs),s=Gs.dot(Hs),a=Gs.dot(Ws),l=Hs.dot(Hs),u=Hs.dot(Ws),c=o*l-s*s;if(0===c)return r.set(-2,-1,-1);const h=1/c,d=(l*a-s*u)*h,p=(o*u-s*a)*h;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,Xs),Xs.x>=0&&Xs.y>=0&&Xs.x+Xs.y<=1}static getUV(t,e,n,i,r,o,s,a){return this.getBarycoord(t,e,n,i,Xs),a.set(0,0),a.addScaledVector(r,Xs.x),a.addScaledVector(o,Xs.y),a.addScaledVector(s,Xs.z),a}static isFrontFacing(t,e,n,i){return Gs.subVectors(n,e),Hs.subVectors(t,e),Gs.cross(Hs).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Gs.subVectors(this.c,this.b),Hs.subVectors(this.a,this.b),.5*Gs.cross(Hs).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ta.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ta.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return ta.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return ta.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ta.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let o,s;Ys.subVectors(i,n),Zs.subVectors(r,n),Js.subVectors(t,n);const a=Ys.dot(Js),l=Zs.dot(Js);if(a<=0&&l<=0)return e.copy(n);Ks.subVectors(t,i);const u=Ys.dot(Ks),c=Zs.dot(Ks);if(u>=0&&c<=u)return e.copy(i);const h=a*c-u*l;if(h<=0&&a>=0&&u<=0)return o=a/(a-u),e.copy(n).addScaledVector(Ys,o);$s.subVectors(t,r);const d=Ys.dot($s),p=Zs.dot($s);if(p>=0&&d<=p)return e.copy(r);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return s=l/(l-p),e.copy(n).addScaledVector(Zs,s);const m=u*p-d*c;if(m<=0&&c-u>=0&&d-p>=0)return Qs.subVectors(r,i),s=(c-u)/(c-u+(d-p)),e.copy(i).addScaledVector(Qs,s);const g=1/(m+f+h);return o=f*g,s=h*g,e.copy(n).addScaledVector(Ys,o).addScaledVector(Zs,s)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let ea=0;class na extends po{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ea++}),this.uuid=i(),this.name="",this.type="Material",this.blending=yn,this.side=hn,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Rn,this.blendDst=On,this.blendEquation=wn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Nn,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=$r,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Fr,this.stencilZFail=Fr,this.stencilZPass=Fr,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===fn;continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){function e(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}const n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==yn&&(i.blending=this.blending),this.side!==hn&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),n){const n=e(t.textures),r=e(t.images);n.length>0&&(i.textures=n),r.length>0&&(i.images=r)}return i}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}na.fromType=function(){return null};class ia extends na{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Po(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Wn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const ra=new Uo,oa=new xo;class sa{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=to,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new Po),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new xo),e[n++]=r.x,e[n++]=r.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new Uo),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new Lo),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)oa.fromBufferAttribute(this,e),oa.applyMatrix3(t),this.setXY(e,oa.x,oa.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)ra.fromBufferAttribute(this,e),ra.applyMatrix3(t),this.setXYZ(e,ra.x,ra.y,ra.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)ra.fromBufferAttribute(this,e),ra.applyMatrix4(t),this.setXYZ(e,ra.x,ra.y,ra.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)ra.fromBufferAttribute(this,e),ra.applyNormalMatrix(t),this.setXYZ(e,ra.x,ra.y,ra.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)ra.fromBufferAttribute(this,e),ra.transformDirection(t),this.setXYZ(e,ra.x,ra.y,ra.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==to&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}class aa extends sa{constructor(t,e,n){super(new Int8Array(t),e,n)}}class la extends sa{constructor(t,e,n){super(new Uint8Array(t),e,n)}}class ua extends sa{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}}class ca extends sa{constructor(t,e,n){super(new Int16Array(t),e,n)}}class ha extends sa{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class da extends sa{constructor(t,e,n){super(new Int32Array(t),e,n)}}class pa extends sa{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class fa extends sa{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}}class ma extends sa{constructor(t,e,n){super(new Float32Array(t),e,n)}}class ga extends sa{constructor(t,e,n){super(new Float64Array(t),e,n)}}let ya=0;const va=new vs,xa=new js,ba=new Uo,_a=new Ho,wa=new Ho,Sa=new Uo;class Aa extends po{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ya++}),this.uuid=i(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(c(t)?pa:ha)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new bo).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return va.makeRotationFromQuaternion(t),this.applyMatrix4(va),this}rotateX(t){return va.makeRotationX(t),this.applyMatrix4(va),this}rotateY(t){return va.makeRotationY(t),this.applyMatrix4(va),this}rotateZ(t){return va.makeRotationZ(t),this.applyMatrix4(va),this}translate(t,e,n){return va.makeTranslation(t,e,n),this.applyMatrix4(va),this}scale(t,e,n){return va.makeScale(t,e,n),this.applyMatrix4(va),this}lookAt(t){return xa.lookAt(t),xa.updateMatrix(),this.applyMatrix4(xa.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ba).negate(),this.translate(ba.x,ba.y,ba.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new ma(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ho);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Uo(-1/0,-1/0,-1/0),new Uo(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];_a.setFromBufferAttribute(n),this.morphTargetsRelative?(Sa.addVectors(this.boundingBox.min,_a.min),this.boundingBox.expandByPoint(Sa),Sa.addVectors(this.boundingBox.max,_a.max),this.boundingBox.expandByPoint(Sa)):(this.boundingBox.expandByPoint(_a.min),this.boundingBox.expandByPoint(_a.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new us);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Uo,1/0);if(t){const n=this.boundingSphere.center;if(_a.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];wa.setFromBufferAttribute(n),this.morphTargetsRelative?(Sa.addVectors(_a.min,wa.min),_a.expandByPoint(Sa),Sa.addVectors(_a.max,wa.max),_a.expandByPoint(Sa)):(_a.expandByPoint(wa.min),_a.expandByPoint(wa.max))}_a.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)Sa.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(Sa));if(e)for(let r=0,o=e.length;r<o;r++){const o=e[r],s=this.morphTargetsRelative;for(let e=0,r=o.count;e<r;e++)Sa.fromBufferAttribute(o,e),s&&(ba.fromBufferAttribute(t,e),Sa.add(ba)),i=Math.max(i,n.distanceToSquared(Sa))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){function t(t,e,n){d.fromArray(o,3*t),p.fromArray(o,3*e),f.fromArray(o,3*n),m.fromArray(a,2*t),g.fromArray(a,2*e),y.fromArray(a,2*n),p.sub(d),f.sub(d),g.sub(m),y.sub(m);const i=1/(g.x*y.y-y.x*g.y);isFinite(i)&&(v.copy(p).multiplyScalar(y.y).addScaledVector(f,-g.y).multiplyScalar(i),x.copy(f).multiplyScalar(g.x).addScaledVector(p,-y.x).multiplyScalar(i),c[t].add(v),c[e].add(v),c[n].add(v),h[t].add(x),h[e].add(x),h[n].add(x))}function e(t){S.fromArray(s,3*t),A.copy(S);const e=c[t];_.copy(e),_.sub(S.multiplyScalar(S.dot(e))).normalize(),w.crossVectors(A,e);const n=w.dot(h[t])<0?-1:1;u[4*t]=_.x,u[4*t+1]=_.y,u[4*t+2]=_.z,u[4*t+3]=n}const n=this.index,i=this.attributes;if(null===n||void 0===i.position||void 0===i.normal||void 0===i.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=n.array,o=i.position.array,s=i.normal.array,a=i.uv.array,l=o.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new sa(new Float32Array(4*l),4));const u=this.getAttribute("tangent").array,c=[],h=[];for(let t=0;t<l;t++)c[t]=new Uo,h[t]=new Uo;const d=new Uo,p=new Uo,f=new Uo,m=new xo,g=new xo,y=new xo,v=new Uo,x=new Uo;let b=this.groups;0===b.length&&(b=[{start:0,count:r.length}]);for(let e=0,n=b.length;e<n;++e){const n=b[e],i=n.start;for(let e=i,o=i+n.count;e<o;e+=3)t(r[e+0],r[e+1],r[e+2])}const _=new Uo,w=new Uo,S=new Uo,A=new Uo;for(let t=0,n=b.length;t<n;++t){const n=b[t],i=n.start;for(let t=i,o=i+n.count;t<o;t+=3)e(r[t+0]),e(r[t+1]),e(r[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new sa(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new Uo,r=new Uo,o=new Uo,s=new Uo,a=new Uo,l=new Uo,u=new Uo,c=new Uo;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),f=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),o.fromBufferAttribute(e,f),u.subVectors(o,r),c.subVectors(i,r),u.cross(c),s.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),s.add(u),a.add(u),l.add(u),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,s=e.count;t<s;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),u.subVectors(o,r),c.subVectors(i,r),u.cross(c),n.setXYZ(t+0,u.x,u.y,u.z),n.setXYZ(t+1,u.x,u.y,u.z),n.setXYZ(t+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i].array,o=t.attributes[i],s=o.array,a=o.itemSize*e,l=Math.min(s.length,r.length-a);for(let t=0,e=a;t<l;t++,e++)r[e]=s[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Sa.fromBufferAttribute(t,e),Sa.normalize(),t.setXYZ(e,Sa.x,Sa.y,Sa.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,o=new n.constructor(e.length*i);let s=0,a=0;for(let r=0,l=e.length;r<l;r++){s=t.isInterleavedBufferAttribute?e[r]*t.data.stride+t.offset:e[r]*i;for(let t=0;t<i;t++)o[a++]=n[s++]}return new sa(o,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Aa,n=this.index.array,i=this.attributes;for(const r in i){const o=t(i[r],n);e.setAttribute(r,o)}const r=this.morphAttributes;for(const i in r){const o=[],s=r[i];for(let e=0,i=s.length;e<i;e++){const i=t(s[e],n);o.push(i)}e.morphAttributes[i]=o}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const i=n[e];t.data.attributes[e]=i.toJSON(t.data)}const i={};let r=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],o=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];o.push(i.toJSON(t.data))}o.length>0&&(i[e]=o,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(t.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const t in i){const n=i[t];this.setAttribute(t,n.clone(e))}const r=t.morphAttributes;for(const t in r){const n=[],i=r[t];for(let t=0,r=i.length;t<r;t++)n.push(i[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let t=0,e=o.length;t<e;t++){const e=o[t];this.addGroup(e.start,e.count,e.materialIndex)}const s=t.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ma=new vs,Ta=new ys,Ea=new us,Pa=new Uo,Ca=new Uo,Ia=new Uo,Ra=new Uo,Oa=new Uo,qa=new Uo,La=new Uo,Da=new Uo,za=new Uo,ka=new xo,Ba=new xo,Fa=new xo,Va=new Uo,Na=new Uo;class Ua extends js{constructor(t=new Aa,e=new ia){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ea.copy(n.boundingSphere),Ea.applyMatrix4(r),!1===t.ray.intersectsSphere(Ea))return;if(Ma.copy(r).invert(),Ta.copy(t.ray).applyMatrix4(Ma),null!==n.boundingBox&&!1===Ta.intersectsBox(n.boundingBox))return;let o;const s=n.index,a=n.attributes.position,l=n.morphAttributes.position,u=n.morphTargetsRelative,c=n.attributes.uv,h=n.attributes.uv2,d=n.groups,p=n.drawRange;if(null!==s)if(Array.isArray(i))for(let n=0,r=d.length;n<r;n++){const r=d[n],f=i[r.materialIndex];for(let n=Math.max(r.start,p.start),i=Math.min(s.count,Math.min(r.start+r.count,p.start+p.count));n<i;n+=3){const i=s.getX(n),d=s.getX(n+1),p=s.getX(n+2);o=x(this,f,t,Ta,a,l,u,c,h,i,d,p),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=r.materialIndex,e.push(o))}}else for(let n=Math.max(0,p.start),r=Math.min(s.count,p.start+p.count);n<r;n+=3){const r=s.getX(n),d=s.getX(n+1),p=s.getX(n+2);o=x(this,i,t,Ta,a,l,u,c,h,r,d,p),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}else if(void 0!==a)if(Array.isArray(i))for(let n=0,r=d.length;n<r;n++){const r=d[n],s=i[r.materialIndex];for(let n=Math.max(r.start,p.start),i=Math.min(a.count,Math.min(r.start+r.count,p.start+p.count));n<i;n+=3)o=x(this,s,t,Ta,a,l,u,c,h,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=r.materialIndex,e.push(o))}else for(let n=Math.max(0,p.start),r=Math.min(a.count,p.start+p.count);n<r;n+=3)o=x(this,i,t,Ta,a,l,u,c,h,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}class ja extends Aa{constructor(t=1,e=1,n=1,i=1,r=1,o=1){function s(t,e,n,i,r,o,s,f,m,g,y){const v=o/m,x=s/g,b=o/2,_=s/2,w=f/2,S=m+1,A=g+1;let M=0,T=0;const E=new Uo;for(let o=0;o<A;o++){const s=o*x-_;for(let a=0;a<S;a++){const l=a*v-b;E[t]=l*i,E[e]=s*r,E[n]=w,u.push(E.x,E.y,E.z),E[t]=0,E[e]=0,E[n]=f>0?1:-1,c.push(E.x,E.y,E.z),h.push(a/m),h.push(1-o/g),M+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const n=d+e+S*t,i=d+e+S*(t+1),r=d+(e+1)+S*(t+1),o=d+(e+1)+S*t;l.push(n,i,o),l.push(i,r,o),T+=6}a.addGroup(p,T,y),p+=T,d+=M}super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};const a=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);const l=[],u=[],c=[],h=[];let d=0,p=0;s("z","y","x",-1,-1,n,e,t,o,r,0),s("z","y","x",1,-1,n,e,-t,o,r,1),s("x","z","y",1,1,t,n,e,i,o,2),s("x","z","y",1,-1,t,n,-e,i,o,3),s("x","y","z",1,-1,t,e,n,i,r,4),s("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(l),this.setAttribute("position",new ma(u,3)),this.setAttribute("normal",new ma(c,3)),this.setAttribute("uv",new ma(h,2))}static fromJSON(t){return new ja(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}const Ga={clone:b,merge:_};class Ha extends na{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=b(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?e.uniforms[n]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[n]={type:"m4",value:i.toArray()}:e.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class Wa extends js{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new vs,this.projectionMatrix=new vs,this.projectionMatrixInverse=new vs}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Xa extends Wa{constructor(t=50,e=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*yo*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*go*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*yo*Math.atan(Math.tan(.5*go*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*go*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,s=o.fullHeight;r+=o.offsetX*i/t,e-=o.offsetY*n/s,i*=o.width/t,n*=o.height/s}const s=this.filmOffset;0!==s&&(r+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const Ya=90;class Za extends js{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new Xa(Ya,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Uo(1,0,0)),this.add(i);const r=new Xa(Ya,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Uo(-1,0,0)),this.add(r);const o=new Xa(Ya,1,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Uo(0,1,0)),this.add(o);const s=new Xa(Ya,1,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new Uo(0,-1,0)),this.add(s);const a=new Xa(Ya,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Uo(0,0,1)),this.add(a);const l=new Xa(Ya,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Uo(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,o,s,a,l]=this.children,u=t.getRenderTarget(),c=t.toneMapping,h=t.xr.enabled;t.toneMapping=Zn,t.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,s),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=d,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.toneMapping=c,t.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class Qa extends qo{constructor(t,e,n,i,r,o,s,a,l,u){super(t=void 0!==t?t:[],e=void 0!==e?e:ni,n,i,r,o,s,a,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class Ja extends Do{constructor(t,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];this.texture=new Qa(i,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:mi}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new ja(5,5,5),s=new Ha({name:"CubemapFromEquirect",uniforms:b(n),vertexShader:i,fragmentShader:r,side:dn,blending:gn});s.uniforms.tEquirect.value=e;const a=new Ua(o,s),l=e.minFilter;return e.minFilter===vi&&(e.minFilter=mi),new Za(1,10,this).update(t,a),e.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,n,i);t.setRenderTarget(r)}}const Ka=new Uo,$a=new Uo,tl=new bo;class el{constructor(t=new Uo(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=Ka.subVectors(n,e).cross($a.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(Ka),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||tl.getNormalMatrix(t),i=this.coplanarPoint(Ka).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const nl=new us,il=new Uo;class rl{constructor(t=new el,e=new el,n=new el,i=new el,r=new el,o=new el){this.planes=[t,e,n,i,r,o]}set(t,e,n,i,r,o){const s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(n),s[3].copy(i),s[4].copy(r),s[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],y=n[14],v=n[15];return e[0].setComponents(s-i,c-a,f-h,v-m).normalize(),e[1].setComponents(s+i,c+a,f+h,v+m).normalize(),e[2].setComponents(s+r,c+l,f+d,v+g).normalize(),e[3].setComponents(s-r,c-l,f-d,v-g).normalize(),e[4].setComponents(s-o,c-u,f-p,v-y).normalize(),e[5].setComponents(s+o,c+u,f+p,v+y).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),nl.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(nl)}intersectsSprite(t){return nl.center.set(0,0,0),nl.radius=.7071067811865476,nl.applyMatrix4(t.matrixWorld),this.intersectsSphere(nl)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let t=0;t<6;t++)if(e[t].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(il.x=i.normal.x>0?t.max.x:t.min.x,il.y=i.normal.y>0?t.max.y:t.min.y,il.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(il)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class ol extends Aa{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,o=e/2,s=Math.floor(n),a=Math.floor(i),l=s+1,u=a+1,c=t/s,h=e/a,d=[],p=[],f=[],m=[];for(let t=0;t<u;t++){const e=t*h-o;for(let n=0;n<l;n++){const i=n*c-r;p.push(i,-e,0),f.push(0,0,1),m.push(n/s),m.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<s;e++){const n=e+l*t,i=e+l*(t+1),r=e+1+l*(t+1),o=e+1+l*t;d.push(n,i,o),d.push(i,r,o)}this.setIndex(d),this.setAttribute("position",new ma(p,3)),this.setAttribute("normal",new ma(f,3)),this.setAttribute("uv",new ma(m,2))}static fromJSON(t){return new ol(t.width,t.height,t.widthSegments,t.heightSegments)}}const sl={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},al={common:{diffuse:{value:new Po(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new bo},uv2Transform:{value:new bo},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new xo(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Po(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Po(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new bo}},sprite:{diffuse:{value:new Po(16777215)},opacity:{value:1},center:{value:new xo(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new bo}}},ll={basic:{uniforms:_([al.common,al.specularmap,al.envmap,al.aomap,al.lightmap,al.fog]),vertexShader:sl.meshbasic_vert,fragmentShader:sl.meshbasic_frag},lambert:{uniforms:_([al.common,al.specularmap,al.envmap,al.aomap,al.lightmap,al.emissivemap,al.fog,al.lights,{emissive:{value:new Po(0)}}]),vertexShader:sl.meshlambert_vert,fragmentShader:sl.meshlambert_frag},phong:{uniforms:_([al.common,al.specularmap,al.envmap,al.aomap,al.lightmap,al.emissivemap,al.bumpmap,al.normalmap,al.displacementmap,al.fog,al.lights,{emissive:{value:new Po(0)},specular:{value:new Po(1118481)},shininess:{value:30}}]),vertexShader:sl.meshphong_vert,fragmentShader:sl.meshphong_frag},standard:{uniforms:_([al.common,al.envmap,al.aomap,al.lightmap,al.emissivemap,al.bumpmap,al.normalmap,al.displacementmap,al.roughnessmap,al.metalnessmap,al.fog,al.lights,{emissive:{value:new Po(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:sl.meshphysical_vert,fragmentShader:sl.meshphysical_frag},toon:{uniforms:_([al.common,al.aomap,al.lightmap,al.emissivemap,al.bumpmap,al.normalmap,al.displacementmap,al.gradientmap,al.fog,al.lights,{emissive:{value:new Po(0)}}]),vertexShader:sl.meshtoon_vert,fragmentShader:sl.meshtoon_frag},matcap:{uniforms:_([al.common,al.bumpmap,al.normalmap,al.displacementmap,al.fog,{matcap:{value:null}}]),vertexShader:sl.meshmatcap_vert,fragmentShader:sl.meshmatcap_frag},points:{uniforms:_([al.points,al.fog]),vertexShader:sl.points_vert,fragmentShader:sl.points_frag},dashed:{uniforms:_([al.common,al.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:sl.linedashed_vert,fragmentShader:sl.linedashed_frag},depth:{uniforms:_([al.common,al.displacementmap]),vertexShader:sl.depth_vert,fragmentShader:sl.depth_frag},normal:{uniforms:_([al.common,al.bumpmap,al.normalmap,al.displacementmap,{opacity:{value:1}}]),vertexShader:sl.meshnormal_vert,fragmentShader:sl.meshnormal_frag},sprite:{uniforms:_([al.sprite,al.fog]),vertexShader:sl.sprite_vert,fragmentShader:sl.sprite_frag},background:{uniforms:{uvTransform:{value:new bo},t2D:{value:null}},vertexShader:sl.background_vert,fragmentShader:sl.background_frag},cube:{uniforms:_([al.envmap,{opacity:{value:1}}]),vertexShader:sl.cube_vert,fragmentShader:sl.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:sl.equirect_vert,fragmentShader:sl.equirect_frag},distanceRGBA:{uniforms:_([al.common,al.displacementmap,{referencePosition:{value:new Uo},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:sl.distanceRGBA_vert,fragmentShader:sl.distanceRGBA_frag},shadow:{uniforms:_([al.lights,al.fog,{color:{value:new Po(0)},opacity:{value:1}}]),vertexShader:sl.shadow_vert,fragmentShader:sl.shadow_frag}};ll.physical={uniforms:_([ll.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new xo(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Po(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new xo},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Po(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Po(1,1,1)},specularColorMap:{value:null}}]),vertexShader:sl.meshphysical_vert,fragmentShader:sl.meshphysical_frag};class ul extends Wa{constructor(t=-1,e=1,n=1,i=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,o=n+t,s=i+e,a=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,o=r+t*this.view.width,s-=e*this.view.offsetY,a=s-e*this.view.height}this.projectionMatrix.makeOrthographic(r,o,s,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const cl=[.125,.215,.35,.446,.526,.582],hl=new ul,dl=new Po;let pl=null;const fl=(1+Math.sqrt(5))/2,ml=1/fl,gl=[new Uo(1,1,1),new Uo(-1,1,1),new Uo(1,1,-1),new Uo(-1,1,-1),new Uo(0,fl,ml),new Uo(0,fl,-ml),new Uo(ml,0,fl),new Uo(-ml,0,fl),new Uo(fl,ml,0),new Uo(-fl,ml,0)];class yl{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){pl=this._renderer.getRenderTarget(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=q(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=O(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(pl),t.scissorTest=!1,R(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===ni||t.mapping===ii?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),pl=this._renderer.getRenderTarget();const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:mi,minFilter:mi,generateMipmaps:!1,type:Ei,format:qi,encoding:Cr,depthBuffer:!1},i=I(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=I(t,e,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],n=[],i=[];let r=t;const o=t-4+1+6;for(let s=0;s<o;s++){const o=Math.pow(2,r);n.push(o);let a=1/o;s>t-4?a=cl[s-t+4-1]:0===s&&(a=0),i.push(a);const l=1/(o-2),u=-l,c=1+l,h=[u,u,c,u,c,c,u,u,c,c,u,c],d=6,p=6,f=3,m=2,g=1,y=new Float32Array(f*p*d),v=new Float32Array(m*p*d),x=new Float32Array(g*p*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];y.set(i,f*p*t),v.set(h,m*p*t);const r=[t,t,t,t,t,t];x.set(r,g*p*t)}const b=new Aa;b.setAttribute("position",new sa(y,f)),b.setAttribute("uv",new sa(v,m)),b.setAttribute("faceIndex",new sa(x,g)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(t,e,n){const i=new Float32Array(20),r=new Uo(0,1,0);return new Ha({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:gn,depthTest:!1,depthWrite:!1})}(i,t,e)}return i}_compileMaterial(t){const e=new Ua(this._lodPlanes[0],t);this._renderer.compile(e,hl)}_sceneToCubeUV(t,e,n,i){const r=new Xa(90,1,e,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,u=a.toneMapping;a.getClearColor(dl),a.toneMapping=Zn,a.autoClear=!1;const c=new ia({name:"PMREM.Background",side:dn,depthWrite:!1,depthTest:!1}),h=new Ua(new ja,c);let d=!1;const p=t.background;p?p.isColor&&(c.color.copy(p),t.background=null,d=!0):(c.color.copy(dl),d=!0);for(let e=0;e<6;e++){const n=e%3;0===n?(r.up.set(0,o[e],0),r.lookAt(s[e],0,0)):1===n?(r.up.set(0,0,o[e]),r.lookAt(0,s[e],0)):(r.up.set(0,o[e],0),r.lookAt(0,0,s[e]));const l=this._cubeSize;R(i,n*l,e>2?l:0,l,l),a.setRenderTarget(i),d&&a.render(h,r),a.render(t,r)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=u,a.autoClear=l,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===ni||t.mapping===ii;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=q()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=O());const r=i?this._cubemapMaterial:this._equirectMaterial,o=new Ua(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const s=this._cubeSize;R(e,0,0,3*s,2*s),n.setRenderTarget(e),n.render(o,hl)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let e=1;e<this._lodPlanes.length;e++){const n=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),i=gl[(e-1)%10];this._blur(t,e-1,e,n,i)}e.autoClear=n}_blur(t,e,n,i,r){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,i,"latitudinal",r),this._halfBlur(o,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,o,s){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new Ua(this._lodPlanes[i],l),c=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):20;f>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let t=0;t<20;++t){const e=t/p,n=Math.exp(-e*e/2);m.push(n),0===t?g+=n:t<f&&(g+=2*n)}for(let t=0;t<m.length;t++)m[t]=m[t]/g;c.envMap.value=t.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===o,s&&(c.poleAxis.value=s);const{_lodMax:y}=this;c.dTheta.value=d,c.mipInt.value=y-n;const v=this._sizeLods[i];R(e,3*v*(i>y-4?i-y+4:0),4*(this._cubeSize-v),3*v,2*v),a.setRenderTarget(e),a.render(u,hl)}}const vl=new qo,xl=new zo,bl=new Bo,_l=new Qa,wl=[],Sl=[],Al=new Float32Array(16),Ml=new Float32Array(9),Tl=new Float32Array(4);class El{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Y;case 35664:return Z;case 35665:return Q;case 35666:return J;case 35674:return K;case 35675:return $;case 35676:return tt;case 5124:case 35670:return et;case 35667:case 35671:return nt;case 35668:case 35672:return it;case 35669:case 35673:return rt;case 5125:return ot;case 36294:return st;case 36295:return at;case 36296:return lt;case 35678:case 36198:case 36298:case 36306:case 35682:return ut;case 35679:case 36299:case 36307:return ct;case 35680:case 36300:case 36308:case 36293:return ht;case 36289:case 36303:case 36311:case 36292:return dt}}(e.type)}}class Pl{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return pt;case 35664:return ft;case 35665:return mt;case 35666:return gt;case 35674:return yt;case 35675:return vt;case 35676:return xt;case 5124:case 35670:return bt;case 35667:case 35671:return _t;case 35668:case 35672:return wt;case 35669:case 35673:return St;case 5125:return At;case 36294:return Mt;case 36295:return Tt;case 36296:return Et;case 35678:case 36198:case 36298:case 36306:case 35682:return Pt;case 35679:case 36299:case 36307:return Ct;case 35680:case 36300:case 36308:case 36293:return It;case 36289:case 36303:case 36311:case 36292:return Rt}}(e.type)}}class Cl{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const o=i[r];o.setValue(t,e[o.id],n)}}}const Il=/(\w+)(\])?(\[|\.)?/g;class Rl{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);qt(n,t.getUniformLocation(e,n.name),this)}}setValue(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)}setOptional(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)}static upload(t,e,n,i){for(let r=0,o=e.length;r!==o;++r){const o=e[r],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,i)}}static seqWithValue(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n}}let Ol=0;const ql=/^[ \t]*#include +<([\w\d./]+)>/gm,Ll=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Dl=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;let zl=0;class kl{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return!1===o.has(i)&&(o.add(i),i.usedTimes++),!1===o.has(r)&&(o.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const n=new Bl(t);e.set(t,n)}return e.get(t)}}class Bl{constructor(t){this.id=zl++,this.code=t,this.usedTimes=0}}let Fl=0;class Vl extends na{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Rr,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class Nl extends na{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Uo,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}class Ul extends Xa{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class jl extends js{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Gl={type:"move"};class Hl{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new jl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new jl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Uo,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Uo),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new jl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Uo,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Uo),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,o=null;const s=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==s&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Gl))),l&&t.hand){o=!0;for(const i of t.hand.values()){const t=e.getJointPose(i,n);if(void 0===l.joints[i.jointName]){const t=new jl;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[i.jointName]=t,l.add(t)}const r=l.joints[i.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],s=i.position.distanceTo(r.position),a=.02,u=.005;l.inputState.pinching&&s>a+u?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&s<=a-u&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));return null!==s&&(s.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==o),this}}class Wl extends qo{constructor(t,e,n,i,r,o,s,a,l,u){if((u=void 0!==u?u:zi)!==zi&&u!==ki)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===zi&&(n=Mi),void 0===n&&u===ki&&(n=Ii),super(null,i,r,o,s,a,u,n,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==s?s:ci,this.minFilter=void 0!==a?a:ci,this.flipY=!1,this.generateMipmaps=!1}}class Xl extends po{constructor(t,e){function n(t){const e=_.get(t.inputSource);void 0!==e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function i(){a.removeEventListener("select",n),a.removeEventListener("selectstart",n),a.removeEventListener("selectend",n),a.removeEventListener("squeeze",n),a.removeEventListener("squeezestart",n),a.removeEventListener("squeezeend",n),a.removeEventListener("end",i),a.removeEventListener("inputsourceschange",r),_.forEach((function(t,e){void 0!==t&&t.disconnect(e)})),_.clear(),E=null,P=null,t.setRenderTarget(v),m=null,f=null,p=null,a=null,x=null,O.stop(),s.isPresenting=!1,s.dispatchEvent({type:"sessionend"})}function r(t){const e=a.inputSources;for(let t=0;t<e.length;t++){const n="right"===e[t].handedness?1:0;_.set(e[t],b[n])}for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=_.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),_.delete(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e],i=_.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}function o(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}super();const s=this;let a=null,l=1,u=null,c="local-floor",h=null,d=null,p=null,f=null,m=null,g=null;const y=e.getContextAttributes();let v=null,x=null;const b=[],_=new Map,S=new Xa;S.layers.enable(1),S.viewport=new Lo;const A=new Xa;A.layers.enable(2),A.viewport=new Lo;const M=[S,A],T=new Ul;T.layers.enable(1),T.layers.enable(2);let E=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=b[t];return void 0===e&&(e=new Hl,b[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=b[t];return void 0===e&&(e=new Hl,b[t]=e),e.getGripSpace()},this.getHand=function(t){let e=b[t];return void 0===e&&(e=new Hl,b[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){l=t,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){c=t,!0===s.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||u},this.setReferenceSpace=function(t){h=t},this.getBaseLayer=function(){return null!==f?f:m},this.getBinding=function(){return p},this.getFrame=function(){return g},this.getSession=function(){return a},this.setSession=async function(o){if(a=o,null!==a){if(v=t.getRenderTarget(),a.addEventListener("select",n),a.addEventListener("selectstart",n),a.addEventListener("selectend",n),a.addEventListener("squeeze",n),a.addEventListener("squeezestart",n),a.addEventListener("squeezeend",n),a.addEventListener("end",i),a.addEventListener("inputsourceschange",r),!0!==y.xrCompatible&&await e.makeXRCompatible(),void 0===a.renderState.layers||!1===t.capabilities.isWebGL2){const n={antialias:void 0!==a.renderState.layers||y.antialias,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:l};m=new XRWebGLLayer(a,e,n),a.updateRenderState({baseLayer:m}),x=new Do(m.framebufferWidth,m.framebufferHeight,{format:qi,type:bi,encoding:t.outputEncoding})}else{let n=null,i=null,r=null;y.depth&&(r=y.stencil?35056:33190,n=y.stencil?ki:zi,i=y.stencil?Ii:Mi);const o={colorFormat:t.outputEncoding===Ir?35907:32856,depthFormat:r,scaleFactor:l};p=new XRWebGLBinding(a,e),f=p.createProjectionLayer(o),a.updateRenderState({layers:[f]}),x=new Do(f.textureWidth,f.textureHeight,{format:qi,type:bi,depthTexture:new Wl(f.textureWidth,f.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:y.stencil,encoding:t.outputEncoding,samples:y.antialias?4:0}),t.properties.get(x).__ignoreDepthValues=f.ignoreDepthValues}x.isXRRenderTarget=!0,this.setFoveation(1),h=null,u=await a.requestReferenceSpace(c),O.setContext(a),O.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}};const C=new Uo,I=new Uo;this.updateCamera=function(t){if(null===a)return;T.near=A.near=S.near=t.near,T.far=A.far=S.far=t.far,E===T.near&&P===T.far||(a.updateRenderState({depthNear:T.near,depthFar:T.far}),E=T.near,P=T.far);const e=t.parent,n=T.cameras;o(T,e);for(let t=0;t<n.length;t++)o(n[t],e);T.matrixWorld.decompose(T.position,T.quaternion,T.scale),t.position.copy(T.position),t.quaternion.copy(T.quaternion),t.scale.copy(T.scale),t.matrix.copy(T.matrix),t.matrixWorld.copy(T.matrixWorld);const i=t.children;for(let t=0,e=i.length;t<e;t++)i[t].updateMatrixWorld(!0);2===n.length?function(t,e,n){C.setFromMatrixPosition(e.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const i=C.distanceTo(I),r=e.projectionMatrix.elements,o=n.projectionMatrix.elements,s=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],c=(r[8]-1)/r[0],h=(o[8]+1)/o[0],d=s*c,p=s*h,f=i/(-c+h),m=f*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=s+f,y=a+f,v=d-m,x=p+(i-m),b=l*a/y*g,_=u*a/y*g;t.projectionMatrix.makePerspective(v,x,b,_,g,y)}(T,S,A):T.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return T},this.getFoveation=function(){return null!==f?f.fixedFoveation:null!==m?m.fixedFoveation:void 0},this.setFoveation=function(t){null!==f&&(f.fixedFoveation=t),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=t)};let R=null;const O=new w;O.setAnimationLoop((function(e,n){if(d=n.getViewerPose(h||u),g=n,null!==d){const e=d.views;null!==m&&(t.setRenderTargetFramebuffer(x,m.framebuffer),t.setRenderTarget(x));let n=!1;e.length!==T.cameras.length&&(T.cameras.length=0,n=!0);for(let i=0;i<e.length;i++){const r=e[i];let o=null;if(null!==m)o=m.getViewport(r);else{const e=p.getViewSubImage(f,r);o=e.viewport,0===i&&(t.setRenderTargetTextures(x,e.colorTexture,f.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(x))}let s=M[i];void 0===s&&(s=new Xa,s.layers.enable(i),s.viewport=new Lo,M[i]=s),s.matrix.fromArray(r.transform.matrix),s.projectionMatrix.fromArray(r.projectionMatrix),s.viewport.set(o.x,o.y,o.width,o.height),0===i&&T.matrix.copy(s.matrix),!0===n&&T.cameras.push(s)}}const i=a.inputSources;for(let t=0;t<b.length;t++){const e=i[t],r=_.get(e);void 0!==r&&r.update(e,n,h||u)}R&&R(e,n),g=null})),this.setAnimationLoop=function(t){R=t},this.dispose=function(){}}}class Yl extends ce{}Yl.prototype.isWebGL1Renderer=!0;class Zl{constructor(t,e=25e-5){this.isFogExp2=!0,this.name="",this.color=new Po(t),this.density=e}clone(){return new Zl(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Ql{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new Po(t),this.near=e,this.far=n}clone(){return new Ql(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Jl extends js{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}class Kl{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=to,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=i()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=i()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=i()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const $l=new Uo;class tu{constructor(t,e,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)$l.fromBufferAttribute(this,e),$l.applyMatrix4(t),this.setXYZ(e,$l.x,$l.y,$l.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)$l.fromBufferAttribute(this,e),$l.applyNormalMatrix(t),this.setXYZ(e,$l.x,$l.y,$l.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)$l.fromBufferAttribute(this,e),$l.transformDirection(t),this.setXYZ(e,$l.x,$l.y,$l.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new sa(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new tu(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class eu extends na{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Po(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let nu;const iu=new Uo,ru=new Uo,ou=new Uo,su=new xo,au=new xo,lu=new vs,uu=new Uo,cu=new Uo,hu=new Uo,du=new xo,pu=new xo,fu=new xo;class mu extends js{constructor(t){if(super(),this.isSprite=!0,this.type="Sprite",void 0===nu){nu=new Aa;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new Kl(t,5);nu.setIndex([0,1,2,0,2,3]),nu.setAttribute("position",new tu(e,3,0,!1)),nu.setAttribute("uv",new tu(e,2,3,!1))}this.geometry=nu,this.material=void 0!==t?t:new eu,this.center=new xo(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ru.setFromMatrixScale(this.matrixWorld),lu.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),ou.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ru.multiplyScalar(-ou.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const o=this.center;he(uu.set(-.5,-.5,0),ou,o,ru,i,r),he(cu.set(.5,-.5,0),ou,o,ru,i,r),he(hu.set(.5,.5,0),ou,o,ru,i,r),du.set(0,0),pu.set(1,0),fu.set(1,1);let s=t.ray.intersectTriangle(uu,cu,hu,!1,iu);if(null===s&&(he(cu.set(-.5,.5,0),ou,o,ru,i,r),pu.set(0,1),s=t.ray.intersectTriangle(uu,hu,cu,!1,iu),null===s))return;const a=t.ray.origin.distanceTo(iu);a<t.near||a>t.far||e.push({distance:a,point:iu.clone(),uv:ta.getUV(iu,uu,cu,hu,du,pu,fu,new xo),face:null,object:this})}copy(t,e){return super.copy(t,e),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}const gu=new Uo,yu=new Uo;class vu extends js{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0){e=Math.abs(e);const n=this.levels;let i;for(i=0;i<n.length&&!(e<n[i].distance);i++);return n.splice(i,0,{distance:e,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,i;for(n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){gu.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(gu);this.getObjectForDistance(n).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){gu.setFromMatrixPosition(t.matrixWorld),yu.setFromMatrixPosition(this.matrixWorld);const n=gu.distanceTo(yu)/t.zoom;let i,r;for(e[0].object.visible=!0,i=1,r=e.length;i<r&&n>=e[i].distance;i++)e[i-1].object.visible=!1,e[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)e[i].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let t=0,i=n.length;t<i;t++){const i=n[t];e.object.levels.push({object:i.object.uuid,distance:i.distance})}return e}}const xu=new Uo,bu=new Lo,_u=new Lo,wu=new Uo,Su=new vs;class Au extends Ua{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new vs,this.bindMatrixInverse=new vs}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Lo,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.fromBufferAttribute(e,n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,i=this.geometry;bu.fromBufferAttribute(i.attributes.skinIndex,t),_u.fromBufferAttribute(i.attributes.skinWeight,t),xu.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const i=_u.getComponent(t);if(0!==i){const r=bu.getComponent(t);Su.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(wu.copy(xu).applyMatrix4(Su),i)}}return e.applyMatrix4(this.bindMatrixInverse)}}class Mu extends js{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Tu extends qo{constructor(t=null,e=1,n=1,i,r,o,s,a,l=ci,u=ci,c,h){super(null,o,s,a,l,u,i,r,c,h),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Eu=new vs,Pu=new vs;class Cu{constructor(t=[],e=[]){this.uuid=i(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new vs)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new vs;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let i=0,r=t.length;i<r;i++){const r=t[i]?t[i].matrixWorld:Pu;Eu.multiplyMatrices(r,e[i]),Eu.toArray(n,16*i)}null!==i&&(i.needsUpdate=!0)}clone(){return new Cu(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=l(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new Tu(e,t,t,qi,Ti);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,i=t.bones.length;n<i;n++){const i=t.bones[n];let r=e[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new Mu),this.bones.push(r),this.boneInverses.push((new vs).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let i=0,r=e.length;i<r;i++){const r=e[i];t.bones.push(r.uuid);const o=n[i];t.boneInverses.push(o.toArray())}return t}}class Iu extends sa{constructor(t,e,n,i=1){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const Ru=new vs,Ou=new vs,qu=[],Lu=new Ua;class Du extends Ua{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new Iu(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,i=this.count;if(Lu.geometry=this.geometry,Lu.material=this.material,void 0!==Lu.material)for(let r=0;r<i;r++){this.getMatrixAt(r,Ru),Ou.multiplyMatrices(n,Ru),Lu.matrixWorld=Ou,Lu.raycast(t,qu);for(let t=0,n=qu.length;t<n;t++){const n=qu[t];n.instanceId=r,n.object=this,e.push(n)}qu.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new Iu(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class zu extends na{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Po(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const ku=new Uo,Bu=new Uo,Fu=new vs,Vu=new ys,Nu=new us;class Uu extends js{constructor(t=new Aa,e=new zu){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)ku.fromBufferAttribute(e,t-1),Bu.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=ku.distanceTo(Bu);t.setAttribute("lineDistance",new ma(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Nu.copy(n.boundingSphere),Nu.applyMatrix4(i),Nu.radius+=r,!1===t.ray.intersectsSphere(Nu))return;Fu.copy(i).invert(),Vu.copy(t.ray).applyMatrix4(Fu);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,l=new Uo,u=new Uo,c=new Uo,h=new Uo,d=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(null!==p)for(let n=Math.max(0,o.start),i=Math.min(p.count,o.start+o.count)-1;n<i;n+=d){const i=p.getX(n),r=p.getX(n+1);if(l.fromBufferAttribute(f,i),u.fromBufferAttribute(f,r),Vu.distanceSqToSegment(l,u,h,c)>a)continue;h.applyMatrix4(this.matrixWorld);const o=t.ray.origin.distanceTo(h);o<t.near||o>t.far||e.push({distance:o,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else for(let n=Math.max(0,o.start),i=Math.min(f.count,o.start+o.count)-1;n<i;n+=d){if(l.fromBufferAttribute(f,n),u.fromBufferAttribute(f,n+1),Vu.distanceSqToSegment(l,u,h,c)>a)continue;h.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(h);i<t.near||i>t.far||e.push({distance:i,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}const ju=new Uo,Gu=new Uo;class Hu extends Uu{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)ju.fromBufferAttribute(e,t),Gu.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+ju.distanceTo(Gu);t.setAttribute("lineDistance",new ma(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Wu extends Uu{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class Xu extends na{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Po(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const Yu=new vs,Zu=new ys,Qu=new us,Ju=new Uo;class Ku extends js{constructor(t=new Aa,e=new Xu){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Qu.copy(n.boundingSphere),Qu.applyMatrix4(i),Qu.radius+=r,!1===t.ray.intersectsSphere(Qu))return;Yu.copy(i).invert(),Zu.copy(t.ray).applyMatrix4(Yu);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,l=n.index,u=n.attributes.position;if(null!==l)for(let n=Math.max(0,o.start),r=Math.min(l.count,o.start+o.count);n<r;n++){const r=l.getX(n);Ju.fromBufferAttribute(u,r),de(Ju,r,a,i,t,e,this)}else for(let n=Math.max(0,o.start),r=Math.min(u.count,o.start+o.count);n<r;n++)Ju.fromBufferAttribute(u,n),de(Ju,n,a,i,t,e,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}class $u extends qo{constructor(t,e,n,i,r,o,s,a,l){super(t,e,n,i,r,o,s,a,l),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:mi,this.magFilter=void 0!==r?r:mi,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){u.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;0=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class tc extends qo{constructor(t,e,n){super({width:t,height:e}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=ci,this.minFilter=ci,this.generateMipmaps=!1,this.needsUpdate=!0}}class ec extends qo{constructor(t,e,n,i,r,o,s,a,l,u,c,h){super(null,o,s,a,l,u,i,r,c,h),this.isCompressedTexture=!0,this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class nc extends qo{constructor(t,e,n,i,r,o,s,a,l){super(t,e,n,i,r,o,s,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ic{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const r=n.length;let o;o=e||t*n[r-1];let s,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),s=n[i]-o,s<0)a=i+1;else{if(!(s>0)){l=i;break}l=i-1}if(i=l,n[i]===o)return i/(r-1);const u=n[i];return(i+(o-u)/(n[i+1]-u))/(r-1)}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const o=this.getPoint(i),s=this.getPoint(r),a=e||(o.isVector2?new xo:new Uo);return a.copy(s).sub(o).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new Uo,i=[],o=[],s=[],a=new Uo,l=new vs;for(let e=0;e<=t;e++){const n=e/t;i[e]=this.getTangentAt(n,new Uo)}o[0]=new Uo,s[0]=new Uo;let u=Number.MAX_VALUE;const c=Math.abs(i[0].x),h=Math.abs(i[0].y),d=Math.abs(i[0].z);c<=u&&(u=c,n.set(1,0,0)),h<=u&&(u=h,n.set(0,1,0)),d<=u&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),o[0].crossVectors(i[0],a),s[0].crossVectors(i[0],o[0]);for(let e=1;e<=t;e++){if(o[e]=o[e-1].clone(),s[e]=s[e-1].clone(),a.crossVectors(i[e-1],i[e]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(r(i[e-1].dot(i[e]),-1,1));o[e].applyMatrix4(l.makeRotationAxis(a,t))}s[e].crossVectors(i[e],o[e])}if(!0===e){let e=Math.acos(r(o[0].dot(o[t]),-1,1));e/=t,i[0].dot(a.crossVectors(o[0],o[t]))>0&&(e=-e);for(let n=1;n<=t;n++)o[n].applyMatrix4(l.makeRotationAxis(i[n],e*n)),s[n].crossVectors(i[n],o[n])}return{tangents:i,normals:o,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class rc extends ic{constructor(t=0,e=0,n=1,i=1,r=0,o=2*Math.PI,s=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a}getPoint(t,e){const n=e||new xo,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);const s=this.aStartAngle+t*r;let a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,i=l-this.aY;a=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class oc extends rc{constructor(t,e,n,i,r,o){super(t,e,n,n,i,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}const sc=new Uo,ac=new pe,lc=new pe,uc=new pe;class cc extends ic{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new Uo){const n=e,i=this.points,r=i.length,o=(r-(this.closed?0:1))*t;let s,a,l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===u&&l===r-1&&(l=r-2,u=1),this.closed||l>0?s=i[(l-1)%r]:(sc.subVectors(i[0],i[1]).add(i[0]),s=sc);const c=i[l%r],h=i[(l+1)%r];if(this.closed||l+2<r?a=i[(l+2)%r]:(sc.subVectors(i[r-1],i[r-2]).add(i[r-1]),a=sc),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(s.distanceToSquared(c),t),n=Math.pow(c.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),ac.initNonuniformCatmullRom(s.x,c.x,h.x,a.x,e,n,i),lc.initNonuniformCatmullRom(s.y,c.y,h.y,a.y,e,n,i),uc.initNonuniformCatmullRom(s.z,c.z,h.z,a.z,e,n,i)}else"catmullrom"===this.curveType&&(ac.initCatmullRom(s.x,c.x,h.x,a.x,this.tension),lc.initCatmullRom(s.y,c.y,h.y,a.y,this.tension),uc.initCatmullRom(s.z,c.z,h.z,a.z,this.tension));return n.set(ac.calc(u),lc.calc(u),uc.calc(u)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Uo).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}class hc extends ic{constructor(t=new xo,e=new xo,n=new xo,i=new xo){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new xo){const n=e,i=this.v0,r=this.v1,o=this.v2,s=this.v3;return n.set(ge(t,i.x,r.x,o.x,s.x),ge(t,i.y,r.y,o.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class dc extends ic{constructor(t=new Uo,e=new Uo,n=new Uo,i=new Uo){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Uo){const n=e,i=this.v0,r=this.v1,o=this.v2,s=this.v3;return n.set(ge(t,i.x,r.x,o.x,s.x),ge(t,i.y,r.y,o.y,s.y),ge(t,i.z,r.z,o.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class pc extends ic{constructor(t=new xo,e=new xo){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new xo){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new xo;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class fc extends ic{constructor(t=new Uo,e=new Uo){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new Uo){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class mc extends ic{constructor(t=new xo,e=new xo,n=new xo){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new xo){const n=e,i=this.v0,r=this.v1,o=this.v2;return n.set(me(t,i.x,r.x,o.x),me(t,i.y,r.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class gc extends ic{constructor(t=new Uo,e=new Uo,n=new Uo){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Uo){const n=e,i=this.v0,r=this.v1,o=this.v2;return n.set(me(t,i.x,r.x,o.x),me(t,i.y,r.y,o.y),me(t,i.z,r.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class yc extends ic{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new xo){const n=e,i=this.points,r=(i.length-1)*t,o=Math.floor(r),s=r-o,a=i[0===o?o:o-1],l=i[o],u=i[o>i.length-2?i.length-1:o+1],c=i[o>i.length-3?i.length-1:o+2];return n.set(fe(s,a.x,l.x,u.x,c.x),fe(s,a.y,l.y,u.y,c.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new xo).fromArray(n))}return this}}var vc=Object.freeze({__proto__:null,ArcCurve:oc,CatmullRomCurve3:cc,CubicBezierCurve:hc,CubicBezierCurve3:dc,EllipseCurve:rc,LineCurve:pc,LineCurve3:fc,QuadraticBezierCurve:mc,QuadraticBezierCurve3:gc,SplineCurve:yc});class xc extends ic{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new pc(e,t))}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const t=i[r]-n,o=this.curves[r],s=o.getLength(),a=0===s?0:1-t/s;return o.getPointAt(a,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const o=r[i],s=o.isEllipseCurve?2*t:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,a=o.getPoints(s);for(let t=0;t<a.length;t++){const i=a[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new vc[n.type]).fromJSON(n))}return this}}class bc extends xc{constructor(t){super(),this.type="Path",this.currentPoint=new xo,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new pc(this.currentPoint.clone(),new xo(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new mc(this.currentPoint.clone(),new xo(t,e),new xo(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,o){const s=new hc(this.currentPoint.clone(),new xo(t,e),new xo(n,i),new xo(r,o));return this.curves.push(s),this.currentPoint.set(r,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new yc(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,o){const s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+s,e+a,n,i,r,o),this}absarc(t,e,n,i,r,o){return this.absellipse(t,e,n,n,i,r,o),this}ellipse(t,e,n,i,r,o,s,a){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+l,e+u,n,i,r,o,s,a),this}absellipse(t,e,n,i,r,o,s,a){const l=new rc(t,e,n,i,r,o,s,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class _c extends Aa{constructor(t=[new xo(0,.5),new xo(.5,0),new xo(0,-.5)],e=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e),i=r(i,0,2*Math.PI);const o=[],s=[],a=[],l=[],u=[],c=1/e,h=new Uo,d=new xo,p=new Uo,f=new Uo,m=new Uo;let g=0,y=0;for(let e=0;e<=t.length-1;e++)switch(e){case 0:g=t[e+1].x-t[e].x,y=t[e+1].y-t[e].y,p.x=1*y,p.y=-g,p.z=0*y,m.copy(p),p.normalize(),l.push(p.x,p.y,p.z);break;case t.length-1:l.push(m.x,m.y,m.z);break;default:g=t[e+1].x-t[e].x,y=t[e+1].y-t[e].y,p.x=1*y,p.y=-g,p.z=0*y,f.copy(p),p.x+=m.x,p.y+=m.y,p.z+=m.z,p.normalize(),l.push(p.x,p.y,p.z),m.copy(f)}for(let r=0;r<=e;r++){const o=n+r*c*i,p=Math.sin(o),f=Math.cos(o);for(let n=0;n<=t.length-1;n++){h.x=t[n].x*p,h.y=t[n].y,h.z=t[n].x*f,s.push(h.x,h.y,h.z),d.x=r/e,d.y=n/(t.length-1),a.push(d.x,d.y);const i=l[3*n+0]*p,o=l[3*n+1],c=l[3*n+0]*f;u.push(i,o,c)}}for(let n=0;n<e;n++)for(let e=0;e<t.length-1;e++){const i=e+n*t.length,r=i,s=i+t.length,a=i+t.length+1,l=i+1;o.push(r,s,l),o.push(a,l,s)}this.setIndex(o),this.setAttribute("position",new ma(s,3)),this.setAttribute("uv",new ma(a,2)),this.setAttribute("normal",new ma(u,3))}static fromJSON(t){return new _c(t.points,t.segments,t.phiStart,t.phiLength)}}class wc extends _c{constructor(t=1,e=1,n=4,i=8){const r=new bc;r.absarc(0,-e/2,t,1.5*Math.PI,0),r.absarc(0,e/2,t,0,.5*Math.PI),super(r.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:t,height:e,capSegments:n,radialSegments:i}}static fromJSON(t){return new wc(t.radius,t.length,t.capSegments,t.radialSegments)}}class Sc extends Aa{constructor(t=1,e=8,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},e=Math.max(3,e);const r=[],o=[],s=[],a=[],l=new Uo,u=new xo;o.push(0,0,0),s.push(0,0,1),a.push(.5,.5);for(let r=0,c=3;r<=e;r++,c+=3){const h=n+r/e*i;l.x=t*Math.cos(h),l.y=t*Math.sin(h),o.push(l.x,l.y,l.z),s.push(0,0,1),u.x=(o[c]/t+1)/2,u.y=(o[c+1]/t+1)/2,a.push(u.x,u.y)}for(let t=1;t<=e;t++)r.push(t,t+1,0);this.setIndex(r),this.setAttribute("position",new ma(o,3)),this.setAttribute("normal",new ma(s,3)),this.setAttribute("uv",new ma(a,2))}static fromJSON(t){return new Sc(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Ac extends Aa{constructor(t=1,e=1,n=1,i=8,r=1,o=!1,s=0,a=2*Math.PI){function l(n){const r=f,o=new xo,l=new Uo;let m=0;const v=!0===n?t:e,x=!0===n?1:-1;for(let t=1;t<=i;t++)h.push(0,g*x,0),d.push(0,x,0),p.push(.5,.5),f++;const b=f;for(let t=0;t<=i;t++){const e=t/i*a+s,n=Math.cos(e),r=Math.sin(e);l.x=v*r,l.y=g*x,l.z=v*n,h.push(l.x,l.y,l.z),d.push(0,x,0),o.x=.5*n+.5,o.y=.5*r*x+.5,p.push(o.x,o.y),f++}for(let t=0;t<i;t++){const e=r+t,i=b+t;!0===n?c.push(i,i+1,e):c.push(i+1,i,e),m+=3}u.addGroup(y,m,!0===n?1:2),y+=m}super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a};const u=this;i=Math.floor(i),r=Math.floor(r);const c=[],h=[],d=[],p=[];let f=0;const m=[],g=n/2;let y=0;!function(){const o=new Uo,l=new Uo;let v=0;const x=(e-t)/n;for(let u=0;u<=r;u++){const c=[],y=u/r,v=y*(e-t)+t;for(let t=0;t<=i;t++){const e=t/i,r=e*a+s,u=Math.sin(r),m=Math.cos(r);l.x=v*u,l.y=-y*n+g,l.z=v*m,h.push(l.x,l.y,l.z),o.set(u,x,m).normalize(),d.push(o.x,o.y,o.z),p.push(e,1-y),c.push(f++)}m.push(c)}for(let t=0;t<i;t++)for(let e=0;e<r;e++){const n=m[e][t],i=m[e+1][t],r=m[e+1][t+1],o=m[e][t+1];c.push(n,i,o),c.push(i,r,o),v+=6}u.addGroup(y,v,0),y+=v}(),!1===o&&(t>0&&l(!0),e>0&&l(!1)),this.setIndex(c),this.setAttribute("position",new ma(h,3)),this.setAttribute("normal",new ma(d,3)),this.setAttribute("uv",new ma(p,2))}static fromJSON(t){return new Ac(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Mc extends Ac{constructor(t=1,e=1,n=8,i=1,r=!1,o=0,s=2*Math.PI){super(0,t,e,n,i,r,o,s),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:s}}static fromJSON(t){return new Mc(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Tc extends Aa{constructor(t=[],e=[],n=1,i=0){function r(t,e,n,i){const r=i+1,s=[];for(let i=0;i<=r;i++){s[i]=[];const o=t.clone().lerp(n,i/r),a=e.clone().lerp(n,i/r),l=r-i;for(let t=0;t<=l;t++)s[i][t]=0===t&&i===r?o:o.clone().lerp(a,t/l)}for(let t=0;t<r;t++)for(let e=0;e<2*(r-t)-1;e++){const n=Math.floor(e/2);e%2==0?(o(s[t][n+1]),o(s[t+1][n]),o(s[t][n])):(o(s[t][n+1]),o(s[t+1][n+1]),o(s[t+1][n]))}}function o(t){u.push(t.x,t.y,t.z)}function s(e,n){const i=3*e;n.x=t[i+0],n.y=t[i+1],n.z=t[i+2]}function a(t,e,n,i){i<0&&1===t.x&&(c[e]=t.x-1),0===n.x&&0===n.z&&(c[e]=i/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i};const u=[],c=[];!function(t){const n=new Uo,i=new Uo,o=new Uo;for(let a=0;a<e.length;a+=3)s(e[a+0],n),s(e[a+1],i),s(e[a+2],o),r(n,i,o,t)}(i),function(t){const e=new Uo;for(let n=0;n<u.length;n+=3)e.x=u[n+0],e.y=u[n+1],e.z=u[n+2],e.normalize().multiplyScalar(t),u[n+0]=e.x,u[n+1]=e.y,u[n+2]=e.z}(n),function(){const t=new Uo;for(let n=0;n<u.length;n+=3){t.x=u[n+0],t.y=u[n+1],t.z=u[n+2];const i=l(t)/2/Math.PI+.5,r=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);c.push(i,1-r)}var e;(function(){const t=new Uo,e=new Uo,n=new Uo,i=new Uo,r=new xo,o=new xo,s=new xo;for(let h=0,d=0;h<u.length;h+=9,d+=6){t.set(u[h+0],u[h+1],u[h+2]),e.set(u[h+3],u[h+4],u[h+5]),n.set(u[h+6],u[h+7],u[h+8]),r.set(c[d+0],c[d+1]),o.set(c[d+2],c[d+3]),s.set(c[d+4],c[d+5]),i.copy(t).add(e).add(n).divideScalar(3);const p=l(i);a(r,d+0,t,p),a(o,d+2,e,p),a(s,d+4,n,p)}})(),function(){for(let t=0;t<c.length;t+=6){const e=c[t+0],n=c[t+2],i=c[t+4],r=Math.max(e,n,i),o=Math.min(e,n,i);r>.9&&o<.1&&(e<.2&&(c[t+0]+=1),n<.2&&(c[t+2]+=1),i<.2&&(c[t+4]+=1))}}()}(),this.setAttribute("position",new ma(u,3)),this.setAttribute("normal",new ma(u.slice(),3)),this.setAttribute("uv",new ma(c,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new Tc(t.vertices,t.indices,t.radius,t.details)}}class Ec extends Tc{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Ec(t.radius,t.detail)}}const Pc=new Uo,Cc=new Uo,Ic=new Uo,Rc=new ta;class Oc extends Aa{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const n=4,i=Math.pow(10,n),r=Math.cos(go*e),o=t.getIndex(),s=t.getAttribute("position"),a=o?o.count:s.count,l=[0,0,0],u=["a","b","c"],c=new Array(3),h={},d=[];for(let t=0;t<a;t+=3){o?(l[0]=o.getX(t),l[1]=o.getX(t+1),l[2]=o.getX(t+2)):(l[0]=t,l[1]=t+1,l[2]=t+2);const{a:e,b:n,c:a}=Rc;if(e.fromBufferAttribute(s,l[0]),n.fromBufferAttribute(s,l[1]),a.fromBufferAttribute(s,l[2]),Rc.getNormal(Ic),c[0]=`${Math.round(e.x*i)},${Math.round(e.y*i)},${Math.round(e.z*i)}`,c[1]=`${Math.round(n.x*i)},${Math.round(n.y*i)},${Math.round(n.z*i)}`,c[2]=`${Math.round(a.x*i)},${Math.round(a.y*i)},${Math.round(a.z*i)}`,c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=c[t],i=c[e],o=Rc[u[t]],s=Rc[u[e]],a=`${n}_${i}`,p=`${i}_${n}`;p in h&&h[p]?(Ic.dot(h[p].normal)<=r&&(d.push(o.x,o.y,o.z),d.push(s.x,s.y,s.z)),h[p]=null):a in h||(h[a]={index0:l[t],index1:l[e],normal:Ic.clone()})}}for(const t in h)if(h[t]){const{index0:e,index1:n}=h[t];Pc.fromBufferAttribute(s,e),Cc.fromBufferAttribute(s,n),d.push(Pc.x,Pc.y,Pc.z),d.push(Cc.x,Cc.y,Cc.z)}this.setAttribute("position",new ma(d,3))}}}class qc extends bc{constructor(t){super(t),this.uuid=i(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new bc).fromJSON(n))}return this}}class Lc{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return Lc.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];Ne(t),Ue(n,t);let o=t.length;e.forEach(Ne);for(let t=0;t<e.length;t++)i.push(o),o+=e[t].length,Ue(n,e[t]);const s=function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let o=ye(t,0,r,n,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,u,c,h,d,p;if(i&&(o=function(t,e,n,i){const r=[];let o,s,a,l,u;for(o=0,s=e.length;o<s;o++)a=e[o]*i,l=o<s-1?e[o+1]*i:t.length,u=ye(t,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(Pe(u));for(r.sort(Ae),o=0;o<r.length;o++)Me(r[o],n),n=ve(n,n.next);return n}(t,e,o,n)),t.length>80*n){a=u=t[0],l=c=t[1];for(let e=n;e<r;e+=n)h=t[e],d=t[e+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);p=Math.max(u-a,c-l),p=0!==p?1/p:0}return xe(o,s,n,a,l,p),s}(n,i);for(let t=0;t<s.length;t+=3)r.push(s.slice(t,t+3));return r}}class Dc extends Aa{constructor(t=new qc([new xo(.5,.5),new xo(-.5,.5),new xo(-.5,-.5),new xo(.5,-.5)]),e={}){function n(t){function n(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function s(t,e,n){let i,r,o;const s=t.x-e.x,a=t.y-e.y,l=n.x-t.x,u=n.y-t.y,c=s*s+a*a,h=s*u-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(c),d=Math.sqrt(l*l+u*u),p=e.x-a/h,f=e.y+s/h,m=((n.x-u/d-p)*u-(n.y+l/d-f)*l)/(s*u-a*l);i=p+s*m-t.x,r=f+a*m-t.y;const g=i*i+r*r;if(g<=2)return new xo(i,r);o=Math.sqrt(g/2)}else{let t=!1;s>Number.EPSILON?l>Number.EPSILON&&(t=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(u)&&(t=!0),t?(i=-a,r=s,o=Math.sqrt(c)):(i=s,r=a,o=Math.sqrt(c/2))}return new xo(i/o,r/o)}function a(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=m+2*_;t<n;t++){const n=D*t,o=D*(t+1);c(e+i+n,e+r+n,e+r+o,e+i+o)}}}function l(t,e,n){p.push(t),p.push(e),p.push(n)}function u(t,e,n){h(t),h(e),h(n);const o=r.length/3,s=S.generateTopUV(i,r,o-3,o-2,o-1);d(s[0]),d(s[1]),d(s[2])}function c(t,e,n,o){h(t),h(e),h(o),h(e),h(n),h(o);const s=r.length/3,a=S.generateSideWallUV(i,r,s-6,s-3,s-2,s-1);d(a[0]),d(a[1]),d(a[3]),d(a[1]),d(a[2]),d(a[3])}function h(t){r.push(p[3*t+0]),r.push(p[3*t+1]),r.push(p[3*t+2])}function d(t){o.push(t.x),o.push(t.y)}const p=[],f=void 0!==e.curveSegments?e.curveSegments:12,m=void 0!==e.steps?e.steps:1;let g=void 0!==e.depth?e.depth:1,y=void 0===e.bevelEnabled||e.bevelEnabled,v=void 0!==e.bevelThickness?e.bevelThickness:.2,x=void 0!==e.bevelSize?e.bevelSize:v-.1,b=void 0!==e.bevelOffset?e.bevelOffset:0,_=void 0!==e.bevelSegments?e.bevelSegments:3;const w=e.extrudePath,S=void 0!==e.UVGenerator?e.UVGenerator:zc;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),g=e.amount);let A,M,T,E,P,C=!1;w&&(A=w.getSpacedPoints(m),C=!0,y=!1,M=w.computeFrenetFrames(m,!1),T=new Uo,E=new Uo,P=new Uo),y||(_=0,v=0,x=0,b=0);const I=t.extractPoints(f);let R=I.shape;const O=I.holes;if(!Lc.isClockWise(R)){R=R.reverse();for(let t=0,e=O.length;t<e;t++){const e=O[t];Lc.isClockWise(e)&&(O[t]=e.reverse())}}const q=Lc.triangulateShape(R,O),L=R;for(let t=0,e=O.length;t<e;t++){const e=O[t];R=R.concat(e)}const D=R.length,z=q.length,k=[];for(let t=0,e=L.length,n=e-1,i=t+1;t<e;t++,n++,i++)n===e&&(n=0),i===e&&(i=0),k[t]=s(L[t],L[n],L[i]);const B=[];let F,V=k.concat();for(let t=0,e=O.length;t<e;t++){const e=O[t];F=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),F[t]=s(e[t],e[i],e[r]);B.push(F),V=V.concat(F)}for(let t=0;t<_;t++){const e=t/_,i=v*Math.cos(e*Math.PI/2),r=x*Math.sin(e*Math.PI/2)+b;for(let t=0,e=L.length;t<e;t++){const e=n(L[t],k[t],r);l(e.x,e.y,-i)}for(let t=0,e=O.length;t<e;t++){const e=O[t];F=B[t];for(let t=0,o=e.length;t<o;t++){const o=n(e[t],F[t],r);l(o.x,o.y,-i)}}}const N=x+b;for(let t=0;t<D;t++){const e=y?n(R[t],V[t],N):R[t];C?(E.copy(M.normals[0]).multiplyScalar(e.x),T.copy(M.binormals[0]).multiplyScalar(e.y),P.copy(A[0]).add(E).add(T),l(P.x,P.y,P.z)):l(e.x,e.y,0)}for(let t=1;t<=m;t++)for(let e=0;e<D;e++){const i=y?n(R[e],V[e],N):R[e];C?(E.copy(M.normals[t]).multiplyScalar(i.x),T.copy(M.binormals[t]).multiplyScalar(i.y),P.copy(A[t]).add(E).add(T),l(P.x,P.y,P.z)):l(i.x,i.y,g/m*t)}for(let t=_-1;t>=0;t--){const e=t/_,i=v*Math.cos(e*Math.PI/2),r=x*Math.sin(e*Math.PI/2)+b;for(let t=0,e=L.length;t<e;t++){const e=n(L[t],k[t],r);l(e.x,e.y,g+i)}for(let t=0,e=O.length;t<e;t++){const e=O[t];F=B[t];for(let t=0,o=e.length;t<o;t++){const o=n(e[t],F[t],r);C?l(o.x,o.y+A[m-1].y,A[m-1].x+i):l(o.x,o.y,g+i)}}}!function(){const t=r.length/3;if(y){let t=0,e=D*t;for(let t=0;t<z;t++){const n=q[t];u(n[2]+e,n[1]+e,n[0]+e)}t=m+2*_,e=D*t;for(let t=0;t<z;t++){const n=q[t];u(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<z;t++){const e=q[t];u(e[2],e[1],e[0])}for(let t=0;t<z;t++){const e=q[t];u(e[0]+D*m,e[1]+D*m,e[2]+D*m)}}i.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;a(L,e),e+=L.length;for(let t=0,n=O.length;t<n;t++){const n=O[t];a(n,e),e+=n.length}i.addGroup(t,r.length/3-t,1)}()}super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const i=this,r=[],o=[];for(let e=0,i=t.length;e<i;e++)n(t[e]);this.setAttribute("position",new ma(r,3)),this.setAttribute("uv",new ma(o,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,i=t.length;e<i;e++){const i=t[e];n.shapes.push(i.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new vc[i.type]).fromJSON(i)),new Dc(n,t.options)}}const zc={generateTopUV:function(t,e,n,i,r){const o=e[3*n],s=e[3*n+1],a=e[3*i],l=e[3*i+1],u=e[3*r],c=e[3*r+1];return[new xo(o,s),new xo(a,l),new xo(u,c)]},generateSideWallUV:function(t,e,n,i,r,o){const s=e[3*n],a=e[3*n+1],l=e[3*n+2],u=e[3*i],c=e[3*i+1],h=e[3*i+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*o],g=e[3*o+1],y=e[3*o+2];return Math.abs(a-c)<Math.abs(s-u)?[new xo(s,1-l),new xo(u,1-h),new xo(d,1-f),new xo(m,1-y)]:[new xo(a,1-l),new xo(c,1-h),new xo(p,1-f),new xo(g,1-y)]}};class kc extends Tc{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new kc(t.radius,t.detail)}}class Bc extends Tc{constructor(t=1,e=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Bc(t.radius,t.detail)}}class Fc extends Aa{constructor(t=.5,e=1,n=8,i=1,r=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},n=Math.max(3,n);const s=[],a=[],l=[],u=[];let c=t;const h=(e-t)/(i=Math.max(1,i)),d=new Uo,p=new xo;for(let t=0;t<=i;t++){for(let t=0;t<=n;t++){const i=r+t/n*o;d.x=c*Math.cos(i),d.y=c*Math.sin(i),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/e+1)/2,p.y=(d.y/e+1)/2,u.push(p.x,p.y)}c+=h}for(let t=0;t<i;t++){const e=t*(n+1);for(let t=0;t<n;t++){const i=t+e,r=i,o=i+n+1,a=i+n+2,l=i+1;s.push(r,o,l),s.push(o,a,l)}}this.setIndex(s),this.setAttribute("position",new ma(a,3)),this.setAttribute("normal",new ma(l,3)),this.setAttribute("uv",new ma(u,2))}static fromJSON(t){return new Fc(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class Vc extends Aa{constructor(t=new qc([new xo(0,.5),new xo(-.5,-.5),new xo(.5,-.5)]),e=12){function n(t){const n=r.length/3,a=t.extractPoints(e);let u=a.shape;const c=a.holes;!1===Lc.isClockWise(u)&&(u=u.reverse());for(let t=0,e=c.length;t<e;t++){const e=c[t];!0===Lc.isClockWise(e)&&(c[t]=e.reverse())}const h=Lc.triangulateShape(u,c);for(let t=0,e=c.length;t<e;t++){const e=c[t];u=u.concat(e)}for(let t=0,e=u.length;t<e;t++){const e=u[t];r.push(e.x,e.y,0),o.push(0,0,1),s.push(e.x,e.y)}for(let t=0,e=h.length;t<e;t++){const e=h[t],r=e[0]+n,o=e[1]+n,s=e[2]+n;i.push(r,o,s),l+=3}}super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const i=[],r=[],o=[],s=[];let a=0,l=0;if(!1===Array.isArray(t))n(t);else for(let e=0;e<t.length;e++)n(t[e]),this.addGroup(a,l,e),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new ma(r,3)),this.setAttribute("normal",new ma(o,3)),this.setAttribute("uv",new ma(s,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}return new Vc(n,t.curveSegments)}}class Nc extends Aa{constructor(t=1,e=32,n=16,i=0,r=2*Math.PI,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let l=0;const u=[],c=new Uo,h=new Uo,d=[],p=[],f=[],m=[];for(let d=0;d<=n;d++){const g=[],y=d/n;let v=0;0==d&&0==o?v=.5/e:d==n&&a==Math.PI&&(v=-.5/e);for(let n=0;n<=e;n++){const a=n/e;c.x=-t*Math.cos(i+a*r)*Math.sin(o+y*s),c.y=t*Math.cos(o+y*s),c.z=t*Math.sin(i+a*r)*Math.sin(o+y*s),p.push(c.x,c.y,c.z),h.copy(c).normalize(),f.push(h.x,h.y,h.z),m.push(a+v,1-y),g.push(l++)}u.push(g)}for(let t=0;t<n;t++)for(let i=0;i<e;i++){const e=u[t][i+1],r=u[t][i],s=u[t+1][i],l=u[t+1][i+1];(0!==t||o>0)&&d.push(e,r,l),(t!==n-1||a<Math.PI)&&d.push(r,s,l)}this.setIndex(d),this.setAttribute("position",new ma(p,3)),this.setAttribute("normal",new ma(f,3)),this.setAttribute("uv",new ma(m,2))}static fromJSON(t){return new Nc(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class Uc extends Tc{constructor(t=1,e=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Uc(t.radius,t.detail)}}class jc extends Aa{constructor(t=1,e=.4,n=8,i=6,r=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const o=[],s=[],a=[],l=[],u=new Uo,c=new Uo,h=new Uo;for(let o=0;o<=n;o++)for(let d=0;d<=i;d++){const p=d/i*r,f=o/n*Math.PI*2;c.x=(t+e*Math.cos(f))*Math.cos(p),c.y=(t+e*Math.cos(f))*Math.sin(p),c.z=e*Math.sin(f),s.push(c.x,c.y,c.z),u.x=t*Math.cos(p),u.y=t*Math.sin(p),h.subVectors(c,u).normalize(),a.push(h.x,h.y,h.z),l.push(d/i),l.push(o/n)}for(let t=1;t<=n;t++)for(let e=1;e<=i;e++){const n=(i+1)*t+e-1,r=(i+1)*(t-1)+e-1,s=(i+1)*(t-1)+e,a=(i+1)*t+e;o.push(n,r,a),o.push(r,s,a)}this.setIndex(o),this.setAttribute("position",new ma(s,3)),this.setAttribute("normal",new ma(a,3)),this.setAttribute("uv",new ma(l,2))}static fromJSON(t){return new jc(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class Gc extends Aa{constructor(t=1,e=.4,n=64,i=8,r=2,o=3){function s(t,e,n,i,r){const o=Math.cos(t),s=Math.sin(t),a=n/e*t,l=Math.cos(a);r.x=i*(2+l)*.5*o,r.y=i*(2+l)*s*.5,r.z=i*Math.sin(a)*.5}super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},n=Math.floor(n),i=Math.floor(i);const a=[],l=[],u=[],c=[],h=new Uo,d=new Uo,p=new Uo,f=new Uo,m=new Uo,g=new Uo,y=new Uo;for(let a=0;a<=n;++a){const v=a/n*r*Math.PI*2;s(v,r,o,t,p),s(v+.01,r,o,t,f),g.subVectors(f,p),y.addVectors(f,p),m.crossVectors(g,y),y.crossVectors(m,g),m.normalize(),y.normalize();for(let t=0;t<=i;++t){const r=t/i*Math.PI*2,o=-e*Math.cos(r),s=e*Math.sin(r);h.x=p.x+(o*y.x+s*m.x),h.y=p.y+(o*y.y+s*m.y),h.z=p.z+(o*y.z+s*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),u.push(d.x,d.y,d.z),c.push(a/n),c.push(t/i)}}for(let t=1;t<=n;t++)for(let e=1;e<=i;e++){const n=(i+1)*(t-1)+(e-1),r=(i+1)*t+(e-1),o=(i+1)*t+e,s=(i+1)*(t-1)+e;a.push(n,r,s),a.push(r,o,s)}this.setIndex(a),this.setAttribute("position",new ma(l,3)),this.setAttribute("normal",new ma(u,3)),this.setAttribute("uv",new ma(c,2))}static fromJSON(t){return new Gc(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class Hc extends Aa{constructor(t=new gc(new Uo(-1,-1,0),new Uo(-1,1,0),new Uo(1,1,0)),e=64,n=1,i=8,r=!1){function o(r){c=t.getPointAt(r/e,c);const o=s.normals[r],u=s.binormals[r];for(let t=0;t<=i;t++){const e=t/i*Math.PI*2,r=Math.sin(e),s=-Math.cos(e);l.x=s*o.x+r*u.x,l.y=s*o.y+r*u.y,l.z=s*o.z+r*u.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=c.x+n*l.x,a.y=c.y+n*l.y,a.z=c.z+n*l.z,h.push(a.x,a.y,a.z)}}super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r};const s=t.computeFrenetFrames(e,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const a=new Uo,l=new Uo,u=new xo;let c=new Uo;const h=[],d=[],p=[],f=[];!function(){for(let t=0;t<e;t++)o(t);o(!1===r?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=i;n++)u.x=t/e,u.y=n/i,p.push(u.x,u.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=i;e++){const n=(i+1)*(t-1)+(e-1),r=(i+1)*t+(e-1),o=(i+1)*t+e,s=(i+1)*(t-1)+e;f.push(n,r,s),f.push(r,o,s)}}()}(),this.setIndex(f),this.setAttribute("position",new ma(h,3)),this.setAttribute("normal",new ma(d,3)),this.setAttribute("uv",new ma(p,2))}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new Hc((new vc[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class Wc extends Aa{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,i=new Uo,r=new Uo;if(null!==t.index){const o=t.attributes.position,s=t.index;let a=t.groups;0===a.length&&(a=[{start:0,count:s.count,materialIndex:0}]);for(let t=0,l=a.length;t<l;++t){const l=a[t],u=l.start;for(let t=u,a=u+l.count;t<a;t+=3)for(let a=0;a<3;a++){const l=s.getX(t+a),u=s.getX(t+(a+1)%3);i.fromBufferAttribute(o,l),r.fromBufferAttribute(o,u),!0===je(i,r,n)&&(e.push(i.x,i.y,i.z),e.push(r.x,r.y,r.z))}}}else{const o=t.attributes.position;for(let t=0,s=o.count/3;t<s;t++)for(let s=0;s<3;s++){const a=3*t+s,l=3*t+(s+1)%3;i.fromBufferAttribute(o,a),r.fromBufferAttribute(o,l),!0===je(i,r,n)&&(e.push(i.x,i.y,i.z),e.push(r.x,r.y,r.z))}}this.setAttribute("position",new ma(e,3))}}}var Xc=Object.freeze({__proto__:null,BoxGeometry:ja,BoxBufferGeometry:ja,CapsuleGeometry:wc,CapsuleBufferGeometry:wc,CircleGeometry:Sc,CircleBufferGeometry:Sc,ConeGeometry:Mc,ConeBufferGeometry:Mc,CylinderGeometry:Ac,CylinderBufferGeometry:Ac,DodecahedronGeometry:Ec,DodecahedronBufferGeometry:Ec,EdgesGeometry:Oc,ExtrudeGeometry:Dc,ExtrudeBufferGeometry:Dc,IcosahedronGeometry:kc,IcosahedronBufferGeometry:kc,LatheGeometry:_c,LatheBufferGeometry:_c,OctahedronGeometry:Bc,OctahedronBufferGeometry:Bc,PlaneGeometry:ol,PlaneBufferGeometry:ol,PolyhedronGeometry:Tc,PolyhedronBufferGeometry:Tc,RingGeometry:Fc,RingBufferGeometry:Fc,ShapeGeometry:Vc,ShapeBufferGeometry:Vc,SphereGeometry:Nc,SphereBufferGeometry:Nc,TetrahedronGeometry:Uc,TetrahedronBufferGeometry:Uc,TorusGeometry:jc,TorusBufferGeometry:jc,TorusKnotGeometry:Gc,TorusKnotBufferGeometry:Gc,TubeGeometry:Hc,TubeBufferGeometry:Hc,WireframeGeometry:Wc});class Yc extends na{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Po(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class Zc extends Ha{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Qc extends na{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Po(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Po(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class Jc extends Qc{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xo(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return r(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Po(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Po(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Po(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class Kc extends na{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Po(16777215),this.specular=new Po(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Po(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Wn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class $c extends na{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Po(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Po(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class th extends na{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class eh extends na{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Po(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Po(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Wn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class nh extends na{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Po(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=qr,this.normalScale=new xo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class ih extends zu{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}const rh={ShadowMaterial:Yc,SpriteMaterial:eu,RawShaderMaterial:Zc,ShaderMaterial:Ha,PointsMaterial:Xu,MeshPhysicalMaterial:Jc,MeshStandardMaterial:Qc,MeshPhongMaterial:Kc,MeshToonMaterial:$c,MeshNormalMaterial:th,MeshLambertMaterial:eh,MeshDepthMaterial:Vl,MeshDistanceMaterial:Nl,MeshBasicMaterial:ia,MeshMatcapMaterial:nh,LineDashedMaterial:ih,LineBasicMaterial:zu,Material:na};na.fromType=function(t){return new rh[t]};const oh={arraySlice:function(t,e,n){return oh.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let o=0,s=0;s!==i;++o){const i=n[o]*e;for(let n=0;n!==e;++n)r[s++]=t[i+n]}return r},flattenJSON:function(t,e,n,i){let r=1,o=t[0];for(;void 0!==o&&void 0===o[i];)o=t[r++];if(void 0===o)return;let s=o[i];if(void 0!==s)if(Array.isArray(s))do{s=o[i],void 0!==s&&(e.push(o.time),n.push.apply(n,s)),o=t[r++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[i],void 0!==s&&(e.push(o.time),s.toArray(n,n.length)),o=t[r++]}while(void 0!==o);else do{s=o[i],void 0!==s&&(e.push(o.time),n.push(s)),o=t[r++]}while(void 0!==o)},subclip:function(t,e,n,i,r=30){const o=t.clone();o.name=e;const s=[];for(let t=0;t<o.tracks.length;++t){const e=o.tracks[t],a=e.getValueSize(),l=[],u=[];for(let t=0;t<e.times.length;++t){const o=e.times[t]*r;if(!(o<n||o>=i)){l.push(e.times[t]);for(let n=0;n<a;++n)u.push(e.values[t*a+n])}}0!==l.length&&(e.times=oh.convertArray(l,e.times.constructor),e.values=oh.convertArray(u,e.values.constructor),s.push(e))}o.tracks=s;let a=1/0;for(let t=0;t<o.tracks.length;++t)a>o.tracks[t].times[0]&&(a=o.tracks[t].times[0]);for(let t=0;t<o.tracks.length;++t)o.tracks[t].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,o=e/i;for(let e=0;e<r;++e){const i=n.tracks[e],r=i.ValueTypeName;if("bool"===r||"string"===r)continue;const s=t.tracks.find((function(t){return t.name===i.name&&t.ValueTypeName===r}));if(void 0===s)continue;let a=0;const l=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let u=0;const c=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);const h=i.times.length-1;let d;if(o<=i.times[0]){const t=a,e=l-a;d=oh.arraySlice(i.values,t,e)}else if(o>=i.times[h]){const t=h*l+a,e=t+l-a;d=oh.arraySlice(i.values,t,e)}else{const t=i.createInterpolant(),e=a,n=l-a;t.evaluate(o),d=oh.arraySlice(t.resultBuffer,e,n)}"quaternion"===r&&(new No).fromArray(d).normalize().conjugate().toArray(d);const p=s.times.length;for(let t=0;t<p;++t){const e=t*c+u;if("quaternion"===r)No.multiplyQuaternionsFlat(s.values,e,d,0,s.values,e);else{const t=c-2*u;for(let n=0;n<t;++n)s.values[e+n]-=d[n]}}}return t.blendMode=Mr,t}};class sh{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let o;n:{i:if(!(t<i)){for(let o=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(r=i,i=e[++n],t<i)break e}o=e.length;break n}if(t>=r)break t;{const s=e[1];t<s&&(n=2,r=s);for(let o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(i=r,r=e[--n-1],t>=r)break e}o=n,n=0}}for(;n<o;){const i=n+o>>>1;t<e[i]?o=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let t=0;t!==i;++t)e[t]=n[r+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ah extends sh{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_r,endingEnd:_r}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,o=t+1,s=i[r],a=i[o];if(void 0===s)switch(this.getSettings_().endingStart){case wr:r=t,s=2*e-n;break;case Sr:r=i.length-2,s=e+i[r]-i[r+1];break;default:r=t,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case wr:o=t,a=2*n-e;break;case Sr:o=1,a=n+i[1]-i[0];break;default:o=t-1,a=e}const l=.5*(n-e),u=this.valueSize;this._weightPrev=l/(e-s),this._weightNext=l/(a-n),this._offsetPrev=r*u,this._offsetNext=o*u}interpolate_(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f;for(let t=0;t!==s;++t)r[t]=g*o[u+t]+y*o[l+t]+v*o[a+t]+x*o[c+t];return r}}class lh extends sh{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,u=(n-e)/(i-e),c=1-u;for(let t=0;t!==s;++t)r[t]=o[l+t]*c+o[a+t]*u;return r}}class uh extends sh{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class ch{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=oh.convertArray(e,this.TimeBufferType),this.values=oh.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:oh.convertArray(t.times,Array),values:oh.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new uh(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new lh(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new ah(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case vr:e=this.InterpolantFactoryMethodDiscrete;break;case xr:e=this.InterpolantFactoryMethodLinear;break;case br:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return vr;case this.InterpolantFactoryMethodLinear:return xr;case this.InterpolantFactoryMethodSmooth:return br}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,o=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);const t=this.getValueSize();this.times=oh.arraySlice(n,r,o),this.values=oh.arraySlice(this.values,r*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let e=0;e!==r;e++){const i=n[e];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,i),t=!1;break}if(null!==o&&o>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,i,o),t=!1;break}o=i}if(void 0!==i&&oh.isTypedArray(i))for(let e=0,n=i.length;e!==n;++e){const n=i[e];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,n),t=!1;break}}return t}optimize(){const t=oh.arraySlice(this.times),e=oh.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===br,r=t.length-1;let o=1;for(let s=1;s<r;++s){let r=!1;const a=t[s];if(a!==t[s+1]&&(1!==s||a!==t[0]))if(i)r=!0;else{const t=s*n,i=t-n,o=t+n;for(let s=0;s!==n;++s){const n=e[t+s];if(n!==e[i+s]||n!==e[o+s]){r=!0;break}}}if(r){if(s!==o){t[o]=t[s];const i=s*n,r=o*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++o}}if(r>0){t[o]=t[r];for(let t=r*n,i=o*n,s=0;s!==n;++s)e[i+s]=e[t+s];++o}return o!==t.length?(this.times=oh.arraySlice(t,0,o),this.values=oh.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=oh.arraySlice(this.times,0),e=oh.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}ch.prototype.TimeBufferType=Float32Array,ch.prototype.ValueBufferType=Float32Array,ch.prototype.DefaultInterpolation=xr;class hh extends ch{}hh.prototype.ValueTypeName="bool",hh.prototype.ValueBufferType=Array,hh.prototype.DefaultInterpolation=vr,hh.prototype.InterpolantFactoryMethodLinear=void 0,hh.prototype.InterpolantFactoryMethodSmooth=void 0;class dh extends ch{}dh.prototype.ValueTypeName="color";class ph extends ch{}ph.prototype.ValueTypeName="number";class fh extends sh{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-e)/(i-e);let l=t*s;for(let t=l+s;l!==t;l+=4)No.slerpFlat(r,0,o,l-s,o,l,a);return r}}class mh extends ch{InterpolantFactoryMethodLinear(t){return new fh(this.times,this.values,this.getValueSize(),t)}}mh.prototype.ValueTypeName="quaternion",mh.prototype.DefaultInterpolation=xr,mh.prototype.InterpolantFactoryMethodSmooth=void 0;class gh extends ch{}gh.prototype.ValueTypeName="string",gh.prototype.ValueBufferType=Array,gh.prototype.DefaultInterpolation=vr,gh.prototype.InterpolantFactoryMethodLinear=void 0,gh.prototype.InterpolantFactoryMethodSmooth=void 0;class yh extends ch{}yh.prototype.ValueTypeName="vector";class vh{constructor(t,e=-1,n,r=Ar){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=i(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let t=0,r=n.length;t!==r;++t)e.push(Ge(n[t]).scale(i));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,i=n.length;t!==i;++t)e.push(ch.toJSON(n[t]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const r=e.length,o=[];for(let t=0;t<r;t++){let s=[],a=[];s.push((t+r-1)%r,t,(t+1)%r),a.push(0,1,0);const l=oh.getKeyframeOrder(s);s=oh.sortedArray(s,1,l),a=oh.sortedArray(a,1,l),i||0!==s[0]||(s.push(r),a.push(a[0])),o.push(new ph(".morphTargetInfluences["+e[t].name+"]",s,a).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],o=n.name.match(r);if(o&&o.length>1){const t=o[1];let e=i[t];e||(i[t]=e=[]),e.push(n)}}const o=[];for(const t in i)o.push(this.CreateFromMorphTargetSequence(t,i[t],e,n));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,i,r){if(0!==n.length){const o=[],s=[];oh.flattenJSON(n,o,s,i),0!==o.length&&r.push(new t(e,o,s))}},i=[],r=t.name||"default",o=t.fps||30,s=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const r=l[t].keys;if(r&&0!==r.length)if(r[0].morphTargets){const t={};let e;for(e=0;e<r.length;e++)if(r[e].morphTargets)for(let n=0;n<r[e].morphTargets.length;n++)t[r[e].morphTargets[n]]=-1;for(const n in t){const t=[],o=[];for(let i=0;i!==r[e].morphTargets.length;++i){const i=r[e];t.push(i.time),o.push(i.morphTarget===n?1:0)}i.push(new ph(".morphTargetInfluence["+n+"]",t,o))}a=t.length*o}else{const o=".bones["+e[t].name+"]";n(yh,o+".position",r,"pos",i),n(mh,o+".quaternion",r,"rot",i),n(yh,o+".scale",r,"scl",i)}}return 0===i.length?null:new this(r,a,i,s)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}const xh={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class bh{constructor(t,e,n){const i=this;let r,o=!1,s=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===o&&void 0!==i.onStart&&i.onStart(t,s,a),o=!0},this.itemEnd=function(t){s++,void 0!==i.onProgress&&i.onProgress(t,s,a),s===a&&(o=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}}const _h=new bh;class wh{constructor(t){this.manager=void 0!==t?t:_h,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Sh={};class Ah extends wh{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=xh.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout((()=>{e&&e(r),this.manager.itemEnd(t)}),0),r;if(void 0!==Sh[t])return void Sh[t].push({onLoad:e,onProgress:n,onError:i});Sh[t]=[],Sh[t].push({onLoad:e,onProgress:n,onError:i});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,a=this.responseType;fetch(o).then((e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=Sh[t],i=e.body.getReader(),r=e.headers.get("Content-Length"),o=r?parseInt(r):0,s=0!==o;let a=0;const l=new ReadableStream({start(t){!function e(){i.read().then((({done:i,value:r})=>{if(i)t.close();else{a+=r.byteLength;const i=new ProgressEvent("progress",{lengthComputable:s,loaded:a,total:o});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(r),e()}}))}()}});return new Response(l)}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)})).then((t=>{switch(a){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,s)));case"json":return t.json();default:if(void 0===s)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(s),n=e&&e[1]?e[1].toLowerCase():void 0,i=new TextDecoder(n);return t.arrayBuffer().then((t=>i.decode(t)))}}})).then((e=>{xh.add(t,e);const n=Sh[t];delete Sh[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}})).catch((e=>{const n=Sh[t];if(void 0===n)throw this.manager.itemError(t),e;delete Sh[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Mh extends wh{constructor(t){super(t)}load(t,e,n,i){const r=this,o=new Ah(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{e(r.parse(JSON.parse(n)))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)}parse(t){const e=[];for(let n=0;n<t.length;n++){const i=vh.parse(t[n]);e.push(i)}return e}}class Th extends wh{constructor(t){super(t)}load(t,e,n,i){function r(r){l.load(t[r],(function(t){const n=o.parse(t,!0);s[r]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},u+=1,6===u&&(1===n.mipmapCount&&(a.minFilter=mi),a.image=s,a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,i)}const o=this,s=[],a=new ec,l=new Ah(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(o.withCredentials);let u=0;if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)r(e);else l.load(t,(function(t){const n=o.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){s[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)s[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),s[e].format=n.format,s[e].width=n.width,s[e].height=n.height}a.image=s}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=mi),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,i);return a}}class Eh extends wh{constructor(t){super(t)}load(t,e,n,i){function r(){s(),xh.add(t,this),e&&e(this),a.manager.itemEnd(t)}function o(e){s(),i&&i(e),a.manager.itemError(t),a.manager.itemEnd(t)}function s(){u.removeEventListener("load",r,!1),u.removeEventListener("error",o,!1)}void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const a=this,l=xh.get(t);if(void 0!==l)return a.manager.itemStart(t),setTimeout((function(){e&&e(l),a.manager.itemEnd(t)}),0),l;const u=d("img");return u.addEventListener("load",r,!1),u.addEventListener("error",o,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(u.crossOrigin=this.crossOrigin),a.manager.itemStart(t),u.src=t,u}}class Ph extends wh{constructor(t){super(t)}load(t,e,n,i){function r(n){s.load(t[n],(function(t){o.images[n]=t,a++,6===a&&(o.needsUpdate=!0,e&&e(o))}),void 0,i)}const o=new Qa,s=new Eh(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;for(let e=0;e<t.length;++e)r(e);return o}}class Ch extends wh{constructor(t){super(t)}load(t,e,n,i){const r=this,o=new Tu,s=new Ah(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(r.withCredentials),s.load(t,(function(t){const n=r.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:li,o.wrapT=void 0!==n.wrapT?n.wrapT:li,o.magFilter=void 0!==n.magFilter?n.magFilter:mi,o.minFilter=void 0!==n.minFilter?n.minFilter:mi,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=vi),1===n.mipmapCount&&(o.minFilter=mi),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,e&&e(o,n))}),n,i),o}}class Ih extends wh{constructor(t){super(t)}load(t,e,n,i){const r=new qo,o=new Eh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}class Rh extends js{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Po(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}class Oh extends Rh{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(js.DefaultUp),this.updateMatrix(),this.groundColor=new Po(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const qh=new vs,Lh=new Uo,Dh=new Uo;class zh{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new xo(512,512),this.map=null,this.mapPass=null,this.matrix=new vs,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rl,this._frameExtents=new xo(1,1),this._viewportCount=1,this._viewports=[new Lo(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Lh.setFromMatrixPosition(t.matrixWorld),e.position.copy(Lh),Dh.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Dh),e.updateMatrixWorld(),qh.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qh),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class kh extends zh{constructor(){super(new Xa(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=2*yo*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class Bh extends Rh{constructor(t,e,n=0,i=Math.PI/3,r=0,o=1){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(js.DefaultUp),this.updateMatrix(),this.target=new js,this.distance=n,this.angle=i,this.penumbra=r,this.decay=o,this.shadow=new kh}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const Fh=new vs,Vh=new Uo,Nh=new Uo;class Uh extends zh{constructor(){super(new Xa(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new xo(4,2),this._viewportCount=6,this._viewports=[new Lo(2,1,1,1),new Lo(0,1,1,1),new Lo(3,1,1,1),new Lo(1,1,1,1),new Lo(3,0,1,1),new Lo(1,0,1,1)],this._cubeDirections=[new Uo(1,0,0),new Uo(-1,0,0),new Uo(0,0,1),new Uo(0,0,-1),new Uo(0,1,0),new Uo(0,-1,0)],this._cubeUps=[new Uo(0,1,0),new Uo(0,1,0),new Uo(0,1,0),new Uo(0,1,0),new Uo(0,0,1),new Uo(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Vh.setFromMatrixPosition(t.matrixWorld),n.position.copy(Vh),Nh.copy(n.position),Nh.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Nh),n.updateMatrixWorld(),i.makeTranslation(-Vh.x,-Vh.y,-Vh.z),Fh.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Fh)}}class jh extends Rh{constructor(t,e,n=0,i=1){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Uh}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class Gh extends zh{constructor(){super(new ul(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Hh extends Rh{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(js.DefaultUp),this.updateMatrix(),this.target=new js,this.shadow=new Gh}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class Wh extends Rh{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class Xh extends Rh{constructor(t,e,n=10,i=10){super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class Yh{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Uo)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*i),e.addScaledVector(o[2],.488603*r),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*i*1.092548),e.addScaledVector(o[5],i*r*1.092548),e.addScaledVector(o[6],.315392*(3*r*r-1)),e.addScaledVector(o[7],n*r*1.092548),e.addScaledVector(o[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*i),e.addScaledVector(o[2],1.023328*r),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*i),e.addScaledVector(o[5],.858086*i*r),e.addScaledVector(o[6],.743125*r*r-.247708),e.addScaledVector(o[7],.858086*n*r),e.addScaledVector(o[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}class Zh extends Rh{constructor(t=new Yh,e=1){super(void 0,e),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}class Qh extends wh{constructor(t){super(t),this.textures={}}load(t,e,n,i){const r=this,o=new Ah(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(n){try{e(r.parse(JSON.parse(n)))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)}parse(t){function e(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}const n=this.textures,i=na.fromType(t.type);if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&void 0!==i.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.sheen&&(i.sheen=t.sheen),void 0!==t.sheenColor&&(i.sheenColor=(new Po).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(i.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==i.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==i.specular&&i.specular.setHex(t.specular),void 0!==t.specularIntensity&&(i.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearcoat&&(i.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(i.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.iridescence&&(i.iridescence=t.iridescence),void 0!==t.iridescenceIOR&&(i.iridescenceIOR=t.iridescenceIOR),void 0!==t.iridescenceThicknessRange&&(i.iridescenceThicknessRange=t.iridescenceThicknessRange),void 0!==t.transmission&&(i.transmission=t.transmission),void 0!==t.thickness&&(i.thickness=t.thickness),void 0!==t.attenuationDistance&&(i.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(t.attenuationColor),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.flatShading&&(i.flatShading=t.flatShading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.combine&&(i.combine=t.combine),void 0!==t.side&&(i.side=t.side),void 0!==t.shadowSide&&(i.shadowSide=t.shadowSide),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(i.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(i.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(i.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(i.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(i.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(i.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(i.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(i.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(i.rotation=t.rotation),1!==t.linewidth&&(i.linewidth=t.linewidth),void 0!==t.dashSize&&(i.dashSize=t.dashSize),void 0!==t.gapSize&&(i.gapSize=t.gapSize),void 0!==t.scale&&(i.scale=t.scale),void 0!==t.polygonOffset&&(i.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(i.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(i.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(i.dithering=t.dithering),void 0!==t.alphaToCoverage&&(i.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(i.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.toneMapped&&(i.toneMapped=t.toneMapped),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?i.vertexColors=t.vertexColors>0:i.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const n in t.uniforms){const r=t.uniforms[n];switch(i.uniforms[n]={},r.type){case"t":i.uniforms[n].value=e(r.value);break;case"c":i.uniforms[n].value=(new Po).setHex(r.value);break;case"v2":i.uniforms[n].value=(new xo).fromArray(r.value);break;case"v3":i.uniforms[n].value=(new Uo).fromArray(r.value);break;case"v4":i.uniforms[n].value=(new Lo).fromArray(r.value);break;case"m3":i.uniforms[n].value=(new bo).fromArray(r.value);break;case"m4":i.uniforms[n].value=(new vs).fromArray(r.value);break;default:i.uniforms[n].value=r.value}}if(void 0!==t.defines&&(i.defines=t.defines),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const e in t.extensions)i.extensions[e]=t.extensions[e];if(void 0!==t.shading&&(i.flatShading=1===t.shading),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=e(t.map)),void 0!==t.matcap&&(i.matcap=e(t.matcap)),void 0!==t.alphaMap&&(i.alphaMap=e(t.alphaMap)),void 0!==t.bumpMap&&(i.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=e(t.normalMap)),void 0!==t.normalMapType&&(i.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),i.normalScale=(new xo).fromArray(e)}return void 0!==t.displacementMap&&(i.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=e(t.specularMap)),void 0!==t.specularIntensityMap&&(i.specularIntensityMap=e(t.specularIntensityMap)),void 0!==t.specularColorMap&&(i.specularColorMap=e(t.specularColorMap)),void 0!==t.envMap&&(i.envMap=e(t.envMap)),void 0!==t.envMapIntensity&&(i.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(i.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(i.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=e(t.gradientMap)),void 0!==t.clearcoatMap&&(i.clearcoatMap=e(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=e(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(i.clearcoatNormalMap=e(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(i.clearcoatNormalScale=(new xo).fromArray(t.clearcoatNormalScale)),void 0!==t.iridescenceMap&&(i.iridescenceMap=e(t.iridescenceMap)),void 0!==t.iridescenceThicknessMap&&(i.iridescenceThicknessMap=e(t.iridescenceThicknessMap)),void 0!==t.transmissionMap&&(i.transmissionMap=e(t.transmissionMap)),void 0!==t.thicknessMap&&(i.thicknessMap=e(t.thicknessMap)),void 0!==t.sheenColorMap&&(i.sheenColorMap=e(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(i.sheenRoughnessMap=e(t.sheenRoughnessMap)),i}setTextures(t){return this.textures=t,this}}class Jh{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class Kh extends Aa{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class $h extends wh{constructor(t){super(t)}load(t,e,n,i){const r=this,o=new Ah(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(t,(function(n){try{e(r.parse(JSON.parse(n)))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)}parse(t){function e(t,e){if(void 0!==n[e])return n[e];const r=t.interleavedBuffers[e],o=function(t,e){if(void 0!==i[e])return i[e];const n=t.arrayBuffers[e],r=new Uint32Array(n).buffer;return i[e]=r,r}(t,r.buffer),s=h(r.type,o),a=new Kl(s,r.stride);return a.uuid=r.uuid,n[e]=a,a}const n={},i={},r=t.isInstancedBufferGeometry?new Kh:new Aa,o=t.data.index;if(void 0!==o){const t=h(o.type,o.array);r.setIndex(new sa(t,1))}const s=t.data.attributes;for(const n in s){const i=s[n];let o;if(i.isInterleavedBufferAttribute){const n=e(t.data,i.data);o=new tu(n,i.itemSize,i.offset,i.normalized)}else{const t=h(i.type,i.array);o=new(i.isInstancedBufferAttribute?Iu:sa)(t,i.itemSize,i.normalized)}void 0!==i.name&&(o.name=i.name),void 0!==i.usage&&o.setUsage(i.usage),void 0!==i.updateRange&&(o.updateRange.offset=i.updateRange.offset,o.updateRange.count=i.updateRange.count),r.setAttribute(n,o)}const a=t.data.morphAttributes;if(a)for(const n in a){const i=a[n],o=[];for(let n=0,r=i.length;n<r;n++){const r=i[n];let s;if(r.isInterleavedBufferAttribute){const n=e(t.data,r.data);s=new tu(n,r.itemSize,r.offset,r.normalized)}else{const t=h(r.type,r.array);s=new sa(t,r.itemSize,r.normalized)}void 0!==r.name&&(s.name=r.name),o.push(s)}r.morphAttributes[n]=o}t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(let t=0,e=l.length;t!==e;++t){const e=l[t];r.addGroup(e.start,e.count,e.materialIndex)}const u=t.data.boundingSphere;if(void 0!==u){const t=new Uo;void 0!==u.center&&t.fromArray(u.center),r.boundingSphere=new us(t,u.radius)}return t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}}class td extends wh{constructor(t){super(t)}load(t,e,n,i){const r=this,o=""===this.path?Jh.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const s=new Ah(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){let o=null;try{o=JSON.parse(n)}catch(e){return void 0!==i&&i(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}const s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?r.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,i)}async loadAsync(t,e){const n=""===this.path?Jh.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||n;const i=new Ah(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(t,e),o=JSON.parse(r),s=o.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(o)}parse(t,e){const n=this.parseAnimations(t.animations),i=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,i),o=this.parseImages(t.images,(function(){void 0!==e&&e(l)})),s=this.parseTextures(t.textures,o),a=this.parseMaterials(t.materials,s),l=this.parseObject(t.object,r,a,s,n),u=this.parseSkeletons(t.skeletons,l);if(this.bindSkeletons(l,u),void 0!==e){let t=!1;for(const e in o)if(o[e].data instanceof HTMLImageElement){t=!0;break}!1===t&&e(l)}return l}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,n),r=await this.parseImagesAsync(t.images),o=this.parseTextures(t.textures,r),s=this.parseMaterials(t.materials,o),a=this.parseObject(t.object,i,s,o,e),l=this.parseSkeletons(t.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(t){const e={};if(void 0!==t)for(let n=0,i=t.length;n<i;n++){const i=(new qc).fromJSON(t[n]);e[i.uuid]=i}return e}parseSkeletons(t,e){const n={},i={};if(e.traverse((function(t){t.isBone&&(i[t.uuid]=t)})),void 0!==t)for(let e=0,r=t.length;e<r;e++){const r=(new Cu).fromJSON(t[e],i);n[r.uuid]=r}return n}parseGeometries(t,e){const n={};if(void 0!==t){const i=new $h;for(let r=0,o=t.length;r<o;r++){let o;const s=t[r];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in Xc?o=Xc[s.type].fromJSON(s,e):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${s.type}"`)}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}}return n}parseMaterials(t,e){const n={},i={};if(void 0!==t){const r=new Qh;r.setTextures(e);for(let e=0,o=t.length;e<o;e++){const o=t[e];if("MultiMaterial"===o.type){const t=[];for(let e=0;e<o.materials.length;e++){const i=o.materials[e];void 0===n[i.uuid]&&(n[i.uuid]=r.parse(i)),t.push(n[i.uuid])}i[o.uuid]=t}else void 0===n[o.uuid]&&(n[o.uuid]=r.parse(o)),i[o.uuid]=n[o.uuid]}}return i}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const i=t[n],r=vh.parse(i);e[r.uuid]=r}return e}parseImages(t,e){function n(t){if("string"==typeof t){const e=t;return function(t){return i.manager.itemStart(t),o.load(t,(function(){i.manager.itemEnd(t)}),void 0,(function(){i.manager.itemError(t),i.manager.itemEnd(t)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:i.resourcePath+e)}return t.data?{data:h(t.type,t.data),width:t.width,height:t.height}:null}const i=this,r={};let o;if(void 0!==t&&t.length>0){const i=new bh(e);o=new Eh(i),o.setCrossOrigin(this.crossOrigin);for(let e=0,i=t.length;e<i;e++){const i=t[e],o=i.url;if(Array.isArray(o)){const t=[];for(let e=0,i=o.length;e<i;e++){const i=n(o[e]);null!==i&&(i instanceof HTMLImageElement?t.push(i):t.push(new Tu(i.data,i.width,i.height)))}r[i.uuid]=new Ro(t)}else{const t=n(i.url);r[i.uuid]=new Ro(t)}}}return r}async parseImagesAsync(t){async function e(t){if("string"==typeof t){const e=t,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e;return await r.loadAsync(i)}return t.data?{data:h(t.type,t.data),width:t.width,height:t.height}:null}const n=this,i={};let r;if(void 0!==t&&t.length>0){r=new Eh(this.manager),r.setCrossOrigin(this.crossOrigin);for(let n=0,r=t.length;n<r;n++){const r=t[n],o=r.url;if(Array.isArray(o)){const t=[];for(let n=0,i=o.length;n<i;n++){const i=o[n],r=await e(i);null!==r&&(r instanceof HTMLImageElement?t.push(r):t.push(new Tu(r.data,r.width,r.height)))}i[r.uuid]=new Ro(t)}else{const t=await e(r.url);i[r.uuid]=new Ro(t)}}}return i}parseTextures(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}const i={};if(void 0!==t)for(let r=0,o=t.length;r<o;r++){const o=t[r];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const s=e[o.image],a=s.data;let l;Array.isArray(a)?(l=new Qa,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new Tu:new qo,a&&(l.needsUpdate=!0)),l.source=s,l.uuid=o.uuid,void 0!==o.name&&(l.name=o.name),void 0!==o.mapping&&(l.mapping=n(o.mapping,ed)),void 0!==o.offset&&l.offset.fromArray(o.offset),void 0!==o.repeat&&l.repeat.fromArray(o.repeat),void 0!==o.center&&l.center.fromArray(o.center),void 0!==o.rotation&&(l.rotation=o.rotation),void 0!==o.wrap&&(l.wrapS=n(o.wrap[0],nd),l.wrapT=n(o.wrap[1],nd)),void 0!==o.format&&(l.format=o.format),void 0!==o.type&&(l.type=o.type),void 0!==o.encoding&&(l.encoding=o.encoding),void 0!==o.minFilter&&(l.minFilter=n(o.minFilter,id)),void 0!==o.magFilter&&(l.magFilter=n(o.magFilter,id)),void 0!==o.anisotropy&&(l.anisotropy=o.anisotropy),void 0!==o.flipY&&(l.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(l.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(l.unpackAlignment=o.unpackAlignment),void 0!==o.userData&&(l.userData=o.userData),i[o.uuid]=l}return i}parseObject(t,e,n,i,r){function o(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function s(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];void 0===n[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),e.push(n[r])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}function a(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined texture",t),i[t]}let l,u,c;switch(t.type){case"Scene":l=new Jl,void 0!==t.background&&(Number.isInteger(t.background)?l.background=new Po(t.background):l.background=a(t.background)),void 0!==t.environment&&(l.environment=a(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?l.fog=new Ql(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(l.fog=new Zl(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":l=new Xa(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(l.focus=t.focus),void 0!==t.zoom&&(l.zoom=t.zoom),void 0!==t.filmGauge&&(l.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(l.filmOffset=t.filmOffset),void 0!==t.view&&(l.view=Object.assign({},t.view));break;case"OrthographicCamera":l=new ul(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(l.zoom=t.zoom),void 0!==t.view&&(l.view=Object.assign({},t.view));break;case"AmbientLight":l=new Wh(t.color,t.intensity);break;case"DirectionalLight":l=new Hh(t.color,t.intensity);break;case"PointLight":l=new jh(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":l=new Xh(t.color,t.intensity,t.width,t.height);break;case"SpotLight":l=new Bh(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":l=new Oh(t.color,t.groundColor,t.intensity);break;case"LightProbe":l=(new Zh).fromJSON(t);break;case"SkinnedMesh":u=o(t.geometry),c=s(t.material),l=new Au(u,c),void 0!==t.bindMode&&(l.bindMode=t.bindMode),void 0!==t.bindMatrix&&l.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(l.skeleton=t.skeleton);break;case"Mesh":u=o(t.geometry),c=s(t.material),l=new Ua(u,c);break;case"InstancedMesh":u=o(t.geometry),c=s(t.material);const e=t.count,n=t.instanceMatrix,i=t.instanceColor;l=new Du(u,c,e),l.instanceMatrix=new Iu(new Float32Array(n.array),16),void 0!==i&&(l.instanceColor=new Iu(new Float32Array(i.array),i.itemSize));break;case"LOD":l=new vu;break;case"Line":l=new Uu(o(t.geometry),s(t.material));break;case"LineLoop":l=new Wu(o(t.geometry),s(t.material));break;case"LineSegments":l=new Hu(o(t.geometry),s(t.material));break;case"PointCloud":case"Points":l=new Ku(o(t.geometry),s(t.material));break;case"Sprite":l=new mu(s(t.material));break;case"Group":l=new jl;break;case"Bone":l=new Mu;break;default:l=new js}if(l.uuid=t.uuid,void 0!==t.name&&(l.name=t.name),void 0!==t.matrix?(l.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(l.matrixAutoUpdate=t.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(void 0!==t.position&&l.position.fromArray(t.position),void 0!==t.rotation&&l.rotation.fromArray(t.rotation),void 0!==t.quaternion&&l.quaternion.fromArray(t.quaternion),void 0!==t.scale&&l.scale.fromArray(t.scale)),void 0!==t.castShadow&&(l.castShadow=t.castShadow),void 0!==t.receiveShadow&&(l.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(l.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(l.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(l.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&l.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(l.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(l.visible=t.visible),void 0!==t.frustumCulled&&(l.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(l.renderOrder=t.renderOrder),void 0!==t.userData&&(l.userData=t.userData),void 0!==t.layers&&(l.layers.mask=t.layers),void 0!==t.children){const o=t.children;for(let t=0;t<o.length;t++)l.add(this.parseObject(o[t],e,n,i,r))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];l.animations.push(r[n])}}if("LOD"===t.type){void 0!==t.autoUpdate&&(l.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],i=l.getObjectByProperty("uuid",n.object);void 0!==i&&l.addLevel(i,n.distance)}}return l}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse((function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(n,t.bindMatrix)}}))}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const ed={UVMapping:ei,CubeReflectionMapping:ni,CubeRefractionMapping:ii,EquirectangularReflectionMapping:ri,EquirectangularRefractionMapping:oi,CubeUVReflectionMapping:si},nd={RepeatWrapping:ai,ClampToEdgeWrapping:li,MirroredRepeatWrapping:ui},id={NearestFilter:ci,NearestMipmapNearestFilter:hi,NearestMipmapLinearFilter:pi,LinearFilter:mi,LinearMipmapNearestFilter:gi,LinearMipmapLinearFilter:vi};class rd extends wh{constructor(t){super(t),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=xh.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout((function(){e&&e(o),r.manager.itemEnd(t)}),0),o;const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(t,s).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){xh.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}let od;const sd={getContext:function(){return void 0===od&&(od=new(window.AudioContext||window.webkitAudioContext)),od},setContext:function(t){od=t}};class ad extends wh{constructor(t){super(t)}load(t,e,n,i){const r=this,o=new Ah(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(t){try{const n=t.slice(0);sd.getContext().decodeAudioData(n,(function(t){e(t)}))}catch(t){i?i(t):console.error(t),r.manager.itemError(n)}}),n,i)}}class ld extends Zh{constructor(t,e,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const i=(new Po).set(t),r=(new Po).set(e),o=new Uo(i.r,i.g,i.b),s=new Uo(r.r,r.g,r.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}}class ud extends Zh{constructor(t,e=1){super(void 0,e),this.isAmbientLightProbe=!0;const n=(new Po).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const cd=new vs,hd=new vs,dd=new vs;class pd{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Xa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Xa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,dd.copy(t.projectionMatrix);const n=e.eyeSep/2,i=n*e.near/e.focus,r=e.near*Math.tan(go*e.fov*.5)/e.zoom;let o,s;hd.elements[12]=-n,cd.elements[12]=n,o=-r*e.aspect+i,s=r*e.aspect+i,dd.elements[0]=2*e.near/(s-o),dd.elements[8]=(s+o)/(s-o),this.cameraL.projectionMatrix.copy(dd),o=-r*e.aspect-i,s=r*e.aspect-i,dd.elements[0]=2*e.near/(s-o),dd.elements[8]=(s+o)/(s-o),this.cameraR.projectionMatrix.copy(dd)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(hd),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(cd)}}class fd{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=He(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=He();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}const md=new Uo,gd=new No,yd=new Uo,vd=new Uo;class xd extends js{constructor(){super(),this.type="AudioListener",this.context=sd.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new fd}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(md,gd,yd),vd.set(0,0,-1).applyQuaternion(gd),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(md.x,t),e.positionY.linearRampToValueAtTime(md.y,t),e.positionZ.linearRampToValueAtTime(md.z,t),e.forwardX.linearRampToValueAtTime(vd.x,t),e.forwardY.linearRampToValueAtTime(vd.y,t),e.forwardZ.linearRampToValueAtTime(vd.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(md.x,md.y,md.z),e.setOrientation(vd.x,vd.y,vd.z,n.x,n.y,n.z)}}class bd extends js{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const _d=new Uo,wd=new No,Sd=new Uo,Ad=new Uo;class Md extends bd{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(_d,wd,Sd),Ad.set(0,0,1).applyQuaternion(wd);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(_d.x,t),e.positionY.linearRampToValueAtTime(_d.y,t),e.positionZ.linearRampToValueAtTime(_d.z,t),e.orientationX.linearRampToValueAtTime(Ad.x,t),e.orientationY.linearRampToValueAtTime(Ad.y,t),e.orientationZ.linearRampToValueAtTime(Ad.z,t)}else e.setPosition(_d.x,_d.y,_d.z),e.setOrientation(Ad.x,Ad.y,Ad.z)}}class Td{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class Ed{constructor(t,e,n){let i,r,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==i;++t)n[r+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,r,0,t,i)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(n,i,t,1-r,e)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let t=e,r=e+e;t!==r;++t)if(n[t]!==n[t+e]){s.setValue(n,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let t=n,r=i;t!==r;++t)e[t]=e[i+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let i=0;i!==r;++i)t[e+i]=t[n+i]}_slerp(t,e,n,i){No.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){const o=this._workIndex*r;No.multiplyQuaternionsFlat(t,o,t,e,t,n),No.slerpFlat(t,e,t,e,t,o,i)}_lerp(t,e,n,i,r){const o=1-i;for(let s=0;s!==r;++s){const r=e+s;t[r]=t[r]*o+t[n+s]*i}}_lerpAdditive(t,e,n,i,r){for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]+t[n+o]*i}}}const Pd="\\[\\]\\.:\\/",Cd=new RegExp("["+Pd+"]","g"),Id="[^"+Pd+"]",Rd="[^"+Pd.replace("\\.","")+"]",Od=/((?:WC+[\/:])*)/.source.replace("WC",Id),qd=/(WCOD+)?/.source.replace("WCOD",Rd),Ld=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Id),Dd=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Id),zd=new RegExp("^"+Od+qd+Ld+Dd+"$"),kd=["material","materials","bones"];class Bd{constructor(t,e,n){this.path=e,this.parsedPath=n||Bd.parseTrackName(e),this.node=Bd.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Bd.Composite(t,e,n):new Bd(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Cd,"")}static parseTrackName(t){const e=zd.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==kd.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const o=n(r.children);if(o)return o}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=Bd.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const o=t[i];if(void 0===o){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",t)}let s=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Bd.Composite=class{constructor(t,e,n){const i=n||Bd.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Bd.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Bd.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Bd.prototype.GetterByBindingType=[Bd.prototype._getValue_direct,Bd.prototype._getValue_array,Bd.prototype._getValue_arrayElement,Bd.prototype._getValue_toArray],Bd.prototype.SetterByBindingTypeAndVersioning=[[Bd.prototype._setValue_direct,Bd.prototype._setValue_direct_setNeedsUpdate,Bd.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bd.prototype._setValue_array,Bd.prototype._setValue_array_setNeedsUpdate,Bd.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bd.prototype._setValue_arrayElement,Bd.prototype._setValue_arrayElement_setNeedsUpdate,Bd.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bd.prototype._setValue_fromArray,Bd.prototype._setValue_fromArray_setNeedsUpdate,Bd.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Fd{constructor(){this.isAnimationObjectGroup=!0,this.uuid=i(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length;let s,a=t.length,l=this.nCachedObjects_;for(let u=0,c=arguments.length;u!==c;++u){const c=arguments[u],h=c.uuid;let d=e[h];if(void 0===d){d=a++,e[h]=d,t.push(c);for(let t=0,e=o;t!==e;++t)r[t].push(new Bd(c,n[t],i[t]))}else if(d<l){s=t[d];const a=--l,u=t[a];e[u.uuid]=d,t[d]=u,e[h]=a,t[a]=c;for(let t=0,e=o;t!==e;++t){const e=r[t],o=e[a];let s=e[d];e[d]=o,void 0===s&&(s=new Bd(c,n[t],i[t])),e[a]=s}}else t[d]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o],a=s.uuid,l=e[a];if(void 0!==l&&l>=r){const o=r++,u=t[o];e[u.uuid]=l,t[l]=u,e[a]=o,t[o]=s;for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[o],r=e[l];e[l]=i,e[o]=r}}}this.nCachedObjects_=r}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,o=t.length;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s].uuid,l=e[a];if(void 0!==l)if(delete e[a],l<r){const s=--r,a=t[s],u=--o,c=t[u];e[a.uuid]=l,t[l]=a,e[c.uuid]=s,t[s]=c,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[s],r=e[u];e[l]=i,e[s]=r,e.pop()}}else{const r=--o,s=t[r];r>0&&(e[s.uuid]=l),t[l]=s,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t];e[l]=e[r],e.pop()}}}this.nCachedObjects_=r}subscribe_(t,e){const n=this._bindingsIndicesByPath;let i=n[t];const r=this._bindings;if(void 0!==i)return r[i];const o=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,u=this.nCachedObjects_,c=new Array(l);i=r.length,n[t]=i,o.push(t),s.push(e),r.push(c);for(let n=u,i=a.length;n!==i;++n){const i=a[n];c[n]=new Bd(i,t,e)}return c}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const i=this._paths,r=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];e[t[s]]=n,o[n]=a,o.pop(),r[n]=r[s],r.pop(),i[n]=i[s],i.pop()}}}class Vd{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,o=r.length,s=new Array(o),a={endingStart:_r,endingEnd:_r};for(let t=0;t!==o;++t){const e=r[t].createInterpolant(null);s[t]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=gr,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,i=t._clip.duration,r=i/n,o=n/i;t.warp(1,r,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,o=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=i._lendControlInterpolant(),this._timeScaleInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=r,a[1]=r+n,l[0]=t/o,l[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;if(i<0||0===n)return;this._startTime=null,e=n*i}e*=this._updateTimeScale(t);const o=this._updateTime(e),s=this._updateWeight(t);if(s>0){const t=this._interpolants,e=this._propertyBindings;if(this.blendMode===Mr)for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulateAdditive(s);else for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulate(i,s)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const o=n===yr;if(0===t)return-1===r?i:o&&1==(1&r)?e-i:i;if(n===mr){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(o&&1==(1&r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=wr,i.endingEnd=wr):(i.endingStart=t?this.zeroSlopeAtStart?wr:_r:Sr,i.endingEnd=e?this.zeroSlopeAtEnd?wr:_r:Sr)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const s=o.parameterPositions,a=o.sampleValues;return s[0]=r,a[0]=e,s[1]=r+t,a[1]=n,this}}const Nd=new Float32Array(1);class Ud extends po{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings,s=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let u=l[a];void 0===u&&(u={},l[a]=u);for(let t=0;t!==r;++t){const r=i[t],l=r.name;let c=u[l];if(void 0!==c)++c.referenceCount,o[t]=c;else{if(c=o[t],void 0!==c){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,a,l));continue}const i=e&&e._propertyBindings[t].binding.parsedPath;c=new Ed(Bd.create(n,l,i),r.ValueTypeName,r.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,a,l),o[t]=c}s[t].resultBuffer=c.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,r=this._actionsByClip;let o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,o=this._actionsByClip,s=o[r],a=s.knownActions,l=a[a.length-1],u=t._byClipCacheIndex;l._byClipCacheIndex=u,a[u]=l,a.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete o[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let o=i[e];void 0===o&&(o={},i[e]=o),o[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,s=o[i],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete s[r],0===Object.keys(s).length&&delete o[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new lh(new Float32Array(2),new Float32Array(2),1,Nd),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){const i=e||this._root,r=i.uuid;let o="string"==typeof t?vh.findByName(i,t):t;const s=null!==o?o.uuid:t,a=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:Ar),void 0!==a){const t=a.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const u=new Vd(this,o,e,n);return this._bindAction(u,l),this._addInactiveAction(u,s,r),u}existingAction(t,e){const n=e||this._root,i=n.uuid,r="string"==typeof t?vh.findByName(n,t):t,o=r?r.uuid:t,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[i]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1;for(let s=0;s!==n;++s)e[s]._update(i,t,r,o);const s=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t)s[t].apply(o);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,o=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,o._cacheIndex=r,e[r]=o,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const i=n[t].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[e];if(void 0!==i)for(const t in i){const e=i[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class jd{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new jd(void 0===this.value.clone?this.value:this.value.clone())}}class Gd extends Kl{constructor(t,e,n=1){super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}class Hd{constructor(t,e,n,i,r){this.isGLBufferAttribute=!0,this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}class Wd{constructor(t,e,n=0,i=1/0){this.ray=new ys(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new Cs,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return Xe(t,this,n,e),n.sort(We),n}intersectObjects(t,e=!0,n=[]){for(let i=0,r=t.length;i<r;i++)Xe(t[i],this,n,e);return n.sort(We),n}}class Xd{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(r(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Yd{constructor(t=1,e=0,n=0){return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}}const Zd=new xo;class Qd{constructor(t=new xo(1/0,1/0),e=new xo(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Zd.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Zd.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Jd=new Uo,Kd=new Uo;class $d{constructor(t=new Uo,e=new Uo){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Jd.subVectors(t,this.start),Kd.subVectors(this.end,this.start);const n=Kd.dot(Kd);let i=Kd.dot(Jd)/n;return e&&(i=r(i,0,1)),i}closestPointToPoint(t,e,n){const i=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const tp=new Uo;class ep extends js{constructor(t,e){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;const n=new Aa,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,e=1,n=32;t<n;t++,e++){const r=t/n*Math.PI*2,o=e/n*Math.PI*2;i.push(Math.cos(r),Math.sin(r),1,Math.cos(o),Math.sin(o),1)}n.setAttribute("position",new ma(i,3));const r=new zu({fog:!1,toneMapped:!1});this.cone=new Hu(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),tp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(tp),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const np=new Uo,ip=new vs,rp=new vs;class op extends Hu{constructor(t){const e=Ye(t),n=new Aa,i=[],r=[],o=new Po(0,0,1),s=new Po(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(s.r,s.g,s.b))}n.setAttribute("position",new ma(i,3)),n.setAttribute("color",new ma(r,3)),super(n,new zu({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");rp.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const r=e[t];r.parent&&r.parent.isBone&&(ip.multiplyMatrices(rp,r.matrixWorld),np.setFromMatrixPosition(ip),i.setXYZ(n,np.x,np.y,np.z),ip.multiplyMatrices(rp,r.parent.matrixWorld),np.setFromMatrixPosition(ip),i.setXYZ(n+1,np.x,np.y,np.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}class sp extends Ua{constructor(t,e,n){super(new Nc(e,4,2),new ia({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const ap=new Uo,lp=new Po,up=new Po;class cp extends js{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new Bc(e);i.rotateY(.5*Math.PI),this.material=new ia({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.setAttribute("color",new sa(o,3)),this.add(new Ua(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");lp.copy(this.light.color),up.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const i=t<n/2?lp:up;e.setXYZ(t,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(ap.setFromMatrixPosition(this.light.matrixWorld).negate())}}class hp extends Hu{constructor(t=10,e=10,n=4473924,i=8947848){n=new Po(n),i=new Po(i);const r=e/2,o=t/e,s=t/2,a=[],l=[];for(let t=0,u=0,c=-s;t<=e;t++,c+=o){a.push(-s,0,c,s,0,c),a.push(c,0,-s,c,0,s);const e=t===r?n:i;e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3}const u=new Aa;u.setAttribute("position",new ma(a,3)),u.setAttribute("color",new ma(l,3)),super(u,new zu({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class dp extends Hu{constructor(t=10,e=16,n=8,i=64,r=4473924,o=8947848){r=new Po(r),o=new Po(o);const s=[],a=[];for(let n=0;n<=e;n++){const i=n/e*(2*Math.PI),l=Math.sin(i)*t,u=Math.cos(i)*t;s.push(0,0,0),s.push(l,0,u);const c=1&n?r:o;a.push(c.r,c.g,c.b),a.push(c.r,c.g,c.b)}for(let e=0;e<=n;e++){const l=1&e?r:o,u=t-t/n*e;for(let t=0;t<i;t++){let e=t/i*(2*Math.PI),n=Math.sin(e)*u,r=Math.cos(e)*u;s.push(n,0,r),a.push(l.r,l.g,l.b),e=(t+1)/i*(2*Math.PI),n=Math.sin(e)*u,r=Math.cos(e)*u,s.push(n,0,r),a.push(l.r,l.g,l.b)}}const l=new Aa;l.setAttribute("position",new ma(s,3)),l.setAttribute("color",new ma(a,3)),super(l,new zu({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const pp=new Uo,fp=new Uo,mp=new Uo;class gp extends js{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);let i=new Aa;i.setAttribute("position",new ma([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const r=new zu({fog:!1,toneMapped:!1});this.lightPlane=new Uu(i,r),this.add(this.lightPlane),i=new Aa,i.setAttribute("position",new ma([0,0,0,0,0,1],3)),this.targetLine=new Uu(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){pp.setFromMatrixPosition(this.light.matrixWorld),fp.setFromMatrixPosition(this.light.target.matrixWorld),mp.subVectors(fp,pp),this.lightPlane.lookAt(fp),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(fp),this.targetLine.scale.z=mp.length()}}const yp=new Uo,vp=new Wa;class xp extends Hu{constructor(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){o.push(0,0,0),s.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(o.length/3-1)}const i=new Aa,r=new zu({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],a={},l=new Po(16755200),u=new Po(16711680),c=new Po(43775),h=new Po(16777215),d=new Po(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",u),e("p","n2",u),e("p","n3",u),e("p","n4",u),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",h),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),i.setAttribute("position",new ma(o,3)),i.setAttribute("color",new ma(s,3)),super(i,r),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}update(){const t=this.geometry,e=this.pointMap;vp.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ze("c",e,t,vp,0,0,-1),Ze("t",e,t,vp,0,0,1),Ze("n1",e,t,vp,-1,-1,-1),Ze("n2",e,t,vp,1,-1,-1),Ze("n3",e,t,vp,-1,1,-1),Ze("n4",e,t,vp,1,1,-1),Ze("f1",e,t,vp,-1,-1,1),Ze("f2",e,t,vp,1,-1,1),Ze("f3",e,t,vp,-1,1,1),Ze("f4",e,t,vp,1,1,1),Ze("u1",e,t,vp,.7,1.1,-1),Ze("u2",e,t,vp,-.7,1.1,-1),Ze("u3",e,t,vp,0,2,-1),Ze("cf1",e,t,vp,-1,0,1),Ze("cf2",e,t,vp,1,0,1),Ze("cf3",e,t,vp,0,-1,1),Ze("cf4",e,t,vp,0,1,1),Ze("cn1",e,t,vp,-1,0,-1),Ze("cn2",e,t,vp,1,0,-1),Ze("cn3",e,t,vp,0,-1,-1),Ze("cn4",e,t,vp,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}const bp=new Ho;class _p extends Hu{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Aa;r.setIndex(new sa(n,1)),r.setAttribute("position",new sa(i,3)),super(r,new zu({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&bp.setFromObject(this.object),bp.isEmpty())return;const e=bp.min,n=bp.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,e){return super.copy(t,e),this.object=t.object,this}}class wp extends Hu{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Aa;i.setIndex(new sa(n,1)),i.setAttribute("position",new ma([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new zu({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class Sp extends Uu{constructor(t,e=1,n=16776960){const i=n,r=new Aa;r.setAttribute("position",new ma([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),super(r,new zu({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const o=new Aa;o.setAttribute("position",new ma([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Ua(o,new ia({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?dn:hn,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const Ap=new Uo;let Mp,Tp;class Ep extends js{constructor(t=new Uo(0,0,1),e=new Uo(0,0,0),n=1,i=16776960,r=.2*n,o=.2*r){super(),this.type="ArrowHelper",void 0===Mp&&(Mp=new Aa,Mp.setAttribute("position",new ma([0,0,0,0,1,0],3)),Tp=new Ac(0,.5,1,5,1),Tp.translate(0,-.5,0)),this.position.copy(e),this.line=new Uu(Mp,new zu({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ua(Tp,new ia({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{Ap.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(Ap,e)}}setLength(t,e=.2*t,n=.2*e){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class Pp extends Hu{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Aa;n.setAttribute("position",new ma(e,3)),n.setAttribute("color",new ma([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new zu({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const i=new Po,r=this.geometry.attributes.color.array;return i.set(t),i.toArray(r,0),i.toArray(r,3),i.set(e),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Cp{constructor(){this.type="ShapePath",this.color=new Po,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new bc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,o){return this.currentPath.bezierCurveTo(t,e,n,i,r,o),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,e){function n(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n],r=new qc;r.curves=i.curves,e.push(r)}return e}function i(t,e){const n=e.length;let i=!1;for(let r=n-1,o=0;o<n;r=o++){let n=e[r],s=e[o],a=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[o],a=-a,s=e[r],l=-l),t.y<n.y||t.y>s.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-a*(t.y-n.y);if(0===e)return!0;if(e<0)continue;i=!i}}else{if(t.y!==n.y)continue;if(s.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=s.x)return!0}}return i}const r=Lc.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);let s,a,l;const u=[];if(1===o.length)return a=o[0],l=new qc,l.curves=a.curves,u.push(l),u;let c=!r(o[0].getPoints());c=t?!c:c;const h=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let e=0,n=o.length;e<n;e++)a=o[e],p=a.getPoints(),s=r(p),s=t?!s:s,s?(!c&&d[g]&&g++,d[g]={s:new qc,p:p},d[g].s.curves=a.curves,c&&g++,m[g]=[]):m[g].push({h:a,p:p[0]});if(!d[0])return n(o);if(d.length>1){let t=!1,e=0;for(let t=0,e=d.length;t<e;t++)h[t]=[];for(let n=0,r=d.length;n<r;n++){const r=m[n];for(let o=0;o<r.length;o++){const s=r[o];let a=!0;for(let r=0;r<d.length;r++)i(s.p,d[r].p)&&(n!==r&&e++,a?(a=!1,h[r].push(s)):t=!0);a&&h[n].push(s)}}e>0&&!1===t&&(m=h)}for(let t=0,e=d.length;t<e;t++){l=d[t].s,u.push(l),f=m[t];for(let t=0,e=f.length;t<e;t++)l.holes.push(f[t].h)}return u}}class Ip{static toHalfFloat(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=r(t,-65504,65504),Op[0]=t;const e=qp[0],n=e>>23&511;return Lp[n]+((8388607&e)>>Dp[n])}static fromHalfFloat(t){const e=t>>10;return qp[0]=zp[Bp[e]+(1023&t)]+kp[e],Op[0]}}const Rp=new ArrayBuffer(4),Op=new Float32Array(Rp),qp=new Uint32Array(Rp),Lp=new Uint32Array(512),Dp=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(Lp[t]=0,Lp[256|t]=32768,Dp[t]=24,Dp[256|t]=24):e<-14?(Lp[t]=1024>>-e-14,Lp[256|t]=1024>>-e-14|32768,Dp[t]=-e-1,Dp[256|t]=-e-1):e<=15?(Lp[t]=e+15<<10,Lp[256|t]=e+15<<10|32768,Dp[t]=13,Dp[256|t]=13):e<128?(Lp[t]=31744,Lp[256|t]=64512,Dp[t]=24,Dp[256|t]=24):(Lp[t]=31744,Lp[256|t]=64512,Dp[t]=13,Dp[256|t]=13)}const zp=new Uint32Array(2048),kp=new Uint32Array(64),Bp=new Uint32Array(64);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0==(8388608&e);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,zp[t]=e|n}for(let t=1024;t<2048;++t)zp[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)kp[t]=t<<23;kp[31]=1199570944,kp[32]=2147483648;for(let t=33;t<63;++t)kp[t]=2147483648+(t-32<<23);kp[63]=3347054592;for(let t=1;t<64;++t)32!==t&&(Bp[t]=1024);class Fp extends Aa{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class Vp extends Aa{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}class Np extends Do{constructor(t,e,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(t,e,n),this.samples=4}}class Up extends zo{constructor(t,e,n,i){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(t,e,n,i)}}class jp extends Bo{constructor(t,e,n,i){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(t,e,n,i)}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$e}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$e)}},n={};t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";function e(t,e,n){t[e]||Object.defineProperty(t,e,{writable:!0,configurable:!0,value:n})}if(t(1934),t(5654),t(7694),t.g._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t.g._babelPolyfill=!0,e(String.prototype,"padLeft","".padStart),e(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach((function(t){[][t]&&e(Array,t,Function.call.bind([][t]))}))})(),(()=>{"use strict";function e(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function n(t){var e=t.toString(16);return"#"+("000000".substr(0,6-e.length)+e)}function i(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)}function r(t,e){return ba[e?1:0][t]}function o(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,i=t>>8&255;return(255*e<<24)+((n=n*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+((255&t)*e+.5|0)}function s(t,e,n,i){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(i||void 0===i)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function a(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,1+((t|=t>>>8)|t>>>16)}function l(t){return!(t&t-1||!t)}function u(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function c(t,e,n){var i,r=t.length;if(!(e>=r||0===n)){var o=r-(n=e+n>r?r-e:n);for(i=e;i<o;++i)t[i]=t[i+n];t.length=o}}function h(t){return 0===t?0:t<0?-1:1}function d(){return++Sa}function p(t,e,n){if(void 0===n&&(n=3),!Aa[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),Aa[e]=!0}}function f(t,e){var n=da.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}function m(t,e){function n(){this.constructor=t}Qa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}function y(t,e){if(!t)return null;var n="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(n=i[1].toLowerCase())}for(var r=ml.length-1;r>=0;--r){var o=ml[r];if(o.test&&o.test(t,n))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}function v(t,e){function n(){this.constructor=t}gl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function x(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}function b(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}function _(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function w(t,e,n,i){var r=_(t,t.VERTEX_SHADER,e),o=_(t,t.FRAGMENT_SHADER,n),s=t.createProgram();if(t.attachShader(s,r),t.attachShader(s,o),i)for(var a in i)t.bindAttribLocation(s,i[a],a);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(r))),t.getShaderParameter(o,t.COMPILE_STATUS)||(console.warn(n),console.error(t.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(s,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(s)),t.deleteProgram(s),s=null),t.deleteShader(r),t.deleteShader(o),s}function S(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function A(t,e){switch(t){case"float":case"int":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return S(2*e);case"bvec3":return S(3*e);case"bvec4":return S(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function M(){if(pu===du||pu&&pu.isContextLost()){var t=document.createElement("canvas"),e=void 0;da.PREFER_ENV>=Os.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),pu=e}return pu}function T(t,e,n){if("precision"!==t.substring(0,9)){var i=e;return e===Ws.HIGH&&n!==Ws.HIGH&&(i=Ws.MEDIUM),"precision "+i+" float;\n"+t}return n!==Ws.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}function E(t){return fu[t]}function P(t,e){if(!mu){var n=Object.keys(gu);mu={};for(var i=0;i<n.length;++i){var r=n[i];mu[t[r]]=gu[r]}}return mu[e]}function C(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}function I(){}function R(t,e,n,i){var r=0,o=t.length;!function s(a){a||r===o?n&&n(a):i?setTimeout((function(){e(t[r++],s)}),1):e(t[r++],s)}()}function O(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function L(t,e,n){return e&&q(t.prototype,e),n&&q(t,n),t}function D(){}function z(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function k(t){return t.toString().replace("object ","")}function B(t,e){function n(){this.constructor=t}Pc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function F(t,e){function n(){this.constructor=t}kc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function V(t,e,n){return t+(e-t)*n}function N(t,e,n,i,r,o,s){void 0===s&&(s=[]);for(var a=s,l=0,u=0,c=0,h=0,d=0,p=0,f=0,m=0;f<=20;++f)l=V(t,n,m=f/20),u=V(e,i,m),c=V(n,r,m),h=V(i,o,m),d=V(l,c,m),p=V(u,h,m),a.push(d,p);return a}function U(t,e,n,i,r,o,s,a){var l,u;s?(l=i,u=-n):(l=-i,u=n);var c=t-n*r+l,h=e-i*r+u,d=t+n*o+l,p=e+i*o+u;return a.push(c,h),a.push(d,p),2}function j(t,e,n,i,r,o,s,a){var l=n-t,u=i-e,c=Math.atan2(l,u),h=Math.atan2(r-t,o-e);a&&c<h?c+=2*Math.PI:!a&&c>h&&(h+=2*Math.PI);var d=c,p=h-c,f=Math.abs(p),m=Math.sqrt(l*l+u*u),g=1+(15*f*Math.sqrt(m)/Math.PI>>0),y=p/g;if(d+=y,a){s.push(t,e),s.push(n,i);for(var v=1,x=d;v<g;v++,x+=y)s.push(t,e),s.push(t+Math.sin(x)*m,e+Math.cos(x)*m);s.push(t,e),s.push(r,o)}else{for(s.push(n,i),s.push(t,e),v=1,x=d;v<g;v++,x+=y)s.push(t+Math.sin(x)*m,e+Math.cos(x)*m),s.push(t,e);s.push(r,o),s.push(t,e)}return 2*g}function G(t,e){t.lineStyle.native?function(t,e){var n=0,i=t.shape,r=t.points||i.points,o=i.type!==wa.POLY||i.closeStroke;if(0!==r.length){var s=e.points,a=e.indices,l=r.length/2,u=s.length/2,c=u;for(s.push(r[0],r[1]),n=1;n<l;n++)s.push(r[2*n],r[2*n+1]),a.push(c,c+1),c++;o&&a.push(c,u)}}(t,e):function(t,e){var n=t.shape,i=t.points||n.points.slice(),r=e.closePointEps;if(0!==i.length){var o=t.lineStyle,s=new ka(i[0],i[1]),a=new ka(i[i.length-2],i[i.length-1]),l=n.type!==wa.POLY||n.closeStroke,u=Math.abs(s.x-a.x)<r&&Math.abs(s.y-a.y)<r;if(l){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var c=.5*(s.x+a.x),h=.5*(a.y+s.y);i.unshift(c,h),i.push(c,h)}var d=e.points,p=i.length/2,f=i.length,m=d.length/2,g=o.width/2,y=g*g,v=o.miterLimit*o.miterLimit,x=i[0],b=i[1],_=i[2],w=i[3],S=0,A=0,M=-(b-w),T=x-_,E=0,P=0,C=Math.sqrt(M*M+T*T);M/=C,T/=C,M*=g,T*=g;var I=o.alignment,R=2*(1-I),O=2*I;l||(o.cap===Ic.ROUND?f+=j(x-M*(R-O)*.5,b-T*(R-O)*.5,x-M*R,b-T*R,x+M*O,b+T*O,d,!0)+2:o.cap===Ic.SQUARE&&(f+=U(x,b,M,T,R,O,!0,d))),d.push(x-M*R,b-T*R),d.push(x+M*O,b+T*O);for(var q=1;q<p-1;++q){x=i[2*(q-1)],b=i[2*(q-1)+1],_=i[2*q],w=i[2*q+1],S=i[2*(q+1)],A=i[2*(q+1)+1],M=-(b-w),T=x-_,M/=C=Math.sqrt(M*M+T*T),T/=C,M*=g,T*=g,E=-(w-A),P=_-S,E/=C=Math.sqrt(E*E+P*P),P/=C,E*=g,P*=g;var L=_-x,D=b-w,z=_-S,k=A-w,B=D*z-k*L,F=B<0;if(Math.abs(B)<.1)d.push(_-M*R,w-T*R),d.push(_+M*O,w+T*O);else{var V=(-M+x)*(-T+w)-(-M+_)*(-T+b),N=(-E+S)*(-P+w)-(-E+_)*(-P+A),G=(L*N-z*V)/B,H=(k*V-D*N)/B,W=(G-_)*(G-_)+(H-w)*(H-w),X=_+(G-_)*R,Y=w+(H-w)*R,Z=_-(G-_)*O,Q=w-(H-w)*O;o.join===Cc.BEVEL||W/y>v?(F?(d.push(X,Y),d.push(_+M*O,w+T*O),d.push(X,Y),d.push(_+E*O,w+P*O)):(d.push(_-M*R,w-T*R),d.push(Z,Q),d.push(_-E*R,w-P*R),d.push(Z,Q)),f+=2):o.join===Cc.ROUND?F?(d.push(X,Y),d.push(_+M*O,w+T*O),f+=j(_,w,_+M*O,w+T*O,_+E*O,w+P*O,d,!0)+4,d.push(X,Y),d.push(_+E*O,w+P*O)):(d.push(_-M*R,w-T*R),d.push(Z,Q),f+=j(_,w,_-M*R,w-T*R,_-E*R,w-P*R,d,!1)+4,d.push(_-E*R,w-P*R),d.push(Z,Q)):(d.push(X,Y),d.push(Z,Q))}}x=i[2*(p-2)],b=i[2*(p-2)+1],_=i[2*(p-1)],M=-(b-(w=i[2*(p-1)+1])),T=x-_,M/=C=Math.sqrt(M*M+T*T),T/=C,M*=g,T*=g,d.push(_-M*R,w-T*R),d.push(_+M*O,w+T*O),l||(o.cap===Ic.ROUND?f+=j(_-M*(R-O)*.5,w-T*(R-O)*.5,_-M*R,w-T*R,_+M*O,w+T*O,d,!1)+2:o.cap===Ic.SQUARE&&(f+=U(_,w,M,T,R,O,!1,d)));var J=e.indices,K=Dc.epsilon*Dc.epsilon;for(q=m;q<f+m-2;++q)x=d[2*q],b=d[2*q+1],_=d[2*(q+1)],w=d[2*(q+1)+1],S=d[2*(q+2)],A=d[2*(q+2)+1],Math.abs(x*(w-A)+_*(A-b)+S*(b-w))<K||J.push(q,q+1,q+2)}}(t,e)}function H(t){return"number"==typeof t?n(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function W(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=H(t[e]);return t}return H(t)}function X(t,e,n){for(var i in n)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}function Y(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof zl){var r=t._textures[i].baseTexture;-1===e.indexOf(r)&&(e.push(r),n=!0)}return n}function Z(t,e){if(t.baseTexture instanceof bl){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Q(t,e){if(t._texture&&t._texture instanceof zl){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function J(t,e){return e instanceof fh&&(e.updateText(!0),!0)}function K(t,e){if(e instanceof ch){var n=e.toFontString();return hh.measureFont(n),!0}return!1}function $(t,e){if(t instanceof fh){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function tt(t,e){return t instanceof ch&&(-1===e.indexOf(t)&&e.push(t),!0)}function et(t,e){return e instanceof bl&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function nt(t,e){if(!(e instanceof nh))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var i=n.batches,r=0;r<i.length;r++){var o=i[r].style.texture;o&&et(t,o.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function it(t,e){return t instanceof nh&&(e.push(t),!0)}function rt(t,e){function n(){this.constructor=t}_h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function ot(t,e){function n(){this.constructor=t}Th(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function st(t){for(var e=0;e<kh.length;e++)if(kh[e].test(t))return kh[e];return null}function at(t,e,n,i,r,o){var s,a=n.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var l=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,c=Math.ceil(t.width/i)-l-2*u,h=Math.ceil(t.height/i)-l-2*u,d=a.slice(),p=n.fillGradientStops.slice();if(!p.length)for(var f=d.length+1,m=1;m<f;++m)p.push(m/f);if(d.unshift(a[0]),p.unshift(0),d.push(a[a.length-1]),p.push(1),n.fillGradientType===Lc.LINEAR_VERTICAL){s=e.createLinearGradient(c/2,u,c/2,h+u);var g=0,y=(o.fontProperties.fontSize+n.strokeThickness)/h;for(m=0;m<r.length;m++)for(var v=o.lineHeight*m,x=0;x<d.length;x++){var b=v/h+("number"==typeof p[x]?p[x]:x/d.length)*y,_=Math.max(g,b);_=Math.min(_,1),s.addColorStop(_,d[x]),g=_}}else{s=e.createLinearGradient(u,h/2,c+u,h/2);var w=d.length+1,S=1;for(m=0;m<d.length;m++){var A;A="number"==typeof p[m]?p[m]:S/w,s.addColorStop(A,d[m]),S++}}return s}function lt(t,n,r,o,s,a,l){var u=r.text,c=r.fontProperties;n.translate(o,s),n.scale(a,a);var h=l.strokeThickness/2,d=-l.strokeThickness/2;n.font=l.toFontString(),n.lineWidth=l.strokeThickness,n.textBaseline=l.textBaseline,n.lineJoin=l.lineJoin,n.miterLimit=l.miterLimit,n.fillStyle=at(t,n,l,a,[u],r),n.strokeStyle=l.stroke,n.font=l.toFontString(),n.lineWidth=l.strokeThickness,n.textBaseline=l.textBaseline,n.lineJoin=l.lineJoin,n.miterLimit=l.miterLimit,n.fillStyle=at(t,n,l,a,[u],r),n.strokeStyle=l.stroke;var p=l.dropShadowColor,f=e("number"==typeof p?p:i(p));l.dropShadow?(n.shadowColor="rgba("+255*f[0]+","+255*f[1]+","+255*f[2]+","+l.dropShadowAlpha+")",n.shadowBlur=l.dropShadowBlur,n.shadowOffsetX=Math.cos(l.dropShadowAngle)*l.dropShadowDistance,n.shadowOffsetY=Math.sin(l.dropShadowAngle)*l.dropShadowDistance):(n.shadowColor="0",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),l.stroke&&l.strokeThickness&&n.strokeText(u,h,d+r.lineHeight-c.descent),l.fill&&n.fillText(u,h,d+r.lineHeight-c.descent),n.setTransform(),n.fillStyle="rgba(0, 0, 0, 0)"}function ut(t,e){function n(){this.constructor=t}sd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function ct(t,e){function n(){this.constructor=t}yd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function dt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ft(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return mt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function gt(t,e,n,i,r,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,r)}function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function vt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xt(t,e,n){return xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wt(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},xt(t,e,n||t)}function bt(t,e){return bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},bt(t,e)}function _t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=wt(t);if(e){var r=wt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function wt(t){return wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},wt(t)}function St(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Mt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Tt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pt(t,e){return Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pt(t,e)}function Ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Rt(t);if(e){var r=Rt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==At(e)&&"function"!=typeof e?It(t):e}(this,n)}}function It(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rt(t){return Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rt(t)}function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function qt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Dt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function zt(t,e){return zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},zt(t,e)}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ft(t);if(e){var r=Ft(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?Bt(t):e}(this,n)}}function Bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}function Vt(t){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(t)}function Nt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ut(t,e){return Ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ut(t,e)}function jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ht(t);if(e){var r=Ht(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Vt(e)&&"function"!=typeof e?Gt(t):e}(this,n)}}function Gt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ht(t){return Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ht(t)}function Wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Yt(t,e,n,i,r,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,r)}function Zt(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){function o(t){Yt(a,i,r,o,s,"next",t)}function s(t){Yt(a,i,r,o,s,"throw",t)}var a=t.apply(e,n);o(void 0)}))}}function Qt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Jt(t,e){return Jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Jt(t,e)}function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=te(t);if(e){var r=te(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Xt(e)&&"function"!=typeof e?$t(t):e}(this,n)}}function $t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function te(t){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},te(t)}function ee(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function ie(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function se(t,e){return se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},se(t,e)}function ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ue(t);if(e){var r=ue(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==ne(e)&&"function"!=typeof e?le(t):e}(this,n)}}function le(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(t)}function ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function he(t,e,n){return n.min.x=e[t],n.min.y=e[t+1],n.min.z=e[t+2],n.max.x=e[t+3],n.max.y=e[t+4],n.max.z=e[t+5],n}function de(t){let e=-1,n=-1/0;for(let i=0;i<3;i++){const r=t[i+3]-t[i];r>n&&(n=r,e=i)}return e}function pe(t,e){e.set(t)}function fe(t,e,n){let i,r;for(let o=0;o<3;o++){const s=o+3;i=t[o],r=e[o],n[o]=i<r?i:r,i=t[s],r=e[s],n[s]=i>r?i:r}}function me(t,e,n){for(let i=0;i<3;i++){const r=e[t+2*i],o=e[t+2*i+1],s=r-o,a=r+o;s<n[i]&&(n[i]=s),a>n[i+3]&&(n[i+3]=a)}}function ge(t){const e=t[3]-t[0],n=t[4]-t[1],i=t[5]-t[2];return 2*(e*n+n*i+i*e)}function ye(t,e,n,i,r=null){let o=1/0,s=1/0,a=1/0,l=-1/0,u=-1/0,c=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0;const y=null!==r;for(let i=6*e,r=6*(e+n);i<r;i+=6){const e=t[i+0],n=t[i+1],r=e-n,v=e+n;r<o&&(o=r),v>l&&(l=v),y&&e<h&&(h=e),y&&e>f&&(f=e);const x=t[i+2],b=t[i+3],_=x-b,w=x+b;_<s&&(s=_),w>u&&(u=w),y&&x<d&&(d=x),y&&x>m&&(m=x);const S=t[i+4],A=t[i+5],M=S-A,T=S+A;M<a&&(a=M),T>c&&(c=T),y&&S<p&&(p=S),y&&S>g&&(g=S)}i[0]=o,i[1]=s,i[2]=a,i[3]=l,i[4]=u,i[5]=c,y&&(r[0]=h,r[1]=d,r[2]=p,r[3]=f,r[4]=m,r[5]=g)}function ve(t){return Math.abs(t)<1e-15}function xe(t,e,n,i,r){const o=3*i,s=t.index.getX(o),a=t.index.getX(o+1),l=t.index.getX(o+2),u=function(t,e,n,i,r,o,s){Dp.fromBufferAttribute(e,i),zp.fromBufferAttribute(e,r),kp.fromBufferAttribute(e,o);const a=function(t,e,n,i,r,o){let s;return s=o===Ad.BackSide?t.intersectTriangle(i,n,e,!0,r):t.intersectTriangle(e,n,i,o!==Ad.DoubleSide,r),null===s?null:{distance:t.origin.distanceTo(r),point:r.clone()}}(t,Dp,zp,kp,Np,s);if(a){n&&(Bp.fromBufferAttribute(n,i),Fp.fromBufferAttribute(n,r),Vp.fromBufferAttribute(n,o),a.uv=Ad.Triangle.getUV(Np,Dp,zp,kp,Bp,Fp,Vp,new Ad.Vector2));const t={a:i,b:r,c:o,normal:new Ad.Vector3,materialIndex:0};Ad.Triangle.getNormal(Dp,zp,kp,t.normal),a.face=t,a.faceIndex=i}return a}(n,t.attributes.position,t.attributes.uv,s,a,l,e);return u?(u.faceIndex=i,r&&r.push(u),u):null}function be(t,e,n,i){const r=t.a,o=t.b,s=t.c;let a=e,l=e+1,u=e+2;n&&(a=n.getX(e),l=n.getX(e+1),u=n.getX(e+2)),r.x=i.getX(a),r.y=i.getY(a),r.z=i.getZ(a),o.x=i.getX(l),o.y=i.getY(l),o.z=i.getZ(l),s.x=i.getX(u),s.y=i.getY(u),s.z=i.getZ(u)}function _e(t,e,n,i,r,o,s){const a=n.index,l=n.attributes.position;for(let n=t,u=e+t;n<u;n++)if(be(s,3*n,a,l),s.needsUpdate=!0,i(s,n,r,o))return!0;return!1}function we(t,e){return 65535===e[t+15]}function Se(t,e){return e[t+6]}function Ae(t,e){return e[t+14]}function Me(t){return t+8}function Te(t,e){return e[t+6]}function Ee(t,e,n,i,r){let o=2*t,s=Qp,a=Jp,l=Kp;if(we(o,a))!function(t,e,n,i,r,o){for(let s=i,a=i+r;s<a;s++)xe(t,e,n,s,o)}(e,n,i,Se(t,l),Ae(o,a),r);else{const o=Me(t);Ce(o,s,i,Gp)&&Ee(o,e,n,i,r);const a=Te(t,l);Ce(a,s,i,Gp)&&Ee(a,e,n,i,r)}}function Pe(t,e,n,i){let r=2*t,o=Qp,s=Jp,a=Kp;if(we(r,s))return function(t,e,n,i,r){let o=1/0,s=null;for(let a=i,l=i+r;a<l;a++){const i=xe(t,e,n,a);i&&i.distance<o&&(s=i,o=i.distance)}return s}(e,n,i,Se(t,a),Ae(r,s));{const r=function(t,e){return e[t+7]}(t,a),s=Hp[r],l=i.direction[s]>=0;let u,c;l?(u=Me(t),c=Te(t,a)):(u=Te(t,a),c=Me(t));const h=Ce(u,o,i,Gp)?Pe(u,e,n,i):null;if(h){const t=h.point[s];if(l?t<=o[c+r]:t>=o[c+r+3])return h}const d=Ce(c,o,i,Gp)?Pe(c,e,n,i):null;return h&&d?h.distance<=d.distance?h:d:h||d||null}}function Ce(t,e,n,i){return he(t,e,jp),n.intersectBox(jp,i)}function Ie(t){Zp&&Yp.push(Zp),Zp=t,Qp=new Float32Array(t),Jp=new Uint16Array(t),Kp=new Uint32Array(t)}function Re(){Zp=null,Qp=null,Jp=null,Kp=null,Yp.length&&Ie(Yp.pop())}function Oe(t){return~~(1000000.1000000001*t)}function qe(t){return`${Oe(t.x)},${Oe(t.y)},${Oe(t.z)}`}function Le(){return"undefined"!=typeof SharedArrayBuffer}function De(t){if(t.buffer instanceof SharedArrayBuffer)return t;const e=t.constructor,n=t.buffer,i=new SharedArrayBuffer(n.byteLength),r=new Uint8Array(n);return new Uint8Array(i).set(r,0),new e(i)}function ze(t){return t.a.distanceToSquared(t.b)<yf||t.a.distanceToSquared(t.c)<yf||t.b.distanceToSquared(t.c)<yf}function ke(t){Wf=t}function Be(t,e){function n(){return Math.random()-.5}t.getNormal(Gf),qf.direction.copy(Gf),t.getMidpoint(qf.origin);let i=0,r=1/0;for(let t=0;t<3;t++){qf.direction.x+=n()*Hf,qf.direction.y+=n()*Hf,qf.direction.z+=n()*Hf,qf.direction.multiplyScalar(-1);const o=e.raycastFirst(qf,Ad.DoubleSide);if(Boolean(o&&qf.direction.dot(o.face.normal)>0)&&i++,null!==o&&(r=Math.min(r,o.distance)),r<=1e-15)return o.face.normal.dot(Gf)>0?2:-2;if(i/3>.5||(t-i+1)/3>.5)break}return i/3>.5?-1:1}function Fe(t,e,n,i,r,o,s=!1){const a=n.attributes,l=n.index,u=3*t,c=l.getX(u+0),h=l.getX(u+1),d=l.getX(u+2);for(const t in o){const n=a[t],l=o[t];if(!(t in a))throw new Error(`CSG Operations: Attribute ${t} not available on geometry.`);const u=n.itemSize;"position"===t?(Df.a.fromBufferAttribute(n,c).applyMatrix4(i),Df.b.fromBufferAttribute(n,h).applyMatrix4(i),Df.c.fromBufferAttribute(n,d).applyMatrix4(i),Ue(Df.a,Df.b,Df.c,e,3,l,s)):"normal"===t?(Df.a.fromBufferAttribute(n,c).applyNormalMatrix(r),Df.b.fromBufferAttribute(n,h).applyNormalMatrix(r),Df.c.fromBufferAttribute(n,d).applyNormalMatrix(r),s&&(Df.a.multiplyScalar(-1),Df.b.multiplyScalar(-1),Df.c.multiplyScalar(-1)),Ue(Df.a,Df.b,Df.c,e,3,l,s,!0)):(kf.fromBufferAttribute(n,c),Bf.fromBufferAttribute(n,h),Ff.fromBufferAttribute(n,d),Ue(kf,Bf,Ff,e,u,l,s))}}function Ve(t,e,n,i,r,o,s,a=!1){je(t,i,r,o,s,a),je(a?n:e,i,r,o,s,a),je(a?e:n,i,r,o,s,a)}function Ne(t,e,n=!1){switch(t){case 0:if(1===e||2===e&&!n)return 1;break;case 1:if(n){if(-1===e)return 0}else if(1===e||-2===e)return 1;break;case 3:if(-1===e)return 0;if(1===e)return 1;break;case 4:if(-1===e||2===e&&!n)return 1;break;default:throw new Error(`Unrecognized CSG operation enum "${t}".`)}return 2}function Ue(t,e,n,i,r,o,s=!1,a=!1){const l=t=>{o.push(t.x),r>1&&o.push(t.y),r>2&&o.push(t.z),r>3&&o.push(t.w)};Vf.set(0,0,0,0).addScaledVector(t,i.a.x).addScaledVector(e,i.a.y).addScaledVector(n,i.a.z),Nf.set(0,0,0,0).addScaledVector(t,i.b.x).addScaledVector(e,i.b.y).addScaledVector(n,i.b.z),Uf.set(0,0,0,0).addScaledVector(t,i.c.x).addScaledVector(e,i.c.y).addScaledVector(n,i.c.z),a&&(Vf.normalize(),Nf.normalize(),Uf.normalize()),l(Vf),s?(l(Uf),l(Nf)):(l(Nf),l(Uf))}function je(t,e,n,i,r,o=!1){for(const s in r){const a=e[s],l=r[s];if(!(s in e))throw new Error(`CSG Operations: Attribute ${s} no available on geometry.`);const u=a.itemSize;"position"===s?(zf.fromBufferAttribute(a,t).applyMatrix4(n),l.push(zf.x,zf.y,zf.z)):"normal"===s?(zf.fromBufferAttribute(a,t).applyNormalMatrix(i),o&&zf.multiplyScalar(-1),l.push(zf.x,zf.y,zf.z)):(l.push(a.getX(t)),u>1&&l.push(a.getY(t)),u>2&&l.push(a.getZ(t)),u>3&&l.push(a.getW(t)))}}function Ge(t){for(const e of t)return e}function He(t,e,n,i,r,o,s,a=0){const l=t.matrixWorld.determinant()<0;Xf.copy(e.matrixWorld).invert().multiply(t.matrixWorld),Yf.getNormalMatrix(t.matrixWorld).multiplyScalar(l?-1:1);const u=t.geometry.groupIndices,c=t.geometry.index,h=t.geometry.attributes.position,d=e.geometry.boundsTree,p=e.geometry.index,f=e.geometry.attributes.position,m=n.ids,g=n.intersectionSet;for(let e=0,n=m.length;e<n;e++){const n=m[e],y=-1===a?0:u[n]+a,v=s.getGroupSet(y),x=3*n,b=c.getX(x+0),_=c.getX(x+1),w=c.getX(x+2);Zf.a.fromBufferAttribute(h,b).applyMatrix4(Xf),Zf.b.fromBufferAttribute(h,_).applyMatrix4(Xf),Zf.c.fromBufferAttribute(h,w).applyMatrix4(Xf),o.initialize(Zf);const S=g[n];for(let t=0,e=S.length;t<e;t++){const e=3*S[t],n=p.getX(e+0),i=p.getX(e+1),r=p.getX(e+2);Qf.a.fromBufferAttribute(f,n),Qf.b.fromBufferAttribute(f,i),Qf.c.fromBufferAttribute(f,r),o.splitByTriangle(Qf)}const A=o.triangles;for(let e=0,o=A.length;e<o;e++){const o=A[e],s=Ne(i,Be(o,d),r);if(2!==s){Zf.getBarycoord(o.a,Kf.a),Zf.getBarycoord(o.b,Kf.b),Zf.getBarycoord(o.c,Kf.c);const e=0===s;Fe(n,Kf,t.geometry,t.matrixWorld,Yf,v,l!==e)}}}return m.length}function We(t,e,n,i,r,o,s=0){const a=t.matrixWorld.determinant()<0;Xf.copy(e.matrixWorld).invert().multiply(t.matrixWorld),Yf.getNormalMatrix(t.matrixWorld).multiplyScalar(a?-1:1);const l=e.geometry.boundsTree,u=t.geometry.groupIndices,c=t.geometry.index,h=t.geometry.attributes,d=h.position,p=[],f=t.geometry.halfEdges,m=new Set;for(let t=0,e=c.count/3;t<e;t++)t in n.intersectionSet||m.add(t);for(;m.size>0;){const e=Ge(m);m.delete(e),p.push(e);const n=3*e,g=c.getX(n+0),y=c.getX(n+1),v=c.getX(n+2);Jf.a.fromBufferAttribute(d,g).applyMatrix4(Xf),Jf.b.fromBufferAttribute(d,y).applyMatrix4(Xf),Jf.c.fromBufferAttribute(d,v).applyMatrix4(Xf);const x=Ne(i,Be(Jf,l),r);for(;p.length>0;){const e=p.pop(),n=-1===s?0:u[e]+s,i=o.getGroupSet(n);for(let t=0;t<3;t++){const n=f.getSiblingTriangleIndex(e,t);-1!==n&&m.has(n)&&(p.push(n),m.delete(n))}if(2===x)continue;const r=3*e,l=0===x;Ve(c.getX(r+0),c.getX(r+1),c.getX(r+2),h,t.matrixWorld,Yf,i,l!==a)}}}function Xe(t,e){let n=e;return Array.isArray(e)||(n=[],t.forEach((t=>{n[t.materialIndex]=e}))),n}function Ye(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ze(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function Je(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ke(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $e(t,e){return $e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},$e(t,e)}function tn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=en(t);if(e){var r=en(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Qe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function en(t){return en=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},en(t)}function nn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function sn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function an(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function un(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function dn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pn(t,e){return pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pn(t,e)}function fn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=gn(t);if(e){var r=gn(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==hn(e)&&"function"!=typeof e?mn(t):e}(this,n)}}function mn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gn(t){return gn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},gn(t)}function yn(t){return yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yn(t)}function vn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xn(t,e){return xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},xn(t,e)}function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=_n(t);if(e){var r=_n(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==yn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function _n(t){return _n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_n(t)}function wn(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Sn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Sn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function An(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Mn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tn(t){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tn(t)}function En(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pn(t,e){return Pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pn(t,e)}function Cn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Rn(t);if(e){var r=Rn(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?In(t):e}(this,n)}}function In(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rn(t){return Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rn(t)}function On(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qn(t){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qn(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dn(t,e){return Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Dn(t,e)}function zn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Bn(t);if(e){var r=Bn(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==qn(e)&&"function"!=typeof e?kn(t):e}(this,n)}}function kn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bn(t){return Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bn(t)}function Fn(t){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(t)}function Vn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Nn(t,e){return Nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Nn(t,e)}function Un(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gn(t);if(e){var r=Gn(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Fn(e)&&"function"!=typeof e?jn(t):e}(this,n)}}function jn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gn(t){return Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gn(t)}function Hn(t){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hn(t)}function Wn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xn(t,e){return Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xn(t,e)}function Yn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Qn(t);if(e){var r=Qn(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Hn(e)&&"function"!=typeof e?Zn(t):e}(this,n)}}function Zn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qn(t){return Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qn(t)}function Jn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kn(t){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kn(t)}function $n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ti(t,e){return ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ti(t,e)}function ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ii(t);if(e){var r=ii(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Kn(e)&&"function"!=typeof e?ni(t):e}(this,n)}}function ni(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ii(t){return ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ii(t)}function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function oi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function si(t,e,n){return si="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ui(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},si(t,e,n||t)}function ai(t,e){return ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ai(t,e)}function li(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ui(t);if(e){var r=ui(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==ri(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function ui(t){return ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ui(t)}function ci(t){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ci(t)}function hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function di(t,e){return di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},di(t,e)}function pi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=mi(t);if(e){var r=mi(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==ci(e)&&"function"!=typeof e?fi(t):e}(this,n)}}function fi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mi(t){return mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},mi(t)}function gi(t){return gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gi(t)}function yi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function vi(t,e){return vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vi(t,e)}function xi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=_i(t);if(e){var r=_i(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==gi(e)&&"function"!=typeof e?bi(t):e}(this,n)}}function bi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _i(t){return _i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_i(t)}function wi(t){return wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wi(t)}function Si(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ai(t,e){return Ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ai(t,e)}function Mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ti(t);if(e){var r=Ti(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==wi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function Ti(t){return Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ti(t)}function Ei(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pi(t){return Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(t)}function Ci(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ii(t,e){return Ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ii(t,e)}function Ri(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Oi(t);if(e){var r=Oi(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function Oi(t){return Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Oi(t)}function qi(t){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(t)}function Li(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Di(t,e){return Di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Di(t,e)}function zi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Bi(t);if(e){var r=Bi(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?ki(t):e}(this,n)}}function ki(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bi(t){return Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bi(t)}function Fi(t){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fi(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ni(t,e){return Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ni(t,e)}function Ui(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gi(t);if(e){var r=Gi(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Fi(e)&&"function"!=typeof e?ji(t):e}(this,n)}}function ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gi(t){return Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gi(t)}function Hi(t,e,n,i,r,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,r)}function Wi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xi(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Yi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yi(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Yi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Zi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ji(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ki(t){return Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ki(t)}function $i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function tr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function er(t,e){return er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},er(t,e)}function nr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ir(t);if(e){var r=ir(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function ir(t){return ir=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ir(t)}function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function or(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function sr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ar(t,e){return ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ar(t,e)}function lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ur(t);if(e){var r=ur(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==rr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function ur(t){return ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ur(t)}function cr(t){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cr(t)}function hr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function dr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pr(t,e){return pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pr(t,e)}function fr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=mr(t);if(e){var r=mr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function mr(t){return mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},mr(t)}function gr(t){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gr(t)}function yr(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=vr(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function vr(t,e){if(t){if("string"==typeof t)return xr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xr(t,e):void 0}}function xr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function br(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _r(t,e){return _r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_r(t,e)}function wr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Sr(t);if(e){var r=Sr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==gr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function Sr(t){return Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Sr(t)}function Ar(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Tr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Er(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function Cr(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ir(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Rr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Or(t,e,n){return Or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zr(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},Or(t,e,n||t)}function qr(t,e){return qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qr(t,e)}function Lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=zr(t);if(e){var r=zr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Pr(e)&&"function"!=typeof e?Dr(t):e}(this,n)}}function Dr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zr(t){return zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},zr(t)}function kr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Br(t){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Br(t)}function Fr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Vr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Nr(t,e,n){return Nr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gr(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},Nr(t,e,n||t)}function Ur(t,e){return Ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ur(t,e)}function jr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gr(t);if(e){var r=Gr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Br(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function Gr(t){return Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gr(t)}function Hr(t){return Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hr(t)}function Wr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Xr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Yr(t,e){return Yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Yr(t,e)}function Zr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Jr(t);if(e){var r=Jr(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Hr(e)&&"function"!=typeof e?Qr(t):e}(this,n)}}function Qr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jr(t){return Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Jr(t)}function Kr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function to(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function no(t){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(t)}function io(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ro(t,e){return ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ro(t,e)}function oo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=so(t);if(e){var r=so(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==no(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function so(t){return so=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},so(t)}function ao(t){return ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ao(t)}function lo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function uo(t,e){return uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},uo(t,e)}function co(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ho(t);if(e){var r=ho(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==ao(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function ho(t){return ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ho(t)}function po(t){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},po(t)}function fo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mo(t,e){return mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},mo(t,e)}function go(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=yo(t);if(e){var r=yo(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function yo(t){return yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},yo(t)}function vo(t){return vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vo(t)}function xo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bo(t,e){return bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},bo(t,e)}function _o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=wo(t);if(e){var r=wo(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function wo(t){return wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},wo(t)}function So(t){return So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},So(t)}function Ao(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Mo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mo(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Mo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function To(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Eo(t,e){return Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Eo(t,e)}function Po(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Co(t);if(e){var r=Co(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==So(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function Co(t){return Co=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Co(t)}function Io(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ro(t){return Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro(t)}function Oo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qo(t,e){return qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qo(t,e)}function Lo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Do(t);if(e){var r=Do(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==Ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,n)}}function Do(t){return Do=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Do(t)}function zo(t,e){return e||"function"!=typeof t||(e=t,t={}),this.ondata=e,t}function ko(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return Vy(t,e,[qy],(function(t){return By(Bo(t.data[0],t.data[1]))}),0,n)}function Bo(t,e){return Ey(t,e||{},0,0)}function Fo(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return Vy(t,e,[Oy],(function(t){return By(Vo(t.data[0],Fy(t.data[1])))}),1,n)}function Vo(t,e){return dy(t,e)}function No(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return Vy(t,e,[qy,Ly,function(){return[Uo]}],(function(t){return By(Uo(t.data[0],t.data[1]))}),2,n)}function Uo(t,e){e||(e={});var n=My(),i=t.length;n.p(t);var r=Ey(t,e,Qy(e),8),o=r.length;return Xy(r,e),Wy(r,o-8,n.d()),Wy(r,o-4,i),r}function jo(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return Vy(t,e,[Oy,Dy,function(){return[Go]}],(function(t){return By(Go(t.data[0]))}),3,n)}function Go(t,e){return dy(t.subarray(Yy(t),-8),e||new Bg(Zy(t)))}function Ho(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return Vy(t,e,[qy,zy,function(){return[Wo]}],(function(t){return By(Wo(t.data[0],t.data[1]))}),4,n)}function Wo(t,e){e||(e={});var n=Ty();n.p(t);var i=Ey(t,e,2,4);return Jy(i,e),Wy(i,i.length-4,n.d()),i}function Xo(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return Vy(t,e,[Oy,ky,function(){return[Yo]}],(function(t){return By(Yo(t.data[0],Fy(t.data[1])))}),5,n)}function Yo(t,e){return dy((Ky(t),t.subarray(2,-4)),e)}function Zo(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return 31==t[0]&&139==t[1]&&8==t[2]?jo(t,e,n):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?Fo(t,e,n):Xo(t,e,n)}function Qo(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?Go(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?Vo(t,e):Yo(t,e)}function Jo(t,e){if(e){for(var n=new Bg(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}if(fv)return fv.encode(t);var r=t.length,o=new Bg(t.length+(t.length>>1)),s=0,a=function(t){o[s++]=t};for(i=0;i<r;++i){if(s+5>o.length){var l=new Bg(s+8+(r-i<<1));l.set(o),o=l}var u=t.charCodeAt(i);u<128||e?a(u):u<2048?(a(192|u>>6),a(128|63&u)):u>55295&&u<57344?(a(240|(u=65536+(1047552&u)|1023&t.charCodeAt(++i))>>18),a(128|u>>12&63),a(128|u>>6&63),a(128|63&u)):(a(224|u>>12),a(128|u>>6&63),a(128|63&u))}return hy(o,0,s)}function Ko(t,e){if(e){for(var n="",i=0;i<t.length;i+=16384)n+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return n}if(mv)return mv.decode(t);var r=yv(t),o=r[0];if(r[1].length)throw"invalid utf-8 data";return o}function $o(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";var i={};pv(t,"",i,e);var r=Object.keys(i),o=r.length,s=0,a=0,l=o,u=new Array(o),c=[],h=function(){for(var t=0;t<c.length;++t)c[t]()},d=function(){var t=new Bg(a+22),e=s,i=a-s;a=0;for(var r=0;r<l;++r){var o=u[r];try{var c=o.c.length;Mv(t,a,o,o.f,o.u,c);var h=30+o.f.length+Av(o.extra),d=a+h;t.set(o.c,d),Mv(t,s,o,o.f,o.u,c,a,o.m),s+=16+h+(o.m?o.m.length:0),a=d+c}catch(t){return n(t,null)}}Tv(t,s,u.length,i,e),n(null,t)};o||d();for(var p=function(t){var e=r[t],l=i[e],p=l[0],f=l[1],m=My(),g=p.length;m.p(p);var y=Jo(e),v=y.length,x=f.comment,b=x&&Jo(x),_=b&&b.length,w=Av(f.extra),S=0==f.level?0:8,A=function(i,r){if(i)h(),n(i,null);else{var l=r.length;u[t]=Py(f,{size:g,crc:m.d(),c:r,f:y,m:b,u:v!=e.length||b&&x.length!=_,compression:S}),s+=30+v+w+l,a+=76+2*(v+w)+(_||0)+l,--o||d()}};if(v>65535&&A("filename too long",null),S)if(g<16e4)try{A(null,Bo(p,f))}catch(t){A(t,null)}else c.push(ko(p,f,A));else A(null,p)},f=0;f<l;++f)p(f);return h}function ts(t,e){e||(e={});var n={},i=[];pv(t,"",n,e);var r=0,o=0;for(var s in n){var a=n[s],l=a[0],u=a[1],c=0==u.level?0:8,h=(S=Jo(s)).length,d=u.comment,p=d&&Jo(d),f=p&&p.length,m=Av(u.extra);if(h>65535)throw"filename too long";var g=c?Bo(l,u):l,y=g.length,v=My();v.p(l),i.push(Py(u,{size:l.length,crc:v.d(),c:g,f:S,m:p,u:h!=s.length||p&&d.length!=f,o:r,compression:c})),r+=30+h+m+y,o+=76+2*(h+m)+(f||0)+y}for(var x=new Bg(o+22),b=r,_=o-r,w=0;w<i.length;++w){var S=i[w];Mv(x,S.o,S,S.f,S.u,S.c.length);var A=30+S.f.length+Av(S.extra);x.set(S.c,S.o+A),Mv(x,r,S,S.f,S.u,S.c.length,S.o,S.m),r+=16+A+(S.m?S.m.length:0)}return Tv(x,r,i.length,_,b),x}function es(t,e){if("function"!=typeof e)throw"no callback";for(var n=[],i=function(){for(var t=0;t<n.length;++t)n[t]()},r={},o=t.length-22;101010256!=Gy(t,o);--o)if(!o||t.length-o>65558)return void e("invalid zip file",null);var s=jy(t,o+8);s||e(null,{});var a=s,l=Gy(t,o+16),u=4294967295==l;if(u){if(o=Gy(t,o-12),101075792!=Gy(t,o))return void e("invalid zip file",null);a=s=Gy(t,o+32),l=Gy(t,o+48)}for(var c=function(o){var a=wv(t,l,u),c=a[0],h=a[1],d=a[2],p=a[3],f=a[4],m=a[5],g=_v(t,m);l=f;var y=function(t,n){t?(i(),e(t,null)):(r[p]=n,--s||e(null,r))};if(c)if(8==c){var v=t.subarray(g,g+h);if(h<32e4)try{y(null,Vo(v,new Bg(d)))}catch(t){y(t,null)}else n.push(Fo(v,{size:d},y))}else y("unknown compression type "+c,null);else y(null,hy(t,g,g+h))},h=0;h<a;++h)c();return i}function ns(t){for(var e={},n=t.length-22;101010256!=Gy(t,n);--n)if(!n||t.length-n>65558)throw"invalid zip file";var i=jy(t,n+8);if(!i)return{};var r=Gy(t,n+16),o=4294967295==r;if(o){if(n=Gy(t,n-12),101075792!=Gy(t,n))throw"invalid zip file";i=Gy(t,n+32),r=Gy(t,n+48)}for(var s=0;s<i;++s){var a=wv(t,r,o),l=a[0],u=a[1],c=a[2],h=a[3],d=a[4],p=a[5],f=_v(t,p);if(r=d,l){if(8!=l)throw"unknown compression type "+l;e[h]=Vo(t.subarray(f,f+u),new Bg(c))}else e[h]=hy(t,f,f+u)}return e}function is(t,e,n){const i=n.length-t-1;if(e>=n[i])return i-1;if(e<=n[t])return t;let r=t,o=i,s=Math.floor((r+o)/2);for(;e<n[s]||e>=n[s+1];)e<n[s]?o=s:r=s,s=Math.floor((r+o)/2);return s}function rs(t,e){let n=1;for(let e=2;e<=t;++e)n*=e;let i=1;for(let t=2;t<=e;++t)i*=t;for(let n=2;n<=t-e;++n)i*=n;return n/i}function os(t){const e=t.match(/FBXVersion: (\d+)/);if(e)return parseInt(e[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function ss(t){return t/46186158e3}function as(t,e,n,i){let r;switch(i.mappingType){case"ByPolygonVertex":r=t;break;case"ByPolygon":r=e;break;case"ByVertice":r=n;break;case"AllSame":r=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}"IndexToDirect"===i.referenceType&&(r=i.indices[r]);const o=r*i.dataSize,s=o+i.dataSize;return function(t,e,n,i){for(let r=n,o=0;r<i;r++,o++)t[o]=e[r];return t}(Xv,i.buffer,o,s)}function ls(t){const e=new Ad.Matrix4,n=new Ad.Matrix4,i=new Ad.Matrix4,r=new Ad.Matrix4,o=new Ad.Matrix4,s=new Ad.Matrix4,a=new Ad.Matrix4,l=new Ad.Matrix4,u=new Ad.Matrix4,c=new Ad.Matrix4,h=new Ad.Matrix4,d=new Ad.Matrix4,p=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(Zv.fromArray(t.translation)),t.preRotation){const e=t.preRotation.map(Ad.MathUtils.degToRad);e.push(t.eulerOrder),n.makeRotationFromEuler(Yv.fromArray(e))}if(t.rotation){const e=t.rotation.map(Ad.MathUtils.degToRad);e.push(t.eulerOrder),i.makeRotationFromEuler(Yv.fromArray(e))}if(t.postRotation){const e=t.postRotation.map(Ad.MathUtils.degToRad);e.push(t.eulerOrder),r.makeRotationFromEuler(Yv.fromArray(e)),r.invert()}t.scale&&o.scale(Zv.fromArray(t.scale)),t.scalingOffset&&a.setPosition(Zv.fromArray(t.scalingOffset)),t.scalingPivot&&s.setPosition(Zv.fromArray(t.scalingPivot)),t.rotationOffset&&l.setPosition(Zv.fromArray(t.rotationOffset)),t.rotationPivot&&u.setPosition(Zv.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(h.copy(t.parentMatrix),c.copy(t.parentMatrixWorld));const f=n.clone().multiply(i).multiply(r),m=new Ad.Matrix4;m.extractRotation(c);const g=new Ad.Matrix4;g.copyPosition(c);const y=g.clone().invert().multiply(c),v=m.clone().invert().multiply(y),x=o,b=new Ad.Matrix4;if(0===p)b.copy(m).multiply(f).multiply(v).multiply(x);else if(1===p)b.copy(m).multiply(v).multiply(f).multiply(x);else{const t=(new Ad.Matrix4).scale((new Ad.Vector3).setFromMatrixScale(h)).clone().invert(),e=v.clone().multiply(t);b.copy(m).multiply(f).multiply(e).multiply(x)}const _=u.clone().invert(),w=s.clone().invert();let S=e.clone().multiply(l).multiply(u).multiply(n).multiply(i).multiply(r).multiply(_).multiply(a).multiply(s).multiply(o).multiply(w);const A=(new Ad.Matrix4).copyPosition(S),M=c.clone().multiply(A);return d.copyPosition(M),S=d.clone().multiply(b),S.premultiply(c.invert()),S}function us(t){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(t=t||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]}function cs(t){return t.split(",").map((function(t){return parseFloat(t)}))}function hs(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),Ad.LoaderUtils.decodeText(new Uint8Array(t,e,n))}function ds(t,e,n){return t.slice(0,e).concat(n).concat(t.slice(e))}function ps(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fs(t){return fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(t)}function ms(t,e,n,i,r,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,r)}function gs(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){function o(t){ms(a,i,r,o,s,"next",t)}function s(t){ms(a,i,r,o,s,"throw",t)}var a=t.apply(e,n);o(void 0)}))}}function ys(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function vs(t,e){return vs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vs(t,e)}function xs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=_s(t);if(e){var r=_s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!==fs(e)&&"function"!=typeof e?bs(t):e}(this,n)}}function bs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _s(t){return _s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_s(t)}function ws(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ss={};t.r(Ss),t.d(Ss,{AsyncCompress:()=>rv,AsyncDecompress:()=>dv,AsyncDeflate:()=>tv,AsyncGunzip:()=>sv,AsyncGzip:()=>rv,AsyncInflate:()=>nv,AsyncUnzipInflate:()=>qv,AsyncUnzlib:()=>cv,AsyncZipDeflate:()=>Cv,AsyncZlib:()=>lv,Compress:()=>iv,DecodeUTF8:()=>vv,Decompress:()=>hv,Deflate:()=>$y,EncodeUTF8:()=>xv,Gunzip:()=>ov,Gzip:()=>iv,Inflate:()=>ev,Unzip:()=>Lv,UnzipInflate:()=>Ov,UnzipPassThrough:()=>Rv,Unzlib:()=>uv,Zip:()=>Iv,ZipDeflate:()=>Pv,ZipPassThrough:()=>Ev,Zlib:()=>av,compress:()=>No,compressSync:()=>Uo,decompress:()=>Zo,decompressSync:()=>Qo,deflate:()=>ko,deflateSync:()=>Bo,gunzip:()=>jo,gunzipSync:()=>Go,gzip:()=>No,gzipSync:()=>Uo,inflate:()=>Fo,inflateSync:()=>Vo,strFromU8:()=>Ko,strToU8:()=>Jo,unzip:()=>es,unzipSync:()=>ns,unzlib:()=>Xo,unzlibSync:()=>Yo,zip:()=>$o,zipSync:()=>ts,zlib:()=>Ho,zlibSync:()=>Wo});var As=t(6713),Ms=t(7418),Ts=t.n(Ms);if(window.Promise||(window.Promise=As.Polyfill),Object.assign||(Object.assign=Ts()),Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!window.performance||!window.performance.now){var Es=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-Es}}for(var Ps=Date.now(),Cs=["ms","moz","webkit","o"],Is=0;Is<4&&!window.requestAnimationFrame;++Is){var Rs=Cs[Is];window.requestAnimationFrame=window[Rs+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Rs+"CancelAnimationFrame"]||window[Rs+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+Ps-e;return n<0&&(n=0),Ps=e,window.setTimeout((function(){Ps=Date.now(),t(performance.now())}),n)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array);var Os,qs,Ls,Ds,zs,ks,Bs,Fs,Vs,Ns,Us,js,Gs,Hs,Ws,Xs,Ys,Zs=/iPhone/i,Qs=/iPod/i,Js=/iPad/i,Ks=/\biOS-universal(?:.+)Mac\b/i,$s=/\bAndroid(?:.+)Mobile\b/i,ta=/Android/i,ea=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,na=/Silk/i,ia=/Windows Phone/i,ra=/\bWindows(?:.+)ARM\b/i,oa=/BlackBerry/i,sa=/BB10/i,aa=/Opera Mini/i,la=/\b(CriOS|Chrome)(?:.+)Mobile/i,ua=/Mobile(?:.+)Firefox\b/i,ca=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream},ha=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,i=n.split("[FBAN");void 0!==i[1]&&(n=i[0]),void 0!==(i=n.split("Twitter"))[1]&&(n=i[0]);var r=function(t){return function(e){return e.test(t)}}(n),o={apple:{phone:r(Zs)&&!r(ia),ipod:r(Qs),tablet:!r(Zs)&&(r(Js)||ca(e))&&!r(ia),universal:r(Ks),device:(r(Zs)||r(Qs)||r(Js)||r(Ks)||ca(e))&&!r(ia)},amazon:{phone:r(ea),tablet:!r(ea)&&r(na),device:r(ea)||r(na)},android:{phone:!r(ia)&&r(ea)||!r(ia)&&r($s),tablet:!r(ia)&&!r(ea)&&!r($s)&&(r(na)||r(ta)),device:!r(ia)&&(r(ea)||r(na)||r($s)||r(ta))||r(/\bokhttp\b/i)},windows:{phone:r(ia),tablet:r(ra),device:r(ia)||r(ra)},other:{blackberry:r(oa),blackberry10:r(sa),opera:r(aa),firefox:r(ua),chrome:r(la),device:r(oa)||r(sa)||r(aa)||r(ua)||r(la)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(window.navigator),da={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e,n=!0;return(ha.tablet||ha.phone)&&(ha.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(n=!1),ha.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(n=!1)),n?32:4}(),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:ha.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!ha.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},pa=t(8718),fa=t.n(pa),ma=t(9187),ga=t.n(ma),ya=t(8575);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Os||(Os={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(qs||(qs={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Ls||(Ls={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Ds||(Ds={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(zs||(zs={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(ks||(ks={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Bs||(Bs={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Fs||(Fs={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Vs||(Vs={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Ns||(Ns={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(Us||(Us={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(js||(js={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Gs||(Gs={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Hs||(Hs={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Ws||(Ws={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Xs||(Xs={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(Ys||(Ys={})),da.RETINA_PREFIX=/@([0-9\.]+)x/,da.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var va,xa=!1,ba=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[Ds.NORMAL_NPM]=Ds.NORMAL,t[Ds.ADD_NPM]=Ds.ADD,t[Ds.SCREEN_NPM]=Ds.SCREEN,e[Ds.NORMAL]=Ds.NORMAL_NPM,e[Ds.ADD]=Ds.ADD_NPM,e[Ds.SCREEN]=Ds.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();Float32Array,Uint32Array,Int32Array,Uint8Array;var _a,wa,Sa=0,Aa={},Ma={},Ta=Object.create(null),Ea=Object.create(null),Pa=function(){function t(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||da.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!1,configurable:!0}),t}(),Ca=2*Math.PI,Ia=180/Math.PI,Ra=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(wa||(wa={}));var Oa=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=wa.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this},t}(),qa=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=wa.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=n},t.prototype.getBounds=function(){return new Oa(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),La=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=wa.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1},t.prototype.getBounds=function(){return new Oa(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),Da=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=Array.isArray(e[0])?e[0]:e;if("number"!=typeof i[0]){for(var r=[],o=0,s=i.length;o<s;o++)r.push(i[o].x,i[o].y);i=r}this.points=i,this.type=wa.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,i=this.points.length/2,r=0,o=i-1;r<i;o=r++){var s=this.points[2*r],a=this.points[2*r+1],l=this.points[2*o],u=this.points[2*o+1];a>e!=u>e&&t<(e-a)/(u-a)*(l-s)+s&&(n=!n)}return n},t}(),za=function(){function t(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r,this.type=wa.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var n=t-(this.x+this.radius),i=e-(this.y+this.radius),r=this.radius*this.radius;if(n*n+i*i<=r)return!0;if((n=t-(this.x+this.width-this.radius))*n+i*i<=r)return!0;if(n*n+(i=e-(this.y+this.height-this.radius))*i<=r)return!0;if((n=t-(this.x+this.radius))*n+i*i<=r)return!0}return!1},t}(),ka=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),Ba=function(){function t(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this._x=n,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),Fa=function(){function t(t,e,n,i,r,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,i,r,o){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new ka;var n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new ka;var n=1/(this.a*this.d+this.c*-this.b),i=t.x,r=t.y;return e.x=this.d*n*i+-this.c*n*r+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*r+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,o=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this},t.prototype.setTransform=function(t,e,n,i,r,o,s,a,l){return this.a=Math.cos(s+l)*r,this.b=Math.sin(s+l)*r,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,i=this.c,r=this.d,o=-Math.atan2(-i,r),s=Math.atan2(n,e),a=Math.abs(o+s);return a<1e-5||Math.abs(Ca-a)<1e-5?(t.rotation=s,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=s),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,o=t*i-e*n;return this.a=i/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-i*r)/o,this.ty=-(t*this.ty-e*r)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Va=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Na=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ua=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ja=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ga=[],Ha=[],Wa=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Ga.push(e);for(var n=0;n<16;n++)for(var i=Wa(Va[t]*Va[n]+Ua[t]*Na[n]),r=Wa(Na[t]*Va[n]+ja[t]*Na[n]),o=Wa(Va[t]*Ua[n]+Ua[t]*ja[n]),s=Wa(Na[t]*Ua[n]+ja[t]*ja[n]),a=0;a<16;a++)if(Va[a]===i&&Na[a]===r&&Ua[a]===o&&ja[a]===s){e.push(a);break}}for(t=0;t<16;t++){var l=new Fa;l.set(Va[t],Na[t],Ua[t],ja[t],0,0),Ha.push(l)}}();var Xa={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Va[t]},uY:function(t){return Na[t]},vX:function(t){return Ua[t]},vY:function(t){return ja[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Ga[t][e]},sub:function(t,e){return Ga[t][Xa.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Xa.S:Xa.N:2*Math.abs(e)<=Math.abs(t)?t>0?Xa.E:Xa.W:e>0?t>0?Xa.SE:Xa.SW:t>0?Xa.NE:Xa.NW},matrixAppendRotationInv:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=Ha[Xa.inv(e)];r.tx=n,r.ty=i,t.append(r)}},Ya=function(){function t(){this.worldTransform=new Fa,this.localTransform=new Fa,this.position=new Ba(this.onChange,this,0,0),this.scale=new Ba(this.onChange,this,1,1),this.pivot=new Ba(this.onChange,this,0,0),this.skew=new Ba(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,i=this.worldTransform;i.a=e.a*n.a+e.b*n.c,i.b=e.a*n.b+e.b*n.d,i.c=e.c*n.a+e.d*n.c,i.d=e.c*n.b+e.d*n.d,i.tx=e.tx*n.a+e.ty*n.c+n.tx,i.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();da.SORTABLE_CHILDREN=!1;var Za=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Oa.EMPTY:((t=t||new Oa(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,o=t[0],s=t[1];e=o<e?o:e,n=s<n?s:n,i=o>i?o:i,r=s>r?s:r,e=(o=t[2])<e?o:e,n=(s=t[3])<n?s:n,i=o>i?o:i,r=s>r?s:r,e=(o=t[4])<e?o:e,n=(s=t[5])<n?s:n,i=o>i?o:i,r=s>r?s:r,e=(o=t[6])<e?o:e,n=(s=t[7])<n?s:n,i=o>i?o:i,r=s>r?s:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r},t.prototype.addFrame=function(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r)},t.prototype.addFrameMatrix=function(t,e,n,i,r){var o=t.a,s=t.b,a=t.c,l=t.d,u=t.tx,c=t.ty,h=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=o*e+a*n+u,g=s*e+l*n+c;h=m<h?m:h,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,h=(m=o*i+a*n+u)<h?m:h,d=(g=s*i+l*n+c)<d?g:d,p=m>p?m:p,f=g>f?g:f,h=(m=o*e+a*r+u)<h?m:h,d=(g=s*e+l*r+c)<d?g:d,p=m>p?m:p,f=g>f?g:f,h=(m=o*i+a*r+u)<h?m:h,d=(g=s*i+l*r+c)<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=h,this.minY=d,this.maxX=p,this.maxY=f},t.prototype.addVertexData=function(t,e,n){for(var i=this.minX,r=this.minY,o=this.maxX,s=this.maxY,a=e;a<n;a+=2){var l=t[a],u=t[a+1];i=l<i?l:i,r=u<r?u:r,o=l>o?l:o,s=u>s?u:s}this.minX=i,this.minY=r,this.maxX=o,this.maxY=s},t.prototype.addVertices=function(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i)},t.prototype.addVerticesMatrix=function(t,e,n,i,r,o){void 0===r&&(r=0),void 0===o&&(o=r);for(var s=t.a,a=t.b,l=t.c,u=t.d,c=t.tx,h=t.ty,d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,g=n;g<i;g+=2){var y=e[g],v=e[g+1],x=s*y+l*v+c,b=u*v+a*y+h;d=Math.min(d,x-r),f=Math.max(f,x+r),p=Math.min(p,b-o),m=Math.max(m,b+o)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=o){var s=this.minX,a=this.minY,l=this.maxX,u=this.maxY;this.minX=n<s?n:s,this.minY=i<a?i:a,this.maxX=r>l?r:l,this.maxY=o>u?o:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=o){var s=this.minX,a=this.minY,l=this.maxX,u=this.maxY;this.minX=n<s?n:s,this.minY=i<a?i:a,this.maxX=r>l?r:l,this.maxY=o>u?o:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,n,i,r,o){t-=r,e-=o,n+=r,i+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},t}(),Qa=function(t,e){return Qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Qa(t,e)},Ja=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Ya,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Za,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return m(e,t),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Oa),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Oa),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Za);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,o},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,i,r,o,s,a,l){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===l&&(l=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=l,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ka),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*Ia},set:function(t){this.transform.rotation=t*Ra},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1),this._mask=t,this._mask&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(fa()),Ka=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return m(e,t),e}(Ja);Ja.prototype.displayObjectUpdateTransform=Ja.prototype.updateTransform;var $a=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=da.SORTABLE_CHILDREN,e.sortDirty=!1,e}return m(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);this.children[n]=e,this.children[i]=t,this.onChildrenChange(n<i?n:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);c(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var r=e[0],o=this.children.indexOf(r);if(-1===o)return null;r.parent=null,r.transform._parentID=-1,c(this.children,o,1),this._boundsID++,this.onChildrenChange(o),r.emit("removed",this),this.emit("childRemoved",r,this,o)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,c(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,i=t,r=e-i;if(r>0&&r<=e){n=this.children.splice(i,r);for(var o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(t),o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(g),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!n)for(var r=0,o=this.children.length;r<o;++r){var s=this.children[r];s.visible&&s.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}n&&t.mask.push(this,this._mask),this._render(t),i=0;for(var r=this.children.length;i<r;i++)this.children[i].render(t);t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(n)for(var r=0;r<i.length;++r)i[r].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(Ja);$a.prototype.containerUpdateTransform=$a.prototype.updateTransform,Ja.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var tl,el=100,nl=function(){function t(t){this._hookDiv=null,(ha.tablet||ha.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width=el+"px",e.style.height=el+"px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessability for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},t.prototype.update=function(){var t=performance.now();if(!(ha.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=this.renderer.resolution,i=e.width/this.renderer.width*n,r=e.height/this.renderer.height*n,o=this.div;o.style.left=e.left+"px",o.style.top=e.top+"px",o.style.width=this.renderer.width+"px",o.style.height=this.renderer.height+"px";for(var s=0;s<this.children.length;s++){var a=this.children[s];if(a.renderId!==this.renderId)a._accessibleActive=!1,c(this.children,s,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,s--;else{o=a._accessibleDiv;var l=a.hitArea,u=a.worldTransform;a.hitArea?(o.style.left=(u.tx+l.x*u.a)*i+"px",o.style.top=(u.ty+l.y*u.d)*r+"px",o.style.width=l.width*u.a*i+"px",o.style.height=l.height*u.d*r+"px"):(l=a.getBounds(),this.capHitArea(l),o.style.left=l.x*i+"px",o.style.top=l.y*r+"px",o.style.width=l.width*i+"px",o.style.height=l.height*r+"px",o.title!==a.accessibleTitle&&null!==a.accessibleTitle&&(o.title=a.accessibleTitle),o.getAttribute("aria-label")!==a.accessibleHint&&null!==a.accessibleHint&&o.setAttribute("aria-label",a.accessibleHint)),a.accessibleTitle===o.title&&a.tabIndex===o.tabIndex||(o.title=a.accessibleTitle,o.tabIndex=a.tabIndex,this.debug&&this.updateDebugHTML(o))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=el+"px",e.style.height=el+"px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();da.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(tl||(tl={}));var il=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=0),void 0===i&&(i=!1),this.fn=t,this.context=e,this.priority=n,this.once=i,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),rl=function(){function t(){var t=this;this._head=new il(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/da.TARGET_FPMS,this.elapsedMS=1/da.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,n){return void 0===n&&(n=tl.NORMAL),this._addListener(new il(t,e,n))},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=tl.NORMAL),this._addListener(new il(t,e,n,!0))},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*da.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,da.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),ol=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,tl.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?rl.shared:new rl,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}(),sl=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new ka,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),al=function(t,e){return al=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},al(t,e)},ll=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),ul=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),cl=function(){function t(){this._tempPoint=new ka}return t.prototype.recursiveFindHit=function(t,e,n,i,r){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=r=e.interactive||r,l=!0;if(e.hitArea?(i&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(i=!1,l=!1)),a=!1):e._mask&&i&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(i=!1)),l&&e.interactiveChildren&&e.children)for(var u=e.children,c=u.length-1;c>=0;c--){var h=u[c],d=this.recursiveFindHit(t,h,n,i,a);if(d){if(!h.parent)continue;a=!1,d&&(t.target&&(i=!1),s=!0)}}return r&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),n&&n(t,e,!!s))),s},t.prototype.findHit=function(t,e,n,i){this.recursiveFindHit(t,e,n,i,!1)},t}(),hl={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};Ja.mixin(hl);var dl={target:null,data:{global:null}},pl=function(t){function e(e,n){var i=t.call(this)||this;return n=n||{},i.renderer=e,i.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new sl,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new ll,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents="ontouchstart"in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new cl,i._tempDisplayObject=new Ka,i._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){function n(){this.constructor=t}al(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return dl.target=null,dl.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(dl,e,null,!0),dl.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(rl.system.add(this.tickerUpdate,this,tl.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(rl.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},e.prototype.mapPositionToPoint=function(t,e,n){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var r=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*r,t.y=(n-i.top)*(this.interactionDOMElement.height/i.height)*r},e.prototype.processInteractive=function(t,e,n,i){var r=this.search.findHit(t,e,n,i),o=this.delayedEvents;if(!o.length)return r;t.stopPropagationHint=!1;var s=o.length;this.delayedEvents=[];for(var a=0;a<s;a++){var l=o[a],u=l.displayObject,c=l.eventString,h=l.eventData;h.stopsPropagatingAt===u&&(h.stopPropagationHint=!0),this.dispatchEvent(u,c,h)}return r},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,i=0;i<n;i++){var r=e[i],o=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,o);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===r.pointerType)this.emit("touchstart",s);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,n){var i=t.data,r=t.data.identifier;if(n)if(e.trackedPointers[r]||(e.trackedPointers[r]=new ul(r)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var o=2===i.button;o?e.trackedPointers[r].rightDown=!0:e.trackedPointers[r].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,n){for(var i=this.normalizeToPointerData(t),r=i.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<r;s++){var a=i[s],l=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,u),"mouse"===a.pointerType||"pen"===a.pointerType){var c=2===a.button;this.emit(c?"rightup"+o:"mouseup"+o,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,u),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var n=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,n){var i=t.data,r=t.data.identifier,o=e.trackedPointers[r],s="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType,l=!1;if(a){var u=2===i.button,c=ul.FLAGS,h=u?c.RIGHT_DOWN:c.LEFT_DOWN,d=void 0!==o&&o.flags&h;n?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),l=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),o&&(u?o.rightDown=!1:o.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!l||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[r]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,i=0;i<n;i++){var r=e[i],o=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,o);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===r.pointerType&&this.emit("touchmove",s),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,n){var i=t.data,r="touch"===i.pointerType,o="mouse"===i.pointerType||"pen"===i.pointerType;o&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),r&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,n){var i=t.data,r=t.data.identifier,o="mouse"===i.pointerType||"pen"===i.pointerType,s=e.trackedPointers[r];n&&!s&&(s=e.trackedPointers[r]=new ul(r)),void 0!==s&&(n&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[r]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i)},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new sl).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,i=t.changedTouches.length;n<i;n++){var r=t.changedTouches[n];void 0===r.button&&(r.button=t.touches.length?1:0),void 0===r.buttons&&(r.buttons=t.touches.length?1:0),void 0===r.isPrimary&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===r.width&&(r.width=r.radiusX||1),void 0===r.height&&(r.height=r.radiusY||1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="touch"),void 0===r.pointerId&&(r.pointerId=r.identifier||0),void 0===r.pressure&&(r.pressure=r.force||.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),void 0===r.layerX&&(r.layerX=r.offsetX=r.clientX),void 0===r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,e.push(r)}else if(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent)e.push(t);else{var o=t;void 0===o.isPrimary&&(o.isPrimary=!0),void 0===o.width&&(o.width=1),void 0===o.height&&(o.height=1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="mouse"),void 0===o.pointerId&&(o.pointerId=1),void 0===o.pressure&&(o.pressure=.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(fa()),fl=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,i,r,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");var l=this.name,u=this.items;this._aliasCount++;for(var c=0,h=u.length;c<h;c++)u[c][l](t,e,n,i,r,o,s,a);return u===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(fl.prototype,{dispatch:{value:fl.prototype.emit},run:{value:fl.prototype.emit}}),da.PREFER_ENV=ha.any?Os.WEBGL:Os.WEBGL2,da.STRICT_TEXTURE_CACHE=!1;var ml=[],gl=function(t,e){return gl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},gl(t,e)},yl=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new fl("setRealSize"),this.onUpdate=new fl("update"),this.onError=new fl("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),vl=function(t){function e(e,n){var i=this,r=n||{},o=r.width,s=r.height;if(!o||!s)throw new Error("BufferResource width or height invalid");return(i=t.call(this,o,s)||this).data=e,i}return v(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===js.UNPACK),n.width===e.width&&n.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(n.width=e.width,n.height=e.height,i.texImage2D(e.target,0,n.internalFormat,e.width,e.height,0,e.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(yl),xl={scaleMode:Vs.NEAREST,format:ks.RGBA,alphaMode:js.NPM},bl=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i=t.call(this)||this,r=(n=n||{}).alphaMode,o=n.mipmap,s=n.anisotropicLevel,a=n.scaleMode,l=n.width,u=n.height,c=n.wrapMode,h=n.format,p=n.type,f=n.target,m=n.resolution,g=n.resourceOptions;return!e||e instanceof yl||((e=y(e,g)).internal=!0),i.width=l||0,i.height=u||0,i.resolution=m||da.RESOLUTION,i.mipmap=void 0!==o?o:da.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==s?s:da.ANISOTROPIC_LEVEL,i.wrapMode=c||da.WRAP_MODE,i.scaleMode=void 0!==a?a:da.SCALE_MODE,i.format=h||ks.RGBA,i.type=p||Fs.UNSIGNED_BYTE,i.target=f||Bs.TEXTURE_2D,i.alphaMode=void 0!==r?r:js.UNPACK,void 0!==n.premultiplyAlpha&&(i.premultiplyAlpha=n.premultiplyAlpha),i.uid=d(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=l>0&&u>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return v(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=l(this.realWidth)&&l(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ea[this.cacheId],delete Ta[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,n,i){void 0===i&&(i=da.STRICT_TEXTURE_CACHE);var r="string"==typeof t,o=null;r?o=t:(t._pixiId||(t._pixiId="pixiid_"+d()),o=t._pixiId);var s=Ea[o];if(r&&i&&!s)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return s||((s=new e(t,n)).cacheId=o,e.addToCache(s,o)),s},e.fromBuffer=function(t,n,i,r){t=t||new Float32Array(n*i*4);var o=new vl(t,{width:n,height:i}),s=t instanceof Float32Array?Fs.FLOAT:Fs.UNSIGNED_BYTE;return new e(o,Object.assign(xl,r||{width:n,height:i,type:s}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ea[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Ea[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Ea[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ea[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Ea[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(fa()),_l=function(t){function e(e,n){var i=this,r=n||{},o=r.width,s=r.height;(i=t.call(this,o,s)||this).items=[],i.itemDirtyIds=[];for(var a=0;a<e;a++){var l=new bl;i.items.push(l),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return v(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof yl?this.addResourceAt(t[n],n):this.addResourceAt(y(t[n],e),n))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,i=e.realHeight;return t.resize(n,i),Promise.resolve(t)})),this._load},e}(yl),wl=function(t){function e(e,n){var i,r,o=this,s=n||{},a=s.width,l=s.height;return Array.isArray(e)?(i=e,r=e.length):r=e,o=t.call(this,r,{width:a,height:l})||this,i&&o.initFromArray(i,n),o}return v(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Bs.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,n){var i=this,r=i.length,o=i.itemDirtyIds,s=i.items,a=t.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var l=0;l<r;l++){var u=s[l];o[l]<u.dirtyId&&(o[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,e.format,e.type,u.resource.source))}return!0},e}(_l),Sl=function(t){function e(e){var n=this,i=e,r=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(n=t.call(this,r,o)||this).source=e,n.noSubImage=!1,n}return v(e,t),e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,_a||(_a=document.createElement("a")),_a.href=t;var n=(0,ya.parse)(_a.href),i=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&i&&n.protocol===e.protocol?"":"anonymous"}(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},e.prototype.upload=function(t,e,n,i){var r=t.gl,o=e.realWidth,s=e.realHeight;return i=i||this.source,r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===js.UNPACK),this.noSubImage||e.target!==r.TEXTURE_2D||n.width!==o||n.height!==s?(n.width=o,n.height=s,r.texImage2D(e.target,0,e.format,e.format,e.type,i)):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,e.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(n,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(yl),Al=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Sl),Ml=function(t){function e(n,i){var r=this,o=i||{},s=o.width,a=o.height,l=o.autoLoad,u=o.linkBaseTexture;if(n&&n.length!==e.SIDES)throw new Error("Invalid length. Got "+n.length+", expected 6");r=t.call(this,6,{width:s,height:a})||this;for(var c=0;c<e.SIDES;c++)r.items[c].target=Bs.TEXTURE_CUBE_MAP_POSITIVE_X+c;return r.linkBaseTexture=!1!==u,n&&r.initFromArray(n,i),!1!==l&&r.load(),r}return v(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Bs.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=Bs.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,n,i){for(var r=this.itemDirtyIds,o=0;o<e.SIDES;o++){var s=this.items[o];r[o]<s.dirtyId&&(s.valid&&s.resource?(s.resource.upload(t,s,i),r[o]=s.dirtyId):r[o]<-1&&(t.gl.texImage2D(s.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),r[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(_l),Tl=function(t){function e(e,n){var i=this;if(n=n||{},!(e instanceof HTMLImageElement)){var r=new Image;Sl.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}return i=t.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==n.createBitmap?n.createBitmap:da.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,i.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,void 0!==n.premultiplyAlpha&&(i.premultiplyAlpha=n.premultiplyAlpha),i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i}return v(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var i=e.source;e.url=i.src;var r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?r():(i.onload=r,i.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(e,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===js.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,n,i){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,i,this.bitmap),!this.preserveBitmap){var r=!0,o=n._glTextures;for(var s in o){var a=o[s];if(a!==i&&a.dirtyId!==n.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(Sl),El=function(t){function e(e,n){var i=this;return n=n||{},(i=t.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=e,i.scale=n.scale||1,i._overrideWidth=n.width,i._overrideHeight=n.height,i._resolve=null,i._crossorigin=n.crossorigin,i._load=null,!1!==n.autoLoad&&i.load(),i}return v(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;Sl.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,i=e.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var r=n*t.scale,o=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(r=t._overrideWidth||t._overrideHeight/i*n,o=t._overrideHeight||t._overrideWidth/n*i),r=Math.round(r),o=Math.round(o);var s=t.source;s.width=r,s.height=o,s._pixiId="canvas_"+d(),s.getContext("2d").drawImage(e,0,0,n,i,0,0,r,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(Sl),Pl=function(t){function e(n,i){var r=this;if(i=i||{},!(n instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof n&&(n=[n]);var s=n[0].src||n[0];Sl.crossOrigin(o,s,i.crossorigin);for(var a=0;a<n.length;++a){var l=document.createElement("source"),u=n[a],c=u.src,h=u.mime,d=(c=c||n[a]).split("?").shift().toLowerCase(),p=d.substr(d.lastIndexOf(".")+1);h=h||e.MIME_TYPES[p]||"video/"+p,l.src=c,l.type=h,o.appendChild(l)}n=o}return(r=t.call(this,n)||this).noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==i.autoPlay,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),!1!==i.autoLoad&&r.load(),r}return v(e,t),e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var n=rl.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(rl.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(rl.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&rl.shared.remove(this.update,this);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(rl.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(rl.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(Sl),Cl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Sl);ml.push(Tl,Cl,Al,Pl,El,vl,Ml,wl);var Il=function(){function t(t){this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),Rl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===js.UNPACK),n.width===e.width&&n.height===e.height?i.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(n.width=e.width,n.height=e.height,i.texImage2D(e.target,0,1===t.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(vl),Ol=function(){function t(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new fl("disposeFramebuffer"),this.multisample=Ys.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new bl(null,{scaleMode:Vs.NEAREST,resolution:1,mipmap:Us.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new bl(new Rl(null,{width:this.width,height:this.height}),{scaleMode:Vs.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Us.OFF,format:ks.DEPTH_COMPONENT,type:Fs.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var i=this.colorTextures[n],r=i.resolution;i.setSize(t/r,e/r)}this.depthTexture&&(r=this.depthTexture.resolution,this.depthTexture.setSize(t/r,e/r))}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),ql=function(t){function e(e){var n=this;"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n=t.call(this,null,e)||this;var i=e||{},r=i.width,o=i.height;return n.mipmap=0,n.width=Math.ceil(r)||100,n.height=Math.ceil(o)||100,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new Ol(n.width*n.resolution,n.height*n.resolution).addColorTexture(0,n),n.maskStack=[],n.filterStack=[{}],n}return v(e,t),e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(bl),Ll=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,n){var i=e.width,r=e.height;if(n){var o=t.width/2/i,s=t.height/2/r,a=t.x/i+o,l=t.y/r+s;n=Xa.add(n,Xa.NW),this.x0=a+o*Xa.uX(n),this.y0=l+s*Xa.uY(n),n=Xa.add(n,2),this.x1=a+o*Xa.uX(n),this.y1=l+s*Xa.uY(n),n=Xa.add(n,2),this.x2=a+o*Xa.uX(n),this.y2=l+s*Xa.uY(n),n=Xa.add(n,2),this.x3=a+o*Xa.uX(n),this.y3=l+s*Xa.uY(n)}else this.x0=t.x/i,this.y0=t.y/r,this.x1=(t.x+t.width)/i,this.y1=t.y/r,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/r,this.x3=t.x/i,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t}(),Dl=new Ll,zl=function(t){function e(n,i,r,o,s,a){var l=t.call(this)||this;if(l.noFrame=!1,i||(l.noFrame=!0,i=new Oa(0,0,1,1)),n instanceof e&&(n=n.baseTexture),l.baseTexture=n,l._frame=i,l.trim=o,l.valid=!1,l._uvs=Dl,l.uvMatrix=null,l.orig=r||i,l._rotate=Number(s||0),!0===s)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new ka(a.x,a.y):new ka(0,0),l._updateID=0,l.textureCacheIds=[],n.valid?l.noFrame?n.valid&&l.onBaseTextureUpdated(n):l.frame=i:n.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&n.on("update",l.onBaseTextureUpdated,l),l}return v(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture;n&&n.url&&Ta[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===Dl&&(this._uvs=new Ll),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,i){void 0===n&&(n={}),void 0===i&&(i=da.STRICT_TEXTURE_CACHE);var r="string"==typeof t,o=null;r?o=t:(t._pixiId||(t._pixiId="pixiid_"+d()),o=t._pixiId);var s=Ta[o];if(r&&i&&!s)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return s||(n.resolution||(n.resolution=f(t)),(s=new e(new bl(t,n))).baseTexture.cacheId=o,bl.addToCache(s.baseTexture,o),e.addToCache(s,o)),s},e.fromURL=function(t,n){var i=Object.assign({autoLoad:!1},null==n?void 0:n.resourceOptions),r=e.from(t,Object.assign({resourceOptions:i},n),!1),o=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):o.load().then((function(){return Promise.resolve(r)}))},e.fromBuffer=function(t,n,i,r){return new e(bl.fromBuffer(t,n,i,r))},e.fromLoader=function(t,n,i){var r=new Tl(t);r.url=n;var o=new e(new bl(r,{scaleMode:da.SCALE_MODE,resolution:f(n)}));return i||(i=n),bl.addToCache(o.baseTexture,i),e.addToCache(o,i),i!==n&&(bl.addToCache(o.baseTexture,n),e.addToCache(o,n)),o},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ta[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Ta[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Ta[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ta[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Ta[t.textureCacheIds[i]]===t&&delete Ta[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,i=t.width,r=t.height,o=e+i>this.baseTexture.width,s=n+r>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",l="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+n+" + "+r+" = "+(n+r)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+a+" "+u)}this.valid=i&&r&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(fa());zl.EMPTY=new zl(new bl),x(zl.EMPTY),x(zl.EMPTY.baseTexture),zl.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new zl(new bl(new Al(t)))}(),x(zl.WHITE),x(zl.WHITE.baseTexture);var kl,Bl,Fl=function(t){function e(e,n){var i=this,r=null;if(!(e instanceof ql)){var o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+s+") instead of the ctor directly."),r=arguments[0],n=null,e=new ql({width:o,height:s,scaleMode:a,resolution:l})}return(i=t.call(this,e,n)||this).legacyRenderer=r,i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return v(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,n&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new ql(t))},e}(zl),Vl=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e){var n=new ql(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Fl(n)},t.prototype.getOptimalTexture=function(e,n,i){void 0===i&&(i=1);var r=t.SCREEN_KEY;e*=i,n*=i,this.enableFullScreen&&e===this._pixelsWidth&&n===this._pixelsHeight||(r=(65535&(e=a(e)))<<16|65535&(n=a(n))),this.texturePool[r]||(this.texturePool[r]=[]);var o=this.texturePool[r].pop();return o||(o=this.createTexture(e,n)),o.filterPoolKey=r,o.setResolution(i),o},t.prototype.getFilterTexture=function(t,e){var n=this.getOptimalTexture(t.width,t.height,e||t.resolution);return n.filterFrame=t.filterFrame,n},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){var n=t.SCREEN_KEY,i=this.texturePool[n];if(this.enableFullScreen=e.width>0&&e.height>0,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[n]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},t.SCREEN_KEY="screen",t}(),Nl=function(){function t(t,e,n,i,r,o,s){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===i&&(i=5126),this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=r,this.start=o,this.instance=s}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,n,i,r,o){return new t(e,n,i,r,o)},t}(),Ul=0,jl=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=Ul++,this.disposeRunner=new fl("disposeBuffer")}return t.prototype.update=function(t){this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),Gl={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},Hl={5126:4,5123:2,5121:1},Wl=0,Xl={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Yl=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Wl++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new fl("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,n,i,r,o,s,a){if(void 0===n&&(n=0),void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof jl||(e instanceof Array&&(e=new Float32Array(e)),e=new jl(e));var l=t.split("|");if(l.length>1){for(var u=0;u<l.length;u++)this.addAttribute(l[u],e,n,i,r);return this}var c=this.buffers.indexOf(e);return-1===c&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Nl(c,n,i,r,o,s,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof jl||(t instanceof Array&&(t=new Uint16Array(t)),t=new jl(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],i=new jl;for(t in this.attributes){var r=this.attributes[t],o=this.buffers[r.buffer];e.push(o.data),n.push(r.size*Hl[r.type]/4),r.buffer=0}for(i.data=function(t,e){for(var n=0,i=0,r={},o=0;o<t.length;o++)i+=e[o],n+=t[o].length;var s=new ArrayBuffer(4*n),a=null,l=0;for(o=0;o<t.length;o++){var u=e[o],c=t[o],h=b(c);r[h]||(r[h]=new Gl[h](s)),a=r[h];for(var d=0;d<c.length;d++)a[(d/u|0)*i+l+d%u]=c[d];l+=u}return new Float32Array(s)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,n=0;n<this.buffers.length;n++)e.buffers[n]=new jl(this.buffers[n].data.slice(0));for(var n in this.attributes){var i=this.attributes[n];e.attributes[n]=new Nl(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},t.merge=function(e){for(var n,i=new t,r=[],o=[],s=[],a=0;a<e.length;a++){n=e[a];for(var l=0;l<n.buffers.length;l++)o[l]=o[l]||0,o[l]+=n.buffers[l].data.length,s[l]=0}for(a=0;a<n.buffers.length;a++)r[a]=new(Xl[b(n.buffers[a].data)])(o[a]),i.buffers[a]=new jl(r[a]);for(a=0;a<e.length;a++)for(n=e[a],l=0;l<n.buffers.length;l++)r[l].set(n.buffers[l].data,s[l]),s[l]+=n.buffers[l].data.length;if(i.attributes=n.attributes,n.indexBuffer){i.indexBuffer=i.buffers[n.buffers.indexOf(n.indexBuffer)],i.indexBuffer.index=!0;var u=0,c=0,h=0,d=0;for(a=0;a<n.buffers.length;a++)if(n.buffers[a]!==n.indexBuffer){d=a;break}for(var a in n.attributes){var p=n.attributes[a];(0|p.buffer)===d&&(c+=p.size*Hl[p.type]/4)}for(a=0;a<e.length;a++){var f=e[a].indexBuffer.data;for(l=0;l<f.length;l++)i.indexBuffer.data[l+h]+=u;u+=n.buffers[d].data.length/c,h+=f.length}}return i},t}(),Zl=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return v(e,t),e}(Yl),Ql=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new jl(e.vertices),e.uvBuffer=new jl(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return v(e,t),e.prototype.map=function(t,e){var n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Yl),Jl=0,Kl=function(){function t(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Jl++,this.static=!!e}return t.prototype.update=function(){this.dirtyId++},t.prototype.add=function(e,n,i){this.uniforms[e]=new t(n,i)},t.from=function(e,n){return new t(e,n)},t}(),$l=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Oa,this.destinationFrame=new Oa,this.filters=[]}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),tu=function(t){function e(e){var n=t.call(this,e)||this;return n.defaultFilterStack=[{}],n.texturePool=new Vl,n.texturePool.setScreenSize(e.view),n.statePool=[],n.quad=new Zl,n.quadUv=new Ql,n.tempRect=new Oa,n.activeState={},n.globalUniforms=new Kl({outputFrame:n.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),n.forceClear=!1,n.useMaxPadding=!1,n}return v(e,t),e.prototype.push=function(t,e){for(var n=this.renderer,i=this.defaultFilterStack,r=this.statePool.pop()||new $l,o=e[0].resolution,s=e[0].padding,a=e[0].autoFit,l=e[0].legacy,u=1;u<e.length;u++){var c=e[u];o=Math.min(o,c.resolution),s=this.useMaxPadding?Math.max(s,c.padding):s+c.padding,a=a||c.autoFit,l=l||c.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=n.renderTexture.current),i.push(r),r.resolution=o,r.legacy=l,r.target=t,r.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),r.sourceFrame.pad(s),a&&r.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),r.sourceFrame.ceil(o),r.renderTexture=this.getOptimalFilterTexture(r.sourceFrame.width,r.sourceFrame.height,o),r.filters=e,r.destinationFrame.width=r.renderTexture.width,r.destinationFrame.height=r.renderTexture.height;var h=this.tempRect;h.width=r.sourceFrame.width,h.height=r.sourceFrame.height,r.renderTexture.filterFrame=r.sourceFrame,n.renderTexture.bind(r.renderTexture,r.sourceFrame,h),n.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var r=i.inputSize,o=i.inputPixel,s=i.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],o[0]=r[0]*e.resolution,o[1]=r[1]*e.resolution,o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=e.sourceFrame.width*r[2]-.5*o[2],s[3]=e.sourceFrame.height*r[3]-.5*o[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var l=t[t.length-1];if(e.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,l.renderTexture,Gs.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,c=this.getOptimalFilterTexture(u.width,u.height,e.resolution);c.filterFrame=u.filterFrame;var h=0;for(h=0;h<n.length-1;++h){n[h].apply(this,u,c,Gs.CLEAR,e);var d=u;u=c,c=d}n[h].apply(this,u,l.renderTexture,Gs.BLEND,e),this.returnFilterTexture(u),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)},e.prototype.bindAndClear=function(t,e){if(void 0===e&&(e=Gs.CLEAR),t&&t.filterFrame){var n=this.tempRect;n.width=t.filterFrame.width,n.height=t.filterFrame.height,this.renderer.renderTexture.bind(t,t.filterFrame,n)}else this.renderer.renderTexture.bind(t);"boolean"==typeof e&&(e=e?Gs.CLEAR:Gs.BLEND,p("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(e===Gs.CLEAR||e===Gs.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},e.prototype.applyFilter=function(t,e,n,i){var r=this.renderer;this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.state.set(t.state),r.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(zs.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(zs.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,i=n.sourceFrame,r=n.destinationFrame,o=e._texture.orig,s=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(Fa.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,n){return void 0===n&&(n=1),this.texturePool.getOptimalTexture(t,e,n)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var n=t;t=e,e=n}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(Il),eu=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),nu=function(t){function e(e){var n=t.call(this,e)||this;return n.emptyRenderer=new eu(e),n.currentRenderer=n.emptyRenderer,n}return v(e,t),e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i)},e.prototype.boundArray=function(t,e,n,i){for(var r=t.elements,o=t.ids,s=t.count,a=0,l=0;l<s;l++){var u=r[l],c=u._batchLocation;if(c>=0&&c<i&&e[c]===u)o[l]=c;else for(;a<i;){var h=e[a];if(!h||h._batchEnabled!==n||h._batchLocation!==a){o[l]=a,u._batchLocation=a,e[a]=u;break}a++}}},e}(Il),iu=0,ru=function(t){function e(e){var n=t.call(this,e)||this;return n.webGLVersion=1,n.extensions={},n.supports={uint32Indices:!1},n.handleContextLost=n.handleContextLost.bind(n),n.handleContextRestored=n.handleContextRestored.bind(n),e.view.addEventListener("webglcontextlost",n.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",n.handleContextRestored,!1),n}return v(e,t),Object.defineProperty(e.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=iu++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=iu++,this.renderer.runners.contextChange.emit(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var n;if(da.PREFER_ENV>=Os.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var e="WebGL2RenderingContext"in window&&t instanceof window.WebGL2RenderingContext||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=e,e||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},e}(Il),ou=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=Ys.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},su=new Oa,au=function(t){function e(e){var n=t.call(this,e)||this;return n.managedFramebuffers=[],n.unknownFramebuffer=new Ol(10,10),n.msaaSamples=null,n}return v(e,t),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Oa,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;da.PREFER_ENV===Os.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},e.prototype.bind=function(t,e){var n=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var r=0;r<t.colorTextures.length;r++){var o=t.colorTextures[r];this.renderer.texture.unbind(o.parentTextureArray||o)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,n,i){var r=this.viewport;r.width===n&&r.height===i&&r.x===t&&r.y===e||(r.x=t,r.y=e,r.width=n,r.height=i,this.gl.viewport(t,e,n,i))},Object.defineProperty(e.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),e.prototype.clear=function(t,e,n,i,r){void 0===r&&(r=Ls.COLOR|Ls.DEPTH);var o=this.gl;o.clearColor(t,e,n,i),o.clear(r)},e.prototype.initFramebuffer=function(t){var e=this.gl,n=new ou(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},e.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var i=t.colorTextures,r=0;r<i.length;r++)this.renderer.texture.bind(i[r],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures.length;e.drawBuffers||(i=Math.min(i,1)),n.multisample>1&&(n.msaaBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,n.msaaBuffer));for(var r=[],o=0;o<i;o++)if(!(0===o&&n.multisample>1)){var s=t.colorTextures[o],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,s.target,a._glTextures[this.CONTEXT_UID].texture,0),r.push(e.COLOR_ATTACHMENT0+o)}if(r.length>1&&e.drawBuffers(r),t.depthTexture&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,0)}n.stencil||!t.stencil&&!t.depth||(n.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,n.stencil))},e.prototype.detectSamples=function(t){var e=this.msaaSamples,n=Ys.NONE;if(t<=1||null===e)return n;for(var i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break}return 1===n&&(n=Ys.NONE),n},e.prototype.blit=function(t,e,n){var i=this,r=i.current,o=i.renderer,s=i.gl,a=i.CONTEXT_UID;if(2===o.context.webGLVersion&&r){var l=r.glFramebuffers[a];if(l){if(!t){if(l.multisample<=1)return;l.blitFramebuffer||(l.blitFramebuffer=new Ol(r.width,r.height),l.blitFramebuffer.addColorTexture(0,r.colorTextures[0])),(t=l.blitFramebuffer).width=r.width,t.height=r.height}e||((e=su).width=r.width,e.height=r.height),n||(n=e);var u=e.width===n.width&&e.height===n.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,l.framebuffer),s.blitFramebuffer(e.x,e.y,e.width,e.height,n.x,n.y,n.width,n.height,s.COLOR_BUFFER_BIT,u?s.NEAREST:s.LINEAR)}}},e.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.stencil&&i.deleteRenderbuffer(n.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var n=t.width,i=t.height,r=this.gl,o=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,o),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,n,i),e.stencil=o,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,o)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Oa},e}(Il),lu=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},uu={5126:4,5123:2,5121:1},cu=function(t){function e(e){var n=t.call(this,e)||this;return n._activeGeometry=null,n._activeVao=null,n.hasVao=!0,n.hasInstance=!0,n.canUseUInt32ElementIndex=!1,n.managedGeometries={},n.managedBuffers={},n}return v(e,t),e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var n=this.renderer.context.extensions.vertexArrayObject;da.PREFER_ENV===Os.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(!t.vertexAttribDivisor){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,r,o){return i.drawElementsInstancedANGLE(t,e,n,r,o)},t.drawArraysInstanced=function(t,e,n,r){return i.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={});var r=i[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==r&&(this._activeVao=r,this.hasVao?n.bindVertexArray(r):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,n=0;n<t.buffers.length;n++){var i=t.buffers[n],r=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==r.updateID){r.updateID=i._updateID;var o=i.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(o,r.buffer),this._boundBuffer=r,r.byteLength>=i.data.byteLength)e.bufferSubData(o,0,i.data);else{var s=i.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=i.data.byteLength,e.bufferData(o,i.data,s)}}}},e.prototype.checkCompatibility=function(t,e){var n=t.attributes,i=e.attributeData;for(var r in i)if(!n[r])throw new Error('shader and geometry incompatible, geometry missing the "'+r+'" attribute')},e.prototype.getSignature=function(t,e){var n=t.attributes,i=e.attributeData,r=["g",t.id];for(var o in n)i[o]&&r.push(o);return r.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var n=this.gl,i=this.CONTEXT_UID,r=this.getSignature(t,e),o=t.glVertexArrayObjects[this.CONTEXT_UID],s=o[r];if(s)return o[e.id]=s,s;var a=t.buffers,l=t.attributes,u={},c={};for(var h in a)u[h]=0,c[h]=0;for(var h in l)!l[h].size&&e.attributeData[h]?l[h].size=e.attributeData[h].size:l[h].size||console.warn("PIXI Geometry attribute '"+h+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[l[h].buffer]+=l[h].size*uu[l[h].type];for(var h in l){var d=l[h],p=d.size;void 0===d.stride&&(u[d.buffer]===p*uu[d.type]?d.stride=0:d.stride=u[d.buffer]),void 0===d.start&&(d.start=c[d.buffer],c[d.buffer]+=p*uu[d.type])}s=n.createVertexArray(),n.bindVertexArray(s);for(var f=0;f<a.length;f++){var m=a[f];m._glBuffers[i]||(m._glBuffers[i]=new lu(n.createBuffer()),this.managedBuffers[m.id]=m,m.disposeRunner.add(this)),m._glBuffers[i].refCount++}return this.activateVao(t,e),this._activeVao=s,o[e.id]=s,o[r]=s,s},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var n=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,r=t.buffers;if(t.disposeRunner.remove(this),n){for(var o=0;o<r.length;o++){var s=r[o]._glBuffers[this.CONTEXT_UID];s.refCount--,0!==s.refCount||e||this.disposeBuffer(r[o],e)}if(!e)for(var a in n)if("g"===a[0]){var l=n[a];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t);for(e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.disposeBuffer(this.managedBuffers[e[n]],t)},e.prototype.activateVao=function(t,e){var n=this.gl,i=this.CONTEXT_UID,r=t.buffers,o=t.attributes;t.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[i].buffer);var s=null;for(var a in o){var l=o[a],u=r[l.buffer]._glBuffers[i];if(e.attributeData[a]){s!==u&&(n.bindBuffer(n.ARRAY_BUFFER,u.buffer),s=u);var c=e.attributeData[a].location;if(n.enableVertexAttribArray(c),n.vertexAttribPointer(c,l.size,l.type||n.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(c,1)}}}},e.prototype.draw=function(t,e,n,i){var r=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?r.UNSIGNED_SHORT:r.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?r.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(n||0)*s,i||1):r.drawElements(t,e||o.indexBuffer.data.length,a,(n||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?r.drawArraysInstanced(t,n,e||o.getSize(),i||1):r.drawArrays(t,n,e||o.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(Il),hu=function(){function t(t){void 0===t&&(t=null),this.type=Xs.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Xs.NONE,this.autoDetect=!0),this._target=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}(),du={},pu=du,fu={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},mu=null,gu={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},yu=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],vu={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},xu={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},bu=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n"),_u=0,wu={},Su=function(){function t(e,n,i){void 0===i&&(i="pixi-shader"),this.id=_u++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),wu[i]?(wu[i]++,i+="-"+wu[i]):wu[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=T(this.vertexSrc,da.PRECISION_VERTEX,Ws.HIGH),this.fragmentSrc=T(this.fragmentSrc,da.PRECISION_FRAGMENT,function(){if(!kl){kl=Ws.MEDIUM;var t=M();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);kl=e.precision?Ws.HIGH:Ws.MEDIUM}}return kl}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return t.prototype.extractData=function(t,e){var n=M();if(n){var i=w(n,t,e);this.attributeData=this.getAttributeData(i,n),this.uniformData=this.getUniformData(i,n),n.deleteProgram(i)}else this.uniformData={},this.attributeData={}},t.prototype.getAttributeData=function(t,e){for(var n={},i=[],r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var s=e.getActiveAttrib(t,o),a=P(e,s.type),l={type:a,name:s.name,size:E(a),location:0};n[s.name]=l,i.push(l)}for(i.sort((function(t,e){return t.name>e.name?1:-1})),o=0;o<i.length;o++)i[o].location=o;return n},t.prototype.getUniformData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var o=e.getActiveUniform(t,r),s=o.name.replace(/\[.*?\]$/,""),a=o.name.match(/\[.*?\]$/),l=P(e,o.type);n[s]={type:l,size:o.size,isArray:a,value:A(l,o.size)}}return n},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,n,i){var r=e+n,o=Ma[r];return o||(Ma[r]=o=new t(e,n,i)),o},t}(),Au=function(){function t(t,e){for(var n in this.program=t,this.uniformGroup=e?e instanceof Kl?e:new Kl(e):new Kl({}),t.uniformData)this.uniformGroup.uniforms[n]instanceof Array&&(this.uniformGroup.uniforms[n]=new Float32Array(this.uniformGroup.uniforms[n]))}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,n,i){return new t(Su.from(e,n),i)},t}(),Mu=function(){function t(){this.data=0,this.blendMode=Ds.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==Ds.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Tu=function(t){function e(n,i,r){var o=this,s=Su.from(n||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(o=t.call(this,s,r)||this).padding=0,o.resolution=da.FILTER_RESOLUTION,o.enabled=!0,o.autoFit=!0,o.legacy=!!o.program.attributeData.aTextureCoord,o.state=new Mu,o}return v(e,t),e.prototype.apply=function(t,e,n,i,r){t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Au),Eu=new Fa,Pu=function(){function t(t,e){this._texture=t,this.mapCoord=new Fa,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,i=0;i<t.length;i+=2){var r=t[i],o=t[i+1];e[i]=r*n.a+o*n.c+n.tx,e[i+1]=r*n.b+o*n.d+n.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var i=e.orig,r=e.trim;r&&(Eu.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Eu));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,l=this.clampOffset;return s[0]=(e._frame.x+a+l)/o.width,s[1]=(e._frame.y+a+l)/o.height,s[2]=(e._frame.x+e._frame.width-a+l)/o.width,s[3]=(e._frame.y+e._frame.height-a+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},t}(),Cu=function(t){function e(e){var n=this,i=new Fa;return n=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,e.renderable=!1,n.maskSprite=e,n.maskMatrix=i,n}return v(e,t),e.prototype.apply=function(t,e,n,i){var r=this.maskSprite,o=r._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Pu(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i))},e}(Tu),Iu=function(t){function e(e){var n=t.call(this,e)||this;return n.enableScissor=!1,n.alphaMaskPool=[],n.maskDataPool=[],n.maskStack=[],n.alphaMaskIndex=0,n}return v(e,t),e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){var n=e;if(!n.isMaskData){var i=this.maskDataPool.pop()||new hu;i.pooled=!0,i.maskObject=e,n=i}switch(n.autoDetect&&this.detect(n),n.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),n._target=t,n.type){case Xs.SCISSOR:this.maskStack.push(n),this.renderer.scissor.push(n);break;case Xs.STENCIL:this.maskStack.push(n),this.renderer.stencil.push(n);break;case Xs.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n),this.maskStack.push(n)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Xs.SCISSOR:this.renderer.scissor.pop();break;case Xs.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Xs.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Xs.SPRITE;else if(t.type=Xs.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var n=e.worldTransform,i=Math.atan2(n.b,n.a),r=Math.atan2(n.d,n.c);i=Math.round(i*(180/Math.PI)*100),r=((r=Math.round(r*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0==(i=(i%9e3+9e3)%9e3)&&9e3===r&&(t.type=Xs.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,n=t._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Cu(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var r=n.filterArea;n.filterArea=e.getBounds(!0),this.renderer.filter.push(n,i),n.filterArea=r,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(Il),Ru=function(t){function e(e){var n=t.call(this,e)||this;return n.maskStack=[],n.glConst=0,n}return v(e,t),e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==n&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.maskStack=null},e}(Il),Ou=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.SCISSOR_TEST,n}return v(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var n=t._scissorRect,i=e.getBounds(!0),r=this.renderer.gl;e.renderable=!1,n?i.fit(n):r.enable(r.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=i,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,n=this.renderer.projection,i=n.transform,r=n.sourceFrame,o=n.destinationFrame,s=e?e.resolution:this.renderer.resolution,a=(t.x-r.x)*s+o.x,l=(t.y-r.y)*s+o.y,u=t.width*s,c=t.height*s;i&&(a+=i.tx*s,l+=i.ty*s),e||(l=this.renderer.height-c-l),this.renderer.gl.scissor(a,l,u,c)},e}(Ru),qu=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.STENCIL_TEST,n}return v(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,i,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Ru),Lu=function(t){function e(e){var n=t.call(this,e)||this;return n.destinationFrame=null,n.sourceFrame=null,n.defaultFrame=null,n.projectionMatrix=new Fa,n.transform=null,n}return v(e,t),e.prototype.update=function(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);var r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,n,i){var r=this.projectionMatrix,o=i?-1:1;r.identity(),r.a=1/e.width*2,r.d=o*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-o-e.y*r.d},e.prototype.setTransform=function(t){},e}(Il),Du=new Oa,zu=new Oa,ku=new Oa,Bu=function(t){function e(e){var n=t.call(this,e)||this;return n.clearColor=e._backgroundColorRgba,n.defaultMaskStack=[],n.current=null,n.sourceFrame=new Oa,n.destinationFrame=new Oa,n}return v(e,t),e.prototype.bind=function(t,e,n){void 0===t&&(t=null);var i,r,o,s=this.renderer;this.current=t,t?(o=(i=t.baseTexture).resolution,e||(Du.width=t.frame.width,Du.height=t.frame.height,e=Du),n||(zu.x=t.frame.x,zu.y=t.frame.y,zu.width=e.width,zu.height=e.height,n=zu),r=i.framebuffer):(o=s.resolution,e||(Du.width=s.screen.width,Du.height=s.screen.height,e=Du),n||((n=Du).width=e.width,n.height=e.height)),ku.x=n.x*o,ku.y=n.y*o,ku.width=n.width*o,ku.height=n.height*o,this.renderer.framebuffer.bind(r,ku),this.renderer.projection.update(n,e,o,!r),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},e.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e)},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Il),Fu=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},t}(),Vu=0,Nu={textureCount:0},Uu=function(t){function e(e){var n=t.call(this,e)||this;return n.destroyed=!1,n.systemCheck(),n.gl=null,n.shader=null,n.program=null,n.cache={},n.id=Vu++,n}return v(e,t),e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Bl)return Bl;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Bl=!0===t({a:"b"},"a","b")}catch(t){Bl=!1}return Bl}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(Nu.textureCount=0,this.syncUniformGroup(t.uniformGroup,Nu)),i},e.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var n=this.getglProgram();t.static&&t.dirtyId===n.uniformGroups[t.id]||(n.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},e.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var n=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in t.uniforms){var r=e[i];if(r){for(var o=t.uniforms[i],s=!1,a=0;a<yu.length;a++)if(yu[a].test(r,o)){n.push(yu[a].code(i,o)),s=!0;break}if(!s){var l=(1===r.size?vu:xu)[r.type].replace("location",'ud["'+i+'"].location');n.push('\n            cv = ud["'+i+'"].value;\n            v = uv["'+i+'"];\n            '+l+";")}}else t.uniforms[i].group&&n.push('\n                    renderer.shader.syncUniformGroup(uv["'+i+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var n=t.uniforms,i=[];for(var r in n)i.push(r),e[r]&&i.push(e[r].type);return i.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,n=t.program,i={};for(var r in n.attributeData)i[r]=n.attributeData[r].location;var o=w(e,n.vertexSrc,n.fragmentSrc,i),s={};for(var r in n.uniformData){var a=n.uniformData[r];s[r]={location:e.getUniformLocation(o,r),value:A(a.type,a.size)}}var l=new Fu(o,s);return n.glPrograms[this.renderer.CONTEXT_UID]=l,l},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Il),ju=function(t){function e(e){var n=t.call(this,e)||this;return n.gl=null,n.stateId=0,n.polygonOffset=0,n.blendMode=Ds.NONE,n._blendEq=!1,n.map=[],n.map[0]=n.setBlend,n.map[1]=n.setOffset,n.map[2]=n.setCullFace,n.map[3]=n.setDepthTest,n.map[4]=n.setFrontFace,n.checks=[],n.defaultState=new Mu,n.defaultState.blend=!0,n}return v(e,t),e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Ds.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.ADD]=[t.ONE,t.ONE],e[Ds.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.NONE]=[0,0],e[Ds.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Ds.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ds.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Ds.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Ds.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ds.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Ds.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Ds.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Ds.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Ds.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ds.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},e}(Il),Gu=function(t){function e(e){var n=t.call(this,e)||this;return n.count=0,n.checkCount=0,n.maxIdle=da.GC_MAX_IDLE,n.checkCountMax=da.GC_MAX_CHECK_COUNT,n.mode=da.GC_MODE,n}return v(e,t),e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Hs.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,i=0;i<e.length;i++){var r=e[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[i]=null,n=!0)}if(n){var o=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[o++]=e[i]);e.length=o}},e.prototype.unload=function(t){var e,n=this.renderer.texture;(null===(e=t._texture)||void 0===e?void 0:e.framebuffer)&&n.destroyTexture(t._texture);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},e}(Il),Hu=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},Wu=function(t){function e(e){var n=t.call(this,e)||this;return n.boundTextures=[],n.currentLocation=-1,n.managedTextures=[],n._unknownBoundTextures=!1,n.unknownTexture=new bl,n}return v(e,t),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var i=new Hu(t.createTexture());for(t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Hu(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture),n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);for(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),n=0;n<this.boundTextures.length;n++)this.bind(null,n)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if(t){if((t=t.castToBaseTexture()).parentTextureArray)return;if(t.valid){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),n[i]=null)},e.prototype.initTexture=function(t){var e=new Hu(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var n=this.renderer.gl;t.type===n.FLOAT&&t.format===n.RGBA&&(e.internalFormat=n.RGBA32F),t.type===Fs.HALF_FLOAT&&(e.type=n.HALF_FLOAT),e.type===n.HALF_FLOAT&&t.format===n.RGBA&&(e.internalFormat=n.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e));else{var i=t.realWidth,r=t.realHeight,o=n.gl;(e.width!==i||e.height!==r||e.dirtyId<0)&&(e.width=i,e.height=r,o.texImage2D(t.target,0,e.internalFormat,i,r,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&c(this.managedTextures,i,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==Us.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Ns.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Vs.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Vs.LINEAR){var r=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Vs.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Vs.LINEAR?n.LINEAR:n.NEAREST)},e}(Il),Xu=new Fa,Yu=function(t){function i(e,n){void 0===e&&(e=qs.UNKNOWN);var i=t.call(this)||this;return(n=Object.assign({},da.RENDER_OPTIONS,n)).roundPixels&&(da.ROUND_PIXELS=n.roundPixels,p("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),i.options=n,i.type=e,i.screen=new Oa(0,0,n.width,n.height),i.view=n.view||document.createElement("canvas"),i.resolution=n.resolution||da.RESOLUTION,i.transparent=n.transparent,i.autoDensity=n.autoDensity||n.autoResize||!1,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,0],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i._lastObjectRendered=null,i.plugins={},i}return v(i,t),i.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(i.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),i.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px"),this.emit("resize",t,e)},i.prototype.generateTexture=function(t,e,n,i){0===(i=i||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var r=Fl.create({width:0|i.width,height:0|i.height,scaleMode:e,resolution:n});return Xu.tx=-i.x,Xu.ty=-i.y,this.render(t,r,!1,Xu,!!t.parent),r},i.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=qs.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(i.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=n(t),e(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),i}(fa()),Zu=function(t){function e(n){var i=t.call(this,qs.WEBGL,n)||this;return n=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new fl("destroy"),contextChange:new fl("contextChange"),reset:new fl("reset"),update:new fl("update"),postrender:new fl("postrender"),prerender:new fl("prerender"),resize:new fl("resize")},i.globalUniforms=new Kl({projectionMatrix:new Fa},!0),i.addSystem(Iu,"mask").addSystem(ru,"context").addSystem(ju,"state").addSystem(Uu,"shader").addSystem(Wu,"texture").addSystem(cu,"geometry").addSystem(au,"framebuffer").addSystem(Ou,"scissor").addSystem(qu,"stencil").addSystem(Lu,"projection").addSystem(Gu,"textureGC").addSystem(tu,"filter").addSystem(Bu,"renderTexture").addSystem(nu,"batch"),i.initPlugins(e.__plugins),n.context?i.context.initFromContext(n.context):i.context.initFromOptions({alpha:!!i.transparent,antialias:n.antialias,premultipliedAlpha:i.transparent&&"notMultiplied"!==i.transparent,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,function(t){var e;if(!xa){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 5.3.3 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,n)}else window.console&&window.console.log("PixiJS 5.3.3 - "+t+" - http://www.pixijs.com/");xa=!0}}(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return v(e,t),e.create=function(t){if(void 0===va&&(va=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:da.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var r=n.getExtension("WEBGL_lose_context");r&&r.loseContext()}return n=null,i}catch(t){return!1}}()),va)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=n,this.runners)this.runners[i].add(n);return this},e.prototype.render=function(t,e,n,i,r){if(this.renderingToScreen=!e,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(e||(this._lastObjectRendered=t),!r){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.emit(e,n)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(Yu),Qu="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Ju=function(){this.texArray=null,this.blend=0,this.type=zs.TRIANGLES,this.start=0,this.size=0,this.data=null},Ku=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),$u=function(){function t(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),tc=function(t){function e(e){var n=t.call(this,e)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=Mu.for2d(),n.size=4*da.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),e.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return v(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;da.PREFER_ENV===Os.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),da.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var i=bu.replace(/%forloop%/gi,C(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Ju);for(;n.length<r;)n.push(new Ku);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,i=e._textureArrayPool,r=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++bl._globalBatch,l=0,u=i[0],c=0;r.copyBoundTextures(o,n);for(var h=0;h<this._bufferSize;++h){var d=t[h];t[h]=null,d._batchEnabled!==a&&(u.count>=n&&(r.boundArray(u,o,a,n),this.buildDrawCalls(u,c,h),c=h,u=i[++l],++a),d._batchEnabled=a,d.touched=s,u.elements[u.count++]=d)}for(u.count>0&&(r.boundArray(u,o,a,n),this.buildDrawCalls(u,c,this._bufferSize),++l,++a),h=0;h<o.length;h++)o[h]=null;bl._globalBatch=a},e.prototype.buildDrawCalls=function(t,n,i){var r=this,o=r._bufferedElements,s=r._attributeBuffer,a=r._indexBuffer,l=r.vertexSize,u=e._drawCallPool,c=this._dcIndex,h=this._aIndex,d=this._iIndex,p=u[c];p.start=this._iIndex,p.texArray=t;for(var f=n;f<i;++f){var m=o[f],g=m._texture.baseTexture,y=ba[g.alphaMode?1:0][m.blendMode];o[f]=null,n<f&&p.blend!==y&&(p.size=d-p.start,n=f,(p=u[++c]).texArray=t,p.start=d),this.packInterleavedGeometry(m,s,a,h,d),h+=m.vertexData.length/2*l,d+=m.indices.length,p.blend=y}n<i&&(p.size=d-p.start,++c),this._dcIndex=c,this._aIndex=h,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,n=t._attributeBuffer,i=t._indexBuffer;da.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,i=n.gl,r=n.state,o=e._drawCallPool,s=null,a=0;a<t;a++){var l=o[a],u=l.texArray,c=l.type,h=l.size,d=l.start,p=l.blend;s!==u&&(s=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,r.set(this.state),i.drawElements(c,h,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),da.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=a(Math.ceil(t/8)),n=u(e),i=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new $u(i*this.vertexSize*4)),r},e.prototype.getIndexBuffer=function(t){var e=a(Math.ceil(t/12)),n=u(e),i=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._iBuffers[n];return r||(this._iBuffers[n]=r=new Uint16Array(i)),r},e.prototype.packInterleavedGeometry=function(t,e,n,i,r){for(var s=e.uint32View,a=e.float32View,l=i/this.vertexSize,u=t.uvs,c=t.indices,h=t.vertexData,d=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),f=p<1&&t._texture.baseTexture.alphaMode?o(t._tintRGB,p):t._tintRGB+(255*p<<24),m=0;m<h.length;m+=2)a[i++]=h[m],a[i++]=h[m+1],a[i++]=u[m],a[i++]=u[m+1],s[i++]=f,a[i++]=d;for(m=0;m<c.length;m++)n[r++]=l+c[m]},e._drawCallPool=[],e._textureArrayPool=[],e}(eu),ec=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=Kl.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Su(this.vertexSrc,i)}var r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Fa,default:this.defaultGroupCache[t]};return new Au(this.programCache[t],r)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return(e+="\n")+"\n"},t}(),nc=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n._buffer=new jl(null,e,!1),n._indexBuffer=new jl(null,e,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,Fs.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,Fs.FLOAT).addAttribute("aColor",n._buffer,4,!0,Fs.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,Fs.FLOAT).addIndex(n._indexBuffer),n}return v(e,t),e}(Yl),ic="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",rc="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",oc=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:ic,fragment:rc,geometryClass:nc,vertexSize:6},t),n=e.vertex,i=e.fragment,r=e.vertexSize,o=e.geometryClass;return function(t){function e(e){var s=t.call(this,e)||this;return s.shaderGenerator=new ec(n,i),s.geometryClass=o,s.vertexSize=r,s}return v(e,t),e}(tc)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return ic},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return rc},enumerable:!1,configurable:!0}),t}(),sc=oc.create(),ac=function(){function t(e){var n=this;e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return Zu.create(t)}(e),this.stage=new $a,t._plugins.forEach((function(t){t.init.call(n,e)}))}return t.registerPlugin=function(e){t._plugins.push(e)},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,n){var i=this,r=t._plugins.slice(0);r.reverse(),r.forEach((function(t){t.destroy.call(i)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null},t}();ac._plugins=[];var lc=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===window)t=window.innerWidth,n=window.innerHeight;else{var i=e._resizeTo;t=i.clientWidth,n=i.clientHeight}e.renderer.resize(t,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t}();ac.registerPlugin(lc);var uc=new Oa,cc=function(){function t(t){this.renderer=t,t.extract=this}return t.prototype.image=function(t,e,n){var i=new Image;return i.src=this.base64(t,e,n),i},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},t.prototype.canvas=function(e){var n,i,r,o=this.renderer,s=!1,a=!1;e&&(e instanceof Fl?r=e:(r=this.renderer.generateTexture(e),a=!0)),r?(n=r.baseTexture.resolution,i=r.frame,s=!1,o.renderTexture.bind(r)):(n=this.renderer.resolution,s=!0,(i=uc).width=this.renderer.width,i.height=this.renderer.height,o.renderTexture.bind(null));var l=Math.floor(i.width*n+1e-4),u=Math.floor(i.height*n+1e-4),c=new Pa(l,u,1),h=new Uint8Array(4*l*u),d=o.gl;d.readPixels(i.x*n,i.y*n,l,u,d.RGBA,d.UNSIGNED_BYTE,h);var p=c.context.getImageData(0,0,l,u);if(t.arrayPostDivide(h,p.data),c.context.putImageData(p,0,0),s){var f=new Pa(c.width,c.height,1);f.context.scale(1,-1),f.context.drawImage(c.canvas,0,-u),c.destroy(),c=f}return a&&r.destroy(!0),c.canvas},t.prototype.pixels=function(e){var n,i,r,o=this.renderer,s=!1;e&&(e instanceof Fl?r=e:(r=this.renderer.generateTexture(e),s=!0)),r?(n=r.baseTexture.resolution,i=r.frame,o.renderTexture.bind(r)):(n=o.resolution,(i=uc).width=o.width,i.height=o.height,o.renderTexture.bind(null));var a=i.width*n,l=i.height*n,u=new Uint8Array(4*a*l),c=o.gl;return c.readPixels(i.x*n,i.y*n,a,l,c.RGBA,c.UNSIGNED_BYTE,u),s&&r.destroy(!0),t.arrayPostDivide(u,u),u},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var i=e[n+3]=t[n+3];0!==i?(e[n]=Math.round(Math.min(255*t[n]/i,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/i,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/i,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},t}(),hc=t(9571),dc=t.n(hc),pc=t(2940),fc=t.n(pc),mc={},gc=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),yc=null,vc=function(){function t(e,n,i){if("string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=D,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new(fc()),this.onProgress=new(fc()),this.onComplete=new(fc()),this.onAfterMiddleware=new(fc())}t.setExtensionLoadType=function(e,n){z(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){z(t._xhrTypeMap,e,n)};var e=t.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(n)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:gc&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return 0!=(this._flags&t)},e._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},e._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},e._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=n,i},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(k(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(k(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(k(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var e=this.xhr,n="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===i&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2==(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(n,"text/xml")}else{var o=document.createElement("div");o.innerHTML=n,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},e._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,yc||(yc=document.createElement("a")),yc.href=t;var n=!(t=dc()(yc.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,i=t.protocol?t.protocol+":":"";return t.host===e.hostname&&n&&i===e.protocol?"":"anonymous"},e._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var i=t.indexOf("?"),r=t.indexOf("#"),o=Math.min(i>-1?i:t.length,r>-1?r:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},e._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},L(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();vc.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},vc.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},vc.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},vc.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},vc._loadTypeMap={gif:vc.LOAD_TYPE.IMAGE,png:vc.LOAD_TYPE.IMAGE,bmp:vc.LOAD_TYPE.IMAGE,jpg:vc.LOAD_TYPE.IMAGE,jpeg:vc.LOAD_TYPE.IMAGE,tif:vc.LOAD_TYPE.IMAGE,tiff:vc.LOAD_TYPE.IMAGE,webp:vc.LOAD_TYPE.IMAGE,tga:vc.LOAD_TYPE.IMAGE,svg:vc.LOAD_TYPE.IMAGE,"svg+xml":vc.LOAD_TYPE.IMAGE,mp3:vc.LOAD_TYPE.AUDIO,ogg:vc.LOAD_TYPE.AUDIO,wav:vc.LOAD_TYPE.AUDIO,mp4:vc.LOAD_TYPE.VIDEO,webm:vc.LOAD_TYPE.VIDEO},vc._xhrTypeMap={xhtml:vc.XHR_RESPONSE_TYPE.DOCUMENT,html:vc.XHR_RESPONSE_TYPE.DOCUMENT,htm:vc.XHR_RESPONSE_TYPE.DOCUMENT,xml:vc.XHR_RESPONSE_TYPE.DOCUMENT,tmx:vc.XHR_RESPONSE_TYPE.DOCUMENT,svg:vc.XHR_RESPONSE_TYPE.DOCUMENT,tsx:vc.XHR_RESPONSE_TYPE.DOCUMENT,gif:vc.XHR_RESPONSE_TYPE.BLOB,png:vc.XHR_RESPONSE_TYPE.BLOB,bmp:vc.XHR_RESPONSE_TYPE.BLOB,jpg:vc.XHR_RESPONSE_TYPE.BLOB,jpeg:vc.XHR_RESPONSE_TYPE.BLOB,tif:vc.XHR_RESPONSE_TYPE.BLOB,tiff:vc.XHR_RESPONSE_TYPE.BLOB,webp:vc.XHR_RESPONSE_TYPE.BLOB,tga:vc.XHR_RESPONSE_TYPE.BLOB,json:vc.XHR_RESPONSE_TYPE.JSON,text:vc.XHR_RESPONSE_TYPE.TEXT,txt:vc.XHR_RESPONSE_TYPE.TEXT,ttf:vc.XHR_RESPONSE_TYPE.BUFFER,otf:vc.XHR_RESPONSE_TYPE.BUFFER},vc.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var xc=window.URL||window.webkitURL,bc={caching:function(t,e){var n=this;mc[t.url]?(t.data=mc[t.url],t.complete()):t.onComplete.once((function(){return mc[n.url]=n.data})),e()},parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===vc.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=xc.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=n,t.type=vc.TYPE.IMAGE,void(t.data.onload=function(){xc.revokeObjectURL(n),t.data.onload=null,e()})}}else{var i=t.xhr.getResponseHeader("content-type");if(i&&0===i.indexOf("image"))return t.data=new Image,t.data.src="data:"+i+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var i=[0,0,0],r=[0,0,0,0],o=0;o<i.length;++o)n<t.length?i[o]=255&t.charCodeAt(n++):i[o]=0;switch(r[0]=i[0]>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|i[2]>>6,r[3]=63&i[2],n-(t.length-1)){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64}for(var s=0;s<r.length;++s)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r[s])}return e}(t.xhr.responseText),t.type=vc.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},_c=/(#[\w-]+)?$/,wc=function(){function t(e,n){var i=this;void 0===e&&(e=""),void 0===n&&(n=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=function(t,e){function n(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(o.started=!0,null==t&&o.idle())setTimeout((function(){return o.drain()}),1);else{var i={data:t,callback:"function"==typeof n?n:I};e?o._tasks.unshift(i):o._tasks.push(i),setTimeout((function(){return o.process()}),1)}}function i(t){return function(){r-=1,t.callback.apply(t,arguments),null!=arguments[0]&&o.error(arguments[0],t.data),r<=o.concurrency-o.buffer&&o.unsaturated(),o.idle()&&o.drain(),o.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var r=0,o={_tasks:[],concurrency:e,saturated:I,unsaturated:I,buffer:e/4,empty:I,drain:I,error:I,started:!1,paused:!1,push:function(t,e){n(t,!1,e)},kill:function(){r=0,o.drain=I,o.started=!1,o._tasks=[]},unshift:function(t,e){n(t,!0,e)},process:function(){for(;!o.paused&&r<o.concurrency&&o._tasks.length;){var e=o._tasks.shift();0===o._tasks.length&&o.empty(),(r+=1)===o.concurrency&&o.saturated(),t(e.data,O(i(e)))}},length:function(){return o._tasks.length},running:function(){return r},idle:function(){return o._tasks.length+r===0},pause:function(){!0!==o.paused&&(o.paused=!0)},resume:function(){if(!1!==o.paused){o.paused=!1;for(var t=1;t<=o.concurrency;t++)o.process()}}};return o}(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new(fc()),this.onError=new(fc()),this.onLoad=new(fc()),this.onStart=new(fc()),this.onComplete=new(fc());for(var r=0;r<t._defaultBeforeMiddleware.length;++r)this.pre(t._defaultBeforeMiddleware[r]);for(var o=0;o<t._defaultAfterMiddleware.length;++o)this.use(t._defaultAfterMiddleware[o])}var e=t.prototype;return e.add=function(t,e,n,i){if(Array.isArray(t)){for(var r=0;r<t.length;++r)this.add(t[r]);return this}if("object"==typeof t&&(i=e||t.callback||t.onComplete,n=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(i=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof n&&(i=n,n=null),this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new vc(t,e,n),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var o=n.parentResource,s=[],a=0;a<o.children.length;++a)o.children[a].isComplete||s.push(o.children[a]);var l=o.progressChunk*(s.length+1)/(s.length+2);o.children.push(this.resources[t]),o.progressChunk=l;for(var u=0;u<s.length;++u)s[u].progressChunk=l;this.resources[t].progressChunk=l}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},e.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var e,n=dc()(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=_c.exec(e)[0];-1!==(e=e.substr(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i}return e},e._loadResource=function(t,e){var n=this;t._dequeue=e,R(this._beforeMiddleware,(function(e,i){e.call(n,t,(function(){i(t.isComplete?{}:null)}))}),(function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())}),!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),R(this._afterMiddleware,(function(n,i){n.call(e,t,i)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},L(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();wc._defaultBeforeMiddleware=[],wc._defaultAfterMiddleware=[],wc.pre=function(t){return wc._defaultBeforeMiddleware.push(t),wc},wc.use=function(t){return wc._defaultAfterMiddleware.push(t),wc};var Sc=vc,Ac=function(t,e){return Ac=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Ac(t,e)},Mc=function(){function t(){}return t.use=function(t,e){t.data&&t.type===vc.TYPE.IMAGE&&(t.texture=zl.fromLoader(t.data,t.url,t.name)),e()},t}(),Tc=function(t){function e(n,i){for(var r=t.call(this,n,i)||this,o=0;o<e._plugins.length;++o){var s=e._plugins[o],a=s.pre,l=s.use;a&&r.pre(a),l&&r.use(l)}return r._protected=!1,r}return function(t,e){function n(){this.constructor=t}Ac(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(e,"shared",{get:function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},enumerable:!1,configurable:!0}),e.registerPlugin=function(t){return e._plugins.push(t),t.add&&t.add(),e},e._plugins=[],e}(wc);Tc.registerPlugin({use:bc.parsing}),Tc.registerPlugin(Mc);var Ec=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Tc.shared:new Tc},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t}(),Pc=function(t,e){return Pc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Pc(t,e)};!function(t){function n(e,n,i,r){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===r&&(r=!1);var o=t.call(this)||this;return i>16384&&(i=16384),o._properties=[!1,!0,!1,!1,!1],o._maxSize=e,o._batchSize=i,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=Ds.NORMAL,o.autoResize=r,o.roundPixels=!0,o.baseTexture=null,o.setProperties(n),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}B(n,t),n.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,e(t,this.tintRgb)},enumerable:!1,configurable:!0}),n.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},n.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},n.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},n.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}($a);var Cc,Ic,Rc=function(){function t(t,e,n){this.geometry=new Yl,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var r=t[i];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||Fs.FLOAT,offset:r.offset},e[i]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new jl(function(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var i=0,r=0;i<n;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n)(s=this.dynamicProperties[n]).offset=e,e+=s.size,this.dynamicStride+=s.size;var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new jl(this.dynamicData,!1,!1);var r=0;for(this.staticStride=0,n=0;n<this.staticProperties.length;++n)(s=this.staticProperties[n]).offset=r,r+=s.size,this.staticStride+=s.size;var o=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new jl(this.staticData,!0,!1),n=0;n<this.dynamicProperties.length;++n){var s=this.dynamicProperties[n];t.addAttribute(s.attributeName,this.dynamicBuffer,0,s.type===Fs.UNSIGNED_BYTE,s.type,4*this.dynamicStride,4*s.offset)}for(n=0;n<this.staticProperties.length;++n)s=this.staticProperties[n],t.addAttribute(s.attributeName,this.staticBuffer,0,s.type===Fs.UNSIGNED_BYTE,s.type,4*this.staticStride,4*s.offset)},t.prototype.uploadDynamic=function(t,e,n){for(var i=0;i<this.dynamicProperties.length;i++){var r=this.dynamicProperties[i];r.uploadFunction(t,e,n,r.type===Fs.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,n){for(var i=0;i<this.staticProperties.length;i++){var r=this.staticProperties[i];r.uploadFunction(t,e,n,r.type===Fs.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),Oc=function(t){function e(e){var n=t.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new Fa,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Fs.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=Au.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),n.state=Mu.for2d(),n}return B(e,t),e.prototype.render=function(t){var e=t.children,n=t._maxSize,i=t._batchSize,o=this.renderer,s=e.length;if(0!==s){s>n&&!t.autoResize&&(s=n);var a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));var l=e[0]._texture.baseTexture;this.state.blendMode=r(t.blendMode,l.alphaMode),o.state.set(this.state);var u,c,h,d,p=o.gl,f=t.worldTransform.copyTo(this.tempMatrix);f.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=(u=t.tintRgb,c=t.worldAlpha,h=this.shader.uniforms.uColor,d=l.alphaMode,h=h||new Float32Array(4),d||void 0===d?(h[0]=u[0]*c,h[1]=u[1]*c,h[2]=u[2]*c):(h[0]=u[0],h[1]=u[1],h[2]=u[2]),h[3]=c,h),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);for(var m=!1,g=0,y=0;g<s;g+=i,y+=1){var v=s-g;v>i&&(v=i),y>=a.length&&a.push(this._generateOneMoreBuffer(t));var x=a[y];x.uploadDynamic(e,g,v);var b=t._bufferUpdateIDs[y]||0;(m=m||x._updateID<b)&&(x._updateID=t._updateID,x.uploadStatic(e,g,v)),o.geometry.bind(x.geometry),p.drawElements(p.TRIANGLES,6*v,p.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,i=t._batchSize,r=t._properties,o=0;o<n;o+=i)e.push(new Rc(this.properties,r,i));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new Rc(this.properties,n,e)},e.prototype.uploadVertices=function(t,e,n,i,r,o){for(var s=0,a=0,l=0,u=0,c=0;c<n;++c){var h=t[e+c],d=h._texture,p=h.scale.x,f=h.scale.y,m=d.trim,g=d.orig;m?(s=(a=m.x-h.anchor.x*g.width)+m.width,l=(u=m.y-h.anchor.y*g.height)+m.height):(s=g.width*(1-h.anchor.x),a=g.width*-h.anchor.x,l=g.height*(1-h.anchor.y),u=g.height*-h.anchor.y),i[o]=a*p,i[o+1]=u*f,i[o+r]=s*p,i[o+r+1]=u*f,i[o+2*r]=s*p,i[o+2*r+1]=l*f,i[o+3*r]=a*p,i[o+3*r+1]=l*f,o+=4*r}},e.prototype.uploadPosition=function(t,e,n,i,r,o){for(var s=0;s<n;s++){var a=t[e+s].position;i[o]=a.x,i[o+1]=a.y,i[o+r]=a.x,i[o+r+1]=a.y,i[o+2*r]=a.x,i[o+2*r+1]=a.y,i[o+3*r]=a.x,i[o+3*r+1]=a.y,o+=4*r}},e.prototype.uploadRotation=function(t,e,n,i,r,o){for(var s=0;s<n;s++){var a=t[e+s].rotation;i[o]=a,i[o+r]=a,i[o+2*r]=a,i[o+3*r]=a,o+=4*r}},e.prototype.uploadUvs=function(t,e,n,i,r,o){for(var s=0;s<n;++s){var a=t[e+s]._texture._uvs;a?(i[o]=a.x0,i[o+1]=a.y0,i[o+r]=a.x1,i[o+r+1]=a.y1,i[o+2*r]=a.x2,i[o+2*r+1]=a.y2,i[o+3*r]=a.x3,i[o+3*r+1]=a.y3,o+=4*r):(i[o]=0,i[o+1]=0,i[o+r]=0,i[o+r+1]=0,i[o+2*r]=0,i[o+2*r+1]=0,i[o+3*r]=0,i[o+3*r+1]=0,o+=4*r)}},e.prototype.uploadTint=function(t,e,n,i,r,s){for(var a=0;a<n;++a){var l=t[e+a],u=l._texture.baseTexture.alphaMode>0,c=l.alpha,h=c<1&&u?o(l._tintRGB,c):l._tintRGB+(255*c<<24);i[s]=h,i[s+r]=h,i[s+2*r]=h,i[s+3*r]=h,s+=4*r}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(eu);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(Cc||(Cc={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(Ic||(Ic={}));var qc,Lc,Dc={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},zc=function(){function t(){this.color=16777215,this.alpha=1,this.texture=zl.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=zl.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),kc=function(t,e){return kc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},kc(t,e)},Bc={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,i=t.holes,r=e.points,o=e.indices;if(n.length>=6){for(var s=[],a=0;a<i.length;a++){var l=i[a];s.push(n.length/2),n=n.concat(l.points)}var u=ga()(n,s,2);if(!u)return;var c=r.length/2;for(a=0;a<u.length;a+=3)o.push(u[a]+c),o.push(u[a+1]+c),o.push(u[a+2]+c);for(a=0;a<n.length;a++)r.push(n[a])}}},Fc={build:function(t){var e,n,i=t.shape,r=t.points,o=i.x,s=i.y;if(r.length=0,t.type===wa.CIRC)e=i.radius,n=i.radius;else{var a=t.shape;e=a.width,n=a.height}if(0!==e&&0!==n){var l=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(e+n));l/=2.3;for(var u=2*Math.PI/l,c=0;c<l-.5;c++)r.push(o+Math.sin(-u*c)*e,s+Math.cos(-u*c)*n);r.push(r[0],r[1])}},triangulate:function(t,e){var n=t.points,i=e.points,r=e.indices,o=i.length/2,s=o,a=t.shape,l=t.matrix,u=a.x,c=a.y;i.push(t.matrix?l.a*u+l.c*c+l.tx:u,t.matrix?l.b*u+l.d*c+l.ty:c);for(var h=0;h<n.length;h+=2)i.push(n[h],n[h+1]),r.push(o++,s,o)}},Vc={build:function(t){var e=t.shape,n=t.points,i=e.x,r=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));n.length=0,a?(N(i,r+a,i,r,i+a,r,n),N(i+o-a,r,i+o,r,i+o,r+a,n),N(i+o,r+s-a,i+o,r+s,i+o-a,r+s,n),N(i+a,r+s,i,r+s,i,r+s-a,n)):n.push(i,r,i+o,r,i+o,r+s,i,r+s)},triangulate:function(t,e){for(var n=t.points,i=e.points,r=e.indices,o=i.length/2,s=ga()(n,null,2),a=0,l=s.length;a<l;a+=3)r.push(s[a]+o),r.push(s[a+1]+o),r.push(s[a+2]+o);for(a=0,l=n.length;a<l;a++)i.push(n[a],n[++a])}},Nc=function(t){function e(e,n,i,r,o,s){void 0===s&&(s=0),o=o||r/2;for(var a=-1*Math.PI/2+s,l=2*i,u=Ca/l,c=[],h=0;h<l;h++){var d=h%2?o:r,p=h*u+a;c.push(e+d*Math.cos(p),n+d*Math.sin(p))}return t.call(this,c)||this}return F(e,t),e}(Da),Uc=function(){function t(){}return t.curveTo=function(t,e,n,i,r,o){var s=o[o.length-2],a=o[o.length-1]-e,l=s-t,u=i-e,c=n-t,h=Math.abs(a*c-l*u);if(h<1e-8||0===r)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var d=a*a+l*l,p=u*u+c*c,f=a*u+l*c,m=r*Math.sqrt(d)/h,g=r*Math.sqrt(p)/h,y=m*f/d,v=g*f/p,x=m*c+g*l,b=m*u+g*a,_=l*(g+y),w=a*(g+y),S=c*(m+v),A=u*(m+v);return{cx:x+t,cy:b+e,radius:r,startAngle:Math.atan2(w-b,_-x),endAngle:Math.atan2(A-b,S-x),anticlockwise:l*u>c*a}},t.arc=function(t,e,n,i,r,o,s,a,l){for(var u=s-o,c=Dc._segmentsCount(Math.abs(u)*r,40*Math.ceil(Math.abs(u)/Ca)),h=u/(2*c),d=2*h,p=Math.cos(h),f=Math.sin(h),m=c-1,g=m%1/m,y=0;y<=m;++y){var v=h+o+d*(y+g*y),x=Math.cos(v),b=-Math.sin(v);l.push((p*x+f*b)*r+n,(p*-b+f*x)*r+i)}},t}(),jc=function(){function t(){}return t.curveLength=function(t,e,n,i,r,o,s,a){for(var l=0,u=0,c=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,x=t,b=e,_=1;_<=10;++_)y=x-(m=(f=(p=(d=1-(u=_/10))*d)*d)*t+3*p*u*n+3*d*(c=u*u)*r+(h=c*u)*s),v=b-(g=f*e+3*p*u*i+3*d*c*o+h*a),x=m,b=g,l+=Math.sqrt(y*y+v*v);return l},t.curveTo=function(e,n,i,r,o,s,a){var l=a[a.length-2],u=a[a.length-1];a.length-=2;var c=Dc._segmentsCount(t.curveLength(l,u,e,n,i,r,o,s)),h=0,d=0,p=0,f=0,m=0;a.push(l,u);for(var g=1,y=0;g<=c;++g)p=(d=(h=1-(y=g/c))*h)*h,m=(f=y*y)*y,a.push(p*l+3*d*y*e+3*h*f*i+m*o,p*u+3*d*y*n+3*h*f*r+m*s)},t}(),Gc=function(){function t(){}return t.curveLength=function(t,e,n,i,r,o){var s=t-2*n+r,a=e-2*i+o,l=2*n-2*t,u=2*i-2*e,c=4*(s*s+a*a),h=4*(s*l+a*u),d=l*l+u*u,p=2*Math.sqrt(c+h+d),f=Math.sqrt(c),m=2*c*f,g=2*Math.sqrt(d),y=h/f;return(m*p+f*h*(p-g)+(4*d*c-h*h)*Math.log((2*f+y+p)/(y+g)))/(4*m)},t.curveTo=function(e,n,i,r,o){for(var s=o[o.length-2],a=o[o.length-1],l=Dc._segmentsCount(t.curveLength(s,a,e,n,i,r)),u=0,c=0,h=1;h<=l;++h){var d=h/l;u=s+(e-s)*d,c=a+(n-a)*d,o.push(u+(e+(i-e)*d-u)*d,c+(n+(r-n)*d-c)*d)}},t}(),Hc=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),Wc=((qc={})[wa.POLY]=Bc,qc[wa.CIRC]=Fc,qc[wa.ELIP]=Fc,qc[wa.RECT]={build:function(t){var e=t.shape,n=e.x,i=e.y,r=e.width,o=e.height,s=t.points;s.length=0,s.push(n,i,n+r,i,n+r,i+o,n,i+o)},triangulate:function(t,e){var n=t.points,i=e.points,r=i.length/2;i.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},qc[wa.RREC]=Vc,qc),Xc=[],Yc=[],Zc=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),Qc=new ka,Jc=new Za,Kc=function(t){function e(){var e=t.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new Za,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return F(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Yc.push(this.drawCalls[t]);for(this.drawCalls.length=0,t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Xc.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null);var r=new Zc(t,e,n,i);return this.graphicsData.push(r),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new Zc(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var i=e[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,Qc):Qc.copyFrom(t),i.shape.contains(Qc.x,Qc.y))){var r=!1;if(i.holes)for(var o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(Qc.x,Qc.y)){r=!0;break}if(!r)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,i=null,r=null;this.batches.length>0&&(r=(i=this.batches[this.batches.length-1]).style);for(var o=this.shapeIndex;o<n.length;o++){this.shapeIndex++;var s=n[o],a=s.fillStyle,l=s.lineStyle;Wc[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var u=0;u<2;u++){var c=0===u?a:l;if(c.visible){var h=c.texture.baseTexture,d=this.indices.length,p=this.points.length/2;h.wrapMode=Ns.REPEAT,0===u?this.processFill(s):this.processLine(s);var f=this.points.length/2-p;0!==f&&(i&&!this._compareStyles(r,c)&&(i.end(d,p),i=null),i||((i=Xc.pop()||new Hc).begin(c,d,p),this.batches.push(i),r=c),this.addUvs(this.points,e,c.texture,p,f,c.matrix))}}}var m=this.indices.length,g=this.points.length/2;if(i&&i.end(m,g),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var y=g>65535&&t;this.indicesUint16=y?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&t.texture.baseTexture===e.texture.baseTexture&&t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],i=n.fillStyle,r=n.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(r&&!r.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var i=t[e],r=0;r<i.size;r++){var o=i.start+r;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++bl._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Yc.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,i=this.textureIds,r=Yc.pop();r||((r=new Ju).texArray=new Ku),r.texArray.count=0,r.start=0,r.size=0,r.type=zs.TRIANGLES;var o=0,s=null,a=0,l=!1,u=zs.TRIANGLES,c=0;for(this.drawCalls.push(r),e=0;e<this.batches.length;e++){var h=this.batches[e],d=h.style,p=d.texture.baseTexture;l!==!!d.native&&(u=(l=!!d.native)?zs.LINES:zs.TRIANGLES,s=null,o=8,t++),s!==p&&(s=p,p._batchEnabled!==t&&(8===o&&(t++,o=0,r.size>0&&((r=Yc.pop())||((r=new Ju).texArray=new Ku),this.drawCalls.push(r)),r.start=c,r.size=0,r.texArray.count=0,r.type=u),p.touched=1,p._batchEnabled=t,p._batchLocation=o,p.wrapMode=10497,r.texArray.elements[r.texArray.count++]=p,o++)),r.size+=h.size,c+=h.size,a=p._batchLocation,this.addColors(n,d.color,d.alpha,h.attribSize),this.addTextureIds(i,a,h.attribSize)}bl._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,i=this.textureIds,r=new ArrayBuffer(3*t.length*4),o=new Float32Array(r),s=new Uint32Array(r),a=0,l=0;l<t.length/2;l++)o[a++]=t[2*l],o[a++]=t[2*l+1],o[a++]=e[2*l],o[a++]=e[2*l+1],s[a++]=n[l],o[a++]=i[l];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),Bc.triangulate(t,this)):Wc[t.type].triangulate(t,this)},e.prototype.processLine=function(t){G(t,this);for(var e=0;e<t.holes.length;e++)G(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];Wc[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=Jc,n=Fa.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var r=this.graphicsData[i],o=r.shape,s=r.type,a=r.lineStyle,l=r.matrix||Fa.IDENTITY,u=0;if(a&&a.visible){var c=a.alignment;u=a.width,s===wa.POLY?u*=.5+Math.abs(.5-c):u*=Math.max(0,c)}if(n!==l&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=l),s===wa.RECT||s===wa.RREC){var h=o;e.addFramePad(h.x,h.y,h.x+h.width,h.y+h.height,u,u)}else if(s===wa.CIRC){var d=o;e.addFramePad(d.x,d.y,d.x,d.y,d.radius+u,d.radius+u)}else if(s===wa.ELIP){var p=o;e.addFramePad(p.x,p.y,p.x,p.y,p.width+u,p.height+u)}else{var f=o;t.addVerticesMatrix(n,f.points,0,f.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var i=t[2*n],r=t[2*n+1];t[2*n]=e.a*i+e.c*r+e.tx,t[2*n+1]=e.b*i+e.d*r+e.ty}},e.prototype.addColors=function(t,e,n,i){for(var r=o((e>>16)+(65280&e)+((255&e)<<16),n);i-- >0;)t.push(r)},e.prototype.addTextureIds=function(t,e,n){for(;n-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,n,i,r,o){void 0===o&&(o=null);for(var s=0,a=e.length,l=n.frame;s<r;){var u=t[2*(i+s)],c=t[2*(i+s)+1];if(o){var h=o.a*u+o.c*c+o.tx;c=o.b*u+o.d*c+o.ty,u=h}s++,e.push(u/l.width,c/l.height)}var d=n.baseTexture;(l.width<d.width||l.height<d.height)&&this.adjustUvs(e,n,a,r)},e.prototype.adjustUvs=function(t,e,n,i){for(var r=e.baseTexture,o=1e-6,s=n+2*i,a=e.frame,l=a.width/r.width,u=a.height/r.height,c=a.x/a.width,h=a.y/a.height,d=Math.floor(t[n]+o),p=Math.floor(t[n+1]+o),f=n+2;f<s;f+=2)d=Math.min(d,Math.floor(t[f]+o)),p=Math.min(p,Math.floor(t[f+1]+o));for(c-=d,h-=p,f=n;f<s;f+=2)t[f]=(t[f]+c)*l,t[f+1]=(t[f+1]+h)*u},e.BATCHABLE_SIZE=100,e}(nc),$c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Ic.BUTT,e.join=Cc.MITER,e.miterLimit=10,e}return F(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(zc),th=new Float32Array(3),eh={},nh=function(t){function n(e){void 0===e&&(e=null);var n=t.call(this)||this;return n._geometry=e||new Kc,n._geometry.refCount++,n.shader=null,n.state=Mu.for2d(),n._fillStyle=new zc,n._lineStyle=new $c,n._matrix=null,n._holeMode=!1,n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n.pluginName="batch",n._transformID=-1,n.tint=16777215,n.blendMode=Ds.NORMAL,n}return F(n,t),Object.defineProperty(n.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return this.finishPoly(),new n(this._geometry)},Object.defineProperty(n.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),n.prototype.lineStyle=function(t){if(void 0===t&&(t=null),"number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},n.prototype.lineTextureStyle=function(t){if("number"==typeof t){p("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments;t={width:e[0],texture:e[1],color:e[2],alpha:e[3],matrix:e[4],alignment:e[5],native:e[6]},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:zl.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ic.BUTT,join:Cc.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this},n.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Da,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Da,this.currentPath.closeStroke=!1},n.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},n.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},n.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,i=n[n.length-2],r=n[n.length-1];return i===t&&r===e||n.push(t,e),this},n.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},n.prototype.quadraticCurveTo=function(t,e,n,i){this._initCurve();var r=this.currentPath.points;return 0===r.length&&this.moveTo(0,0),Gc.curveTo(t,e,n,i,r),this},n.prototype.bezierCurveTo=function(t,e,n,i,r,o){return this._initCurve(),jc.curveTo(t,e,n,i,r,o,this.currentPath.points),this},n.prototype.arcTo=function(t,e,n,i,r){this._initCurve(t,e);var o=this.currentPath.points,s=Uc.curveTo(t,e,n,i,r,o);if(s){var a=s.cx,l=s.cy,u=s.radius,c=s.startAngle,h=s.endAngle,d=s.anticlockwise;this.arc(a,l,u,c,h,d)}return this},n.prototype.arc=function(t,e,n,i,r,o){if(void 0===o&&(o=!1),i===r)return this;if(!o&&r<=i?r+=Ca:o&&i<=r&&(i+=Ca),0==r-i)return this;var s=t+Math.cos(i)*n,a=e+Math.sin(i)*n,l=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var c=Math.abs(u[u.length-2]-s),h=Math.abs(u[u.length-1]-a);c<l&&h<l||u.push(s,a)}else this.moveTo(s,a),u=this.currentPath.points;return Uc.arc(s,a,t,e,n,i,r,o,u),this},n.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:zl.WHITE,color:t,alpha:e})},n.prototype.beginTextureFill=function(t){if(t instanceof zl){p("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments;t={texture:e[0],color:e[1],alpha:e[2],matrix:e[3]},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:zl.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this},n.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},n.prototype.drawRect=function(t,e,n,i){return this.drawShape(new Oa(t,e,n,i))},n.prototype.drawRoundedRect=function(t,e,n,i,r){return this.drawShape(new za(t,e,n,i,r))},n.prototype.drawCircle=function(t,e,n){return this.drawShape(new qa(t,e,n))},n.prototype.drawEllipse=function(t,e,n,i){return this.drawShape(new La(t,e,n,i))},n.prototype.drawPolygon=function(){for(var t,e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];var r=!0,o=n[0];o.points?(r=o.closeStroke,t=o.points):t=Array.isArray(n[0])?n[0]:n;var s=new Da(t);return s.closeStroke=r,this.drawShape(s),this},n.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},n.prototype.drawStar=function(t,e,n,i,r,o){return void 0===o&&(o=0),this.drawPolygon(new Nc(t,e,n,i,r,o))},n.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},n.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===wa.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},n.prototype._render=function(t){this.finishPoly();var e=this._geometry,n=t.context.supports.uint32Indices;e.updateBatches(n),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},n.prototype._populateBatches=function(){var t=this._geometry,n=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var r=0;r<i;r++){var o=t.batches[r],s=o.style.color,a=new Float32Array(this.vertexData.buffer,4*o.attribStart*2,2*o.attribSize),l=new Float32Array(t.uvsFloat32.buffer,4*o.attribStart*2,2*o.attribSize),u={vertexData:a,blendMode:n,indices:new Uint16Array(t.indicesUint16.buffer,2*o.start,o.size),uvs:l,_batchRGB:e(s),_tintRGB:s,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[r]=u}},n.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},n.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,i=this.tint,r=this.worldAlpha,o=e.uniforms,s=n.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(i>>16&255)/255*r,o.tint[1]=(i>>8&255)/255*r,o.tint[2]=(255&i)/255*r,o.tint[3]=r,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var a=0,l=s.length;a<l;a++)this._renderDrawCallDirect(t,n.drawCalls[a])},n.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,i=e.type,r=e.size,o=e.start,s=n.count,a=0;a<s;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(i,r,o)},n.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!eh[n]){for(var i=new Int32Array(16),r=0;r<16;r++)i[r]=r;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Fa,default:Kl.from({uSamplers:i},!0)},s=t.plugins[n]._shader.program;eh[n]=new Au(s,o)}e=eh[n]}return e},n.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,i=e.minY,r=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,n,i,r,o)}},n.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,n._TEMP_POINT),this._geometry.containsPoint(n._TEMP_POINT)},n.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=e(this.tint,th),n=0;n<this.batches.length;n++){var i=this.batches[n],r=i._batchRGB,o=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(o>>16)+(65280&o)+((255&o)<<16)}}},n.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,o=e.d,s=e.tx,a=e.ty,l=this._geometry.points,u=this.vertexData,c=0,h=0;h<l.length;h+=2){var d=l[h],p=l[h+1];u[c++]=n*d+r*p+s,u[c++]=o*p+i*d+a}}},n.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},n.prototype.setMatrix=function(t){return this._matrix=t,this},n.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},n.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},n.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},n._TEMP_POINT=new ka,n}($a),ih=function(t,e){return ih=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ih(t,e)},rh=new ka,oh=new Uint16Array([0,1,2,0,2,3]),sh=function(t){function e(e){var n=t.call(this)||this;return n._anchor=new Ba(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=Ds.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||zl.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=oh,n.pluginName="batch",n.isSprite=!0,n._roundPixels=da.ROUND_PIXELS,n}return function(t,e){function n(){this.constructor=t}ih(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=h(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=h(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,o=e.d,s=e.tx,a=e.ty,l=this.vertexData,u=t.trim,c=t.orig,h=this._anchor,d=0,p=0,f=0,m=0;if(u?(d=(p=u.x-h._x*c.width)+u.width,f=(m=u.y-h._y*c.height)+u.height):(d=(p=-h._x*c.width)+c.width,f=(m=-h._y*c.height)+c.height),l[0]=n*p+r*m+s,l[1]=o*m+i*p+a,l[2]=n*d+r*m+s,l[3]=o*m+i*d+a,l[4]=n*d+r*f+s,l[5]=o*f+i*d+a,l[6]=n*p+r*f+s,l[7]=o*f+i*p+a,this._roundPixels)for(var g=da.RESOLUTION,y=0;y<l.length;++y)l[y]=Math.round((l[y]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,r=this.transform.worldTransform,o=r.a,s=r.b,a=r.c,l=r.d,u=r.tx,c=r.ty,h=-i._x*n.width,d=h+n.width,p=-i._y*n.height,f=p+n.height;e[0]=o*h+a*p+u,e[1]=l*p+s*h+c,e[2]=o*d+a*p+u,e[3]=l*p+s*d+c,e[4]=o*d+a*f+u,e[5]=l*f+s*d+c,e[6]=o*h+a*f+u,e[7]=l*f+s*h+c},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Oa),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,rh);var e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x,r=0;return rh.x>=i&&rh.x<i+e&&(r=-n*this.anchor.y,rh.y>=r&&rh.y<r+n)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,n){return new e(t instanceof zl?t:zl.from(t,n))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=h(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=h(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||zl.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}($a),ah=function(t,e){return ah=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ah(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(Lc||(Lc={}));var lh={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Lc.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},uh=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ch=function(){function t(t){this.styleID=0,this.reset(),X(this,t,t)}return t.prototype.clone=function(){var e={};return X(e,this,lh),new t(e)},t.prototype.reset=function(){X(this,lh,lh)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=W(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=W(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=W(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var i=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&uh.indexOf(i)<0&&(i='"'+i+'"'),e[n]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}(),hh=function(){function t(t,e,n,i,r,o,s,a,l){this.text=t,this.style=e,this.width=n,this.height=i,this.lines=r,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=l}return t.measureText=function(e,n,i,r){void 0===r&&(r=t._canvas),i=null==i?n.wordWrap:i;var o=n.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=n.fontSize,s.ascent=n.fontSize);var a=r.getContext("2d");a.font=o;for(var l=(i?t.wordWrap(e,n,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length),c=0,h=0;h<l.length;h++){var d=a.measureText(l[h]).width+(l[h].length-1)*n.letterSpacing;u[h]=d,c=Math.max(c,d)}var p=c+n.strokeThickness;n.dropShadow&&(p+=n.dropShadowDistance);var f=n.lineHeight||s.fontSize+n.strokeThickness,m=Math.max(f,s.fontSize+n.strokeThickness)+(l.length-1)*(f+n.leading);return n.dropShadow&&(m+=n.dropShadowDistance),new t(e,n,p,m,l,u,f+n.leading,c,s)},t.wordWrap=function(e,n,i){void 0===i&&(i=t._canvas);for(var r=i.getContext("2d"),o=0,s="",a="",l={},u=n.letterSpacing,c=n.whiteSpace,h=t.collapseSpaces(c),d=t.collapseNewlines(c),p=!h,f=n.wordWrapWidth+u,m=t.tokenize(e),g=0;g<m.length;g++){var y=m[g];if(t.isNewline(y)){if(!d){a+=t.addLine(s),p=!h,s="",o=0;continue}y=" "}if(h){var v=t.isBreakingSpace(y),x=t.isBreakingSpace(s[s.length-1]);if(v&&x)continue}var b=t.getFromCache(y,u,l,r);if(b>f)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(y,n.breakWords))for(var _=t.wordWrapSplit(y),w=0;w<_.length;w++){for(var S=_[w],A=1;_[w+A];){var M=_[w+A],T=S[S.length-1];if(t.canBreakChars(T,M,y,w,n.breakWords))break;S+=M,A++}w+=S.length-1;var E=t.getFromCache(S,u,l,r);E+o>f&&(a+=t.addLine(s),p=!1,s="",o=0),s+=S,o+=E}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var P=g===m.length-1;a+=t.addLine(y,!P),p=!1,s="",o=0}else b+o>f&&(p=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(y)||p)&&(s+=y,o+=b)}return a+t.addLine(s,!1)},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),n?e+"\n":e},t.getFromCache=function(t,e,n,i){var r=n[t];if(void 0===r){var o=t.length*e;r=i.measureText(t).width+o,n[t]=r}return r},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var i=e[n];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var n=[],i="";if("string"!=typeof e)return n;for(var r=0;r<e.length;r++){var o=e[r];t.isBreakingSpace(o)||t.isNewline(o)?(""!==i&&(n.push(i),i=""),n.push(o)):i+=o}return""!==i&&n.push(i),n},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,n,i,r){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},i=t._canvas,r=t._context;r.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(r.measureText(o).width),a=Math.ceil(r.measureText(t.BASELINE_SYMBOL).width),l=2*a;a=a*t.BASELINE_MULTIPLIER|0,i.width=s,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,s,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,a);var u=r.getImageData(0,0,s,l).data,c=u.length,h=4*s,d=0,p=0,f=!1;for(d=0;d<a;++d){for(var m=0;m<h;m+=4)if(255!==u[p+m]){f=!0;break}if(f)break;p+=h}for(n.ascent=a-d,p=c-h,f=!1,d=l;d>a;--d){for(m=0;m<h;m+=4)if(255!==u[p+m]){f=!0;break}if(f)break;p-=h}return n.descent=d-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),dh=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();dh.width=dh.height=10,hh._canvas=dh,hh._context=dh.getContext("2d"),hh._fonts={},hh.METRICS_STRING="|ÉqÅ",hh.BASELINE_SYMBOL="M",hh.BASELINE_MULTIPLIER=1.4,hh._newlines=[10,13],hh._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var ph={texture:!0,children:!1,baseTexture:!0},fh=function(t){function n(e,n,i){var r=this,o=!1;i||(i=document.createElement("canvas"),o=!0),i.width=3,i.height=3;var s=zl.from(i);return s.orig=new Oa,s.trim=new Oa,(r=t.call(this,s)||this)._ownCanvas=o,r.canvas=i,r.context=r.canvas.getContext("2d"),r._resolution=da.RESOLUTION,r._autoResolution=!0,r._text=null,r._style=null,r._styleListener=null,r._font="",r.text=e,r.style=n,r.localStyleID=-1,r}return function(t,e){function n(){this.constructor=t}ah(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,t),n.prototype.updateText=function(t){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){this._font=this._style.toFontString();var r,o,s=this.context,a=hh.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),l=a.width,u=a.height,c=a.lines,h=a.lineHeight,d=a.lineWidths,p=a.maxLineWidth,f=a.fontProperties;this.canvas.width=Math.ceil((Math.max(1,l)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,u)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var m=n.dropShadow?2:1,g=0;g<m;++g){var y=n.dropShadow&&0===g,v=y?2*u:0,x=v*this.resolution;if(y){s.fillStyle="black",s.strokeStyle="black";var b=n.dropShadowColor,_=e("number"==typeof b?b:i(b));s.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+n.dropShadowAlpha+")",s.shadowBlur=n.dropShadowBlur,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*n.dropShadowDistance,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*n.dropShadowDistance+x}else s.fillStyle=this._generateFillStyle(n,c,a),s.strokeStyle=n.stroke,s.shadowColor="0",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;for(var w=0;w<c.length;w++)r=n.strokeThickness/2,o=n.strokeThickness/2+w*h+f.ascent,"right"===n.align?r+=p-d[w]:"center"===n.align&&(r+=(p-d[w])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(c[w],r+n.padding,o+n.padding-v,!0),n.fill&&this.drawLetterSpacing(c[w],r+n.padding,o+n.padding-v)}this.updateTexture()}},n.prototype.drawLetterSpacing=function(t,e,n,i){void 0===i&&(i=!1);var r=this._style.letterSpacing;if(0!==r)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,l=0,u=0;u<s.length;++u){var c=s[u];i?this.context.strokeText(c,o,n):this.context.fillText(c,o,n),o+=a-(l=this.context.measureText(t.substring(u+1)).width)+r,a=l}else i?this.context.strokeText(t,e,n):this.context.fillText(t,e,n)},n.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,n,i,r=t.width,o=t.height,s=t.getContext("2d"),a=s.getImageData(0,0,r,o).data,l=a.length,u={top:null,left:null,right:null,bottom:null},c=null;for(e=0;e<l;e+=4)0!==a[e+3]&&(n=e/4%r,i=~~(e/4/r),null===u.top&&(u.top=i),(null===u.left||n<u.left)&&(u.left=n),(null===u.right||u.right<n)&&(u.right=n+1),(null===u.bottom||u.bottom<i)&&(u.bottom=i));return null!==u.top&&(r=u.right-u.left,o=u.bottom-u.top+1,c=s.getImageData(u.left,u.top,r,o)),{height:o,width:r,data:c}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,i=this._style,r=i.trim?0:i.padding,o=n.baseTexture;n.trim.width=n._frame.width=Math.ceil(t.width/this._resolution),n.trim.height=n._frame.height=Math.ceil(t.height/this._resolution),n.trim.x=-r,n.trim.y=-r,n.orig.width=n._frame.width-2*r,n.orig.height=n._frame.height-2*r,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},n.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},n.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},n.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},n.prototype._generateFillStyle=function(t,e,n){var i,r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];var o=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,a=Math.ceil(this.canvas.width/this._resolution)-o-2*s,l=Math.ceil(this.canvas.height/this._resolution)-o-2*s,u=r.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var h=u.length+1,d=1;d<h;++d)c.push(d/h);if(u.unshift(r[0]),c.unshift(0),u.push(r[r.length-1]),c.push(1),t.fillGradientType===Lc.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,s,a/2,l+s);var p=0,f=(n.fontProperties.fontSize+t.strokeThickness)/l;for(d=0;d<e.length;d++)for(var m=n.lineHeight*d,g=0;g<u.length;g++){var y=m/l+("number"==typeof c[g]?c[g]:g/u.length)*f,v=Math.max(p,y);v=Math.min(v,1),i.addColorStop(v,u[g]),p=v}}else{i=this.context.createLinearGradient(s,l/2,a+s,l/2);var x=u.length+1,b=1;for(d=0;d<u.length;d++){var _;_="number"==typeof c[d]?c[d]:b/x,i.addColorStop(_,u[d]),b++}}return i},n.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},ph,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(n.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=h(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=h(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof ch?t:new ch(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),n}(sh);da.UPLOADS_PER_FRAME=4;var mh=function(t,e){return mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},mh(t,e)},gh=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}(),yh=function(){function t(t){var e=this;this.limiter=new gh(da.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook($),this.registerFindHook(tt),this.registerFindHook(Y),this.registerFindHook(Z),this.registerFindHook(Q),this.registerUploadHook(J),this.registerUploadHook(K)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,rl.system.addOnce(this.tick,this,tl.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)rl.system.addOnce(this.tick,this,tl.UTILITY);else{this.ticking=!1;var r=this.completes.slice(0);for(this.completes.length=0,n=0,i=r.length;n<i;n++)r[n]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof $a)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&rl.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}(),vh=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(it),n.registerUploadHook(et),n.registerUploadHook(nt),n}return function(t,e){function n(){this.constructor=t}mh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(yh),xh=(function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds}}(),function(){function t(t,e,n){void 0===n&&(n=null),this._texture=t instanceof zl?t:null,this.baseTexture=t instanceof bl?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(n||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,n=f(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var n=e,i=t.BATCH_SIZE;n-e<i&&n<this._frameKeys.length;){var r=this._frameKeys[n],o=this._frames[r],s=o.frame;if(s){var a,l=null,u=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,c=new Oa(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);a=o.rotated?new Oa(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new Oa(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(l=new Oa(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new zl(this.baseTexture,a,c,l,o.rotated?2:0,o.anchor),zl.addToCache(this.textures[r],r)}n++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var i=t[e][n];this.animations[e].push(this.textures[i])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var n in void 0===t&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}()),bh=function(){function t(){}return t.use=function(e,n){var i=this,r=e.name+"_image";if(e.data&&e.type===Sc.TYPE.JSON&&e.data.frames&&!i.resources[r]){var o={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},s=t.getResourcePath(e,i.baseUrl);i.add(r,s,o,(function(t){if(t.error)n(t.error);else{var i=new xh(t.texture,e.data,e.url);i.parse((function(){e.spritesheet=i,e.textures=i.textures,n()}))}}))}else n()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:ya.resolve(t.url.replace(e,""),t.data.meta.image)},t}(),_h=function(t,e){return _h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},_h(t,e)},wh=new ka,Sh=(function(t){function e(e,n,i){void 0===n&&(n=100),void 0===i&&(i=100);var r=t.call(this,e)||this;return r.tileTransform=new Ya,r._width=n,r._height=i,r.uvMatrix=e.uvMatrix||new Pu(e),r.pluginName="tilingSprite",r.uvRespectAnchor=!1,r}rt(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Oa),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,wh);var e=this._width,n=this._height,i=-e*this.anchor._x;if(wh.x>=i&&wh.x<i+e){var r=-n*this.anchor._y;if(wh.y>=r&&wh.y<r+n)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n){return"number"==typeof n&&(p("5.3.0","TilingSprite.from use options instead of width and height args"),n={width:n,height:arguments[2]}),new e(zl.from(t,n),n.width,n.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0})}(sh),"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"),Ah=new Fa,Mh=function(t){function e(e){var n=t.call(this,e)||this,i={globals:n.renderer.globalUniforms};return n.shader=Au.from(Sh,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",i),n.simpleShader=Au.from(Sh,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",i),n.quad=new Ql,n.state=Mu.for2d(),n}return rt(e,t),e.prototype.render=function(t){var e=this.renderer,n=this.quad,i=n.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((i=n.uvs)[0]=i[6]=-t.anchor.x,i[1]=i[3]=-t.anchor.y,i[2]=i[4]=1-t.anchor.x,i[5]=i[7]=1-t.anchor.y),n.invalidate();var o=t._texture,a=o.baseTexture,l=t.tileTransform.localTransform,u=t.uvMatrix,c=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;c&&(a._glTextures[e.CONTEXT_UID]?c=a.wrapMode!==Ns.CLAMP:a.wrapMode===Ns.CLAMP&&(a.wrapMode=Ns.REPEAT));var h=c?this.simpleShader:this.shader,d=o.width,p=o.height,f=t._width,m=t._height;Ah.set(l.a*d/f,l.b*d/m,l.c*p/f,l.d*p/m,l.tx/f,l.ty/m),Ah.invert(),c?Ah.prepend(u.mapCoord):(h.uniforms.uMapCoord=u.mapCoord.toArray(!0),h.uniforms.uClampFrame=u.uClampFrame,h.uniforms.uClampOffset=u.uClampOffset),h.uniforms.uTransform=Ah.toArray(!0),h.uniforms.uColor=s(t.tint,t.worldAlpha,h.uniforms.uColor,a.alphaMode),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.uSampler=o,e.shader.bind(h),e.geometry.bind(n),this.state.blendMode=r(t.blendMode,a.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(eu),Th=function(t,e){return Th=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Th(t,e)},Eh=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),Ph=new ka,Ch=new Da,Ih=function(t){function e(e,n,i,r){void 0===r&&(r=zs.TRIANGLES);var o=t.call(this)||this;return o.geometry=e,e.refCount++,o.shader=n,o.state=i||Mu.for2d(),o.drawMode=r,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=0,o._transformID=-1,o.tint=16777215,o.blendMode=Ds.NORMAL,o._roundPixels=da.ROUND_PIXELS,o.batchUvs=null,o}return ot(e,t),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===zs.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var n=this.transform.worldTransform,i=n.a,r=n.b,o=n.c,s=n.d,a=n.tx,l=n.ty,u=this.vertexData,c=0;c<u.length/2;c++){var h=e[2*c],d=e[2*c+1];u[2*c]=i*h+o*d+a,u[2*c+1]=r*h+s*d+l}if(this._roundPixels){var p=da.RESOLUTION;for(c=0;c<u.length;++c)u[c]=Math.round((u[c]*p|0)/p)}this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Eh(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ph);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=Ch.points,i=this.geometry.getIndex().data,r=i.length,o=4===this.drawMode?3:1,s=0;s+2<r;s+=o){var a=2*i[s],l=2*i[s+1],u=2*i[s+2];if(n[0]=e[a],n[1]=e[a+1],n[2]=e[l],n[3]=e[l+1],n[4]=e[u],n[5]=e[u+1],Ch.contains(Ph.x,Ph.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}($a),Rh=function(t){function e(e,n){var i=this,r={uSampler:e,alpha:1,uTextureMatrix:Fa.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(r,n.uniforms),(i=t.call(this,n.program||Su.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r)||this)._colorDirty=!1,i.uvMatrix=new Pu(e),i.batchable=void 0===n.program,i.pluginName=n.pluginName,i.tint=n.tint,i.alpha=n.alpha,i}return ot(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;s(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(Au),Oh=function(t){function e(e,n,i){var r=t.call(this)||this,o=new jl(e),s=new jl(n,!0),a=new jl(i,!0,!0);return r.addAttribute("aVertexPosition",o,2,!1,Fs.FLOAT).addAttribute("aTextureCoord",s,2,!1,Fs.FLOAT).addIndex(a),r._updateId=-1,r}return ot(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(Yl),qh=function(t,e){return qh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},qh(t,e)},Lh=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},Dh=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[]};for(var i in e){var r=e[i].match(/^[a-z]+/gm)[0],o=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(var a in o){var l=o[a].split("="),u=l[0],c=l[1].replace(/"/gm,""),h=parseFloat(c),d=isNaN(h)?c:h;s[u]=d}n[r].push(s)}var p=new Lh;return n.info.forEach((function(t){return p.info.push({face:t.face,size:parseInt(t.size,10)})})),n.common.forEach((function(t){return p.common.push({lineHeight:parseInt(t.lineHeight,10)})})),n.page.forEach((function(t){return p.page.push({id:parseInt(t.id,10),file:t.file})})),n.char.forEach((function(t){return p.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),n.kerning.forEach((function(t){return p.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),p},t}(),zh=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new Lh,n=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),s=t.getElementsByTagName("kerning"),a=0;a<n.length;a++)e.info.push({face:n[a].getAttribute("face"),size:parseInt(n[a].getAttribute("size"),10)});for(a=0;a<i.length;a++)e.common.push({lineHeight:parseInt(i[a].getAttribute("lineHeight"),10)});for(a=0;a<r.length;a++)e.page.push({id:parseInt(r[a].getAttribute("id"),10)||0,file:r[a].getAttribute("file")});for(a=0;a<o.length;a++){var l=o[a];e.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(a=0;a<s.length;a++)e.kerning.push({first:parseInt(s[a].getAttribute("first"),10),second:parseInt(s[a].getAttribute("second"),10),amount:parseInt(s[a].getAttribute("amount"),10)});return e},t}(),kh=[Dh,zh],Bh=function(){function t(t,e){var n=t.info[0],i=t.common[0],r=f(t.page[0].file),o={};this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/r,this.chars={},this.pageTextures=o;for(var s=0;s<t.page.length;s++){var a=t.page[s],l=a.id,u=a.file;o[l]=e instanceof Array?e[s]:e[u]}for(s=0;s<t.char.length;s++){var c=t.char[s],h=(l=c.id,c.page),d=t.char[s],p=d.x,m=d.y,g=d.width,y=d.height,v=d.xoffset,x=d.yoffset,b=d.xadvance;m/=r,g/=r,y/=r,v/=r,x/=r,b/=r;var _=new Oa((p/=r)+o[h].frame.x/r,m+o[h].frame.y/r,g,y);this.chars[l]={xOffset:v,yOffset:x,xAdvance:b,kerning:{},texture:new zl(o[h].baseTexture,_),page:h}}for(s=0;s<t.kerning.length;s++){var w=t.kerning[s],S=w.first,A=w.second,M=w.amount;S/=r,A/=r,M/=r,this.chars[A]&&(this.chars[A].kerning[S]=M)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,n){var i;if(e instanceof Lh)i=e;else{var r=st(e);if(!r)throw new Error("Unrecognized data format for font.");i=r.parse(e)}n instanceof zl&&(n=[n]);var o=new t(i,n);return t.available[o.font]=o,o},t.uninstall=function(e){var n=t.available[e];if(!n)throw new Error("No font found named '"+e+"'");n.destroy(),delete t.available[e]},t.from=function(e,n,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},t.defaultOptions,i),o=r.chars,s=r.padding,a=r.resolution,l=r.textureWidth,u=r.textureHeight,c=function(t){"string"==typeof t&&(t=[t]);for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(Array.isArray(r)){if(2!==r.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+r.length+".");var o=r[0].charCodeAt(0),s=r[1].charCodeAt(0);if(s<o)throw new Error("[BitmapFont]: Invalid character range.");for(var a=o,l=s;a<=l;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,r.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(o),h=n instanceof ch?n:new ch(n),d=l,p=new Lh;p.info[0]={face:h.fontFamily,size:h.fontSize},p.common[0]={lineHeight:h.fontSize};for(var f,m,g,y=0,v=0,x=0,b=[],_=0;_<c.length;_++){f||((f=document.createElement("canvas")).width=l,f.height=u,m=f.getContext("2d"),g=new bl(f,{resolution:a}),b.push(new zl(g)),p.page.push({id:b.length-1,file:""}));var w=hh.measureText(c[_],h,!1,f),S=w.width,A=Math.ceil(w.height),M=Math.ceil(("italic"===h.fontStyle?2:1)*S);if(v>=u-A*a){if(0===v)throw new Error("[BitmapFont] textureHeight "+u+"px is too small for "+h.fontSize+"px fonts");--_,f=null,m=null,g=null,v=0,y=0,x=0}else if(x=Math.max(A+w.fontProperties.descent,x),M*a+y>=d)--_,v+=x*a,v=Math.ceil(v),y=0,x=0;else{lt(f,m,w,y,v,a,h);var T=w.text.charCodeAt(0);p.char.push({id:T,page:b.length-1,x:y/a,y:v/a,width:M,height:A,xoffset:0,yoffset:0,xadvance:Math.ceil(S-(h.dropShadow?h.dropShadowDistance:0)-(h.stroke?h.strokeThickness:0))}),y+=(M+2*s)*a,y=Math.ceil(y)}}var E=new t(p,b);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=E,E},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),Fh=[],Vh=[],Nh=(function(t){function e(n,i){void 0===i&&(i={});var r=t.call(this)||this;r._tint=16777215,i.font&&(p("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),r._upgradeStyle(i));var o=Object.assign({},e.styleDefaults,i),s=o.align,a=o.tint,l=o.maxWidth,u=o.letterSpacing,c=o.fontName,h=o.fontSize;if(!Bh.available[c])throw new Error('Missing BitmapFont "'+c+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=s,r._tint=a,r._fontName=c,r._fontSize=h||Bh.available[c].size,r._text=n,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=u,r._anchor=new Ba((function(){r.dirty=!0}),r,0,0),r.roundPixels=da.ROUND_PIXELS,r.dirty=!0,r}(function(t,e){function n(){this.constructor=t}qh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.updateText=function(){for(var t,e=Bh.available[this._fontName],n=this._fontSize/e.size,i=new ka,r=[],o=[],s=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",a=s.length,l=this._maxWidth*e.size/this._fontSize,u=null,h=0,d=0,p=0,f=-1,m=0,g=0,y=0,v=0;v<a;v++){var x=s.charCodeAt(v),b=s.charAt(v);if(/(?:\s)/.test(b)&&(f=v,m=h),"\r"!==b&&"\n"!==b){var _=e.chars[x];if(_){u&&_.kerning[u]&&(i.x+=_.kerning[u]);var w=Vh.pop()||{texture:zl.EMPTY,line:0,charCode:0,position:new ka};w.texture=_.texture,w.line=p,w.charCode=x,w.position.x=i.x+_.xOffset+this._letterSpacing/2,w.position.y=i.y+_.yOffset,r.push(w),i.x+=_.xAdvance+this._letterSpacing,h=i.x,y=Math.max(y,_.yOffset+_.texture.height),u=x,-1!==f&&l>0&&i.x>l&&(c(r,1+f-++g,1+v-f),v=f,f=-1,o.push(m),d=Math.max(d,m),p++,i.x=0,i.y+=e.lineHeight,u=null)}}else o.push(h),d=Math.max(d,h),++p,++g,i.x=0,i.y+=e.lineHeight,u=null}var S=s.charAt(s.length-1);"\r"!==S&&"\n"!==S&&(/(?:\s)/.test(S)&&(h=m),o.push(h),d=Math.max(d,h));var A=[];for(v=0;v<=p;v++){var M=0;"right"===this._align?M=d-o[v]:"center"===this._align&&(M=(d-o[v])/2),A.push(M)}var T=r.length,E={},P=[],C=this._activePagesMeshData;for(v=0;v<C.length;v++)Fh.push(C[v]);for(v=0;v<T;v++){var I=(L=r[v].texture).baseTexture.uid;if(!E[I]){if(!(N=Fh.pop())){var R=new Oh,O=new Rh(zl.EMPTY);N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new Ih(R,O),vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0,N.mesh.texture=new zl(L.baseTexture),N.mesh.tint=this._tint,P.push(N),E[I]=N}E[I].total++}for(v=0;v<C.length;v++)-1===P.indexOf(C[v])&&this.removeChild(C[v].mesh);for(v=0;v<P.length;v++)P[v].mesh.parent!==this&&this.addChild(P[v].mesh);for(var v in this._activePagesMeshData=P,E){var q=(N=E[v]).total;(null===(t=N.indices)||void 0===t?void 0:t.length)>6*q&&!(N.vertices.length<2*Ih.BATCHABLE_SIZE)||(N.vertices=new Float32Array(8*q),N.uvs=new Float32Array(8*q),N.indices=new Uint16Array(6*q)),N.mesh.size=6*q}for(v=0;v<T;v++){var L,D=((b=r[v]).position.x+A[b.line])*n,z=b.position.y*n,k=E[(L=b.texture).baseTexture.uid],B=L.frame,F=L._uvs,V=k.index++;k.indices[6*V+0]=0+4*V,k.indices[6*V+1]=1+4*V,k.indices[6*V+2]=2+4*V,k.indices[6*V+3]=0+4*V,k.indices[6*V+4]=2+4*V,k.indices[6*V+5]=3+4*V,k.vertices[8*V+0]=D,k.vertices[8*V+1]=z,k.vertices[8*V+2]=D+B.width*n,k.vertices[8*V+3]=z,k.vertices[8*V+4]=D+B.width*n,k.vertices[8*V+5]=z+B.height*n,k.vertices[8*V+6]=D,k.vertices[8*V+7]=z+B.height*n,k.uvs[8*V+0]=F.x0,k.uvs[8*V+1]=F.y0,k.uvs[8*V+2]=F.x1,k.uvs[8*V+3]=F.y1,k.uvs[8*V+4]=F.x2,k.uvs[8*V+5]=F.y2,k.uvs[8*V+6]=F.x3,k.uvs[8*V+7]=F.y3}for(var v in this._textWidth=d*n,this._textHeight=(i.y+e.lineHeight)*n,E){var N=E[v];if(0!==this.anchor.x||0!==this.anchor.y)for(var U=0,j=this._textWidth*this.anchor.x,G=this._textHeight*this.anchor.y,H=0;H<N.total;H++)N.vertices[U++]-=j,N.vertices[U++]-=G,N.vertices[U++]-=j,N.vertices[U++]-=G,N.vertices[U++]-=j,N.vertices[U++]-=G,N.vertices[U++]-=j,N.vertices[U++]-=G;this._maxLineHeight=y*n;var W=N.mesh.geometry.getBuffer("aVertexPosition"),X=N.mesh.geometry.getBuffer("aTextureCoord"),Y=N.mesh.geometry.getIndex();W.data=N.vertices,X.data=N.uvs,Y.data=N.indices,W.update(),X.update(),Y.update()}for(v=0;v<r.length;v++)Vh.push(r[v])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Bh.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype._upgradeStyle=function(t){if("string"==typeof t.font){var e=t.font.split(" ");t.fontName=1===e.length?e[0]:e.slice(1).join(" "),e.length>=2&&(t.fontSize=parseInt(e[0],10))}else t.fontName=t.font.name,t.fontSize="number"==typeof t.font.size?t.font.size:parseInt(t.font.size,10)},e.registerFont=function(t,e){return p("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),Bh.install(t,e)},Object.defineProperty(e,"fonts",{get:function(){return p("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),Bh.available},enumerable:!1,configurable:!0}),e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}($a),function(){function t(){}return t.add=function(){Sc.setExtensionXhrType("fnt",Sc.XHR_RESPONSE_TYPE.DOCUMENT)},t.use=function(e,n){var i=st(e.data);if(i)for(var r=t.getBaseUrl(this,e),o=i.parse(e.data),s={},a=function(t){s[t.metadata.pageFile]=t.texture,Object.keys(s).length===o.page.length&&(e.bitmapFont=Bh.install(o,s),n())},l=0;l<o.page.length;++l){var u=o.page[l].file,c=r+u,h=!1;for(var d in this.resources){var p=this.resources[d];if(p.url===c){p.metadata.pageFile=u,p.texture?a(p):p.onAfterMiddleware.add(a),h=!0;break}}if(!h){var f={crossOrigin:e.crossOrigin,loadType:Sc.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(c,f,a)}}else n()},t.getBaseUrl=function(e,n){var i=n.isDataUrl?"":t.dirname(n.url);return n.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}()),Uh=function(t,e){return Uh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Uh(t,e)};!function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return n.alpha=e,n}(function(t,e){function n(){this.constructor=t}Uh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0})}(Tu);var jh,Gh,Hh,Wh,Xh,Yh,Zh,Qh,Jh,Kh,$h,td,ed,nd,id,rd,od,sd=function(t,e){return sd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},sd(t,e)},ad={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},ld=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(jh||(jh={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Gh||(Gh={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Hh||(Hh={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Wh||(Wh={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Xh||(Xh={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Yh||(Yh={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Zh||(Zh={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Qh||(Qh={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Jh||(Jh={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Kh||(Kh={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}($h||($h={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(td||(td={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(ed||(ed={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(nd||(nd={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(id||(id={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(rd||(rd={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(od||(od={}));var ud=function(t){function e(e,n,i,r,o){void 0===n&&(n=8),void 0===i&&(i=4),void 0===r&&(r=da.RESOLUTION),void 0===o&&(o=5);var s=this,a=function(t,e){var n,i=Math.ceil(t/2),r="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var a=n.replace("%index%",s.toString());o+=a=a.replace("%sampleIndex%",s-(i-1)+".0"),o+="\n"}return(r=r.replace("%blur%",o)).replace("%size%",t.toString())}(o,e),l=function(t){for(var e,n=ad[t],i=n.length,r=ld,o="",s=0;s<t;s++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s.toString());e=s,s>=i&&(e=t-s-1),o+=a=a.replace("%value%",n[e].toString()),o+="\n"}return(r=r.replace("%blur%",o)).replace("%size%",t.toString())}(o);return(s=t.call(this,a,l)||this).horizontal=e,s.resolution=r,s._quality=0,s.quality=i,s.blur=n,s}return ut(e,t),e.prototype.apply=function(t,e,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,i);else{var r=t.getFilterTexture(),o=t.renderer,s=e,a=r;this.state.blend=!1,t.applyFilter(this,s,a,ed.CLEAR);for(var l=1;l<this.passes-1;l++){t.bindAndClear(s,ed.BLIT),this.uniforms.uSampler=a;var u=a;a=s,s=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,n,i),t.returnFilterTexture(r)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(Tu),cd=(function(t){function e(e,n,i,r){void 0===e&&(e=8),void 0===n&&(n=4),void 0===i&&(i=da.RESOLUTION),void 0===r&&(r=5);var o=t.call(this)||this;return o.blurXFilter=new ud(!0,e,n,i,r),o.blurYFilter=new ud(!1,e,n,i,r),o.resolution=i,o.quality=n,o.blur=e,o.repeatEdgePixels=!1,o}ut(e,t),e.prototype.apply=function(t,e,n,i){var r=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(r&&o){var s=t.getFilterTexture();this.blurXFilter.apply(t,e,s,ed.CLEAR),this.blurYFilter.apply(t,s,n,i),t.returnFilterTexture(s)}else o?this.blurYFilter.apply(t,e,n,i):this.blurXFilter.apply(t,e,n,i)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0})}(Tu),function(t,e){return cd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},cd(t,e)}),hd=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,Qu,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e}return function(t,e){function n(){this.constructor=t}cd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=1/3,o=(0,Math.sqrt)(r),s=[n+(1-n)*r,r*(1-n)-o*i,r*(1-n)+o*i,0,0,r*(1-n)+o*i,n+r*(1-n),r*(1-n)-o*i,0,0,r*(1-n)-o*i,r*(1-n)+o*i,n+r*(1-n),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,i=-.5*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,i=-.5*(n-1),r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,i,r){var o=((n=n||16770432)>>16&255)/255,s=(n>>8&255)/255,a=(255&n)/255,l=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,c=(255&i)/255,h=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,l,u,c,e=e||.15,0,o-l,s-u,a-c,0,0];this._loadMatrix(h,r)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Tu);hd.prototype.grayscale=hd.prototype.greyscale;var dd=function(t,e){return dd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},dd(t,e)};!function(t){function e(e,n){var i=this,r=new Fa;return e.renderable=!1,(i=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,i.maskMatrix=r,null==n&&(n=20),i.scale=new ka(n,n),i}(function(t,e){function n(){this.constructor=t}dd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.apply=function(t,e,n,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var r=this.maskSprite.worldTransform,o=Math.sqrt(r.a*r.a+r.b*r.b),s=Math.sqrt(r.c*r.c+r.d*r.d);0!==o&&0!==s&&(this.uniforms.rotation[0]=r.a/o,this.uniforms.rotation[1]=r.b/o,this.uniforms.rotation[2]=r.c/s,this.uniforms.rotation[3]=r.d/s),t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0})}(Tu);var pd=function(t,e){return pd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},pd(t,e)};!function(t){!function(t,e){function n(){this.constructor=t}pd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}((function(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}),t)}(Tu);var fd=function(t,e){return fd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},fd(t,e)};!function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random());var i=t.call(this,Qu,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=n,i}(function(t,e){function n(){this.constructor=t}fd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0})}(Tu);var md=new Fa;Ja.prototype._cacheAsBitmap=!1,Ja.prototype._cacheData=null;var gd=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(Ja.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new gd),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),Ja.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},Ja.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var n=this.getLocalBounds(null,!0).clone();if(this.filters){var i=this.filters[0].padding;n.pad(i)}n.ceil(da.RESOLUTION);var r=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),s=t.projection.transform,a=Fl.create({width:n.width,height:n.height}),l="cacheAsBitmap_"+d();this._cacheData.textureCacheId=l,bl.addToCache(a.baseTexture,l),zl.addToCache(a,l);var u=this.transform.localTransform.copyTo(md).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,a,!0,u,!1),t.projection.transform=s,t.renderTexture.bind(r,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var c=new sh(a);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-n.x/n.width,c.anchor.y=-n.y/n.height,c.alpha=e,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)}},Ja.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},Ja.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;var i=t.context,r=t._projTransform;e.ceil(da.RESOLUTION);var o=Fl.create({width:e.width,height:e.height}),s="cacheAsBitmap_"+d();this._cacheData.textureCacheId=s,bl.addToCache(o.baseTexture,s),zl.addToCache(o,s);var a=md;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,o,!0,a,!1),t.context=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new sh(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-e.x/e.width,l.anchor.y=-e.y/e.height,l.alpha=n,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},Ja.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Ja.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Ja.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,bl.removeFromCache(this._cacheData.textureCacheId),zl.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Ja.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},Ja.prototype.name=null,$a.prototype.getChildByName=function(t,e){for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,i=this.children.length;n<i;n++)if(this.children[n].getChildByName){var r=this.children[n].getChildByName(t,!0);if(r)return r}return null},Ja.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new ka),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var yd=function(t,e){return yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},yd(t,e)},vd=function(t){function e(e,n,i,r){void 0===e&&(e=100),void 0===n&&(n=100),void 0===i&&(i=10),void 0===r&&(r=10);var o=t.call(this)||this;return o.segWidth=i,o.segHeight=r,o.width=e,o.height=n,o.build(),o}return ct(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],i=[],r=this.segWidth-1,o=this.segHeight-1,s=this.width/r,a=this.height/o,l=0;l<t;l++){var u=l%this.segWidth,c=l/this.segWidth|0;e.push(u*s,c*a),n.push(u/r,c/o)}var h=r*o;for(l=0;l<h;l++){var d=l%r,p=l/r|0,f=p*this.segWidth+d,m=p*this.segWidth+d+1,g=(p+1)*this.segWidth+d,y=(p+1)*this.segWidth+d+1;i.push(f,m,g,m,y,g)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(Oh),xd=function(t){function e(e,n,i){void 0===e&&(e=200),void 0===i&&(i=0);var r=t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return r.points=n,r._width=e,r.textureScale=i,r.build(),r}return ct(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var r=n.data,o=i.data;r[0]=0,r[1]=0,r[2]=0,r[3]=1;for(var s=0,a=t[0],l=this._width*this.textureScale,u=t.length,c=0;c<u;c++){var h=4*c;if(this.textureScale>0){var d=a.x-t[c].x,p=a.y-t[c].y,f=Math.sqrt(d*d+p*p);a=t[c],s+=f/l}else s=c/(u-1);r[h]=s,r[h+1]=0,r[h+2]=s,r[h+3]=1}var m=0;for(c=0;c<u-1;c++)h=2*c,o[m++]=h,o[m++]=h+1,o[m++]=h+2,o[m++]=h+2,o[m++]=h+1,o[m++]=h+3;n.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],i=0,r=0,o=this.buffers[0].data,s=t.length,a=0;a<s;a++){var l=t[a],u=4*a;r=-((e=a<t.length-1?t[a+1]:l).x-n.x),i=e.y-n.y;var c=Math.sqrt(i*i+r*r),h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=c,r/=c,i*=h,r*=h,o[u]=l.x+i,o[u+1]=l.y+r,o[u+2]=l.x-i,o[u+3]=l.y-r,n=l}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(Oh),bd=(function(t){function e(e,n,i){void 0===i&&(i=0);var r=this,o=new xd(e.height,n,i),s=new Rh(e);return i>0&&(e.baseTexture.wrapMode=Ns.REPEAT),(r=t.call(this,o,s)||this).autoUpdate=!0,r}ct(e,t),e.prototype._render=function(e){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),t.prototype._render.call(this,e)}}(Ih),function(t){function e(e,n,i){var r=this,o=new vd(e.width,e.height,n,i),s=new Rh(zl.WHITE);return(r=t.call(this,o,s)||this).texture=e,r}return ct(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e}(Ih)),_d=(function(t){function e(e,n,i,r,o){void 0===e&&(e=zl.EMPTY);var s=this,a=new Oh(n,i,r);a.getBuffer("aVertexPosition").static=!1;var l=new Rh(e);return(s=t.call(this,a,l,null,o)||this).autoUpdate=!0,s}ct(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)}}(Ih),function(t){function e(e,n,i,r,o){void 0===n&&(n=10),void 0===i&&(i=10),void 0===r&&(r=10),void 0===o&&(o=10);var s=t.call(this,zl.WHITE,4,4)||this;return s._origWidth=e.orig.width,s._origHeight=e.orig.height,s._width=s._origWidth,s._height=s._origHeight,s._leftWidth=n,s._rightWidth=r,s._topHeight=i,s._bottomHeight=o,s.texture=e,s}ct(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,i=this._height>n?1:this._height/n;return Math.min(e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}(bd),function(t,e){return _d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},_d(t,e)}),wd=function(t){function e(e,n){void 0===n&&(n=!0);var i=t.call(this,e[0]instanceof zl?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=n,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i}return function(t,e){function n(){this.constructor=t}_d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(rl.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(rl.shared.add(this.update,this,tl.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var n=[],i=0;i<t.length;++i)n.push(zl.from(t[i]));return new e(n)},e.fromImages=function(t){for(var n=[],i=0;i<t.length;++i)n.push(zl.from(t[i]));return new e(n)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof zl)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(rl.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(rl.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(sh);Zu.registerPlugin("accessibility",nl),Zu.registerPlugin("extract",cc),Zu.registerPlugin("interaction",pl),Zu.registerPlugin("particle",Oc),Zu.registerPlugin("prepare",vh),Zu.registerPlugin("batch",sc),Zu.registerPlugin("tilingSprite",Mh),Tc.registerPlugin(Nh),Tc.registerPlugin(bh),ac.registerPlugin(ol),ac.registerPlugin(Ec);var Sd,Ad=t(9477),Md=t(6729),Td=t.n(Md),Ed={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-Ed.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Ed.Bounce.In(2*t):.5*Ed.Bounce.Out(2*t-1)+.5}}},Pd="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},Cd=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=Pd()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var r=this._tweens[n[i]],o=!e;r&&!1===r.update(t,o)&&!e&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),Id={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=Id.Utils.Linear;return e<0?o(t[0],t[1],i):e>1?o(t[n],t[n-1],n-i):o(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,o=Id.Utils.Bernstein,s=0;s<=i;s++)n+=r(1-e,i-s)*r(e,s)*t[s]*o(i,s);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=Id.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),o(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):o(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Id.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(Sd=[1],function(t){var e=1;if(Sd[t])return Sd[t];for(var n=t;n>1;n--)e*=n;return Sd[t]=e,e}),CatmullRom:function(t,e,n,i,r){var o=.5*(n-t),s=.5*(i-e),a=r*r;return(2*e-2*n+o+s)*(r*a)+(-3*e+3*n-2*o-s)*a+o*r+e}}},Rd=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),Od=new Cd,qd=function(){function t(t,e){void 0===e&&(e=Od),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Ed.Linear.None,this._interpolationFunction=Id.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Rd.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?Pd()+parseFloat(t):t:Pd(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,n,i){for(var r in n){var o=t[r],s=Array.isArray(o),a=s?"array":typeof o,l=!s&&Array.isArray(n[r]);if("undefined"!==a&&"function"!==a){if(l){var u=n[r];if(0===u.length)continue;u=u.map(this._handleRelativeValue.bind(this,o)),n[r]=[o].concat(u)}if("object"!==a&&!s||!o||l)void 0===e[r]&&(e[r]=o),s||(e[r]*=1),i[r]=l?n[r].slice().reverse():e[r]||0;else{for(var c in e[r]=s?[]:{},o)e[r][c]=o[c];i[r]=s?[]:{},this._setupProperties(o,e[r],n[r],i[r])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=Pd()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=Pd()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=Pd()),void 0===e&&(e=!0),this._isPaused)return!0;var n,i,r=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>r)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||i>1?1:i;var o=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,a=this._chainedTweens.length;s<a;s++)this._chainedTweens[s].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,n,i){for(var r in n)if(void 0!==e[r]){var o=e[r]||0,s=n[r],a=Array.isArray(t[r]),l=Array.isArray(s);!a&&l?t[r]=this._interpolationFunction(s,i):"object"==typeof s&&s?this._updateProperties(t[r],o,s,i):"number"==typeof(s=this._handleRelativeValue(o,s))&&(t[r]=o+(s-o)*i)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),Ld=Rd.nextId,Dd=Od,zd=Dd.getAll.bind(Dd),kd=Dd.removeAll.bind(Dd),Bd=Dd.add.bind(Dd),Fd=Dd.remove.bind(Dd),Vd=Dd.update.bind(Dd);const Nd={Easing:Ed,Group:Cd,Interpolation:Id,now:Pd,Sequence:Rd,nextId:Ld,Tween:qd,VERSION:"18.6.4",getAll:zd,removeAll:kd,add:Bd,remove:Fd,update:Vd};var Ud=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"init",value:function(){t.eventEmitter=new(Td()),t.isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;var e=t.getVisibilityProps();e.visibilityChange&&document.addEventListener(e.visibilityChange,t.handleVisibilityChange)}},{key:"start",value:function(){window.addEventListener("resize",t.fitLayout),setInterval(t.fitLayout,100),t.fitLayout()}},{key:"hideAddressBar",value:function(){window.scrollTo(0,1)}},{key:"getVisibilityProps",value:function(){var t,e;return void 0!==document.hidden?(t="hidden",e="visibilitychange"):void 0!==document.mozHidden?(t="mozHidden",e="mozvisibilitychange"):void 0!==document.msHidden?(t="msHidden",e="msvisibilitychange"):void 0!==document.webkitHidden&&(t="webkitHidden",e="webkitvisibilitychange"),{hidden:t,visibilityChange:e}}},{key:"handleVisibilityChange",value:function(){var e=t.getVisibilityProps();t.eventEmitter.emit("visibilityChange",{hidden:document[e.hidden]})}},{key:"isHidden",value:function(){var e=t.getVisibilityProps();return!!document[e.hidden]}},{key:"fitLayout",value:function(e,n){var i,r;"number"==typeof e&&"number"==typeof n||(e=window.innerWidth,n=window.innerHeight,t.isOpera&&t.isMobileDevice()&&(e=window.outerWidth,n=window.outerHeight)),(t.width!==e||t.height!==n)&&(document.body.style.width=e+"px",document.body.style.height=n+"px",t.width=e,t.height=n,t.orientation=e>n?t.LANDSCAPE:t.PORTRAIT,t.orientation===t.LANDSCAPE?(r=$v.size.width,(i=Math.floor(r*(e/n)))<$v.size.height&&(i=$v.size.height,r=Math.floor($v.size.height*(n/e)))):(r=$v.size.height,(i=Math.floor(r*(e/n)))<$v.size.width&&(i=$v.size.width,r=Math.floor($v.size.width*(n/e)))),t.gameWidth=i,t.gameHeight=r,t.left=-i/2,t.right=i/2,t.top=-r/2,t.bottom=r/2,t.scale=Math.min(e/i,n/r),t.aspectRatio=Math.max(i/r,r/i),t.eventEmitter.emit("resize",{width:t.gameWidth,height:t.gameHeight}),setTimeout(t.hideAddressBar,100))}},{key:"on",value:function(e,n,i){t.eventEmitter.on(e,n,i)}},{key:"once",value:function(e,n,i){t.eventEmitter.once(e,n,i)}},{key:"off",value:function(e,n,i){t.eventEmitter.off(e,n,i)}},{key:"isTablet",value:function(){return t.aspectRatio<1.4}},{key:"isIphoneX",value:function(){return t.aspectRatio>2}},{key:"isLandscape",value:function(){return t.orientation===t.LANDSCAPE}},{key:"isPortrait",value:function(){return t.orientation===t.PORTRAIT}},{key:"isMobileDevice",value:function(){return/android|iphone|kindle|ipad/i.test(navigator.userAgent)}}],null&&ht(e.prototype,null),n&&ht(e,n),t}();dt(Ud,"width",0),dt(Ud,"height",0),dt(Ud,"scale",1),dt(Ud,"aspectRatio",1),dt(Ud,"gameWidth",0),dt(Ud,"gameHeight",0),dt(Ud,"orientation",0),dt(Ud,"left",0),dt(Ud,"right",0),dt(Ud,"top",0),dt(Ud,"bottom",0),dt(Ud,"isOpera",!1),dt(Ud,"LANDSCAPE",1),dt(Ud,"PORTRAIT",2),dt(Ud,"eventEmitter",null);const jd=Ud;var Gd=t(1766),Hd={sounds:{}};Hd.soundsOff=Gd.Howler.mute.bind(Gd.Howler,!0),Hd.soundsOn=Gd.Howler.mute.bind(Gd.Howler,!1),Hd.addSound=function(t,e){Hd.sounds[t]=e},Hd.enabled=!0,Hd.paused=!1,Hd.silentSound=null,Hd.isLocked=!0,Hd.play=function(t,e,n){if(Hd.enabled&&!Hd.paused){Hd.isLocked&&console.error("STOP! Do not play sounds before first user interaction!",t);var i=Hd.create(t,{autoplay:!0,loop:e||!1,volume:void 0===n?1:n});return i&&(Hd.createSilentSound(),i._playId=i.play()),i}},Hd.replay=function(t){t._playId?t.play(t._playId):t._playId=t.play()},Hd.playSingle=function(t,e,n){for(var i=Hd.getSrc(t),r=0;r<Gd.Howler._howls.length;++r){var o=Gd.Howler._howls[r];if("function"==typeof o.volume&&o!==Hd.silentSound&&0!==o.volume()&&0!==o.seek(o._playId)&&o._src===i)return null}return Hd.play(t,e,n)},Hd.createSilentSound=function(){Hd.silentSound||(Hd.silentSound=new Gd.Howl({src:Hd.SILENT_SOUND,autoplay:!0,loop:!0,volume:0}),Hd.silentSound._playId=Hd.silentSound.play())},Hd.checkDuration=function(){this._name&&this.duration()<1&&!Hd.durationAttentions[this._name]&&(console.warn("ATTENTION! Sound "+this._name+" have less than 1 second duration!"),Hd.durationAttentions[this._name]=!0)},Hd.create=function(t,e){var n=Hd.getSrc(t);if(!n)return null;(e=e||{}).src=[n],e.onload=Hd.checkDuration;var i=new Gd.Howl(e);return i._name=t,i},Hd.getSrc=function(t){var e=Hd.sounds[t];return e||console.warn("Sound "+t+" not found"),e},Hd.unlock=function(){Hd.isLocked&&(Hd.createSilentSound(),Hd.isLocked=!1,document.body.removeEventListener("mousedown",Hd.unlock,!0),document.body.removeEventListener("touchstart",Hd.unlock,!0),document.body.removeEventListener("pointerdown",Hd.unlock,!0))},Hd.init=function(){var t,e=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{for(e.s();!(t=e.n()).done;){var n=t.value;Hd.addSound(n.name,n.url)}}catch(t){e.e(t)}finally{e.f()}document.body.addEventListener("mousedown",Hd.unlock,!0),document.body.addEventListener("touchstart",Hd.unlock,!0),document.body.addEventListener("pointerdown",Hd.unlock,!0)},Hd.mute=function(t){Hd.soundsOff()},Hd.unmute=function(){Hd.enabled&&Hd.soundsOn()},Hd.pauseAll=function(){if(!Hd.paused){Hd.paused=!0;for(var t=0;t<Gd.Howler._howls.length;++t){var e=Gd.Howler._howls[t];if("function"!=typeof e.volume)return;0!==e.volume()&&0!==e.seek(e._playId)&&(e._pausedSeek=e.seek(e._playId),e.pause())}}},Hd.resumeAll=function(){if(Hd.paused){Hd.paused=!1;for(var t=0;t<Gd.Howler._howls.length;++t){var e=Gd.Howler._howls[t];if("function"!=typeof e.volume)return;0!==e.volume()&&0!==e.seek(e._playId)&&(e.play(e._playId),e.seek(e._pausedSeek||0,e._playId))}}},window.famobi.onRequest("enableAudio",(function(){Hd.mute()})),window.famobi.onRequest("disableAudio",(function(){Hd.unmute()})),Hd.removeAll=function(){for(var t=0;t<Gd.Howler._howls.length;++t)Gd.Howler._howls[t].unload()},Hd.autoStartBackgroundMusic=function(t,e){return new Promise((function(n,i){if(t){e||(e={}),e.autoplay=!1,e.loop=void 0===e.loop||e.loop;var r=Hd.create(t,e);r.play(),n(r)}else i()}))},Hd.autoStartSound=function(t,e){return e||(e={}),e.loop=void 0!==e.loop&&e.loop,Hd.autoStartBackgroundMusic(t,e)},Hd.durationAttentions={},Hd.SILENT_SOUND="data:audio/mp3;base64,//OAxAAAAAAAAAAAAEluZm8AAAAPAAAAOQAAL9cABAgIDQ0RERYaGh8fIyMoLCwxMTU1Oj4+Q0NHR0xQUFVVWVleYmJnZ2trcHR0eXl9fYKGhouLj4+UmJidnaGhpqqqr6+zs7i8vMHBxcXKzs7T09fX3ODg5eXp6e7y8vf3+/v/AAAAOUxBTUUzLjk3IAFuAAAAAC3+AAAUQCQE8CIAAEAAAC9XIvp9JwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zgMQAAAADSAAAAABMQU1FMy45N1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuOTdVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/84LEwwAAA0gAAAAAVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVMQU1FMy45N1VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zgsT/AAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjk3VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//OCxP8AAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVCR2WtMlTPLaCEcQhDRIkWpNUBccLCIBTNBBCxhFgrs01SUYOMLnq6Vgf/CX08NvEvxE9ZSkE51tF7g7/84LE/wAAA0gAAAAAFNMEyGgsmTVmUIxkv+FgwdWZjQIFAT6ThlGCs4+ce75gPCSJdNy1lAYwAskz5uyglwDoGamDhxR49Ajd600dKPJgzTt45pxP9kTkPg26RPPRTcJAzYZNaSDCiEzkhFRHJhLEHvM1iaJwoBAnM5AQMYIQjQwYJPEsg4qY7XkiGNsXXZLXYnX/ppZu3pAqGgUBQiLAoQGX6EoSa4ABlZLEk7wsVDK/U3yiIqOhc56i/aowEw0plqPata1CzheBXCt7dS8QQf/zgsT/McnRgBDO8YGK5GjjfNM1VhgZsfhiZz3gYRCkikEQw6ICsS0SnBkomfub5Qo0sIniYBhQCtsuIxgKMUJjAwcBERlKOY8IGzvI6yAGRNfWTsR8zaiM+JjD3s8L2OnaTkEkDeRn5aYUDsqM6FGuJvKMmgyGtgVM8d0sBJF9TfBYIrQIAEN2OpDsDn1kNYRoiTh6Z2/9uteAJAkMvisxsRzAplMnA0xscAMCDCBNMXG01CeTSo1FnOZ1MhE/TAKwMrD80KghJTGnAQZBK5gg//OCxPsxgcWwEM7zZXAhMZkEWGjQgaNBxgcIGmB2YFERpo7GEQaZGJxnEIhQimfDEYBL5kcUmPCkZwuhgsAmdDSaXbZkgNGKCQae9Rk6CmsIYaQSpn5BmFGGI3EbXdpmMGmeXeaHbCuTI6UM1h8ysdTLxDMHBgxUayAVm00eYoZxlwgmHQUZPm5sk5GqZ6erZhzF8GaOVn2edG1j3GOG4mMQIGXR0HPFYHPxqnDsjGDwnFgajHlEzOI1zK4HWbH1NwjGzpBE0d3NFYDTbgwQaNb/84LE+U/R4YgQ53eAns6c+P7UzN3w0IGNrWzQyszOcMEWg6CNUGjCQ81sACh8ZUMA0IIi9OYSB0r3HSvac4LiSvV3//14uv/0HTDS4///////aqoJmbuZidGiBwYhmFsxlA2YCeowiwaZOOAg/AIOIisxxKMXNAaKGGHpipQY0MkT+DUUw0iJo4ahTOoQyQ+EmgQjogGTUE8wgjMuBDFCEwMuAyOMF4WzjEgIeGTBRQ3MLACMYGFDPcbmImf1BzhoQRBoJ8bU0GfFJA6nDZBnY//zgsR9RXnVmAjfNYImNE5Q2GSkxgC0DoYSlzITEzIBNAPjZD4DIxlBQaG1GBsJzXAcaUGZCIaQbZqYznjKgOtI0jMjn+OMTRs5WpzJhkBBnMdgEwyAjAIqMgyNMGMilOaAMWzDoIIMDEoy4Ixr8KhDK1x12HcTJIAy8ZsuYDccU0KtiiwOCzKuhLCCB5dgYDigsaDqSTds4Ax/////4xdn/////9EYUAq0ZGZLSHmul60Ny/xf1nysKwMFWp5YqLEmgN6FAy7sMkKQC8vGPlNK//OCxCsvwdXAWMazZci6RnDBtoXgTuAQB0TsJMgpCjxvYXGYOIshoQAJcp4SbSGeZimXhOx1cnYZZ8xlAhVuwUj+vtUAVGAIlFwwUJKDGFgIrMQJJnxlzBWZOcaNZyLdAeSbhkrhKFphaRZgITCCQsKAhUMGYrgGmFFihFYUrEBRBnFt8AABosE7At8HeFzgYEZpRbWUBgy90ZHBjMYgTCsAxwFHAyg2bOBJRQEuYX1QNCMxokKEMVQDlBhnjqXANZNcRiKql4RqYDEqtMkJmJD/84LEMDJ53bQQzrEslrBqpo9vKFhgYEHoiYCVpUaCqqDpggicBpxpkiKehqJwKIAY2rYawyDlYYKBpMuMj+pshNAwMxgVM8KhAgmBh5olAGVo0j1heRmLxiG5uRYQoMYbPjUSFM3ENqWNNVKFpEOBy5zEwQHMCol4KAWRARDbJgoicgsKudlFgxkBQUrA5JtOF0D3y/BGMvq0Nn6HNhjD5prUtv41dAmM00FcYtACFFtmMIIz1bi86RAVUohwRiCAIBJGq0XKV0OUp7PjhKFqmv/zgsQqM3HVsAjO8Utkp3BUxxzNWByQGPZKmsbtQwaYIwUKB6xhhCWQsSaHh8nA2UFEHug1wxcGESSTKQcCEIIPLwQJpchweWAZJSFmGFgOWhoVMZJ2FCySYcUgYLMTLDAAoiFzb1A8E7MqaBxkCH44syNjQniEIMKCAJEzAgAnWy5OoyjGQCYQupxyodNUtoNLKnwNdBGrcWrNgE1xPCl6NCLYkFWFs0FKnf6BqTtMSmAGLPQLaZdNSxNBbFTtXwiMuownComSJOvsO1VCF5iV//OCxCAwYdW4MMaxLIiIX9a+JRI9goYRsFOJ5ETFSsaLzB60fl8mTKVKmiHRFYdPptGONGACGqANABgMWRBw4OJmdAA644iY5hQq2i2gJBq6SmApAHBy1ZqSDLjNpEmTH5jLOzNwDFFRJGcxWYlyYiQZNeftyYUiiqj015lqH7jiQFyo3gJ6pF8q/Z0lqcxuW3FsyfQsUz5GAKwpSiSAgyhzd1ely12q5f2Pv3U2igGCGmB7mNIVYW4PL2bjQ0cy46Woy0LAMRUwSg6Krzwo0DT/84LEIjCZ0bgQxrMQeTWAIYI3uMnsmEX4bshavEmQNBWFJZlahY4jABw0uYQBwEOCoArBDBlAUBRY+ZLeCIQYAQACLZUOZngxap0XYATJAADAIQfxHQI0AL5GGanPYmsMnyLoNEZg7IknCG50go6ZMwUQEA6sEJLfkwsSKM0QoCMIAwgBpoEIl0maAwpAaYZ5eRrYUCQaOMlu7DgsIaBSmkJjaYCgy4LUth+zZVXgDocJt3W2SoSDjyaw9xFskS4QREmM1lFIYEutPYRAHEqpNf/zgsQjLsHRvDDGsWX1eJ6pMpVCMk4ouhWjOISglKGqYAJEuqGxC1E4eAKxh0TigGOYXjVvVjMCwPBHNVpcw3DXwgBaoCgamYCHEQIEDzCCp8IImqmGzNmPUmDWGdZGLSmLXGrNHIvFI0/LUmYLxV3AqVxcM2HTETTSvBhiwlNMwEQdjhiOhMdBAaAtJzgBjTxghhEaJMWQJQagspoo7HJfDMavjRwQda6dAUHTxGR0B7TmgILlgkRGg52Dmsl0wUyhzpAEFeQFOmoyVRFksrFj//OCxCwxedW8UM6xZcxy0IDOqNVotGLEjyIUCh4KjA4Iy0Bp1g4haChhFOYibmFwogNHG+caAoloqgrMFSigUzQH8UOQFgQCYMoYgQY8aIzKMoQaOGnM8yNG2MiUB2EaQg78ZJsaDmcFyX8NMNRaaQgwYQE3dZgJSrGhEblhrzIJdpIVOM0DAqQYFZbcCFow06tCtFuCR0Xi2pa9jirYdi7tQPNU+U4lAAK5zBV8t0bv2WNmgx6mvsreNnbT4afSmkacjK2TCE4gCvaLMtUBSnX/84LEKim51cxYxl+BLofXG1ItSr1N4SEigLEQobo1VeyGgUK2haiGUKQpFcDD1TtJag4C0l8uPBKVIVEnSyJ12inmxuUIjkQyqFA7lHpQZ7Z4spRnbGdACgbBHPVlZeLaEdTqLGiYBFnIHpKL40C7F1aiYDpBxgniaiwF2D/Q8b4JZoTyEnDvEq0AavSA9ZSl+O1SoJLHQmV+Inmc4ydhDhci7rYWIzOnZa6ipmv+/KWbA4aWghGshk8vdqBi36GTTGcsBYOPIW4rDTOeqNEeR//zgsRHJmHR3Zh+Hr088TQad0HohiiZa474v0lY30Mo+peA6KRZIGlGBQCgTEZAkauJnbW6GyG2ZSkRB5CarJ3EoUJISLFIFLD0SodwIMEZOwhDCOou62nirY0MV8bAlWAABhQq406i4H4e8Mbs5PRQGQTQULgspa+EDpFWOyIyQItBgAchdzV1K4E6lTGW0dJm7dBkS+lIBBodZYFAJyw4WApmNzGkKY+8Dwt6w12W4JzKhYawhOgDBS9IYkwVYyEAqeFriEs2ogYYcDwXqC/A//OCxHEoecnMWH4ynVDZO6yTT+sDWUkc4Szmtr1gy2+ytzOWMroS6kzXUcAMAjoXhWOj0sxQSLuL70w5RhIAlg3NnV3NPWAcRtUtFzU7G1h25tMY2lewlcitrCoqnxEldMZlLW05XzUoZZPcVYiZACeQqtdIKajgQligiQ3NuQiCHUg5eqtaa8SVWZw6iHrHWGtaTKUCCsAgT1BrCK6WAqA03S1YzUz4IWOq4R/mlAd8jIISls4zmFsOI2W0wzIE0ETE5F3LeMB8HOXkSoGi+If/84LEkyjp1cwQxl+DJYAVq09bnaJCbxb6qh+5zy0AmZAHMlCzUgD9gKBPmg7OIlwc5KhH1CpibJHLnWg4KT7cGWrzWGUgJCgQmgt5gjuM5jS8WUSoMGoKXZL+RhsjcC2okMaao2XrUCcJfSkIYjDbTTrLsc1I9tXNWsKyMR0zyILP0hTVHDFA6sgEC8IH0NU9hLqQNKH0SJgdh6cjE6RiLSouny+i4WcMycGkLhpCraU2McVlLZmdNY1Fp2kuASoA0/l0Rst+xlTNLKIO0w9fBf/zgsSzKEnJ0ZB+Mrn5bk6a+0vH3Zw0KBomzha7D2CL+bxmjws4Z2/cJeVgbJIbcFBxBtK4i05pAttCyZUACJArq4BZZpQ4aEstWKhRhbddCwCA1wYii4kWr1MMcSIsAkI9IFUhg1YMmGTEDw0ypELjzBImYofQC3dVinptgrQ1hGnqxsRXMl2sHi0xFdYWZc2BmfixJOk5I+RGWOM4dT7ddDUJrWFlGDqIqLQhCFzIpNBHYh7REdAEEPVtRQRmLXG+A0oQyHMtaKgAgSg60VYQ//OCxNUpmdHIEMaxgQFMcwOVTZIwwJRRIRlzAChEURxAOkCMC7plQZtRAK0IyCQMgCCVUwB8xIcxaFjKxzNgAuJdduIQDIizhJnMXLSGXFmANGVHGtZGCMnDRgEDNJNzoQk24uMzfzPwg4kaJWY3Q1DAYVGiYmJQZyWWwyBgossDiEmCyYKAAWWVCBAaRl+AIeRpAwA6D9kQaloRBJhYal8rAsp5o20iJOTcjtYYCGAACAgcxhVOgwRAEFgmVrvCwJEyQmNIAgIyIXaMoFQ9HKH/84LE8jO50bAIxrcNSAJCFx0CCVgGCJFYdViMhoAtEApKO5SAdkYsgjkKrGQQL4AmE54yUc01k0C8Sm5gKHlERJBx6KqgaVQIGRsCoRWSBghCMEQcWTlgGX2HQgUgC1dOMyCU6cMX+g0eImhkgx/lJ2QphL5kUoHDIVIupUFARIcgCFhLRAri6hcRrZEYzkBAGipmosptpIooiFoew3KBKyUxjGAiITIohqps77SoCn5ZFREKyl/NOZUq0oSLrNdtkocmFBSU2aeNkq5BEAkyQv/zgsTnMnnVuPjOsWUJjFpbuEOhDJL8Upd1rLqSJEFK1BhDoXflJbQBoG7SSbhuAcOYYgj9BiQ4OicCFYmrU8ykkc0oAoAYY5fZaCW600LEWwgQMdJEtBYLNDJDFUQDVJgq2Bng44GM0GgSEGVMppyUaceFrEg06EBSegQAINo8m8KpSdYEEOpkCokU0+mjNjGRJIrFZWnGs1opctZ8DOC/D2RaEZ2Mbu1FQhQgQ9QyA5Q0sFjh1pgYGEQ7F82hgJYGgAo0tog8VTRYpQsz0gES//OCxOEuYdW8CM7xZWCSs5VFLiVKPPqYQSjCA4yxyg4RPCNIQPGuyMXIhQ2bfpijHcQb2IgRL3GWQBBxkYwFqjHUKTVKRrWcUFkEJgBKPI0FATUzYUeriNAUTxQKYisaqQInpsC4FhGpRHRumm2gWWYZSASKgYqQEhkyWSWgMPRDIVAwqmAwARAZ2iKtkWCvBaQmJEd+k7obYuinAkQlDhPLRU263iUKUCAYDSS6RcQMFL1IbNOJRC/IiDIiICL0GQULAMGQDAKCDzJbL8JkKIj/84LE6zAx0bQAzrFl8ILKQanQJBK6UcERpeVH9BVwhCuJDiEAGOHQElcKqJkjUwF0IgTFBLcCz4GAA0ZAICoBgsRiKYJ4MkV0mImcvkzZjGDHshFKZ8ilwUKO+43As1dkuwYh8bq2bgAkCaQQHqmdKfHiKxZpjLqSmGDDCf8FJooglMBAPwDBiwCURpIqaGYCWfMygwVAKGIi0JkEJWp62lBVjyjGIXVKCIAACIoLrQyf+DB4LGgQQrGXzSULdBciRoXQW0eVXKPqQCcy8zaoQ//zgsTuMVnVvPjOs4AiygmczjImizEgEAbI4S1AvYFBJ/FtQ5ARYuYNCQbXilceUDHyIimS/QaMlPECYhQ9jbsLiLXJkkRxoJeU0A5P4wRJD4xggGNTPGwNPOS8DsRvWZsxx1xx514qFMiaLyKmkIEDJbDU4eZYWoYsIhiMDatdf0CActhy53qCwDFFrhnEZUBcpkCEJVSQSIVtwh+FvjDF6mTVD4AYwV775d0HCW8hqvMvqwwYoDBiEQ6YHECGlKF7J3OeXOY8XQMgzYECnXYv//OCxOwvidW8+MaxZAestKFokPjHEXQFiiQskKBkpvhmuYZRxQiZ9oYRJ2QmQiYzqCMaLKBgoSBmbAwM09Q0FFIpiEcFIFIZ5pmaumwZDAXHNJYHJGmmZ0YbteEoCpOPU5N/jPcuN3umC25IMChkqD1tiohIdGR+BI4sMHEAwClRJCwFTzIRBfBQEteVQQCAGgJDoVeQBGhcApY2cRhJRLHE3EyW1QpRo6EBwWIg9RwQBo+Alpmw8+YIRMiWvdwvqFSFdjIiKgKIBs5gjJiGMaD/84LE8TFRzbjQxnTx5AhIME0uOW9Y+pog6XwhJjEAoE0oG6gEUj1MogklLVlx2/LrhVUyxAylQYlJUuMNE5XwEQGFBlSnRadTMdCAweZAOLjAQaNBPGZRqkYVVnuOmOQgYmdjaI4J/vBlUgOJGGDAESzAwoFiAKNjIQVsgE1IwPTUQ7rCNdUCKgRCJeDJUErS0LgDUsKRCBAEErFRQcy8j8txfmIReOoBlISAYylOteAG+wNeCgqlq2AdJG8wkH5GgSehjGBRFoVNwVwGkVoBoP/zgsTvMVnNtAjOsWcSSTPJAjCwWN3liAk7NkyR5AyoYAKPQlDrii4QgAqAjROonTARYkMscafMMEFLC1K6EEQyIVBm4J0MhaQOiizpfh1yqAbRJ5TlWkBJn+qCkgtZBNU074iDmf+G5jiMWJNVSF4kJCh644FEhwYFQdMOHUGFhi7yzSvhEIYZMl/kfaYWICzIsmLKgsZDkLK2XDQ1fCYiEDY4bmqv2MYHABsDL3iwyFTQi4gIVYKhKR3RECBS9blESIyCxRPQhGiDjFzlhlWK//OCxO0xMd29mMZ1KFIICLgEIKCwAFBQ4hALcKoMRhkYRImVVwAWZ0aVBhlFuzEVMImnBhgsuFkkz0iTHBSqX2tYuOJFJqA0J2kE6Ka8koQdcYzpk0HDqdax1S5iD5rJ5/FpYclAoFXxrWbkaVBLIlpKrF0h0CPagKsZeJ6F6ISkKyEgsgZI8QycHVlw1MIEI1jzxQSGAOWw6H55b7OaKc5DmKAFgAETdRLlgjCIgQuEp2BAFM35doGDIrCAxahnkLaZwYAVGmUgUoCAmkE6EkH/84LE7C/B1bzQzrGBgJiEOevNlCJrLCANj6IiFKKqJIWaVjAgCbFCxAyIS05lOFzBG0XzaAlCJMLiSoRmZ0i0kYloFiC5a0jRYKgp9lB/oCVMtI6w4f5GebmJaoDCrCNoQB5oVLA0AQgH+okyQsKBVB15INqUpJKAF0wsEv7BYqVMAmWpWLBERhHgEzMjkfQSJJZN13koEBTNYrSyG9Zv1UKZr3BAkEgC8yUQZoEjJdgxZQOEBQEmIYEUYEEFAJc2BxCASvIgBlyDWAqEAIBsS//zgsTxMAndvNjOsYCIBElARoQXxTAFSCGZfNDUwAsy6GImPbmilDBBOEyhAGjjNmzBhTWhDFFzAMAMWNaFXOCBQUAMMBREgDGTMSgwwsYKmMIEitAKHcjdGylkaJecacBV0Lt5nCaYsLGdAhqUYbummJKZM4jIANAYCRAMVLxc5poVIB0hVdKBVmJwPgk6ZkKOoQgKKVaW6KCIKw7uIdXOjLYXhhprFqUXrQ8eCgAaHEgGuRA5ZMPjhS1pYIWHmlifzrl30AMLL0EwgEiVmARK//OCxPQz+c2wINbxgSW2kOsGXadNAEuxXQiEsItJzWcqAjnjtxrQVkAUJCgPSW4PK77CTZYpaayDIgeAs8h2ccFCLMDwAsGIAKo2PGLFhQeYsyaosaUIYkIYgAYUmaISCroDyksAyJEO6Bcuc6KBh8KdQVAUhiAAXaBToYqCKXBxgSFHUWYRGRKL6kI1Ny6LYAmBZwGETSWc7S6kB6KD9uu4k7GZNyntVU7QKgMyfFlhaEhEIqjReEIsrBhUepEEGB4MY0SKjFlo6AgEDqpqQVL/84LE6C/J2bzQxrFkKvBhIu2OlWWhwgyQBTYOLIJQsNMwBDERlYIhqplnQJmZcGxGmhLClA2QozYCLmrzK/SSVjNuPRnLQiMwY4IBSg6ES6EqQKUNFMIiMSSM6hOeFMM/PQ5EiJoXY0bGgkhpJ8aAuGdVAwXg4WMKsTqgwWPjEg9C8uYjwnUXNCFnGIEiDYJlgOYK0rSnIbBpFByEhgqlgwLcKBfifWQLFDgXm2oIKeCnEgYac8iKyfsSXexpPp5ncDjLEL1m96qJAYhIJEcNCv/zgsTsM7nJrADW8YFRSJkhZL+rmTOFBRMkG3KJJGITAuloKkRRyIDDxoQ3Q0pB3h04W2u5mhUeWhQ7wUIhLBJe2V8qqirAVVlICAxBBMk6KjR3IBH7Qd8KYMIJNw0NSMNCpIhwwMAqo8rMFA06kqnNRHbukCnArSmAthtWMsRAwldyU7YBgGragAihLwzxPTVfKpAJR6suTgwpSNUNABCFZfQeqbVGNIoVWsO4ASAh5RVYd4REBIkHDAzQ5wLqZgBSgyMDZMexUAtA/4FBinYc//OCxOErCcXAAMafhR29cwFQAAEDH5gxggOmaKo/AYSOAQYZA5w6ZIyRYiMLbHRRhzQBEjIZ0QUQS9MQGW2Ai4CJLRRTRQBwAgEjBUHHAAeNxeMMLDXB2mhnERg1hwv581I1kKLIhanStnbsGSEuGDQxAOSpSUAVZMqWdAzalwDBQ+UKBq61BR5phYDEgQsQKLGAoNaiAwUHL1OWls0FWiGWKsrY/KpD0koHiBGEEnPAaikFpZA7QzwxgUs+OhEBoCABTqlyA9IhSkgCDHHgAAD/84LE+DQZ1bDQxrL1BRXmZvYGuyQ0BQOSDTxSAxRSg5W92QdCSiK0UyOzpkEoDtM2dTQKAGccACggAdDcQzCxAgabQkKJHqCrnBRqRhjMGCu/pqmHZKDphTM2EDQTMoOAQFBU7NfDAbbgQjMcCDCXE4I/YYRBwOAi9joGg7iiiBhLWguIRFEaUalJE4TbYmfYYi34osxTAWVRVoQnaBqoPOfYikheKvUyXhUBe8gMnIjSOpADgMYogJAQ5GE4NoSCSNMJk6AeFBKPOW4LSEnobv/zgsTrMPHVtNDO8YG1nuQHBUwrJiKM5coUAqq2MSFF8wFTLnl1g4EVjk/gKEMAfRYTcHiYiLCzVWBSkBIhEFYaghDnhQCnwgvZLMFUGNBkfm5BBEykEEEAFHMIsDlJkdpsYZUNmD9GQrHLrGmRAZqAjymrmLILzK3IMqRL+pVGNw0Mt4ECB2ElzAVIYWCmKkSTTBtUEULaw8iJyWDP6CPwbQSmlpxlE8AY6Kk2VAwUIKhJVJiAw0GmAwcdDMauUR99S5ZnjWQQQW0CygY0VFwi//OCxOswKdG4yMaxEfDBDHTQcEQhhjmcsgRVyoO5yDpgmHREDSAEsFwUqSkgOJVR64YFBTsDo25LsF1EOxASXnDCmgDTqfzZkh5wxQTRCQ2BIiZuZGLlKZZmKQbILGCAhmhwYONGEphmg0ZaImTzpkBYiMGDhe0WA1H0FViK8wLKkgqICCgJCLRFw0wlYC55aZGk4xQCKkEOrmEOBlVTKzFz14JVPbDcSnLloQoJahUiaLDBGJAWCsrvEng6Yh8IKIqBeBZEaQhslwFzpeiC6V7/84LE7jJZ1bjQzvNlJGFCr0KAqBstYerOMDIWOMW7B20ljU8ReayiKewGDaLIIMlYDmBRqX49rL9hw42aEmHEIQvXAoqAZO/BhicNmTACI2ABS+W0eELBzVGAYKA2s1IEaFjDIz3Axz0xTkyiA3A1uJMfV0SAEQndQSC1Emhq4lBOURgEvGJMMl2lCC+yhJRMcCpkWmL9JFJfIPMOe5jcButK6DKlkgrChi6TRQCTLAwsmTBQi9BYhZgOUMosCAszMiwmNCpgkkJAIXB3pdtHgP/zgsToL3HRtAjGsUkgIABIEGsm8KZIQWALyDQo0KBDy559mgphBQMhMogLNK4PNzooeiqbG5i3gZwKSqsMRQ1STEEgQBFGEQWAyXAwTdFbZj4igjDFIw9cMeExklcgwM4MFPTdQkLzZk4eYM7mvrBpxaakIAADARoMhAGDiUVOQXfZIjqUbLjI4MCM9QF5TV2gVQKiR7WIKHU5DKB4nWHVIZwAzZ/F+O87dTGPTiAVYAAYUAIDS7IhBZ6oEnUjpI0QTDNZ9NMIXsjkjiVVGEgA//OCxO4zAdWwCM7xZ+QAP0XFdFfKZyOZRE5qnCeg8u2GbBjiMyykhwTKWAngQyFEANEzQHIBASXxf8tnKDZJATLAi97FkkWEMMLbP4j2IATHGZslsKHpHg0sBIKZiAmMjwRlOMnPexNqhP3aAhpTtjSwCe5cQCLYOpUnMJDcpaqFyfoECtUYGsG2YGJSABqCWg0kENNrggqbqLS6V4F+ZTAkC1ZbenoVEc/H1iVYQGMgwoYkQgVyIDnj56aqFGU0JTNZiupu5gedJmUCvQw2DhX/84LE5i7h1cD4zrGBkW0nzShN5FOgvEyZYFK0ZAMINEA1Zj1+P2oaeBBZqGlVw4JzePQmAYoucabQCmcZkSJqxQYKAkR0Y0Sk+wAODhW7gAcoAM2g73CFk7JwxKDSRlE5sEYiOGxPBSCfD2dpSDgJgALJzABRgEZMgjEvgw4ZDMxg1XZgg5dFYVrhZZNMxAlNhnLOVhWIzvar+v7TdiLu2KZYGhGvICIxRQGnEQCoklgK1AkAQBBdWBcafKAIEBBLABcxoQbEQMkCA4eF2AtSS//zgsTuMDHJpADGdNWArmOWiCQErgAYs+XkEYYMACBxYoDCgkAKBhUYGHhVoRRiOgA3DFYo8FURQocTGXiGcKSCjgNRBAiANTRh60FTp4F2S9yqLYGkl/gQWFVAs6DISw0Fzy3CZYjGCypC4I2xlMLEFuy0CFaZihRdExwjLWAjY6kSkiowAXMGgLakvQh4FXwYkYIoOAQXR8UvXo2r7RuDotS6yxq1ruA5akxBTUUzLjk3qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//OCxPEyoeTsCM4yEaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqTEFNRTMuOTeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/84LE6gAAA0gAAAAAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy45N6qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/zgsT/AAADSAAAAACqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjk3qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//OCxP8AAANIAAAAAKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy45N6qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/84DE/wAAA0gAAAAAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjk3qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//OCxP8AAANIAAAAAKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqTEFNRTMuOTeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/84LE/wAAA0gAAAAAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy45N6qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/zgsT/AAADSAAAAACqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjk3qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//OCxP8AAANIAAAAAKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqTEFNRTMuOTeqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/84LE/wAAA0gAAAAAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1FMy45N6qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqv/zgsT/AAADSAAAAACqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqkxBTUUzLjk3qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//OCxP8AAANIAAAAAKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpUQUdzaWxlbmNlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/w==";const Wd=Hd;var Xd=t(2075),Yd=t.n(Xd),Zd=null,Qd=null,Jd={},Kd={},$d={},tp={},ep=function(){var t=function(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){function o(t){gt(a,i,r,o,s,"next",t)}function s(t){gt(a,i,r,o,s,"throw",t)}var a=t.apply(e,n);o(void 0)}))}}(regeneratorRuntime.mark((function t(e){var n,i,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=Object.keys(e),i=0,r=n;i<r.length;i++)o=r[i],np(o,e[o]);return t.next=4,ip(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),np=function(t,e){Jd[t]=e},ip=function(t){for(var e=Object.keys(t),n=[],i=function(){var t=o[r];if(0!==t.indexOf("textures"))return"continue";var e=new Promise((function(e){op(t,!1,e)}));n.push(e)},r=0,o=e;r<o.length;r++)i();return Promise.all(n)},rp=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Zd,i=Qd,r=Kd[t];if(!r)throw new Error("Model ".concat(t," not found"));if(e)return r;r.scene&&(r=r.scene);var o=!1;r.traverse((function(t){t.isSkinnedMesh&&(o=!0)}));var s=o?i.clone(r):r.clone();if(o){s.animations=[];var a,l=ft(r.animations);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=n.toJSON(u),h=n.parse(c);h.userData=u.userData,s.animations.push(h)}}catch(t){l.e(t)}finally{l.f()}}return s},op=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e&&$d[t])return $d[t];var i=Jd[t];if(!i)throw new Error("Texture ".concat(t," not found"));var r=(new Ad.TextureLoader).load(i.url,n);return e||($d[t]=r),r},sp=function(t){if(Ta[t])return zl.from(t);var e=function(t,e){var n,i=ft(tp[e]);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.name===t)return r}}catch(t){i.e(t)}finally{i.f()}return null}(t,"images");if(e){var n=new zl.from(e.url);return np(t,{texture:n}),n}throw new Error("PIXI texture ".concat(t," not found"))},ap=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=t?sp(t):zl.EMPTY;return(n=o.call(this,[i])).anchor.set(.5),n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,t);var n,i,r,o=_t(e);return n=e,i=[{key:"on",value:function(t,n,i){return e.pointerEvents.indexOf(t)>=0&&(this.interactive=!0),xt(wt(e.prototype),"on",this).call(this,t,n,i)}},{key:"once",value:function(t,n,i){return e.pointerEvents.indexOf(t)>=0&&(this.interactive=!0),xt(wt(e.prototype),"once",this).call(this,t,n,i)}},{key:"removeListener",value:function(t,n,i,r){if(xt(wt(e.prototype),"removeListener",this).call(this,t,n,i,r),e.pointerEvents.indexOf(t)>=0){for(var o=!1,s=0;s<e.pointerEvents.length;s++){var a=e.pointerEvents[s];if(this.listeners(a).length>0){o=!0;break}}this.interactive=o}return this}},{key:"off",value:function(t,e,n,i){return this.removeListener(t,e,n,i)}},{key:"emit",value:function(t){var n=arguments[1];e.pointerEvents.indexOf(t)>=0&&(n.data||(n.data={}),n.data.local=n.data.getLocalPosition(this)),arguments.length<3&&xt(wt(e.prototype),"emit",this).call(this,t,n),3===arguments.length&&xt(wt(e.prototype),"emit",this).call(this,t,n,arguments[2]),4===arguments.length&&xt(wt(e.prototype),"emit",this).call(this,t,n,arguments[2],arguments[3]),arguments.length>=5&&xt(wt(e.prototype),"emit",this).call(this,t,n,arguments[2],arguments[3],arguments[4])}},{key:"has",value:function(t,e,n){if(!this._events)return!1;var i=this._events[t];if(!i)return!1;if(Array.isArray(i)||(i=[i]),void 0===e)return!0;for(var r=0;r<i.length;r++){var o=i[r];if(o.fn===e&&(void 0===n||o.context===n))return!0}return!1}}],r=[{key:"create",value:function(t){return new e(t)}},{key:"from",value:function(t){var n;return Array.isArray(t)?e.fromTextures(e.parseSourceArray(t)):"string"!=typeof t||Ta[t]?((n=new e).texture=sp(t),n):e.fromPattern(t)}},{key:"parseSourceArray",value:function(t){var e,n=[];for(e=0;e<t.length;e++)n.push(sp(t[e]));return n}},{key:"fromFrame",value:function(t){return new e(t)}},{key:"fromPattern",value:function(t){return e.fromTextures(e.getTexturesFromPattern(t))}},{key:"getTexturesFromPattern",value:function(t){var n=[];for(var i in Ta)if(i.substring(0,t.length)===t){var r=sp(i),o=(i.substring(t.length).match(/[0-9]+/)||"")[0];r._ix=parseInt(o),n.push(r)}return n.length?n.sort(e.sortTextures):(n=[zl.EMPTY],console.warn("Unknown animation",t)),n}},{key:"fromTextures",value:function(t){var n=new e;return Array.isArray(t)||(t=[t]),n.textures=t,t.length>1?n.gotoAndPlay(0):n.gotoAndStop(0),n}}],i&&vt(n.prototype,i),r&&vt(n,r),e}(wd);St(ap,"sortTextures",(function(t,e){return t._ix>e._ix?1:t._ix<e._ix?-1:0})),St(ap,"pointerEvents",["mousedown","mouseup","mousemove","click","touchstart","touchend","touchmove","tap","mouseover","mouseout","mouseupoutside","rightclick","rightdown","rightup","rightupoutside","touchendoutside","pointerdown","pointerup","pointermove","pointerclick","pointerover","pointerout","pointerupoutside","pointertap"]);const lp=ap;var up=[];const cp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=o.call(this),up.push(It(n)),n.stroke=0,n.strokeWidth=0,n.animationSpeed=.4,n.particlesBlendMode=Ds.NORMAL,n.renderer=new(Yd().PixiRenderer)(t),n.renderer.createSprite=n.createSprite.bind(It(n)),n.renderer.createCircle=n.createCircle.bind(It(n)),n.renderer.setColor=!0,n.addRenderer(n.renderer),n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(e,t);var n,i,r,o=Ct(e);return n=e,r=[{key:"destroy",value:function(t){up.splice(up.indexOf(t),1)}},{key:"update",value:function(t){var e,n=Mt(up);try{for(n.s();!(e=n.n()).done;)e.value.update(t)}catch(t){n.e(t)}finally{n.f()}}}],(i=[{key:"createEmitter",value:function(){var t=new(Yd().BehaviourEmitter);return this.addEmitter(t),t}},{key:"update",value:function(t){if(this.dispatchEvent(Yd().PROTON_UPDATE),this.elapsed=t/1e3,this.elapsed>0){var n,i=!1,r=Mt(this.emitters);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.update(this.elapsed),o.emitTime>0&&o.emitTime>o.totalTime&&o.stop(),(o.emitTime>0||o.particles.length>0)&&(i=!0)}}catch(t){r.e(t)}finally{r.f()}i||e.destroy(this)}this.dispatchEvent(Yd().PROTON_UPDATE_AFTER)}},{key:"createSprite",value:function(t){var e=lp.from(t.src);return e.anchor.x=.5,e.anchor.y=.5,e.animationSpeed=this.animationSpeed,e.width=t.width,e.height=t.height,e.blendMode=this.particlesBlendMode,e}},{key:"createCircle",value:function(t){var e=new nh;if(void 0!==this.stroke){var n=this.stroke instanceof String?parseInt(this.stroke,16):this.stroke;e.lineStyle(void 0===this.strokeWidth?1:this.strokeWidth,n)}return e.beginFill(16777215),e.drawCircle(0,0,t.radius),e.endFill(),e.blendMode=this.particlesBlendMode,e}}])&&Et(n.prototype,i),r&&Et(n,r),e}(Yd());var hp=t(6624),dp=t.n(hp),pp=[],fp=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=o.call(this,t,n),pp.push(Bt(i)),i}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zt(t,e)}(e,t);var n,i,r,o=kt(e);return n=e,r=[{key:"destroy",value:function(t){t.destroy(),pp.splice(pp.indexOf(t),1)}},{key:"update",value:function(t){var e,n=qt(pp);try{for(n.s();!(e=n.n()).done;)e.value.update(t)}catch(t){n.e(t)}finally{n.f()}}}],(i=[{key:"update",value:function(t){if(this.elapsed=t/1e3,this.elapsed>0){var n,i=!1,r=qt(this.emitters);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.update(this.elapsed),o.totalEmitTimes>0&&o.currentEmitTime>o.totalEmitTimes&&o.stopEmit(),(o.totalEmitTimes>0||o.particles.length>0)&&(i=!0)}}catch(t){r.e(t)}finally{r.f()}i||e.destroy(this)}}}])&&Dt(n.prototype,i),r&&Dt(n,r),e}(dp());dp().Rotate.prototype.convertValue=function(t){if("number"==typeof t)return t*dp().DR;if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e[n]=t[n]*dp().DR;return e}return dp().createSpan(t.a*dp().DR,t.b*dp().DR,t.c)},dp().Rotate.prototype.reset=function(t,e,n,i,r){this.a=t||0,this.b=e||0,this.c=n||0,void 0===t||"same"===t?this._type="same":null==e?this._type="set":void 0===n?this._type="to":(this._type="add",this.a=dp().createSpan(this.convertValue(this.a)),this.b=dp().createSpan(this.convertValue(this.b)),this.c=dp().createSpan(this.convertValue(this.c))),i&&Rotate._super_.prototype.reset.call(this,i,r)};const mp=fp;var gp=function(t){function e(t,n,i,o){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),s=r.call(this),t=t>=0?t:1e3,n=n>0?Math.floor(n):0,i=i>0?i:0,o="boolean"!=typeof o||o,s._initialDelay=t,s.delay=0,s.repeat=n,s._repeated=0,s.destroyOnFinish=o,s.running=!0,s.finished=!1,s.periodDelay=0,s.emitPeriod=i,e.pool.unshift(Gt(s)),s}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ut(t,e)}(e,t);var n,i,r=jt(e);return n=e,(i=[{key:"start",value:function(){if(!this.finished)return this.emit("start",this),this.running=!0,this;console.warn("Timer is finished. Use 'restart' method for processing")}},{key:"stop",value:function(){return this.running=!1,this.emit("stop",this),this}},{key:"finish",value:function(){this.destroyOnFinish&&this.destroy(),this.stop(),this.finished=!0,this.emit("finish",this)}},{key:"restart",value:function(){return this.delay=0,this.periodDelay=0,this._repeated=0,this.running=!0,this.finished=!1,this.emit("restart",this),this}},{key:"destroy",value:function(){var t=e.pool.indexOf(this);return t>=0&&(this.stop(),e.pool.splice(t,1)),this}},{key:"getTotalDelay",value:function(){return this.finished?(this._repeated+1)*this._initialDelay:this._repeated*this._initialDelay+this.delay}},{key:"tick",value:function(t){if(this.running){this.emit("tick",this),this.emit("update",this);for(var e=0;e<t;e++){if(this.emitPeriod&&(this.periodDelay++,this.periodDelay>=this.emitPeriod&&(this.periodDelay=0,this.emit("period",this),!this.running)))return;if(this.delay++,this.delay>=this._initialDelay){if(this.delay=0,this.emit("complete",this),!this.running)return;if(!(this.repeat&&this._repeated<this.repeat))return void this.finish();if(this._repeated++,this.emit("repeat",this),!this.running)return}}}}}])&&Nt(n.prototype,i),e}(fa());Wt(gp,"pool",[]),Wt(gp,"create",(function(t,e,n,i){return new gp(t,e,n,i)})),Wt(gp,"destroy",(function(t){return t.destroy(),t})),Wt(gp,"update",(function(t){for(var e=gp.pool.length-1;e>=0;e--)gp.pool[e].tick(t)})),Wt(gp,"clear",(function(){for(;gp.pool.length;)gp.pool.pop().destroy()}));const yp=gp,vp=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ee($t(t=l.call(this)),"localStorage",famobi.localStorage),ee($t(t),"log",famobi.log),ee($t(t),"reasonTypes",{timeout:"timeout",dead:"dead",wrongAnswer:"wrong_answer",draw:"draw"}),ee($t(t),"levelEndResultTypes",{success:"success",draw:"draw",fail:"fail"}),ee($t(t),"events",{pauseRequested:"pauseRequested",resumeRequested:"resumeRequested"}),t.type="FAMOBI",window.famobi.onRequest("pauseGameplay",(function(){return t.emit(t.events.pauseRequested)})),window.famobi.onRequest("resumeGameplay",(function(){return t.emit(t.events.resumeRequested)})),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jt(t,e)}(e,t);var n,i,r,o,s,a,l=Kt(e);return n=e,i=[{key:"init",value:(a=Zt(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"setLoadingProgress",value:function(t){famobi.setPreloadProgress(t)}},{key:"loadingComplete",value:function(){famobi.gameReady()}},{key:"levelStart",value:function(t){return(0,famobi_analytics.trackEvent)("EVENT_LEVELSTART",{levelName:t})}},{key:"levelRestart",value:(s=Zt(regeneratorRuntime.mark((function t(e){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=famobi_analytics,i=n.trackEvent,t.next=3,i("EVENT_LEVELRESTART",{levelName:e});case 3:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})},{key:"forcedLevelEnd",value:function(t,e){return(0,famobi_analytics.trackEvent)("EVENT_CUSTOM",{eventName:"LEVELEND",result:t,score:e})}},{key:"levelSuccess",value:(o=Zt(regeneratorRuntime.mark((function t(e,n){var i,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=famobi_analytics,r=i.trackEvent,o=[r("EVENT_LEVELSUCCESS",{levelName:e}),r("EVENT_TOTALSCORE",{levelName:e,totalScore:n})],e&&o.push(r("EVENT_LEVELSCORE",{levelName:e,levelScore:n})),t.next=5,Promise.all(o);case 5:case"end":return t.stop()}}),t)}))),function(t,e){return o.apply(this,arguments)})},{key:"levelFail",value:(r=Zt(regeneratorRuntime.mark((function t(e,n,i){var r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=famobi_analytics,o=r.trackEvent,s=[o("EVENT_LEVELFAIL",{levelName:e,reason:n}),o("EVENT_TOTALSCORE",{levelName:e,totalScore:i})],e&&s.push(o("EVENT_LEVELSCORE",{levelName:e,levelScore:i})),t.next=5,Promise.all(s);case 5:case"end":return t.stop()}}),t)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"updateScore",value:function(t){return(0,famobi_analytics.trackEvent)("EVENT_LIVESCORE",{liveScore:t})}},{key:"updateProgress",value:function(t){return Promise.resolve()}},{key:"requestPause",value:function(){return(0,famobi_analytics.trackEvent)("EVENT_PAUSE")}},{key:"requestResume",value:function(){return(0,famobi_analytics.trackEvent)("EVENT_RESUME")}},{key:"getBrandingButtonImage",value:function(){return famobi.getBrandingButtonImage(!0)}},{key:"openBrandingLink",value:function(){famobi.openBrandingLink()}},{key:"getCopyright",value:function(){return famobi.hasFeature("copyright")?"(c) Famobi":""}},{key:"gameOver",value:function(){return famobi.log("gameOver call not expected!"),Promise.resolve()}},{key:"hasRewardedAd",value:function(){return famobi.hasRewardedAd()}},{key:"rewardedAd",value:function(t){return famobi.rewardedAd(t)}}],i&&Qt(n.prototype,i),e}(Td());var xp=function(t){function e(t){var n,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).doNotWaitForSounds,r=void 0!==i&&i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=o.call(this)).assets=t,n.doNotWaitForSounds=r,n.totalItems=0,n.loadedItems=0,n.loader=null,n.done=!1,n.handleLoadProgress=n.handleLoadProgress.bind(le(n)),n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&se(t,e)}(e,t);var n,i,r,o=ae(e);return n=e,r=[{key:"injectOptionalDependency",value:function(t,n){e.optionalDependecies[t]=n}},{key:"injectOptionalDependencies",value:function(t){var n,i=ie(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=r.name,s=r.dependency;e.injectOptionalDependency(o,s)}}catch(t){i.e(t)}finally{i.f()}}}],(i=[{key:"getImagesLoaderOptions",value:function(t){var e={};return t.match(/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/)||(e.crossOrigin="anonymous"),e}},{key:"load",value:function(){var t=this,e=[];e.push(this.loadImages()),e.push(this.loadFonts()),e.push(this.loadSounds()),e.push(this.loadModels()),Promise.all(e).then((function(){t.done=!0,ep(t.loader.resources).then((function(){t.emit("complete")}))}))}},{key:"handleLoadProgress",value:function(){this.loadedItems++,this.emit("progress",Math.floor(this.loadedItems/this.totalItems*100))}},{key:"loadImages",value:function(){var t=this;return new Promise((function(n){var i=new(0,e.optionalDependecies.Loader);if(t.loader=i,t.assets.images){var r,o=ie(t.assets.images);try{for(o.s();!(r=o.n()).done;){var s=r.value;t.totalItems++,i.add(s.name,s.url,t.getImagesLoaderOptions(s.url))}}catch(t){o.e(t)}finally{o.f()}}if(t.assets.atlases){var a,l=ie(t.assets.atlases);try{for(l.s();!(a=l.n()).done;){var u=a.value;"json"===u.ext&&(t.totalItems+=2,i.add(u.name,u.url))}}catch(t){l.e(t)}finally{l.f()}}if(t.assets.spine){var c,h=ie(t.assets.spine);try{for(h.s();!(c=h.n()).done;){var d=c.value;"json"===d.ext&&(t.totalItems+=3,i.add(d.name,d.url))}}catch(t){h.e(t)}finally{h.f()}}var p=i.onProgress.add(t.handleLoadProgress);i.load((function(){i.onProgress.detach(p),n()}))}))}},{key:"loadFonts",value:function(){var t,n=this,i=e.optionalDependecies.FontFaceObserver,r=[],o=document.getElementsByTagName("head")[0],s=ie(this.assets.fonts);try{var a=function(){var s=t.value;n.totalItems++;var a=document.createElement("style");a.type="text/css",a.appendChild(document.createTextNode("@font-face {font-family: "+s.name+"; src: url("+s.url+");}")),o.appendChild(a),r.push(new Promise((function(t){var r=s.name;new i(r).load(null,e.FONT_LOAD_TIMEOUT).then((function(){n.handleLoadProgress(),t()})).catch((function(){console.warn(r+" not loaded!"),n.handleLoadProgress(),t()}))})))};for(s.s();!(t=s.n()).done;)a()}catch(t){s.e(t)}finally{s.f()}return Promise.all(r)}},{key:"loadSounds",value:function(){var t,e=this,n=[],i=ie(this.assets.sounds);try{var r=function(){var i=t.value;e.totalItems++,n.push(new Promise((function(t){var n=new Audio;n.preload="auto",n.src=i.url,n.addEventListener("canplay",t),n.load(),e.doNotWaitForSounds&&t()})).then((function(){return e.handleLoadProgress()})))};for(i.s();!(t=i.n()).done;)r()}catch(t){i.e(t)}finally{i.f()}return Promise.all(n)}},{key:"loadModels",value:function(){var t=this;if(!this.assets.models)return Promise.resolve();var n,i=[],r=ie(this.assets.models);try{var o=function(){var r=n.value;t.totalItems++,i.push(new Promise((function(n){var i=e.modelsExtentionsToLoadersTable[r.ext],o=e.optionalDependecies[i];if(!o)throw new Error("Unknown model type: "+r.ext+" for "+r.url);(new o).load(r.url,(function(e){!function(t,e){Kd[t]=e}(r.name,e),t.handleLoadProgress(),n()}),(function(t){}),(function(t){console.log(t)}))})))};for(r.s();!(n=r.n()).done;)o()}catch(t){r.e(t)}finally{r.f()}return Promise.all(i)}}])&&oe(n.prototype,i),r&&oe(n,r),e}(Td());ce(xp,"optionalDependecies",{Loader:null,FontFaceObserver:null,FBXLoader:null,OBJLoader:null,GLTFLoader:null}),ce(xp,"modelsExtentionsToLoadersTable",{fbx:"FBXLoader",obj:"OBJLoader",gltf:"GLTFLoader",glb:"GLTFLoader"}),xp.FONT_LOAD_TIMEOUT=5e3;const bp=xp,_p=1.25,wp=65535,Sp=Math.pow(2,-24);class Ap{constructor(){}}const Mp=32,Tp=(t,e)=>t.candidate-e.candidate,Ep=new Array(Mp).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),Pp=new Float32Array(6);class Cp{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let n=1/0,i=-1/0;for(let r=0,o=t.length;r<o;r++){const o=t[r][e];n=o<n?o:n,i=o>i?o:i}this.min=n,this.max=i}setFromPoints(t,e){let n=1/0,i=-1/0;for(let r=0,o=e.length;r<o;r++){const o=e[r],s=t.dot(o);n=s<n?s:n,i=s>i?s:i}this.min=n,this.max=i}isSeparated(t){return this.min>t.max||t.min>this.max}}Cp.prototype.setFromBox=function(){const t=new Ad.Vector3;return function(e,n){const i=n.min,r=n.max;let o=1/0,s=-1/0;for(let n=0;n<=1;n++)for(let a=0;a<=1;a++)for(let l=0;l<=1;l++){t.x=i.x*n+r.x*(1-n),t.y=i.y*a+r.y*(1-a),t.z=i.z*l+r.z*(1-l);const u=e.dot(t);o=Math.min(u,o),s=Math.max(u,s)}this.min=o,this.max=s}}(),new Cp;const Ip=function(){const t=new Ad.Vector3,e=new Ad.Vector3,n=new Ad.Vector3;return function(i,r,o){const s=i.start,a=t,l=r.start,u=e;n.subVectors(s,l),t.subVectors(i.end,i.start),e.subVectors(r.end,r.start);const c=n.dot(u),h=u.dot(a),d=u.dot(u),p=n.dot(a),f=a.dot(a)*d-h*h;let m,g;m=0!==f?(c*h-p*d)/f:0,g=(c+m*h)/d,o.x=m,o.y=g}}(),Rp=function(){const t=new Ad.Vector2,e=new Ad.Vector3,n=new Ad.Vector3;return function(i,r,o,s){Ip(i,r,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1)return i.at(a,o),void r.at(l,s);if(a>=0&&a<=1)return l<0?r.at(0,s):r.at(1,s),void i.closestPointToPoint(s,!0,o);if(l>=0&&l<=1)return a<0?i.at(0,o):i.at(1,o),void r.closestPointToPoint(o,!0,s);{let t,u;t=a<0?i.start:i.end,u=l<0?r.start:r.end;const c=e,h=n;return i.closestPointToPoint(u,!0,e),r.closestPointToPoint(t,!0,n),c.distanceToSquared(u)<=h.distanceToSquared(t)?(o.copy(c),void s.copy(u)):(o.copy(t),void s.copy(h))}}}(),Op=function(){const t=new Ad.Vector3,e=new Ad.Vector3,n=new Ad.Plane,i=new Ad.Line3;return function(r,o){const{radius:s,center:a}=r,{a:l,b:u,c:c}=o;if(i.start=l,i.end=u,i.closestPointToPoint(a,!0,t).distanceTo(a)<=s)return!0;if(i.start=l,i.end=c,i.closestPointToPoint(a,!0,t).distanceTo(a)<=s)return!0;if(i.start=u,i.end=c,i.closestPointToPoint(a,!0,t).distanceTo(a)<=s)return!0;const h=o.getPlane(n);if(Math.abs(h.distanceToPoint(a))<=s){const t=h.projectPoint(a,e);if(o.containsPoint(t))return!0}return!1}}();class qp extends Ad.Triangle{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new Ad.Vector3)),this.satBounds=new Array(4).fill().map((()=>new Cp)),this.points=[this.a,this.b,this.c],this.sphere=new Ad.Sphere,this.plane=new Ad.Plane,this.needsUpdate=!0}intersectsSphere(t){return Op(t,this)}update(){const t=this.a,e=this.b,n=this.c,i=this.points,r=this.satAxes,o=this.satBounds,s=r[0],a=o[0];this.getNormal(s),a.setFromPoints(s,i);const l=r[1],u=o[1];l.subVectors(t,e),u.setFromPoints(l,i);const c=r[2],h=o[2];c.subVectors(e,n),h.setFromPoints(c,i);const d=r[3],p=o[3];d.subVectors(n,t),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(s,t),this.needsUpdate=!1}}qp.prototype.closestPointToSegment=function(){const t=new Ad.Vector3,e=new Ad.Vector3,n=new Ad.Line3;return function(i,r=null,o=null){const{start:s,end:a}=i,l=this.points;let u,c=1/0;for(let s=0;s<3;s++){const a=(s+1)%3;n.start.copy(l[s]),n.end.copy(l[a]),Rp(n,i,t,e),u=t.distanceToSquared(e),u<c&&(c=u,r&&r.copy(t),o&&o.copy(e))}return this.closestPointToPoint(s,t),u=s.distanceToSquared(t),u<c&&(c=u,r&&r.copy(t),o&&o.copy(s)),this.closestPointToPoint(a,t),u=a.distanceToSquared(t),u<c&&(c=u,r&&r.copy(t),o&&o.copy(a)),Math.sqrt(c)}}(),qp.prototype.intersectsTriangle=function(){const t=new qp,e=new Array(3),n=new Array(3),i=new Cp,r=new Cp,o=new Ad.Vector3,s=new Ad.Vector3,a=new Ad.Vector3,l=new Ad.Vector3,u=new Ad.Line3,c=new Ad.Line3,h=new Ad.Line3;return function(d,p=null,f=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);const m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){const t=this.satBounds,s=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let e=0;e<4;e++){const r=t[e],o=s[e];if(i.setFromPoints(o,n),r.isSeparated(i))return!1}const a=d.satBounds,l=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let t=0;t<4;t++){const n=a[t],r=l[t];if(i.setFromPoints(r,e),n.isSeparated(i))return!1}for(let t=0;t<4;t++){const a=s[t];for(let t=0;t<4;t++){const s=l[t];if(o.crossVectors(a,s),i.setFromPoints(o,e),r.setFromPoints(o,n),i.isSeparated(r))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}{const t=this.points;let e=!1,n=0;for(let i=0;i<3;i++){const r=t[i],o=t[(i+1)%3];u.start.copy(r),u.end.copy(o),u.delta(s);const a=e?c.start:c.end,l=ve(g.distanceToPoint(r));if(ve(g.normal.dot(s))&&l){c.copy(u),n=2;break}if((g.intersectLine(u,a)||l)&&!ve(a.distanceTo(o))){if(n++,e)break;e=!0}}if(1===n&&d.containsPoint(c.end))return p&&(p.start.copy(c.end),p.end.copy(c.end)),!0;if(2!==n)return!1;const i=d.points;let r=!1,o=0;for(let t=0;t<3;t++){const e=i[t],n=i[(t+1)%3];u.start.copy(e),u.end.copy(n),u.delta(a);const s=r?h.start:h.end,l=ve(m.distanceToPoint(e));if(ve(m.normal.dot(a))&&l){h.copy(u),o=2;break}if((m.intersectLine(u,s)||l)&&!ve(s.distanceTo(n))){if(o++,r)break;r=!0}}if(1===o&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(2!==o)return!1;if(c.delta(s),h.delta(a),s.dot(a)<0){let t=h.start;h.start=h.end,h.end=t}const f=c.start.dot(s),y=c.end.dot(s),v=h.start.dot(s),x=h.end.dot(s);return(f===x||v===y||y<v!=f<x)&&(p&&(l.subVectors(c.start,h.start),l.dot(s)>0?p.start.copy(c.start):p.start.copy(h.start),l.subVectors(c.end,h.end),l.dot(s)<0?p.end.copy(c.end):p.end.copy(h.end)),!0)}}}(),qp.prototype.distanceToPoint=function(){const t=new Ad.Vector3;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}(),qp.prototype.distanceToTriangle=function(){const t=new Ad.Vector3,e=new Ad.Vector3,n=["a","b","c"],i=new Ad.Line3,r=new Ad.Line3;return function(o,s=null,a=null){const l=s||a?i:null;if(this.intersectsTriangle(o,l))return(s||a)&&(s&&l.getCenter(s),a&&l.getCenter(a)),0;let u=1/0;for(let e=0;e<3;e++){let i;const r=n[e],l=o[r];this.closestPointToPoint(l,t),i=l.distanceToSquared(t),i<u&&(u=i,s&&s.copy(t),a&&a.copy(l));const c=this[r];o.closestPointToPoint(c,t),i=c.distanceToSquared(t),i<u&&(u=i,s&&s.copy(c),a&&a.copy(t))}for(let l=0;l<3;l++){const c=n[l],h=n[(l+1)%3];i.set(this[c],this[h]);for(let l=0;l<3;l++){const c=n[l],h=n[(l+1)%3];r.set(o[c],o[h]),Rp(i,r,t,e);const d=t.distanceToSquared(e);d<u&&(u=d,s&&s.copy(t),a&&a.copy(e))}}return Math.sqrt(u)}}();class Lp{constructor(t,e,n){this.isOrientedBox=!0,this.min=new Ad.Vector3,this.max=new Ad.Vector3,this.matrix=new Ad.Matrix4,this.invMatrix=new Ad.Matrix4,this.points=new Array(8).fill().map((()=>new Ad.Vector3)),this.satAxes=new Array(3).fill().map((()=>new Ad.Vector3)),this.satBounds=new Array(3).fill().map((()=>new Cp)),this.alignedSatBounds=new Array(3).fill().map((()=>new Cp)),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),n&&this.matrix.copy(n)}set(t,e,n){this.min.copy(t),this.max.copy(e),this.matrix.copy(n),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}Lp.prototype.update=function(){const t=this.matrix,e=this.min,n=this.max,i=this.points;for(let r=0;r<=1;r++)for(let o=0;o<=1;o++)for(let s=0;s<=1;s++){const a=i[1*r|2*o|4*s];a.x=r?n.x:e.x,a.y=o?n.y:e.y,a.z=s?n.z:e.z,a.applyMatrix4(t)}const r=this.satBounds,o=this.satAxes,s=i[0];for(let t=0;t<3;t++){const e=o[t],n=r[t],a=i[1<<t];e.subVectors(s,a),n.setFromPoints(e,i)}const a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},Lp.prototype.intersectsBox=function(){const t=new Cp;return function(e){this.needsUpdate&&this.update();const n=e.min,i=e.max,r=this.satBounds,o=this.satAxes,s=this.alignedSatBounds;if(t.min=n.x,t.max=i.x,s[0].isSeparated(t))return!1;if(t.min=n.y,t.max=i.y,s[1].isSeparated(t))return!1;if(t.min=n.z,t.max=i.z,s[2].isSeparated(t))return!1;for(let n=0;n<3;n++){const i=o[n],s=r[n];if(t.setFromBox(i,e),s.isSeparated(t))return!1}return!0}}(),Lp.prototype.intersectsTriangle=function(){const t=new qp,e=new Array(3),n=new Cp,i=new Cp,r=new Ad.Vector3;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(t.copy(o),t.update(),o=t);const s=this.satBounds,a=this.satAxes;e[0]=o.a,e[1]=o.b,e[2]=o.c;for(let t=0;t<3;t++){const i=s[t],r=a[t];if(n.setFromPoints(r,e),i.isSeparated(n))return!1}const l=o.satBounds,u=o.satAxes,c=this.points;for(let t=0;t<3;t++){const e=l[t],i=u[t];if(n.setFromPoints(i,c),e.isSeparated(n))return!1}for(let t=0;t<3;t++){const o=a[t];for(let t=0;t<4;t++){const s=u[t];if(r.crossVectors(o,s),n.setFromPoints(r,e),i.setFromPoints(r,c),n.isSeparated(i))return!1}}return!0}}(),Lp.prototype.closestPointToPoint=function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e},Lp.prototype.distanceToPoint=function(){const t=new Ad.Vector3;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}(),Lp.prototype.distanceToBox=function(){const t=["x","y","z"],e=new Array(12).fill().map((()=>new Ad.Line3)),n=new Array(12).fill().map((()=>new Ad.Line3)),i=new Ad.Vector3,r=new Ad.Vector3;return function(o,s=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(a||l)&&(o.getCenter(r),this.closestPointToPoint(r,i),o.closestPointToPoint(i,r),a&&a.copy(i),l&&l.copy(r)),0;const u=s*s,c=o.min,h=o.max,d=this.points;let p=1/0;for(let t=0;t<8;t++){const e=d[t];r.copy(e).clamp(c,h);const n=e.distanceToSquared(r);if(n<p&&(p=n,a&&a.copy(e),l&&l.copy(r),n<u))return Math.sqrt(n)}let f=0;for(let i=0;i<3;i++)for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){const s=(i+1)%3,a=(i+2)%3,l=1<<i|r<<s|o<<a,u=d[r<<s|o<<a],p=d[l];e[f].set(u,p);const m=t[i],g=t[s],y=t[a],v=n[f],x=v.start,b=v.end;x[m]=c[m],x[g]=r?c[g]:h[g],x[y]=o?c[y]:h[g],b[m]=h[m],b[g]=r?c[g]:h[g],b[y]=o?c[y]:h[g],f++}for(let t=0;t<=1;t++)for(let e=0;e<=1;e++)for(let n=0;n<=1;n++){r.x=t?h.x:c.x,r.y=e?h.y:c.y,r.z=n?h.z:c.z,this.closestPointToPoint(r,i);const o=r.distanceToSquared(i);if(o<p&&(p=o,a&&a.copy(i),l&&l.copy(r),o<u))return Math.sqrt(o)}for(let t=0;t<12;t++){const o=e[t];for(let t=0;t<12;t++){const e=n[t];Rp(o,e,i,r);const s=i.distanceToSquared(r);if(s<p&&(p=s,a&&a.copy(i),l&&l.copy(r),s<u))return Math.sqrt(s)}}return Math.sqrt(p)}}();const Dp=new Ad.Vector3,zp=new Ad.Vector3,kp=new Ad.Vector3,Bp=new Ad.Vector2,Fp=new Ad.Vector2,Vp=new Ad.Vector2,Np=new Ad.Vector3;class Up{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return 0===t.length?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}const jp=new Ad.Box3,Gp=new Ad.Vector3,Hp=["x","y","z"],Wp=function(){function t(i,r,o,s,a=null,l=0,u=0){function c(t){let e=2*t,n=Jp,i=Kp;for(;!we(e,n);)e=2*(t=Me(t));return Se(t,i)}function h(t){let e=2*t,n=Jp,i=Kp;for(;!we(e,n);)e=2*(t=Te(t,i));return Se(t,i)+Ae(e,n)}let d=2*i,p=Qp,f=Jp,m=Kp;if(we(d,f)){const t=Se(i,m),n=Ae(d,f);return he(i,p,e),s(t,n,!1,u,l+i,e)}{const d=Me(i),g=Te(i,m);let y,v,x,b,_=d,w=g;if(a&&(x=e,b=n,he(_,p,x),he(w,p,b),y=a(x),v=a(b),v<y)){_=g,w=d;const t=y;y=v,v=t,x=b}x||(x=e,he(_,p,x));const S=o(x,we(2*_,f),y,u+1,l+_);let A;if(2===S){const t=c(_);A=s(t,h(_)-t,!0,u+1,l+_,x)}else A=S&&t(_,r,o,s,a,l,u+1);if(A)return!0;b=n,he(w,p,b);const M=o(b,we(2*w,f),v,u+1,l+w);let T;if(2===M){const t=c(w);T=s(t,h(w)-t,!0,u+1,l+w,b)}else T=M&&t(w,r,o,s,a,l,u+1);return!!T}}let e,n;const i=[],r=new Up((()=>new Ad.Box3));return function(...o){e=r.getPrimitive(),n=r.getPrimitive(),i.push(e,n);const s=t(...o);r.releasePrimitive(e),r.releasePrimitive(n),i.pop(),i.pop();const a=i.length;return a>0&&(n=i[a-1],e=i[a-2]),s}}(),Xp=function(){const t=new qp,e=new qp,n=new Ad.Matrix4,i=new Lp,r=new Lp;return function o(s,a,l,u,c=null){let h=2*s,d=Qp,p=Jp,f=Kp;if(null===c&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,u),c=i),!we(h,p)){const t=s+8,e=f[s+6];return he(t,d,jp),!(!c.intersectsBox(jp)||!o(t,a,l,u,c))||(he(e,d,jp),!(!c.intersectsBox(jp)||!o(e,a,l,u,c)))}{const i=a,o=i.index,c=i.attributes.position,m=l.index,g=l.attributes.position,y=Se(s,f),v=Ae(h,p);if(n.copy(u).invert(),l.boundsTree){he(s,d,r),r.matrix.copy(n),r.needsUpdate=!0;const t=l.boundsTree.shapecast({intersectsBounds:t=>r.intersectsBox(t),intersectsTriangle:t=>{t.a.applyMatrix4(u),t.b.applyMatrix4(u),t.c.applyMatrix4(u),t.needsUpdate=!0;for(let n=3*y,i=3*(v+y);n<i;n+=3)if(be(e,n,o,c),e.needsUpdate=!0,t.intersectsTriangle(e))return!0;return!1}});return t}for(let i=3*y,r=v+3*y;i<r;i+=3){be(t,i,o,c),t.a.applyMatrix4(n),t.b.applyMatrix4(n),t.c.applyMatrix4(n),t.needsUpdate=!0;for(let n=0,i=m.count;n<i;n+=3)if(be(e,n,m,g),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}}}(),Yp=[];let Zp,Qp,Jp,Kp;const $p=Symbol("skip tree generation"),tf=new Ad.Box3,ef=new Ad.Box3,nf=new Ad.Matrix4,rf=new Lp,of=new Lp,sf=new Ad.Vector3,af=new Ad.Vector3,lf=new Ad.Vector3,uf=new Ad.Vector3,cf=new Ad.Vector3,hf=new Ad.Box3,df=new Up((()=>new qp));class pf{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),pf.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});e={cloneBuffers:!0,...e};const n=t.geometry,i=t._roots,r=n.getIndex();let o;return o=e.cloneBuffers?{roots:i.map((t=>t.slice())),index:r.array.slice()}:{roots:i,index:r.array},o}static deserialize(t,e,n={}){if("boolean"==typeof n)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),pf.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});n={setIndex:!0,...n};const{index:i,roots:r}=t,o=new pf(e,{...n,[$p]:!0});if(o._roots=r,n.setIndex){const n=e.getIndex();if(null===n){const n=new Ad.BufferAttribute(t.index,1,!1);e.setIndex(n)}else n.array!==i&&(n.array.set(i),n.needsUpdate=!0)}return o}constructor(t,e={}){if(!t.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[$p]:!1},e)).useSharedArrayBuffer&&"undefined"==typeof SharedArrayBuffer)throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[$p]||(this._roots=function(t,e){function n(t){return t.count?1:1+n(t.left)+n(t.right)}function i(t,e){const n=t/4,r=t/2,l=!!e.count,u=e.boundingData;for(let t=0;t<6;t++)o[n+t]=u[t];if(l){const i=e.offset,o=e.count;return s[n+6]=i,a[r+14]=o,a[r+15]=wp,t+32}{const r=e.left,o=e.right,a=e.splitAxis;let l;if(l=i(t+32,r),l/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return s[n+6]=l/4,l=i(l,o),s[n+7]=a,l}}const r=function(t,e){function n(t){d&&d(t/p)}function i(e,r,d,p=null,m=0){if(!f&&m>=l&&(f=!0,u&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),d<=c||m>=l)return n(r+d),e.offset=r,e.count=d,e;const g=function(t,e,n,i,r,o){let s=-1,a=0;if(0===o)s=de(e),-1!==s&&(a=(e[s]+e[s+3])/2);else if(1===o)s=de(t),-1!==s&&(a=function(t,e,n,i){let r=0;for(let o=e,s=e+n;o<s;o++)r+=t[6*o+2*i];return r/n}(n,i,r,s));else if(2===o){const o=ge(t);let l=_p*r;const u=6*i,c=6*(i+r);for(let t=0;t<3;t++){const i=e[t],h=(e[t+3]-i)/Mp;if(r<8){const e=[...Ep];e.length=r;let i=0;for(let r=u;r<c;r+=6,i++){const o=e[i];o.candidate=n[r+2*t],o.count=0;const{bounds:s,leftCacheBounds:a,rightCacheBounds:l}=o;for(let t=0;t<3;t++)l[t]=1/0,l[t+3]=-1/0,a[t]=1/0,a[t+3]=-1/0,s[t]=1/0,s[t+3]=-1/0;me(r,n,s)}e.sort(Tp);let h=r;for(let t=0;t<h;t++){const n=e[t];for(;t+1<h&&e[t+1].candidate===n.candidate;)e.splice(t+1,1),h--}for(let i=u;i<c;i+=6){const r=n[i+2*t];for(let t=0;t<h;t++){const o=e[t];r>=o.candidate?me(i,n,o.rightCacheBounds):(me(i,n,o.leftCacheBounds),o.count++)}}for(let n=0;n<h;n++){const i=e[n],u=i.count,c=r-i.count,h=i.leftCacheBounds,d=i.rightCacheBounds;let p=0;0!==u&&(p=ge(h)/o);let f=0;0!==c&&(f=ge(d)/o);const m=1+_p*(p*u+f*c);m<l&&(s=t,l=m,a=i.candidate)}}else{for(let t=0;t<Mp;t++){const e=Ep[t];e.count=0,e.candidate=i+h+t*h;const n=e.bounds;for(let t=0;t<3;t++)n[t]=1/0,n[t+3]=-1/0}for(let e=u;e<c;e+=6){let r=~~((n[e+2*t]-i)/h);r>=Mp&&(r=31);const o=Ep[r];o.count++,me(e,n,o.bounds)}const e=Ep[31];pe(e.bounds,e.rightCacheBounds);for(let t=30;t>=0;t--){const e=Ep[t],n=Ep[t+1];fe(e.bounds,n.rightCacheBounds,e.rightCacheBounds)}let d=0;for(let e=0;e<31;e++){const n=Ep[e],i=n.count,u=n.bounds,c=Ep[e+1].rightCacheBounds;0!==i&&(0===d?pe(u,Pp):fe(u,Pp,Pp)),d+=i;let h=0,p=0;0!==d&&(h=ge(Pp)/o);const f=r-d;0!==f&&(p=ge(c)/o);const m=1+_p*(h*d+p*f);m<l&&(s=t,l=m,a=n.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${o} used.`);return{axis:s,pos:a}}(e.boundingData,p,s,r,d,h);if(-1===g.axis)return n(r+d),e.offset=r,e.count=d,e;const y=function(t,e,n,i,r){let o=n,s=n+i-1;const a=r.pos,l=2*r.axis;for(;;){for(;o<=s&&e[6*o+l]<a;)o++;for(;o<=s&&e[6*s+l]>=a;)s--;if(!(o<s))return o;for(let n=0;n<3;n++){let i=t[3*o+n];t[3*o+n]=t[3*s+n],t[3*s+n]=i;let r=e[6*o+2*n+0];e[6*o+2*n+0]=e[6*s+2*n+0],e[6*s+2*n+0]=r;let a=e[6*o+2*n+1];e[6*o+2*n+1]=e[6*s+2*n+1],e[6*s+2*n+1]=a}o++,s--}}(a,s,r,d,g);if(y===r||y===r+d)n(r+d),e.offset=r,e.count=d;else{e.splitAxis=g.axis;const t=new Ap,n=r,a=y-r;e.left=t,t.boundingData=new Float32Array(6),ye(s,n,a,t.boundingData,o),i(t,n,a,o,m+1);const l=new Ap,u=y,c=d-a;e.right=l,l.boundingData=new Float32Array(6),ye(s,u,c,l.boundingData,o),i(l,u,c,o,m+1)}return e}!function(t,e){if(!t.index){const n=t.attributes.position.count,i=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;let r;r=n>65535?new Uint32Array(new i(4*n)):new Uint16Array(new i(2*n)),t.setIndex(new Ad.BufferAttribute(r,1));for(let t=0;t<n;t++)r[t]=t}}(t,e);const r=new Float32Array(6),o=new Float32Array(6),s=function(t,e){const n=t.attributes.position,i=t.index.array,r=i.length/3,o=new Float32Array(6*r),s=n.normalized,a=n.array,l=n.offset||0;let u=3;n.isInterleavedBufferAttribute&&(u=n.data.stride);const c=["getX","getY","getZ"];for(let t=0;t<r;t++){const r=3*t,h=6*t;let d,p,f;s?(d=i[r+0],p=i[r+1],f=i[r+2]):(d=i[r+0]*u+l,p=i[r+1]*u+l,f=i[r+2]*u+l);for(let t=0;t<3;t++){let i,r,l;s?(i=n[c[t]](d),r=n[c[t]](p),l=n[c[t]](f)):(i=a[d+t],r=a[p+t],l=a[f+t]);let u=i;r<u&&(u=r),l<u&&(u=l);let m=i;r>m&&(m=r),l>m&&(m=l);const g=(m-u)/2,y=2*t;o[h+y+0]=u+g,o[h+y+1]=g+(Math.abs(u)+g)*Sp,u<e[t]&&(e[t]=u),m>e[t+3]&&(e[t+3]=m)}}return o}(t,r),a=t.index.array,l=e.maxDepth,u=e.verbose,c=e.maxLeafTris,h=e.strategy,d=e.onProgress,p=t.index.count/3;let f=!1;const m=[],g=function(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];const e=[],n=new Set;for(const e of t.groups)n.add(e.start),n.add(e.start+e.count);const i=Array.from(n.values()).sort(((t,e)=>t-e));for(let t=0;t<i.length-1;t++){const n=i[t],r=i[t+1];e.push({offset:n/3,count:(r-n)/3})}return e}(t);if(1===g.length){const t=g[0],e=new Ap;e.boundingData=r,function(t,e,n,i){let r=1/0,o=1/0,s=1/0,a=-1/0,l=-1/0,u=-1/0;for(let i=6*e,c=6*(e+n);i<c;i+=6){const e=t[i+0];e<r&&(r=e),e>a&&(a=e);const n=t[i+2];n<o&&(o=n),n>l&&(l=n);const c=t[i+4];c<s&&(s=c),c>u&&(u=c)}i[0]=r,i[1]=o,i[2]=s,i[3]=a,i[4]=l,i[5]=u}(s,t.offset,t.count,o),i(e,t.offset,t.count,o),m.push(e)}else for(let t of g){const e=new Ap;e.boundingData=new Float32Array(6),ye(s,t.offset,t.count,e.boundingData,o),i(e,t.offset,t.count,o),m.push(e)}return m}(t,e);let o,s,a;const l=[],u=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let t=0;t<r.length;t++){const e=r[t],c=new u(32*n(e));o=new Float32Array(c),s=new Uint32Array(c),a=new Uint16Array(c),i(0,e),l.push(c)}return l}(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Ad.Box3))),this.geometry=t}refit(t=null){function e(n,o,u=!1){const c=2*n;if(a[c+15]===wp){const t=s[n+6];let e=1/0,o=1/0,u=1/0,h=-1/0,d=-1/0,p=-1/0;for(let n=3*t,s=3*(t+a[c+14]);n<s;n++){const t=i[n],s=r.getX(t),a=r.getY(t),l=r.getZ(t);s<e&&(e=s),s>h&&(h=s),a<o&&(o=a),a>d&&(d=a),l<u&&(u=l),l>p&&(p=l)}return(l[n+0]!==e||l[n+1]!==o||l[n+2]!==u||l[n+3]!==h||l[n+4]!==d||l[n+5]!==p)&&(l[n+0]=e,l[n+1]=o,l[n+2]=u,l[n+3]=h,l[n+4]=d,l[n+5]=p,!0)}{const i=n+8,r=s[n+6],a=i+o,c=r+o;let h=u,d=!1,p=!1;t?h||(d=t.has(a),p=t.has(c),h=!d&&!p):(d=!0,p=!0);const f=h||p;let m=!1;(h||d)&&(m=e(i,o,h));let g=!1;f&&(g=e(r,o,h));const y=m||g;if(y)for(let t=0;t<3;t++){const e=i+t,o=r+t,s=l[e],a=l[e+3],u=l[o],c=l[o+3];l[n+t]=s<u?s:u,l[n+t+3]=a>c?a:c}return y}}t&&Array.isArray(t)&&(t=new Set(t));const n=this.geometry,i=n.index.array,r=n.attributes.position;let o,s,a,l,u=0;const c=this._roots;for(let t=0,n=c.length;t<n;t++)o=c[t],s=new Uint32Array(o),a=new Uint16Array(o),l=new Float32Array(o),e(0,u),u+=o.byteLength}traverse(t,e=0){const n=this._roots[e],i=new Uint32Array(n),r=new Uint16Array(n);!function e(o,s=0){const a=2*o,l=r[a+15]===wp;if(l){const e=i[o+6],u=r[a+14];t(s,l,new Float32Array(n,4*o,6),e,u)}else{const r=o+8,a=i[o+6],u=i[o+7];t(s,l,new Float32Array(n,4*o,6),u)||(e(r,s+1),e(a,s+1))}}(0)}raycast(t,e=Ad.FrontSide){const n=this._roots,i=this.geometry,r=[],o=e.isMaterial,s=Array.isArray(e),a=i.groups,l=o?e.side:e;for(let o=0,u=n.length;o<u;o++){const u=s?e[a[o].materialIndex].side:l,c=r.length;if(Ie(n[o]),Ee(0,i,u,t,r),Re(),s){const t=a[o].materialIndex;for(let e=c,n=r.length;e<n;e++)r[e].face.materialIndex=t}}return r}raycastFirst(t,e=Ad.FrontSide){const n=this._roots,i=this.geometry,r=e.isMaterial,o=Array.isArray(e);let s=null;const a=i.groups,l=r?e.side:e;for(let r=0,u=n.length;r<u;r++){const u=o?e[a[r].materialIndex].side:l;Ie(n[r]);const c=Pe(0,i,u,t);Re(),null!=c&&(null==s||c.distance<s.distance)&&(s=c,o&&(c.face.materialIndex=a[r].materialIndex))}return s}intersectsGeometry(t,e){const n=this.geometry;let i=!1;for(const r of this._roots)if(Ie(r),i=Xp(0,n,t,e),Re(),i)break;return i}shapecast(t,e,n){const i=this.geometry;if(t instanceof Function){if(e){const t=e;e=(e,n,i,r)=>{const o=3*n;return t(e,o,o+1,o+2,i,r)}}t={boundsTraverseOrder:n,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}const r=df.getPrimitive();let{boundsTraverseOrder:o,intersectsBounds:s,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){const t=a;a=(e,n,o,s,a)=>!!t(e,n,o,s,a)||_e(e,n,i,l,o,s,r)}else a||(a=l?(t,e,n,o)=>_e(t,e,i,l,n,o,r):(t,e,n)=>n);let u=!1,c=0;for(const t of this._roots){if(Ie(t),u=Wp(0,i,s,a,o,c),Re(),u)break;c+=t.byteLength}return df.releasePrimitive(r),u}bvhcast(t,e,n){let{intersectsRanges:i,intersectsTriangles:r}=n;const o=this.geometry.index,s=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;nf.copy(e).invert();const u=df.getPrimitive(),c=df.getPrimitive();if(r){function d(t,n,i,h,d,p,f,m){for(let g=i,y=i+h;g<y;g++){be(c,3*g,a,l),c.a.applyMatrix4(e),c.b.applyMatrix4(e),c.c.applyMatrix4(e),c.needsUpdate=!0;for(let e=t,i=t+n;e<i;e++)if(be(u,3*e,o,s),u.needsUpdate=!0,r(u,c,e,g,d,p,f,m))return!0}return!1}if(i){const p=i;i=function(t,e,n,i,r,o,s,a){return!!p(t,e,n,i,r,o,s,a)||d(t,e,n,i,r,o,s,a)}}else i=d}t.getBoundingBox(ef),ef.applyMatrix4(e);const h=this.shapecast({intersectsBounds:t=>ef.intersectsBox(t),intersectsRange:(e,n,r,o,s,a)=>(tf.copy(a),tf.applyMatrix4(nf),t.shapecast({intersectsBounds:t=>tf.intersectsBox(t),intersectsRange:(t,r,a,l,u)=>i(e,n,t,r,o,s,l,u)}))});return df.releasePrimitive(u),df.releasePrimitive(c),h}intersectsBox(t,e){return rf.set(t.min,t.max,e),rf.needsUpdate=!0,this.shapecast({intersectsBounds:t=>rf.intersectsBox(t),intersectsTriangle:t=>rf.intersectsTriangle(t)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,n={},i={},r=0,o=1/0){t.boundingBox||t.computeBoundingBox(),rf.set(t.boundingBox.min,t.boundingBox.max,e),rf.needsUpdate=!0;const s=this.geometry,a=s.attributes.position,l=s.index,u=t.attributes.position,c=t.index,h=df.getPrimitive(),d=df.getPrimitive();let p=af,f=lf,m=null,g=null;i&&(m=uf,g=cf);let y=1/0,v=null,x=null;return nf.copy(e).invert(),of.matrix.copy(nf),this.shapecast({boundsTraverseOrder:t=>rf.distanceToBox(t),intersectsBounds:(t,e,n)=>n<y&&n<o&&(e&&(of.min.copy(t.min),of.max.copy(t.max),of.needsUpdate=!0),!0),intersectsRange:(n,i)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:t=>of.distanceToBox(t),intersectsBounds:(t,e,n)=>n<y&&n<o,intersectsRange:(t,o)=>{for(let s=3*t,b=3*(t+o);s<b;s+=3){be(d,s,c,u),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let t=3*n,e=3*(n+i);t<e;t+=3){be(h,t,l,a),h.needsUpdate=!0;const e=h.distanceToTriangle(d,p,m);if(e<y&&(f.copy(p),g&&g.copy(m),y=e,v=t/3,x=s/3),e<r)return!0}}}});for(let t=0,o=c?c.count:u.count;t<o;t+=3){be(d,t,c,u),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let e=3*n,o=3*(n+i);e<o;e+=3){be(h,e,l,a),h.needsUpdate=!0;const n=h.distanceToTriangle(d,p,m);if(n<y&&(f.copy(p),g&&g.copy(m),y=n,v=e/3,x=t/3),n<r)return!0}}}}),df.releasePrimitive(h),df.releasePrimitive(d),y===1/0?null:(n.point?n.point.copy(f):n.point=f.clone(),n.distance=y,n.faceIndex=v,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(nf),f.applyMatrix4(nf),i.distance=f.sub(i.point).length(),i.faceIndex=x),n)}closestPointToPoint(t,e={},n=0,i=1/0){const r=n*n,o=i*i;let s=1/0,a=null;if(this.shapecast({boundsTraverseOrder:e=>(sf.copy(t).clamp(e.min,e.max),sf.distanceToSquared(t)),intersectsBounds:(t,e,n)=>n<s&&n<o,intersectsTriangle:(e,n)=>{e.closestPointToPoint(t,sf);const i=t.distanceToSquared(sf);return i<s&&(af.copy(sf),s=i,a=n),i<r}}),s===1/0)return null;const l=Math.sqrt(s);return e.point?e.point.copy(af):e.point=af.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach((e=>{he(0,new Float32Array(e),hf),t.union(hf)})),t}}const ff=[new Ad.Vector3,new Ad.Vector3,new Ad.Vector3];class mf{constructor(t=null){this.data=null,this.unmatchedEdges=null,this.matchedEdges=null,this.useDrawRange=!0,t&&this.updateFrom(t)}getSiblingTriangleIndex(t,e){const n=this.data[3*t+e];return-1===n?-1:~~(n/3)}getSiblingEdgeIndex(t,e){const n=this.data[3*t+e];return-1===n?-1:n%3}updateFrom(t){const e=new Map,{attributes:n}=t,i=t.index,r=n.position;let o=i?i.count/3:r.count/3;const s=o;let a=0;this.useDrawRange&&(a=t.drawRange.start,t.drawRange.count!==1/0&&(o=~~(t.drawRange.count/3)));let l=this.data;(!l||l.length<3*s)&&(l=new Int32Array(3*s)),l.fill(-1);let u=0,c=0;for(let t=0;t<o;t++){const n=3*t+a;for(let t=0;t<3;t++){let e=n+t;i&&(e=i.getX(e)),ff[t].fromBufferAttribute(r,e)}for(let t=0;t<3;t++){const i=(t+1)%3,r=ff[t],o=ff[i],s=qe(r),a=qe(o),h=`${a}_${s}`;if(e.has(h)){const i=e.get(h);l[n+t]=i,l[i]=n+t,e.delete(h),u--,c++}else{const i=`${s}_${a}`;e.set(i,n+t),u++}}}this.matchedEdges=c,this.unmatchedEdges=u,this.data=l}}class gf extends Ad.Mesh{constructor(...t){super(...t),this.isBrush=!0,this._previousMatrix=new Ad.Matrix4,this._previousMatrix.elements.fill(0)}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:t,_previousMatrix:e}=this,n=t.elements,i=e.elements;for(let t=0;t<16;t++)if(n[t]!==i[t])return!0;return!1}prepareGeometry(){const t=this.geometry,e=t.attributes;if(Le())for(const t in e){const n=e[t];if(n.isInterleavedBufferAttribute)throw new Error("Brush: InterleavedBufferAttributes are not supported.");n.array=De(n.array)}if(t.boundsTree||(t.boundsTree=new pf(t,{maxLeafTris:3}),t.halfEdges&&t.halfEdges.updateFrom(t)),t.halfEdges||(t.halfEdges=new mf(t)),!t.groupIndices){const e=t.index.count/3,n=new Uint16Array(e),i=t.groups;for(let t=0,e=i.length;t<e;t++){const{start:e,count:r}=i[t];for(let i=e/3,o=(e+r)/3;i<o;i++)n[i]=t}t.groupIndices=n}}disposeCacheData(){const{geometry:t}=this;t.halfEdges=null,t.boundsTree=null,t.groupIndices=null}}const yf=1e-14,vf=1e-10,xf=new Ad.Line3,bf=new Ad.Line3,_f=new Ad.Vector3,wf=new Ad.Vector3,Sf=new Ad.Plane,Af=new qp;class Mf{constructor(){this._pool=[],this._index=0}getTriangle(){return this._index>=this._pool.length&&this._pool.push(new Ad.Triangle),this._pool[this._index++]}clear(){this._index=0}reset(){this._pool.length=0,this._index=0}}class Tf{constructor(){this.trianglePool=new Mf,this.triangles=[],this.normal=new Ad.Vector3}initialize(t){const{triangles:e,trianglePool:n,normal:i}=this;if(e.length=0,n.clear(),Array.isArray(t))for(let r=0,o=t.length;r<o;r++){const o=t[r];if(0===r)o.getNormal(i);else if(Math.abs(1-o.getNormal(_f).dot(i))>yf)throw new Error("Triangle Splitter: Cannot initialize with triangles that have different normals.");const s=n.getTriangle();s.copy(o),e.push(s)}else{t.getNormal(i);const r=n.getTriangle();r.copy(t),e.push(r)}}splitByTriangle(t){const{normal:e,triangles:n}=this;if(t.getPlane(Sf),Math.abs(1-Math.abs(Sf.normal.dot(e)))<vf){const i=[t.a,t.b,t.c];for(let n=0;n<3;n++){const r=(n+1)%3,o=i[n],s=i[r];_f.subVectors(s,o).normalize(),wf.crossVectors(e,_f),Sf.setFromNormalAndCoplanarPoint(wf,o),this.splitByPlane(Sf,t,n)}for(let t=0,e=n.length;t<e;t++)n[t].coplanarCount=0}else this.splitByPlane(Sf,t)}splitByPlane(t,e=null,n=-1){const{triangles:i,trianglePool:r}=this;let o=null;null!==e&&(o=Af,o.copy(e),o.needsUpdate=!0);for(let e=0,n=i.length;e<n;e++){const s=i[e],{a:a,b:l,c:u}=s;if(o&&!o.intersectsTriangle(s,xf,!0))continue;let c=0,h=-1,d=0,p=!1;const f=[a,l,u];for(let e=0;e<3;e++){const n=(e+1)%3;xf.start.copy(f[e]),xf.end.copy(f[n]);const i=t.distanceToPoint(xf.start),r=t.distanceToPoint(xf.end);if(Math.abs(i)<vf&&Math.abs(r)<vf){p=!0;break}if(Math.abs(i)<vf)continue;i>0&&d++;let o=!!t.intersectLine(xf,_f);!o&&Math.abs(r)<vf&&(_f.copy(xf.end),o=!0),!o||_f.distanceTo(xf.start)<yf||(_f.distanceTo(xf.end)<yf&&(h=e),0===c?bf.start.copy(_f):bf.end.copy(_f),c++)}if(!p)if(2===c&&bf.distance()>vf)if(-1!==h){h=(h+1)%3;let t=0;t===h&&(t=(t+1)%3);let o=t+1;o===h&&(o=(o+1)%3);const a=r.getTriangle();a.a.copy(f[o]),a.b.copy(bf.end),a.c.copy(bf.start),ze(a)||i.push(a),s.a.copy(f[t]),s.b.copy(bf.start),s.c.copy(bf.end),ze(s)&&(i.splice(e,1),e--,n--)}else{const o=f.findIndex((e=>d>=2?t.distanceToPoint(e)<0:t.distanceToPoint(e)>0));if(0===o){let t=bf.start;bf.start=bf.end,bf.end=t}else if(-1===o)continue;const a=(o+1)%3,l=(o+2)%3,u=r.getTriangle(),c=r.getTriangle();f[a].distanceToSquared(bf.start)<f[l].distanceToSquared(bf.end)?(u.a.copy(f[a]),u.b.copy(bf.start),u.c.copy(bf.end),c.a.copy(f[a]),c.b.copy(f[l]),c.c.copy(bf.start)):(u.a.copy(f[l]),u.b.copy(bf.start),u.c.copy(bf.end),c.a.copy(f[a]),c.b.copy(f[l]),c.c.copy(bf.end)),s.a.copy(f[o]),s.b.copy(bf.end),s.c.copy(bf.start),ze(u)||i.push(u),ze(c)||i.push(c),ze(s)&&(i.splice(e,1),e--,n--)}else 3===c&&console.warn("TriangleClipper: Coplanar clip not handled")}}reset(){this.triangles.length=0}}class Ef{constructor(t,e=500){const n=Le()?SharedArrayBuffer:ArrayBuffer;this.expansionFactor=1.5,this.type=t,this.array=new t(new n(e*t.BYTES_PER_ELEMENT)),this.length=0}expand(t=null){const{type:e,array:n,expansionFactor:i}=this;null===t&&(t=~~(n.length*i));const r=new e(t);r.set(n,0),this.array=r}push(...t){let{array:e,length:n}=this;n+t.length>e.length&&(this.expand(),e=this.array);for(let i=0,r=t.length;i<r;i++)e[n+i]=t[i];this.length+=t.length}clear(){this.length=0}}class Pf{constructor(){this.groupAttributes=[{}],this.groupCount=0}getType(t){return this.groupAttributes[0][t].type}getTotalLength(t){const{groupCount:e,groupAttributes:n}=this;let i=0;for(let r=0;r<e;r++)i+=n[r][t].length;return i}getGroupSet(t=0){const{groupAttributes:e}=this;if(e[t])return this.groupCount=Math.max(this.groupCount,t+1),e[t];const n=e[0];for(this.groupCount=Math.max(this.groupCount,t+1);t>=e.length;){const t={};e.push(t);for(const e in n)t[e]=new Ef(n[e].type)}return e[t]}getGroupArray(t,e=0){const{groupAttributes:n}=this;if(!n[0][t])throw new Error(`TypedAttributeData: Attribute with "${t}" has not been initialized`);return this.getGroupSet(e)[t]}initializeArray(t,e){const{groupAttributes:n}=this,i=n[0][t];if(i){if(i.type!==e)throw new Error(`TypedAttributeData: Array ${t} already initialized with a different type.`)}else for(let i=0,r=n.length;i<r;i++)n[i][t]=new Ef(e)}clear(){this.groupCount=0;const{groupAttributes:t}=this;t.forEach((t=>{for(const e in t)t[e].clear()}))}delete(t){this.groupAttributes.forEach((e=>{delete e[t]}))}reset(){this.groupAttributes=[]}}class Cf{constructor(t){this.triangle=(new Ad.Triangle).copy(t),this.intersects={}}addTriangle(t,e){this.intersects[t]=(new Ad.Triangle).copy(e)}getIntersectArray(){const t=[],{intersects:e}=this;for(const n in e)t.push(e[n]);return t}}class If{constructor(){this.data={}}addTriangleIntersection(t,e,n,i){const{data:r}=this;r[t]||(r[t]=new Cf(e)),r[t].addTriangle(n,i)}getTrianglesAsArray(t=null){const{data:e}=this,n=[];if(null!==t)t in e&&n.push(e[t].triangle);else for(const t in e)n.push(e[t].triangle);return n}getTriangleIndices(){return Object.keys(this.data).map((t=>parseInt(t)))}getIntersectionIndices(t){const{data:e}=this;return e[t]?Object.keys(e[t].intersects).map((t=>parseInt(t))):[]}getIntersectionsAsArray(t=null,e=null){const{data:n}=this,i=new Set,r=[],o=t=>{if(n[t])if(null!==e)n[t].intersects[e]&&r.push(n[t].intersects[e]);else{const e=n[t].intersects;for(const t in e)i.has(t)||(i.add(t),r.push(e[t]))}};if(null!==t)o(t);else for(const t in n)o(t);return r}reset(){this.data={}}}class Rf{constructor(){this.enabled=!1,this.triangleIntersectsA=new If,this.triangleIntersectsB=new If,this.intersectionEdges=[]}addIntersectingTriangles(t,e,n,i){const{triangleIntersectsA:r,triangleIntersectsB:o}=this;r.addTriangleIntersection(t,e,n,i),o.addTriangleIntersection(n,i,t,e)}addEdge(t){this.intersectionEdges.push(t.clone())}reset(){this.triangleIntersectsA.reset(),this.triangleIntersectsB.reset(),this.intersectionEdges=[]}}class Of{constructor(){this.intersectionSet={},this.ids=[]}add(t,e){const{intersectionSet:n,ids:i}=this;n[t]||(n[t]=[],i.push(t)),n[t].push(e)}}const qf=new Ad.Ray,Lf=new Ad.Matrix4,Df=new Ad.Triangle,zf=new Ad.Vector3,kf=new Ad.Vector4,Bf=new Ad.Vector4,Ff=new Ad.Vector4,Vf=new Ad.Vector4,Nf=new Ad.Vector4,Uf=new Ad.Vector4,jf=new Ad.Line3,Gf=new Ad.Vector3,Hf=1e-8;let Wf=null;const Xf=new Ad.Matrix4,Yf=new Ad.Matrix3,Zf=new Ad.Triangle,Qf=new Ad.Triangle,Jf=new Ad.Triangle,Kf=new Ad.Triangle;var $f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"init",value:function(){this.calculateVerticesOfShape(),this.sideMaterial=new Ad.MeshPhongMaterial,this.sideMaterial.map=op("textures/grass-side"),this.sideMaterial.map.wrapS=Ad.RepeatWrapping,this.sideMaterial.map.wrapT=Ad.RepeatWrapping,this.sideMaterial.map.repeat=new Ad.Vector2(1,1),this.topMaterial=new Ad.MeshPhongMaterial,this.topMaterial.map=op("textures/grass"),this.createMiddleMaterials()}},{key:"createMiddleMaterials",value:function(){var t=op("textures/grass-center");this.middleMaterials.next=function(t){return new Ad.ShaderMaterial({uniforms:{map:{type:"t",value:t}},defines:{USE_UV:!0},vertexShader:"\n            #include <common>\n            #include <logdepthbuf_pars_vertex>\n            varying vec2 vUv;\n\n            void main() {\n                vUv = uv;\n                vUv.y = 0.95;\n                #include <begin_vertex>\n                #include <project_vertex>\n                #include <logdepthbuf_vertex>\n            }",fragmentShader:"\n            #include <common>\n            #include <logdepthbuf_pars_fragment>\n            varying vec2 vUv;\n            uniform sampler2D map;\n\n            void main() {\n                #include <logdepthbuf_fragment>\n                gl_FragColor = texture2D(map, vUv);\n            }"})}(t),this.middleMaterials.current=function(t){return new Ad.ShaderMaterial({uniforms:{currentPoint:{value:0},map:{type:"t",value:t}},defines:{USE_UV:!0},depthWrite:!1,vertexShader:"\n            #include <common>\n            #include <logdepthbuf_pars_vertex>\n            uniform float currentPoint;\n            attribute float vertexId;\n            varying vec2 vUv;\n\n            void main() {\n                vUv = uv;\n                #include <begin_vertex>\n\n                if(vertexId > 0.0 && vertexId < currentPoint - 0.35) {\n                    transformed.y = 0.5;\n                } else {\n                    vUv.y = 0.95;\n                }\n\n                #include <project_vertex>\n                #include <logdepthbuf_vertex>\n            }",fragmentShader:"\n            #include <common>\n            #include <logdepthbuf_pars_fragment>\n            varying vec2 vUv;\n            uniform sampler2D map;\n            uniform float currentPoint;\n\n            void main() {\n                #include <logdepthbuf_fragment>\n                gl_FragColor = texture2D(map, vUv);\n            }"})}(t),this.middleMaterials.previous=function(t){return new Ad.ShaderMaterial({uniforms:{map:{type:"t",value:t}},defines:{USE_UV:!0},depthWrite:!1,vertexShader:"\n            #include <common>\n            #include <logdepthbuf_pars_vertex>\n            varying vec2 vUv;\n\n            void main() {\n                vUv = uv;\n                #include <begin_vertex>\n                transformed.y = 0.5;\n                #include <project_vertex>\n                #include <logdepthbuf_vertex>\n            }",fragmentShader:"\n            #include <common>\n            #include <logdepthbuf_pars_fragment>\n            varying vec2 vUv;\n            uniform sampler2D map;\n\n            void main() {\n                #include <logdepthbuf_fragment>\n                gl_FragColor = texture2D(map, vUv);\n            }"})}(t)}},{key:"calculateVerticesOfShape",value:function(){var t=new Ad.Shape(this.shapeConfig.map((function(t){return new Ad.Vector2(t.x,t.y)}))).extractPoints().shape;!Ad.ShapeUtils.isClockWise(t)&&t.reverse(),this.verticesOfShape=t}},{key:"create",value:function(t,e,n,i){this.curve=t,this.steps=e,this.offset=n,this.blocks=i,this.vertexId=[],this.vertices={},this.sideFaces=[],this.topFaces=[],this.middleFaces=[],this.middleFacesIndices=[],this.mainUvs=[],this.middleUvs=[],this.currentQueueIndex=0,this.currentBlockIndex=0,this.active=!0}},{key:"next",value:function(){this.active&&this.generationQueue[this.currentQueueIndex].call(t)}},{key:"processCurrentChunkSync",value:function(){for(;this.active;)t.next()}},{key:"completeGeneration",value:function(){this.active=!1,this.observer.emit(t.events.complete,[new Ad.Mesh(this.mainGeometry,this.topMaterial),new Ad.Mesh(this.middleGeometry,this.middleMaterials.next),new Ad.Mesh(this.sideGeometry,this.sideMaterial)])}},{key:"generateVertices",value:function(){for(var e=this.curve.computeFrenetFrames(this.steps,!1),n=this.curve.getSpacedPoints(this.steps),i=0,r=this.verticesOfShape.length;i<r;i++){var o=this.shapeConfig[i].label;this.vertices[o]=[];for(var s=0;s<=this.steps;s++){var a=this.verticesOfShape[i];this.normal.copy(e.normals[s]).multiplyScalar(a.x),this.binormal.copy(e.binormals[s]).multiplyScalar(a.y),this.position.copy(n[s]).add(this.normal).add(this.binormal),this.vertices[o].push(this.position.clone())}}this.currentQueueIndex+=1,this.observer.emit(t.events.frenetFramesCompute,e,n)}},{key:"groupVertices",value:function(){for(var t=1;t<=this.steps;t++)this.groupVerticesIntoFacesByLabels("a","b",this.vertices,t,this.sideFaces),this.groupVerticesIntoFacesByLabels("c","d",this.vertices,t,this.sideFaces),this.groupVerticesIntoFacesByLabels("e","f",this.vertices,t,this.sideFaces),this.groupVerticesIntoFacesByLabels("g","h",this.vertices,t,this.sideFaces),this.groupVerticesIntoFacesByLabels("b","c",this.vertices,t,this.topFaces),this.groupVerticesIntoFacesByLabels("f","g",this.vertices,t,this.topFaces);this.currentQueueIndex+=1}},{key:"groupMiddleGrassVertices",value:function(){for(var t=this.steps;t>=1;t--)this.reverceGroupVerticesIntoFacesByLabels("d","e",this.vertices,t,this.middleFaces);this.currentQueueIndex+=1}},{key:"reverceGroupVerticesIntoFacesByLabels",value:function(t,e,n,i,r){var o=n[t][i],s=n[t][i-1],a=n[e][i],l=n[e][i-1];r.push(o.x,o.y,o.z,l.x,l.y,l.z,a.x,a.y,a.z,o.x,o.y,o.z,s.x,s.y,s.z,l.x,l.y,l.z)}},{key:"groupVerticesIntoFacesByLabels",value:function(t,e,n,i,r){var o=n[t][i-1],s=n[t][i],a=n[e][i-1],l=n[e][i];r.push(a.x,a.y,a.z,s.x,s.y,s.z,o.x,o.y,o.z,a.x,a.y,a.z,l.x,l.y,l.z,s.x,s.y,s.z)}},{key:"generateTopUVs",value:function(){for(var e=0,n=this.topFaces.length;e<n;e+=9){var i=this.topFaces[e],r=this.topFaces[e+2],o=this.topFaces[e+3],s=this.topFaces[e+5],a=this.topFaces[e+6],l=this.topFaces[e+8];this.mainUvs.push(i+this.offset.x,1-r+this.offset.z),this.mainUvs.push(o+this.offset.x,1-s+this.offset.z),this.mainUvs.push(a+this.offset.x,1-l+this.offset.z)}this.currentQueueIndex+=1,this.observer.emit(t.events.generateTopUVs)}},{key:"generateSideUVs",value:function(){for(var t=0,e=this.sideFaces.length;t<e;t+=9){var n=this.sideFaces[t],i=this.sideFaces[t+1],r=this.sideFaces[t+2],o=this.sideFaces[t+3],s=this.sideFaces[t+4],a=this.sideFaces[t+5],l=this.sideFaces[t+6],u=this.sideFaces[t+7],c=this.sideFaces[t+8];this.mainUvs.push(r+n+this.offset.z,i),this.mainUvs.push(a+o+this.offset.z,s),this.mainUvs.push(c+l+this.offset.z,u)}this.currentQueueIndex+=1}},{key:"generateMiddleUVs",value:function(){for(var t=0,e=this.middleFaces.length;t<e;t+=18)this.middleUvs.push(.85,0),this.middleUvs.push(0,.85),this.middleUvs.push(0,0),this.middleUvs.push(.85,0),this.middleUvs.push(.85,.85),this.middleUvs.push(0,.85);this.currentQueueIndex+=1}},{key:"calculateVertexIdForMiddleFaces",value:function(){for(var t=this.steps,e=0,n=this.middleFaces.length/3;e<n;e+=6)this.middleFaces[3*e+1]=1,this.middleFaces[3*(e+1)+1]=1,this.middleFaces[3*(e+2)+1]=1,this.middleFaces[3*(e+3)+1]=1,this.middleFaces[3*(e+4)+1]=1,this.middleFaces[3*(e+5)+1]=1,this.vertexId[e]=t-1+n/6,this.vertexId[e+1]=t-1+n/6,this.vertexId[e+2]=t-1+n/6,this.vertexId[e+3]=t-1+n/6,this.vertexId[e+4]=t-1+n/6,this.vertexId[e+5]=t-1+n/6,t--;this.currentQueueIndex+=1}},{key:"calculateMiddleFacesIndices",value:function(){for(var t=0;t<this.steps-1;t++){var e=6*t;this.middleFacesIndices.push(e+0,e+1,e+2,e+3,e+4,e+5,e+4,e+8,e+1,e+4,e+6,e+8)}var n=6*(this.steps-1);this.middleFacesIndices.push(n+0,n+1,n+2,n+3,n+4,n+5),this.currentQueueIndex+=1}},{key:"buildGeometries",value:function(){var t=new Ad.BufferGeometry,e=new Ad.BufferGeometry,n=new Ad.BufferGeometry;t.setAttribute("position",new Ad.BufferAttribute(new Float32Array(this.topFaces),3)),t.setAttribute("uv",new Ad.BufferAttribute(new Float32Array(this.mainUvs.slice(Math.ceil(this.sideFaces.length/9*6))),2,!1)),t.addGroup(0,this.topFaces.length/3,0),t.computeVertexNormals(),e.setIndex(this.middleFacesIndices),e.setAttribute("position",new Ad.BufferAttribute(new Float32Array(this.middleFaces),3)),e.setAttribute("uv",new Ad.BufferAttribute(new Float32Array(this.middleUvs),2)),e.setAttribute("vertexId",new Ad.BufferAttribute(new Float32Array(this.vertexId),1)),e.addGroup(0,this.middleFaces.length/3,0),e.computeVertexNormals(),n.setAttribute("position",new Ad.BufferAttribute(new Float32Array(this.sideFaces),3)),n.setAttribute("uv",new Ad.BufferAttribute(new Float32Array(this.mainUvs),2)),n.addGroup(0,this.sideFaces.length/3,0),n.computeVertexNormals(),this.middleGeometry=e,this.mainBrush=new gf(t),this.sideBrush=new gf(n),this.currentQueueIndex+=1}},{key:"substractNextBlock",value:function(){if(this.currentBlockIndex===this.blocks.length)return this.currentQueueIndex+=1,this.mainGeometry=this.mainBrush.geometry,this.currentBlockIndex=0,void this.evaluator.reset();var t=this.blocks[this.currentBlockIndex];this.substractionBlockBrush.position.set(t.x,.75,t.z),this.substractionBlockBrush.rotation.y=t.r,this.substractionBlockBrush.updateMatrixWorld(),this.mainBrush=this.evaluator.evaluate(this.mainBrush,this.substractionBlockBrush,1),this.currentBlockIndex+=1}},{key:"substractNextBlockFromSideGeometry",value:function(){if(this.currentBlockIndex===this.blocks.length)return this.currentQueueIndex+=1,void(this.sideGeometry=this.sideBrush.geometry);var t=this.blocks[this.currentBlockIndex];this.substractionBlockBrush.position.set(t.x,.75,t.z),this.substractionBlockBrush.rotation.y=t.r,this.substractionBlockBrush.updateMatrixWorld(),this.sideBrush=this.evaluator.evaluate(this.sideBrush,this.substractionBlockBrush,1),this.currentBlockIndex+=1}}],null&&Ye(e.prototype,null),n&&Ye(e,n),t}();Ze($f,"curve",null),Ze($f,"steps",null),Ze($f,"offset",null),Ze($f,"blocks",null),Ze($f,"mainBrush",null),Ze($f,"sideBrush",null),Ze($f,"substractionBlockBrush",new gf(new Ad.BoxGeometry(1,.51,.94))),Ze($f,"binormal",new Ad.Vector3),Ze($f,"normal",new Ad.Vector3),Ze($f,"position",new Ad.Vector3),Ze($f,"vertexId",[]),Ze($f,"vertices",{}),Ze($f,"sideFaces",[]),Ze($f,"topFaces",[]),Ze($f,"middleFaces",[]),Ze($f,"middleFacesIndices",[]),Ze($f,"mainUvs",[]),Ze($f,"middleUvs",[]),Ze($f,"shapeConfig",[{x:0,y:-3,label:"h"},{x:-1,y:-3,label:"g"},{x:-1,y:-.5,label:"f"},{x:-.5,y:-.5,label:"e"},{x:-.5,y:.5,label:"d"},{x:-1,y:.5,label:"c"},{x:-1,y:3,label:"b"},{x:0,y:3,label:"a"}]),Ze($f,"verticesOfShape",null),Ze($f,"generationQueue",[$f.generateVertices,$f.groupVertices,$f.groupMiddleGrassVertices,$f.generateSideUVs,$f.generateTopUVs,$f.generateMiddleUVs,$f.calculateVertexIdForMiddleFaces,$f.calculateMiddleFacesIndices,$f.buildGeometries,$f.substractNextBlock,$f.substractNextBlockFromSideGeometry,$f.completeGeneration]),Ze($f,"currentQueueIndex",0),Ze($f,"currentBlockIndex",0),Ze($f,"mainGeometry",null),Ze($f,"middleGeometry",null),Ze($f,"sideGeometry",null),Ze($f,"topMaterial",null),Ze($f,"sideMaterial",null),Ze($f,"evaluator",new class{constructor(){this.triangleSplitter=new Tf,this.attributeData=new Pf,this.attributes=["position","uv","normal"],this.useGroups=!0,this.debug=new Rf}evaluate(t,e,n,i=new gf){t.prepareGeometry(),e.prepareGeometry();const{triangleSplitter:r,attributeData:o,attributes:s,useGroups:a,debug:l}=this,u=i.geometry,c=t.geometry.attributes;for(let t=0,e=s.length;t<e;t++){const e=s[t],n=c[e];o.initializeArray(e,n.array.constructor)}for(const t in o.attributes)s.includes(t)||o.delete(t);for(const t in u.attributes)s.includes(t)||(u.deleteAttribute(t),u.dispose());o.clear(),l.enabled&&(l.reset(),ke(l)),function(t,e,n,i,r,o){const{useGroups:s=!0}=o,{aIntersections:a,bIntersections:l}=function(t,e){const n=new Of,i=new Of;return Lf.copy(t.matrixWorld).invert().multiply(e.matrixWorld),t.geometry.boundsTree.bvhcast(e.geometry.boundsTree,Lf,{intersectsTriangles(t,e,r,o){if(t.intersectsTriangle(e,jf,!0)){if(0===jf.distanceSq()&&t.plane.normal.dot(e.plane.normal)<1-1e-10)return!1;n.add(r,o),i.add(o,r),Wf&&(Wf.addEdge(jf),Wf.addIntersectingTriangles(r,t,o,e))}return!1}}),{aIntersections:n,bIntersections:i}}(t,e);let u;u=s?0:-1,We(t,e,a,n,!1,r,u),He(t,e,a,n,!1,i,r,u),u=s?t.geometry.groups.length||1:-1,We(e,t,l,n,!0,r,u),He(e,t,l,n,!0,i,r,u)}(t,e,n,r,o,{useGroups:a}),l.enabled&&ke(null);const h=a&&0!==t.geometry.groups.length?t.geometry.groups.map((t=>({...t}))):[{start:0,count:1/0,materialIndex:0}],d=a&&0!==e.geometry.groups.length?e.geometry.groups.map((t=>({...t}))):[{start:0,count:1/0,materialIndex:0}],p=Xe(h,t.material),f=Xe(d,e.material);d.forEach((t=>{t.materialIndex+=p.length})),function(t,e,n,i){let r=!1,o=-1;const s=i.groupCount,a=t.attributes,l=i.groupAttributes[0];for(const n in l){const u=i.getTotalLength(n,s),c=l[n].type;let h=a[n];if(!h||h.array.length<u){const i=e.attributes[n];h=new Ad.BufferAttribute(new c(u),i.itemSize,i.normalized),t.setAttribute(n,h),r=!0}let d=0;for(let t=0;t<s;t++){const{array:e,type:r,length:o}=i.groupAttributes[t][n],s=new r(e.buffer,0,o);h.array.set(s,d),d+=s.length}h.needsUpdate=!0,o=u/h.itemSize}t.setDrawRange(0,o),t.clearGroups();let u=0;for(let e=0;e<s;e++){const r=i.getGroupArray("position",e).length/3;if(0!==r){const i=n[e];t.addGroup(u,r,i.materialIndex),u+=r}}if(t.index){const e=t.index.array;if(e.length<o)t.index=null,r=!0;else for(let t=0,n=e.length;t<n;t++)e[t]=t}t.boundsTree=null,r&&t.dispose()}(u,t.geometry,[...h,...d],o);const m=u.groups;if(a){const t=new Map,e=[...p,...f];let n=0;for(let i=0,r=e.length;i<r;i++)Boolean(m.find((t=>t.materialIndex===i)))?(t.set(i,n),n++):e[i]=null;for(let e=0,n=m.length;e<n;e++){const n=m[e];n.materialIndex=t.get(n.materialIndex)}i.material=e.filter((t=>t))}return i}evaluateHierarchy(t,e=new gf){t.updateMatrixWorld(!0);const n=(t,e)=>{const i=t.children;for(let t=0,r=i.length;t<r;t++){const r=i[t];r.isOperationGroup?n(r,e):e(r)}},i=t=>{const e=t.children;let r=!1;for(let t=0,n=e.length;t<n;t++){const n=e[t];r=i(n)||r}const o=t.isDirty();if(o&&t.markUpdated(),r&&!t.isOperationGroup){let e;return n(t,(n=>{e=e?this.evaluate(e,n,n.operation):this.evaluate(t,n,n.operation)})),t._cachedGeometry=e.geometry,t._cachedMaterials=e.material,!0}return r||o};return i(t),e.geometry=t._cachedGeometry,e.material=t._cachedMaterials,e}reset(){this.triangleSplitter.reset()}}),Ze($f,"middleMaterials",{next:null,current:null,previous:null}),Ze($f,"observer",new(Td())),Ze($f,"events",{complete:"conplete",frenetFramesCompute:"frenetFamesCompute",generateTopUVs:"generateTopUVs"}),Ze($f,"active",!1);const tm=$f;var em=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=r.call(this,t)).leafsEmitter=null,n.windEmitter=null,n.spawnZone=null,n.createEmitters(),n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,t);var n,i,r=tn(e);return n=e,i=[{key:"createEmitters",value:function(){this.spawnZone=new(Yd().RectZone)(0,0,1,1),this.windEmitter=this.createEmitter(),this.windEmitter.rate=new(Yd().Rate)(2,.2),this.windEmitter.addInitialize(new(Yd().Life)(2,3)),this.windEmitter.addInitialize(new(Yd().Velocity)(7,90,"polar")),this.windEmitter.addInitialize(new(Yd().Position)(this.spawnZone));for(var t=[],n=0;n<e.windTextures;n++)t.push("leafs-particles/wind-"+(n+1));this.windEmitter.addInitialize(new(Yd().Body)(t)),this.windEmitter.addBehaviour(new(Yd().Alpha)(1,0,1/0,Yd().easeInExpo)),this.leafsEmitter=this.createEmitter(),this.leafsEmitter.rate=new(Yd().Rate)(4,.1),this.leafsEmitter.addInitialize(new(Yd().Life)(1,3)),this.leafsEmitter.addInitialize(new(Yd().Velocity)(6,90,"polar")),this.leafsEmitter.addInitialize(new(Yd().Position)(this.spawnZone));for(var i=[],r=0;r<e.leafsTestures;r++)i.push("leafs-particles/feal-"+(r+1));this.leafsEmitter.addInitialize(new(Yd().Body)(i)),this.leafsEmitter.addBehaviour(new(Yd().RandomDrift)(10,5,0,1/0,Yd().easeLinear)),this.leafsEmitter.addBehaviour(new(Yd().Rotate)(new(Yd().getSpan)(-2,2),new(Yd().getSpan)(-2,2),"to",1/0,Yd().easeOutSine)),this.leafsEmitter.addBehaviour(new(Yd().Alpha)(1,0,1/0,Yd().easeInExpo))}},{key:"createRenderer",value:function(){this.renderer=new ProtonPIXIRenderer(this),this.renderer.particlesBlendMode=Ds.NORMAL,this.proton.addRenderer(this.renderer)}},{key:"show",value:function(){this.leafsEmitter.emit(2),this.windEmitter.emit(2)}},{key:"hide",value:function(){this.leafsEmitter.stop(),this.windEmitter.stop()}},{key:"resize",value:function(){var t=jd.gameWidth,e=jd.gameHeight;this.spawnZone.width=t,this.spawnZone.height=.25*e}},{key:"update",value:function(t){if(this.dispatchEvent(Yd().PROTON_UPDATE),this.elapsed=t/1e3,this.elapsed>0){var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Je(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Je(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(this.emitters);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.update(this.elapsed),i.emitTime>0&&i.emitTime>i.totalTime&&i.stop()}}catch(t){n.e(t)}finally{n.f()}}this.dispatchEvent(Yd().PROTON_UPDATE_AFTER)}}],i&&Ke(n.prototype,i),e}(cp);nn(em,"leafsTestures",9),nn(em,"windTextures",4),nn(em,"spawnZone",{width:500,height:100});const nm=em,im=JSON.parse('{"1":{"path":[{"x":0,"z":0},{"x":0.48,"z":-134.97}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":4.28,"z":-51.38},"indicatorPosition":0,"width":6,"height":1,"rotationSpeed":-1,"segmentsConfigId":0},{"type":0,"position":{"x":-3.8,"z":-26.25},"indicatorPosition":0.17696460707858427,"width":6,"height":1,"rotationSpeed":1,"segmentsConfigId":0},{"type":0,"position":{"x":4.05,"z":-77.59},"indicatorPosition":0,"width":6,"height":1,"rotationSpeed":-1,"segmentsConfigId":0},{"type":0,"position":{"x":-3.92,"z":-109.65},"indicatorPosition":0,"width":6,"height":1,"rotationSpeed":1,"segmentsConfigId":0},{"type":0,"position":{"x":4.34,"z":-109.6},"indicatorPosition":0,"width":6,"height":1,"rotationSpeed":-1,"segmentsConfigId":0}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":3.59,"z":-36.67},"indicatorPosition":0,"radius":4,"theta":3,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":1,"position":{"x":-3.26,"z":-108.33},"indicatorPosition":0,"radius":4,"theta":3,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":2,"position":{"x":0.21,"z":-68.87},"indicatorPosition":0,"radius":5,"rotationSpeed":1,"segmentsConfigId":"1"},{"type":2,"position":{"x":0.28,"z":-68.73},"indicatorPosition":0,"radius":4,"rotationSpeed":-1,"segmentsConfigId":0}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":-3.69,"z":-111.21},"indicatorPosition":0,"width":5,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":2,"position":{"x":0.24,"z":-83.05},"indicatorPosition":0,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"4"},{"type":1,"position":{"x":3.69,"z":-56.87},"indicatorPosition":0,"radius":4,"theta":0.8,"rotationSpeed":-1.5,"segmentsConfigId":"1"},{"type":2,"position":{"x":0,"z":-28.92},"indicatorPosition":0,"radius":8,"rotationSpeed":0.7,"segmentsConfigId":"5"},{"type":0,"position":{"x":4.38,"z":-109.56},"indicatorPosition":0,"width":5,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":"2"}]}]}},"2":{"path":[{"x":-0.35,"z":0},{"x":-0.39,"z":-5.04},{"x":1.47,"z":-10.94},{"x":8.29,"z":-16.89},{"x":27.84,"z":-15.06},{"x":32.15,"z":-20.55},{"x":28.86,"z":-26.08},{"x":8.23,"z":-32.55},{"x":-7.21,"z":-11.07},{"x":-14.95,"z":-4.82},{"x":-20.75,"z":-10.77},{"x":-12.37,"z":-42.67}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":26.99,"z":-22.68},"indicatorPosition":0,"radius":8,"rotationSpeed":0.7,"segmentsConfigId":"4"},{"type":0,"position":{"x":1.32,"z":-19.18},"indicatorPosition":0,"width":7,"height":1,"rotationSpeed":0.6,"segmentsConfigId":"2"},{"type":2,"position":{"x":-20.5,"z":-12.65},"indicatorPosition":0,"radius":4,"rotationSpeed":1,"segmentsConfigId":"7"}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":-1.91,"z":-13.73},"indicatorPosition":0,"radius":5,"theta":1.5,"rotationSpeed":0.8,"segmentsConfigId":"1"},{"type":2,"position":{"x":18.56,"z":-25.67},"indicatorPosition":0,"radius":9,"rotationSpeed":1,"segmentsConfigId":"1"},{"type":0,"position":{"x":-15.13,"z":-23.8},"indicatorPosition":0,"width":5,"height":1,"rotationSpeed":-1,"segmentsConfigId":0}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":34.55,"z":-21.83},"indicatorPosition":0.3091381723655269,"radius":6,"rotationSpeed":-1,"segmentsConfigId":"7"},{"type":0,"position":{"x":16.91,"z":-25.78},"indicatorPosition":0,"width":10,"height":1,"rotationSpeed":1,"segmentsConfigId":"3"},{"type":2,"position":{"x":-3.27,"z":-18.69},"indicatorPosition":0,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":1,"position":{"x":-16.08,"z":-10.95},"indicatorPosition":0,"radius":4,"theta":5,"rotationSpeed":-1.6,"segmentsConfigId":0},{"type":1,"position":{"x":-21.13,"z":-28.83},"indicatorPosition":0,"radius":4,"theta":5,"rotationSpeed":1.6,"segmentsConfigId":0}]}]}},"3":{"path":[{"x":-2.13,"z":0},{"x":-3.83,"z":-3.9},{"x":-44.92,"z":-32.17},{"x":-47.01,"z":-43.94},{"x":-38.03,"z":-49.9},{"x":33.71,"z":-2.87},{"x":43.76,"z":-5.71},{"x":45.16,"z":-13.86},{"x":-0.32,"z":-30.58},{"x":0,"z":-51.1}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":-41.8,"z":-43.65},"indicatorPosition":0,"radius":6,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":0,"position":{"x":-21.67,"z":-21.26},"indicatorPosition":0.11437712457508498,"width":4,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":1,"position":{"x":-4.21,"z":-34.59},"indicatorPosition":0.9224155168966207,"radius":3.5,"theta":1,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":2,"position":{"x":43.31,"z":-7.84},"indicatorPosition":0.6858628274345131,"radius":4,"rotationSpeed":1,"segmentsConfigId":"1"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":-15.32,"z":-9.68},"indicatorPosition":0,"radius":4,"rotationSpeed":1,"segmentsConfigId":0},{"type":2,"position":{"x":-11.23,"z":-15.83},"indicatorPosition":0,"radius":4,"rotationSpeed":-1,"segmentsConfigId":0},{"type":2,"position":{"x":-46.33,"z":-46.95},"indicatorPosition":0,"radius":3.5,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":1,"position":{"x":-20.19,"z":-38.39},"indicatorPosition":0.3987202559488102,"radius":4,"theta":0.47,"rotationSpeed":-1.5,"segmentsConfigId":"1"},{"type":2,"position":{"x":34.3,"z":-12.8},"indicatorPosition":0,"radius":15,"rotationSpeed":0.8,"segmentsConfigId":"1"},{"type":0,"position":{"x":40.29,"z":-9.58},"indicatorPosition":0,"width":4,"height":1,"rotationSpeed":1.5,"segmentsConfigId":0}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":-9.79,"z":-10.5},"indicatorPosition":0,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":0,"position":{"x":-16.41,"z":-12.41},"indicatorPosition":0,"width":2.5,"height":1,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":1,"position":{"x":-36.49,"z":-22.81},"indicatorPosition":0,"radius":4,"theta":0.47,"rotationSpeed":-1.8,"segmentsConfigId":"0"},{"type":2,"position":{"x":-47.5,"z":-42.27},"indicatorPosition":0,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"1"},{"type":2,"position":{"x":-43.12,"z":-49.79},"indicatorPosition":0,"radius":3,"rotationSpeed":2,"segmentsConfigId":"1"},{"type":2,"position":{"x":-33.17,"z":-50.83},"indicatorPosition":0,"radius":3,"rotationSpeed":2,"segmentsConfigId":"1"},{"type":0,"position":{"x":9.7,"z":-15.66},"indicatorPosition":0,"width":4,"height":1,"rotationSpeed":2,"segmentsConfigId":0},{"type":0,"position":{"x":1.04,"z":-33.96},"indicatorPosition":0,"width":7,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":2,"position":{"x":37.07,"z":-12.16},"indicatorPosition":0,"radius":13,"rotationSpeed":2,"segmentsConfigId":"2"},{"type":2,"position":{"x":37.21,"z":-12.29},"indicatorPosition":0,"radius":10,"rotationSpeed":-1.8,"segmentsConfigId":"0"},{"type":2,"position":{"x":37.09,"z":-12.52},"indicatorPosition":0,"radius":8,"rotationSpeed":1.2,"segmentsConfigId":"7"}]}]}},"4":{"path":[{"x":0,"z":0},{"x":-15.44,"z":-31.12},{"x":-35.93,"z":-37.33},{"x":-42.86,"z":-27},{"x":-36.52,"z":-16.65},{"x":1.99,"z":-24.46},{"x":29.91,"z":-53.46},{"x":50.56,"z":-53.53},{"x":56.09,"z":-40.77},{"x":49.13,"z":-31.29},{"x":28.2,"z":-30.01},{"x":0,"z":-81.95}],"blocks":[{"w":0.98,"h":2,"x":-7.169,"z":-20.541,"r":-1.123},{"w":0.98,"h":2,"x":-7.557,"z":-21.341,"r":-1.114},{"w":0.98,"h":2,"x":-8.855,"z":-21.854,"r":-2.818},{"w":0.98,"h":2,"x":-6.329,"z":-22.744,"r":-2.787},{"w":0.98,"h":2,"x":19.23,"z":-45.307,"r":-2.219},{"w":0.98,"h":2,"x":18.653,"z":-43.205,"r":-1.018},{"w":0.98,"h":2,"x":-6.81,"z":-19.79,"r":-1.13},{"w":0.98,"h":2,"x":-8.773,"z":-23.729,"r":-1.083},{"w":0.98,"h":2,"x":-9.193,"z":-24.51,"r":-1.071},{"w":0.98,"h":2,"x":-9.758,"z":-21.557,"r":-2.828},{"w":0.98,"h":2,"x":-10.553,"z":-21.304,"r":-2.837},{"w":0.98,"h":2,"x":-7.116,"z":-22.458,"r":-2.797},{"w":0.98,"h":2,"x":-5.497,"z":-23.058,"r":-2.776},{"w":0.98,"h":2,"x":16.709,"z":-41.916,"r":-2.205},{"w":0.98,"h":2,"x":16.287,"z":-41.342,"r":-2.205},{"w":0.98,"h":2,"x":17.17,"z":-42.541,"r":-2.205},{"w":0.98,"h":2,"x":18.689,"z":-44.589,"r":-2.213},{"w":0.98,"h":2,"x":19.771,"z":-46.016,"r":-2.226},{"w":0.98,"h":2,"x":20.276,"z":-46.667,"r":-2.233},{"w":0.98,"h":2,"x":19.125,"z":-42.448,"r":-1.008},{"w":0.98,"h":2,"x":19.596,"z":-41.707,"r":-0.998},{"w":0.98,"h":2,"x":20.099,"z":-40.936,"r":-0.986},{"x":-8.389,"z":-22.995,"r":-1.094},{"x":17.735,"z":-43.307,"r":-2.207},{"x":16.386,"z":-47.06,"r":-1.057},{"x":17.26,"z":-45.534,"r":-1.043},{"x":18.15,"z":-44.03,"r":-1.027},{"x":16.823,"z":-46.292,"r":-1.05},{"x":17.711,"z":-44.766,"r":-1.035}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":-12.08,"z":-23.9},"indicatorPosition":0.09178164367126575,"width":5,"height":1,"rotationSpeed":1,"segmentsConfigId":0},{"type":2,"position":{"x":-41.59,"z":-32.01},"indicatorPosition":0.23175364927014597,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":1,"position":{"x":21.7,"z":-43.65},"indicatorPosition":0.8378324335132974,"radius":4,"theta":0.47,"rotationSpeed":-1,"segmentsConfigId":"1"},{"type":0,"position":{"x":0.37,"z":-71.34},"indicatorPosition":0.9530093981203759,"width":5,"height":1,"rotationSpeed":0.9,"segmentsConfigId":"1"}]}],"1":[{"name":"m","obstacles":[{"type":0,"position":{"x":-11.09,"z":-23.67},"indicatorPosition":0,"width":4,"height":1,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":2,"position":{"x":-42,"z":-33},"indicatorPosition":0,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"6"},{"type":2,"position":{"x":-41.59,"z":-32.9},"indicatorPosition":0.22895420915816836,"radius":3,"rotationSpeed":-1.2,"segmentsConfigId":"6"},{"type":0,"position":{"x":9.81,"z":-28.36},"indicatorPosition":0.4443111377724455,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"},{"type":0,"position":{"x":39.11,"z":-43.99},"indicatorPosition":0,"width":17,"height":1,"rotationSpeed":-0.7,"segmentsConfigId":"2"},{"type":2,"position":{"x":6.65,"z":-67.03},"indicatorPosition":0,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"4"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":-7.85,"z":-22.26},"indicatorPosition":0.38452309538092383,"radius":4,"rotationSpeed":1.8,"segmentsConfigId":0},{"type":1,"position":{"x":-23.76,"z":-34.53},"indicatorPosition":0.15276944611077783,"radius":4,"theta":0.47,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":1,"position":{"x":-21.53,"z":-40.29},"indicatorPosition":0.15336932613477305,"radius":4,"theta":0.47,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":2,"position":{"x":-42.44,"z":-29.13},"indicatorPosition":0.24235152969406118,"radius":3,"rotationSpeed":1.2,"segmentsConfigId":"7"},{"type":2,"position":{"x":-42.5,"z":-29.22},"indicatorPosition":0.2419516096780644,"radius":4,"rotationSpeed":-1.2,"segmentsConfigId":"7"},{"type":0,"position":{"x":-24.94,"z":-14.62},"indicatorPosition":0.3239352129574085,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"2"},{"type":0,"position":{"x":6.5,"z":-43.49},"indicatorPosition":0.47650469906018794,"width":12,"height":1,"rotationSpeed":0.8,"segmentsConfigId":"2"},{"type":2,"position":{"x":42.67,"z":-44.65},"indicatorPosition":0.6056788642271546,"radius":15,"rotationSpeed":-1,"segmentsConfigId":0},{"type":1,"position":{"x":52.69,"z":-43.5},"indicatorPosition":0.6756648670265947,"radius":4,"theta":4,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":2,"position":{"x":10.39,"z":-58.94},"indicatorPosition":0.901619676064787,"radius":4,"rotationSpeed":1.8,"segmentsConfigId":"6"}]}]}},"5":{"path":[{"x":-10.21,"z":0},{"x":-9.37,"z":-18.38},{"x":-12.8,"z":-59.05},{"x":-30.76,"z":-74.48},{"x":-48.48,"z":-79.15},{"x":-64.5,"z":-72.34},{"x":-75.89,"z":-52.34},{"x":-69.86,"z":-29.16},{"x":-51.22,"z":-15.42},{"x":-27.85,"z":-17.83},{"x":-16.28,"z":-29.21},{"x":-14.62,"z":-48.36},{"x":-15.99,"z":-53.83},{"x":-24.4,"z":-63.59},{"x":-39.87,"z":-72.37},{"x":-54.35,"z":-71.93},{"x":-66.14,"z":-61.69},{"x":-70.33,"z":-50.94},{"x":-67.77,"z":-36.69},{"x":-58.51,"z":-25.28},{"x":-44.57,"z":-20.27},{"x":-30.91,"z":-22.89},{"x":-24.48,"z":-27.15},{"x":-4.22,"z":-71.69},{"x":-2.49,"z":-83.81}],"blocks":[{"x":-9.99,"z":-50.664,"r":-1.44},{"x":-10.11,"z":-51.56,"r":-1.42},{"x":-9.876,"z":-49.743,"r":-1.454},{"x":-10.406,"z":-53.34,"r":-1.39},{"x":-10.571,"z":-54.199,"r":-1.371},{"x":-10.75,"z":-55.04,"r":-1.35},{"x":-11.25,"z":-57.01,"r":-1.29},{"x":-11.05,"z":-56.29,"r":-1.31},{"x":-11.48,"z":-57.78,"r":-1.26},{"x":-11.703,"z":-58.444,"r":-1.237},{"x":-14.35,"z":-45.19,"r":-1.55},{"x":-14.34,"z":-44.36,"r":-1.56},{"x":-14.34,"z":-43.51,"r":-1.57},{"x":-14.379,"z":-46.047,"r":-1.54},{"x":-14.411,"z":-46.918,"r":-1.53},{"x":-14.48,"z":-48.32,"r":-1.51},{"x":-14.52,"z":-49.11,"r":-1.5},{"x":-14.58,"z":-49.91,"r":-1.49},{"x":-14.64,"z":-50.7,"r":-1.48},{"x":-14.71,"z":-51.42,"r":-1.47},{"x":-14.81,"z":-52.25,"r":-1.43},{"x":-14.95,"z":-53.07,"r":-1.36},{"x":-15.13,"z":-53.78,"r":-1.28},{"x":-14.35,"z":-42.77,"r":-1.58},{"x":-14.36,"z":-41.94,"r":-1.59},{"x":-14.39,"z":-41.11,"r":-1.61},{"x":-14.43,"z":-40.28,"r":-1.62},{"x":-14.49,"z":-39.44,"r":-1.64},{"x":-10.254,"z":-52.464,"r":-1.408},{"x":-17.765,"z":-40.525,"r":-2.031},{"x":-17.342,"z":-41.383,"r":-2.026},{"x":-16.96,"z":-42.169,"r":-2.021},{"x":-15.815,"z":-44.576,"r":-2.009},{"x":-16.201,"z":-43.756,"r":-2.013},{"x":-15.428,"z":-45.406,"r":-2.005},{"x":-16.587,"z":-42.945,"r":-2.017},{"x":-14.733,"z":-46.917,"r":-1.998},{"x":-15.081,"z":-46.159,"r":-2.001},{"x":-11.19,"z":-55.022,"r":-1.968},{"x":-11.477,"z":-54.342,"r":-1.971},{"x":-11.838,"z":-53.49,"r":-1.973},{"x":-12.203,"z":-52.637,"r":-1.976},{"x":-10.65,"z":-56.29,"r":-1.96},{"x":-10.33,"z":-57.05,"r":-1.96},{"x":-9.741,"z":-58.532,"r":-1.956},{"x":-10.032,"z":-57.819,"r":-1.959},{"x":-9.102,"z":-60.12,"r":-1.95},{"x":-9.419,"z":-59.33,"r":-1.953},{"x":-12.396,"z":-60.205,"r":-1.151},{"x":-12.031,"z":-59.333,"r":-1.197},{"x":-14.195,"z":-48.107,"r":-1.993},{"x":-13.888,"z":-48.792,"r":-1.991},{"x":-13.544,"z":-49.565,"r":-1.988},{"x":-13.166,"z":-50.421,"r":-1.984},{"x":-12.831,"z":-51.187,"r":-1.982},{"x":-12.535,"z":-51.869,"r":-1.979}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":-10.64,"z":-55.68},"indicatorPosition":0.9274145170965807,"radius":4,"rotationSpeed":1,"segmentsConfigId":"7"},{"type":2,"position":{"x":-10.72,"z":-55.9},"indicatorPosition":0.9278144371125775,"radius":5,"rotationSpeed":-1,"segmentsConfigId":"7"},{"type":0,"position":{"x":-25.64,"z":-77},"indicatorPosition":0.17636472705458908,"width":10,"height":1,"rotationSpeed":-0.8,"segmentsConfigId":"0"},{"type":1,"position":{"x":-66.32,"z":-48.89},"indicatorPosition":0.7284543091381723,"radius":10,"theta":3,"rotationSpeed":1,"segmentsConfigId":0},{"type":1,"position":{"x":-30.39,"z":-15.3},"indicatorPosition":0.4621075784843031,"radius":4,"theta":1,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":1,"position":{"x":-33.96,"z":-27.14},"indicatorPosition":0.8408318336332733,"radius":4,"theta":0.9424777960769379,"rotationSpeed":1.2,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":-12.28,"z":-51.75},"indicatorPosition":0.9182163567286543,"radius":6,"rotationSpeed":1.2,"segmentsConfigId":"2"},{"type":0,"position":{"x":-35.42,"z":-81.55},"indicatorPosition":0.19876024795040992,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"},{"type":2,"position":{"x":-68.07,"z":-65.61},"indicatorPosition":0.6924615076984603,"radius":6,"rotationSpeed":1.3,"segmentsConfigId":"1"},{"type":1,"position":{"x":-77.52,"z":-40.81},"indicatorPosition":0.34253149370125974,"radius":4,"theta":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"},{"type":0,"position":{"x":-43.31,"z":-13.46},"indicatorPosition":0.4359128174365127,"width":4,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":0},{"type":1,"position":{"x":-36.72,"z":-70.05},"indicatorPosition":0.6172765446910617,"radius":4,"theta":2,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":1,"position":{"x":-45.64,"z":-25.57},"indicatorPosition":0.8118376324735053,"radius":4,"theta":3,"rotationSpeed":2,"segmentsConfigId":0}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":-12.09,"z":-36.59},"indicatorPosition":0.5190961807638472,"width":3.5,"height":1,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":2,"position":{"x":-10.86,"z":-55.53},"indicatorPosition":0.12037592481503699,"radius":3,"rotationSpeed":2,"segmentsConfigId":"2"},{"type":2,"position":{"x":-14.38,"z":-47.77},"indicatorPosition":0.908618276344731,"radius":3,"rotationSpeed":-2,"segmentsConfigId":"2"},{"type":0,"position":{"x":-23.2,"z":-68.37},"indicatorPosition":0.5904819036192761,"width":3.5,"height":1,"rotationSpeed":1.8,"segmentsConfigId":0},{"type":0,"position":{"x":-68.54,"z":-65.2},"indicatorPosition":0.2855428914217157,"width":3.5,"height":1,"rotationSpeed":2,"segmentsConfigId":0},{"type":1,"position":{"x":-54.76,"z":-21.84},"indicatorPosition":0.40751849630073983,"radius":4,"theta":0.47,"rotationSpeed":1.5,"segmentsConfigId":"1"},{"type":2,"position":{"x":-48.43,"z":-77.93},"indicatorPosition":0.645870825834833,"radius":6,"rotationSpeed":1.8,"segmentsConfigId":"2"},{"type":2,"position":{"x":-48.33,"z":-77.93},"indicatorPosition":0.6456708658268346,"radius":5,"rotationSpeed":-1.8,"segmentsConfigId":0},{"type":2,"position":{"x":-74.48,"z":-41.42},"indicatorPosition":0.34313137372525493,"radius":3,"rotationSpeed":2,"segmentsConfigId":"6"},{"type":2,"position":{"x":-68.58,"z":-40.38},"indicatorPosition":0.7464507098580284,"radius":3,"rotationSpeed":2,"segmentsConfigId":"6"},{"type":2,"position":{"x":-71.55,"z":-41.34},"indicatorPosition":0.7426514697060588,"radius":8,"rotationSpeed":1,"segmentsConfigId":0},{"type":2,"position":{"x":-31.21,"z":-21.76},"indicatorPosition":0.8426314737052589,"radius":3.2,"rotationSpeed":1,"segmentsConfigId":0}]}]}},"6":{"path":[{"x":16.02,"z":0},{"x":20.96,"z":-8.57},{"x":73.26,"z":-75},{"x":81.64,"z":-81},{"x":90.69,"z":-76},{"x":86.87,"z":-66},{"x":77.09,"z":-64},{"x":63.91,"z":-78},{"x":54.38,"z":-80},{"x":48.26,"z":-75},{"x":47.72,"z":-66.66},{"x":66.45,"z":-48},{"x":64.79,"z":-39},{"x":57.16,"z":-36},{"x":36.03,"z":-56},{"x":25.87,"z":-53},{"x":25.71,"z":-43},{"x":54.01,"z":-24.58},{"x":109.93,"z":-91.83}],"blocks":[{"x":36.185,"z":-31.403,"r":-2.217},{"x":36.722,"z":-32.113,"r":-2.218},{"x":35.701,"z":-30.761,"r":-2.216},{"x":38.801,"z":-31.783,"r":2.535},{"x":38.357,"z":-34.27,"r":-2.22},{"x":37.858,"z":-33.612,"r":-2.219},{"x":35.788,"z":-34.032,"r":2.463},{"x":35.09,"z":-34.603,"r":2.447},{"x":36.565,"z":-33.42,"r":2.481},{"x":39.542,"z":-31.281,"r":2.554},{"x":38.859,"z":-34.93,"r":-2.221},{"x":38.068,"z":-32.299,"r":2.517},{"x":46.735,"z":-45.176,"r":-2.231},{"x":46.183,"z":-44.465,"r":-2.23},{"x":47.287,"z":-45.886,"r":-2.232},{"x":48.909,"z":-47.965,"r":-2.234},{"x":48.351,"z":-47.25,"r":-2.233},{"x":49.517,"z":-48.742,"r":-2.235},{"x":46.73,"z":-47.952,"r":-0.886},{"x":46.107,"z":-48.715,"r":-0.885},{"x":47.301,"z":-47.251,"r":-0.886},{"x":49.538,"z":-44.543,"r":-0.869},{"x":49.001,"z":-45.183,"r":-0.876},{"x":48.386,"z":-45.927,"r":-0.881},{"x":56.483,"z":-57.53,"r":-2.247},{"x":55.959,"z":-56.878,"r":-2.246},{"x":57.055,"z":-58.242,"r":-2.248},{"x":58.901,"z":-60.525,"r":-2.252},{"x":59.456,"z":-61.207,"r":-2.254},{"x":58.29,"z":-59.772,"r":-2.251},{"x":58.393,"z":-58.437,"r":2.473},{"x":59.105,"z":-57.873,"r":2.468},{"x":56.211,"z":-60.15,"r":2.476},{"x":55.51,"z":-60.702,"r":2.473},{"x":59.805,"z":-57.31,"r":2.461},{"x":56.917,"z":-59.597,"r":2.477},{"x":68.807,"z":-74.909,"r":-0.933},{"x":70.431,"z":-74.086,"r":-2.315},{"x":68.665,"z":-72.13,"r":-2.296},{"x":69.292,"z":-72.833,"r":-2.302},{"x":71.045,"z":-74.746,"r":-2.324},{"x":71.678,"z":-75.413,"r":-2.335},{"x":68.07,"z":-71.46,"r":-2.29},{"x":70.919,"z":-72.003,"r":-0.939},{"x":70.393,"z":-72.727,"r":-0.944},{"x":69.341,"z":-74.18,"r":-0.941},{"x":71.458,"z":-71.273,"r":-0.929},{"x":68.27,"z":-75.62,"r":-0.92}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":26.95,"z":-15.32},"indicatorPosition":0.04799040191961608,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":0,"position":{"x":32.89,"z":-49.41},"indicatorPosition":0.6834633073385323,"width":10,"height":1,"rotationSpeed":0.7,"segmentsConfigId":"2"},{"type":1,"position":{"x":55.47,"z":-74.18},"indicatorPosition":0.4259148170365927,"radius":8,"theta":1,"rotationSpeed":0.7,"segmentsConfigId":"1"},{"type":2,"position":{"x":90.26,"z":-67.96},"indicatorPosition":0.3119376124775045,"radius":5,"rotationSpeed":-1,"segmentsConfigId":"1"},{"type":0,"position":{"x":66.77,"z":-38.73},"indicatorPosition":0.8216356728654269,"width":3.5,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":37.23,"z":-32.63},"indicatorPosition":0.09698060387922415,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":0},{"type":2,"position":{"x":47.81,"z":-46.39},"indicatorPosition":0.13937212557488501,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":"1"},{"type":2,"position":{"x":57.58,"z":-58.75},"indicatorPosition":0.17776444711057787,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":"2"},{"type":2,"position":{"x":69.87,"z":-73.42},"indicatorPosition":0.368126374725055,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":"4"},{"type":1,"position":{"x":91.51,"z":-69.91},"indicatorPosition":0.30713857228554287,"radius":3.5,"theta":4,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":1,"position":{"x":47.94,"z":-81.1},"indicatorPosition":0.42751449710057987,"radius":4,"theta":1,"rotationSpeed":-1,"segmentsConfigId":"1"},{"type":2,"position":{"x":67,"z":-38.9},"indicatorPosition":0.5454909018196361,"radius":5,"rotationSpeed":1,"segmentsConfigId":0},{"type":2,"position":{"x":66.99,"z":-38.97},"indicatorPosition":0.8224355128974206,"radius":6,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":1,"position":{"x":27.07,"z":-15.25},"indicatorPosition":0.04819036192761448,"radius":3,"theta":2.5,"rotationSpeed":-1.4,"segmentsConfigId":0}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":54.1,"z":-75.58},"indicatorPosition":0.4261147770445911,"radius":10,"rotationSpeed":1.8,"segmentsConfigId":0},{"type":0,"position":{"x":51.48,"z":-77.37},"indicatorPosition":0.4283143371325735,"width":3,"height":1,"rotationSpeed":1.8,"segmentsConfigId":0},{"type":2,"position":{"x":82.26,"z":-72.88},"indicatorPosition":0.32113577284543093,"radius":10,"rotationSpeed":-0.7,"segmentsConfigId":0},{"type":0,"position":{"x":84.67,"z":-69.59},"indicatorPosition":0.3193361327734453,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":1,"position":{"x":65.88,"z":-64.07},"indicatorPosition":0.20075984803039393,"radius":4,"theta":0.47,"rotationSpeed":-1.8,"segmentsConfigId":"1"},{"type":2,"position":{"x":47.87,"z":-46.46},"indicatorPosition":0.5966806638672265,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"3"},{"type":0,"position":{"x":37.83,"z":-29.93},"indicatorPosition":0.737252549490102,"width":3,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":0,"position":{"x":37.09,"z":-35.79},"indicatorPosition":0.10277944411117776,"width":3,"height":1,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":1,"position":{"x":31.94,"z":-50.36},"indicatorPosition":0.6756648670265947,"radius":8,"theta":4,"rotationSpeed":0.8,"segmentsConfigId":0},{"type":1,"position":{"x":66.44,"z":-38.71},"indicatorPosition":0.5456908618276345,"radius":3.5,"theta":4.5,"rotationSpeed":1.6,"segmentsConfigId":0},{"type":2,"position":{"x":23.49,"z":-14.11},"indicatorPosition":0.03999200159968006,"radius":3,"rotationSpeed":1.8,"segmentsConfigId":"6"},{"type":0,"position":{"x":80.26,"z":-54.17},"indicatorPosition":0.8728254349130175,"width":3,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":0},{"type":0,"position":{"x":100.27,"z":-82.36},"indicatorPosition":0.9576084783043392,"width":3,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":0}]}]}},"7":{"path":[{"x":0,"z":0},{"x":-1.03,"z":-12.49},{"x":-26.31,"z":-26.49},{"x":-30.72,"z":-35.97},{"x":-27.194,"z":-47.643},{"x":14.66,"z":-48.69},{"x":19.3,"z":-38.11},{"x":15.95,"z":-27.91},{"x":-29.2,"z":-21.84},{"x":-41.28,"z":-25.22},{"x":-45.65,"z":-34.51},{"x":-40.02,"z":-42.64},{"x":28.67,"z":-27.19},{"x":30.71,"z":-35.87},{"x":15.24,"z":-55.57},{"x":2.01,"z":-67.25},{"x":0,"z":-74.42}],"blocks":[{"x":-11.218,"z":-20.869,"r":-0.399},{"x":-12.108,"z":-21.242,"r":-0.393},{"x":-13.004,"z":-21.612,"r":-0.389},{"x":-13.9,"z":-21.979,"r":-0.387},{"x":-14.795,"z":-22.344,"r":-0.387},{"x":-15.686,"z":-22.709,"r":-0.389},{"x":-16.549,"z":-23.064,"r":-0.392},{"x":-17.393,"z":-23.417,"r":-0.398},{"x":-17.586,"z":-23.498,"r":-0.399},{"x":-18.729,"z":-23.988,"r":-0.411},{"x":-19.613,"z":-24.38,"r":-0.423},{"x":-20.513,"z":-24.794,"r":-0.439},{"x":-21.38,"z":-25.212,"r":-0.459},{"x":-22.21,"z":-25.634,"r":-0.483},{"x":-23.033,"z":-26.082,"r":-0.514},{"x":-23.864,"z":-26.573,"r":-0.555},{"x":-24.64,"z":-27.082,"r":-0.607},{"x":-30.627,"z":-42.485,"r":-1.692},{"x":-30.716,"z":-41.592,"r":-1.648},{"x":-30.495,"z":-43.376,"r":-1.742},{"x":-29.819,"z":-45.917,"r":-1.929},{"x":-30.104,"z":-45.063,"r":-1.857},{"x":-29.468,"z":-46.743,"r":-2.013},{"x":18.014,"z":-32.476,"r":1.09},{"x":17.556,"z":-31.701,"r":0.988},{"x":17.021,"z":-30.981,"r":0.881},{"x":16.747,"z":-30.667,"r":0.83},{"x":14.955,"z":-29.213,"r":0.544},{"x":15.708,"z":-29.718,"r":0.65},{"x":14.141,"z":-28.766,"r":0.467},{"x":13.26,"z":-28.358,"r":0.407},{"x":12.365,"z":-27.997,"r":0.362},{"x":-10.654,"z":-24.127,"r":0.07},{"x":-11.636,"z":-24.061,"r":0.064},{"x":-12.615,"z":-24,"r":0.059},{"x":-13.587,"z":-23.945,"r":0.054},{"x":-15.505,"z":-23.849,"r":0.044},{"x":-14.55,"z":-23.894,"r":0.049},{"x":-16.469,"z":-23.808,"r":0.039},{"x":-16.9,"z":-23.792,"r":0.037},{"x":-17.469,"z":-23.771,"r":0.034},{"x":-18.801,"z":-23.73,"r":0.027},{"x":-19.76,"z":-23.707,"r":0.021},{"x":-20.7,"z":-23.689,"r":0.016},{"x":-21.675,"z":-23.676,"r":0.01},{"x":-22.619,"z":-23.669,"r":0.004},{"x":-23.603,"z":-23.669,"r":-0.002},{"x":-24.553,"z":-23.675,"r":-0.01},{"x":-25.528,"z":-23.689,"r":-0.018},{"x":-32.797,"z":-44.646,"r":2.98},{"x":-31.877,"z":-44.486,"r":2.961},{"x":-31.293,"z":-44.376,"r":2.951},{"x":-28.47,"z":-43.769,"r":2.911},{"x":-29.413,"z":-43.984,"r":2.923},{"x":-27.569,"z":-43.553,"r":2.902},{"x":12.244,"z":-31.26,"r":2.862},{"x":13.157,"z":-31.002,"r":2.868},{"x":14.646,"z":-30.593,"r":2.878},{"x":14.013,"z":-30.764,"r":2.873},{"x":15.476,"z":-30.372,"r":2.885},{"x":17.865,"z":-29.777,"r":2.909},{"x":16.955,"z":-29.996,"r":2.899},{"x":18.813,"z":-29.559,"r":2.921},{"x":19.763,"z":-29.354,"r":2.935}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":0.54,"z":-25.41},"indicatorPosition":0.4287142571485703,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":2,"position":{"x":-29.69,"z":-43.79},"indicatorPosition":0.17596480703859227,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":1,"position":{"x":12.96,"z":-54.98},"indicatorPosition":0.3061387722455509,"radius":4,"theta":3.3,"rotationSpeed":1.4,"segmentsConfigId":0},{"type":0,"position":{"x":-47.39,"z":-29.88},"indicatorPosition":0.5674865026994601,"width":4,"height":1,"rotationSpeed":1.1,"segmentsConfigId":"2"}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":-19.52,"z":-21.17},"indicatorPosition":0.4871025794841032,"radius":4,"theta":3.2,"rotationSpeed":1.4,"segmentsConfigId":0},{"type":2,"position":{"x":-11.63,"z":-45.47},"indicatorPosition":0.6924615076984603,"radius":10.2,"rotationSpeed":-0.8,"segmentsConfigId":"7"},{"type":2,"position":{"x":-11.54,"z":-51.77},"indicatorPosition":0.23715256948610278,"radius":3,"rotationSpeed":-1.3,"segmentsConfigId":"6"},{"type":2,"position":{"x":-15.05,"z":-40.09},"indicatorPosition":0.6878624275144971,"radius":3,"rotationSpeed":1.3,"segmentsConfigId":"6"},{"type":2,"position":{"x":16.26,"z":-30.13},"indicatorPosition":0.7826434713057389,"radius":3,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":0,"position":{"x":23.34,"z":-52.85},"indicatorPosition":0.8946210757848431,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":16.25,"z":-30.2},"indicatorPosition":0.38032393521295743,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":2,"position":{"x":21.21,"z":-32.33},"indicatorPosition":0.36892621475704857,"radius":10,"rotationSpeed":1,"segmentsConfigId":"1"},{"type":0,"position":{"x":18.33,"z":-50.65},"indicatorPosition":0.3213357328534293,"width":3,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":0,"position":{"x":-3.93,"z":-12.74},"indicatorPosition":0.04379124175164967,"width":4,"height":1,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":2,"position":{"x":-18.43,"z":-23.92},"indicatorPosition":0.10077984403119376,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"7"},{"type":2,"position":{"x":-18.43,"z":-23.96},"indicatorPosition":0.10097980403919216,"radius":4,"rotationSpeed":-1.5,"segmentsConfigId":"7"},{"type":0,"position":{"x":-43.85,"z":-25.21},"indicatorPosition":0.5538892221555689,"width":4,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":0,"position":{"x":-37.88,"z":-29.26},"indicatorPosition":0.5464907018596281,"width":4,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":"2"},{"type":1,"position":{"x":-30.53,"z":-46.98},"indicatorPosition":0.1825634873025395,"radius":4,"theta":4.2,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":2,"position":{"x":-12.98,"z":-51.44},"indicatorPosition":0.23295340931813638,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":"4"},{"type":2,"position":{"x":-6.42,"z":-52.28},"indicatorPosition":0.2521495700859828,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":"6"},{"type":2,"position":{"x":0.02,"z":-52.66},"indicatorPosition":0.2709458108378324,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":0},{"type":0,"position":{"x":-2.59,"z":-32.77},"indicatorPosition":0.7284543091381723,"width":4,"height":1,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":0,"position":{"x":-16.95,"z":-37.28},"indicatorPosition":0.6850629874025195,"width":4,"height":1,"rotationSpeed":1.2,"segmentsConfigId":0}]}]}},"8":{"path":[{"x":0,"z":0},{"x":2.02,"z":-39},{"x":10.47,"z":-43},{"x":14.47,"z":-41.98},{"x":17.57,"z":-39},{"x":19.29,"z":-34.66},{"x":18.39,"z":-30},{"x":11.86,"z":-25},{"x":-11.26,"z":-24.15},{"x":-22.27,"z":-26.3},{"x":-24,"z":-47.26}],"blocks":[{"x":-0.468,"z":-23.764,"r":-1.585},{"x":-0.48,"z":-22.787,"r":-1.579},{"x":-0.451,"z":-24.737,"r":-1.591},{"x":-0.374,"z":-27.352,"r":-1.61},{"x":-0.4,"z":-26.647,"r":-1.604},{"x":-0.335,"z":-28.263,"r":-1.617},{"x":-2.305,"z":-25.709,"r":-0.017},{"x":-3.252,"z":-25.729,"r":-0.025},{"x":-1.354,"z":-25.695,"r":-0.009},{"x":1.412,"z":-25.703,"r":0.017},{"x":2.279,"z":-25.723,"r":0.027},{"x":0.462,"z":-25.692,"r":0.007}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":8.92,"z":-36.45},"indicatorPosition":0.28834233153369326,"width":11,"height":1,"rotationSpeed":-1,"segmentsConfigId":0},{"type":2,"position":{"x":-0.34,"z":-11.3},"indicatorPosition":0.08338332333533294,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"7"},{"type":1,"position":{"x":-26.99,"z":-31.95},"indicatorPosition":0.8612277544491101,"radius":4,"theta":2.2,"rotationSpeed":1.3,"segmentsConfigId":0}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":9.76,"z":-35.57},"indicatorPosition":0.5584883023395321,"radius":10,"theta":1.5,"rotationSpeed":-0.7,"segmentsConfigId":"1"},{"type":0,"position":{"x":-3.76,"z":-10.58},"indicatorPosition":0.07918416316736653,"width":4,"height":1,"rotationSpeed":1.4,"segmentsConfigId":0},{"type":0,"position":{"x":3.18,"z":-10.54},"indicatorPosition":0.07718456308738253,"width":4,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":0},{"type":2,"position":{"x":-22.19,"z":-28.29},"indicatorPosition":0.8272345530893821,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"4"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":10.24,"z":-36.33},"indicatorPosition":0.3623275344931014,"radius":11,"rotationSpeed":-0.8,"segmentsConfigId":0},{"type":0,"position":{"x":6.72,"z":-41.52},"indicatorPosition":0.34013197360527897,"width":3,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":1,"position":{"x":13.36,"z":-30.53},"indicatorPosition":0.5476904619076185,"radius":3,"theta":4.5,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":2,"position":{"x":17.07,"z":-40.87},"indicatorPosition":0.4377124575084983,"radius":2,"rotationSpeed":-1.5,"segmentsConfigId":"7"},{"type":2,"position":{"x":-0.44,"z":-25.75},"indicatorPosition":0.1899620075984803,"radius":3,"rotationSpeed":-1.6,"segmentsConfigId":"1"},{"type":0,"position":{"x":-2.92,"z":-10.65},"indicatorPosition":0.07958408318336332,"width":3,"height":1,"rotationSpeed":-1.1,"segmentsConfigId":0},{"type":0,"position":{"x":2.35,"z":-10.49},"indicatorPosition":0.07718456308738253,"width":3,"height":1,"rotationSpeed":1.1,"segmentsConfigId":0},{"type":0,"position":{"x":-20.26,"z":-30.06},"indicatorPosition":0.827634473105379,"width":3,"height":1,"rotationSpeed":0.4,"segmentsConfigId":"1"}]}]}},"9":{"path":[{"x":0,"z":0},{"x":1.07,"z":-8.43},{"x":20,"z":-8.53},{"x":21.14,"z":-12.13},{"x":18.53,"z":-14.86},{"x":-20,"z":-15},{"x":-21.55,"z":-18.32},{"x":-19.87,"z":-21.82},{"x":20,"z":-22},{"x":21.34,"z":-25.4},{"x":19.77,"z":-28.63},{"x":-20,"z":-29},{"x":-21.65,"z":-31.76},{"x":-19.72,"z":-34.47},{"x":0,"z":-35.52},{"x":0,"z":-45.19}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":2.82,"z":-8.72},"indicatorPosition":0.05698860227954409,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"0"},{"type":0,"position":{"x":18.04,"z":-27.43},"indicatorPosition":0.609878024395121,"width":3.5,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":2,"position":{"x":-19.94,"z":-20.58},"indicatorPosition":0.3827234553089382,"radius":5,"rotationSpeed":1.2,"segmentsConfigId":"7"},{"type":2,"position":{"x":-20.03,"z":-20.32},"indicatorPosition":0.381123775244951,"radius":4,"rotationSpeed":-1.2,"segmentsConfigId":"7"},{"type":1,"position":{"x":-17.71,"z":-33.82},"indicatorPosition":0.8570285942811438,"radius":4,"theta":2.0420352248333655,"rotationSpeed":-1.2,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":20.99,"z":-13.14},"indicatorPosition":0.15596880623875226,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"1"},{"type":2,"position":{"x":-17.64,"z":-20.31},"indicatorPosition":0.381123775244951,"radius":8,"rotationSpeed":1,"segmentsConfigId":"2"},{"type":2,"position":{"x":-21.46,"z":-20.35},"indicatorPosition":0.381123775244951,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"0"},{"type":1,"position":{"x":23.62,"z":-27.41},"indicatorPosition":0.6082783443311338,"radius":3,"theta":2.670353755551324,"rotationSpeed":-1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":-17.87,"z":-33.7},"indicatorPosition":0.8558288342331534,"radius":5,"rotationSpeed":1.4,"segmentsConfigId":"4"}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":3.12,"z":-8.66},"indicatorPosition":0.0591881623675265,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":2,"position":{"x":21.04,"z":-12.72},"indicatorPosition":0.15396920615876825,"radius":3,"rotationSpeed":1.3,"segmentsConfigId":0},{"type":0,"position":{"x":10.83,"z":-20.07},"indicatorPosition":0.21595680863827235,"width":3.6,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"},{"type":2,"position":{"x":-9.81,"z":-20.32},"indicatorPosition":0.3129374125174965,"radius":4.5,"rotationSpeed":-1.1,"segmentsConfigId":"6"},{"type":0,"position":{"x":-23.91,"z":-20.24},"indicatorPosition":0.3807238552289542,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":1,"position":{"x":23.77,"z":-27.15},"indicatorPosition":0.6072785442911418,"radius":3,"theta":3.21,"rotationSpeed":-1.2,"segmentsConfigId":0},{"type":2,"position":{"x":10.04,"z":-31.35},"indicatorPosition":0.6734653069386123,"radius":3,"rotationSpeed":1.2,"segmentsConfigId":"2"},{"type":0,"position":{"x":-6.78,"z":-33.31},"indicatorPosition":0.7520495900819836,"width":3.5,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":"2"},{"type":2,"position":{"x":-21.36,"z":-33.71},"indicatorPosition":0.8318336332733454,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"7"}]}]}},"10":{"path":[{"x":0.15,"z":0},{"x":-1.06,"z":-7.99},{"x":-22.61,"z":-12.81},{"x":-21.55,"z":-24.77},{"x":24.55,"z":-25.37},{"x":26.72,"z":-16.38},{"x":20.5,"z":-10.39},{"x":8.9,"z":-8.47},{"x":0,"z":-15.77},{"x":0,"z":-46.63}],"blocks":[{"x":-1.224,"z":-32.608,"r":-1.615},{"x":-1.176,"z":-33.586,"r":-1.622},{"x":-1.265,"z":-31.631,"r":-1.608},{"x":-1.333,"z":-29.001,"r":-1.583},{"x":-1.32,"z":-29.743,"r":-1.591},{"x":-1.339,"z":-28.133,"r":-1.573},{"x":0.627,"z":-30.737,"r":-3.128},{"x":1.603,"z":-30.745,"r":-3.136},{"x":-0.348,"z":-30.72,"r":-3.12},{"x":-3.117,"z":-30.631,"r":-3.097},{"x":-2.207,"z":-30.667,"r":-3.105},{"x":-3.988,"z":-30.589,"r":-3.089}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":-15.68,"z":-20.94},"indicatorPosition":0.29354129174165167,"width":9,"height":1,"rotationSpeed":-0.9,"segmentsConfigId":"3"},{"type":1,"position":{"x":23.4,"z":-20.37},"indicatorPosition":0.5990801839632074,"radius":4,"theta":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":-17.48,"z":-12.93},"indicatorPosition":0.16136772645470907,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"6"},{"type":0,"position":{"x":-3.17,"z":-32.39},"indicatorPosition":0.38392321535692864,"width":3,"height":1,"rotationSpeed":1,"segmentsConfigId":"1"},{"type":0,"position":{"x":20.25,"z":-18.5},"indicatorPosition":0.6402719456108779,"width":6,"height":1,"rotationSpeed":-1,"segmentsConfigId":"2"}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":0.81,"z":-11.93},"indicatorPosition":0.0617876424715057,"width":3.5,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":0},{"type":2,"position":{"x":-17.16,"z":-20.43},"indicatorPosition":0.23275344931013797,"radius":10,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":0,"position":{"x":-21.4,"z":-20.31},"indicatorPosition":0.22935412917416517,"width":3,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":0},{"type":2,"position":{"x":-1.39,"z":-30.67},"indicatorPosition":0.394121175764847,"radius":3,"rotationSpeed":1.8,"segmentsConfigId":"2"},{"type":1,"position":{"x":13.61,"z":-27.91},"indicatorPosition":0.48470305938812236,"radius":3,"theta":4,"rotationSpeed":-1.6,"segmentsConfigId":0},{"type":1,"position":{"x":24.31,"z":-21.83},"indicatorPosition":0.585882823435313,"radius":3,"theta":4,"rotationSpeed":-1.6,"segmentsConfigId":0},{"type":1,"position":{"x":15.63,"z":-13.07},"indicatorPosition":0.6890621875624875,"radius":3,"theta":4,"rotationSpeed":-1.6,"segmentsConfigId":0}]}]}},"11":{"path":[{"x":0,"z":0},{"x":-0.38,"z":-23.4},{"x":-33.09,"z":-25.76},{"x":-36.7,"z":-18.12},{"x":-31.39,"z":-10.72},{"x":-19.92,"z":-12.06},{"x":-18.35,"z":-32.08},{"x":-0.35,"z":-33.06},{"x":0,"z":-46.3}],"blocks":[{"x":-19.62,"z":-27.912,"r":-1.522},{"x":-19.582,"z":-27.244,"r":-1.505},{"x":-19.65,"z":-28.839,"r":-1.554},{"x":-19.262,"z":-32.485,"r":-1.871},{"x":-19.59,"z":-30.719,"r":-1.66},{"x":-19.466,"z":-31.642,"r":-1.749},{"x":-17.796,"z":-29.78,"r":-0.027},{"x":-17.072,"z":-29.757,"r":-0.038},{"x":-18.694,"z":-29.799,"r":-0.014},{"x":-21.362,"z":-29.785,"r":0.024},{"x":-20.575,"z":-29.8,"r":0.013},{"x":-22.2,"z":-29.75,"r":0.03}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":-19.58,"z":-29.76},"indicatorPosition":0.317,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":0,"position":{"x":3.48,"z":-9.58},"indicatorPosition":0.06898620275944811,"width":3,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":1.1,"z":-30.33},"indicatorPosition":0.8868226354729054,"radius":5.5,"theta":1,"rotationSpeed":-1.2,"segmentsConfigId":"1"},{"type":2,"position":{"x":-19.61,"z":-29.71},"indicatorPosition":0.7324535092981403,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":0,"position":{"x":-34.93,"z":-12.44},"indicatorPosition":0.52249550089982,"width":3,"height":1,"rotationSpeed":-1,"segmentsConfigId":0},{"type":2,"position":{"x":-19.56,"z":-29.66},"indicatorPosition":0.7320535892821436,"radius":4,"rotationSpeed":-1,"segmentsConfigId":0}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":-1.68,"z":-17.56},"indicatorPosition":0.1221755648870226,"width":4,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"1"},{"type":0,"position":{"x":-22.17,"z":-27.45},"indicatorPosition":0.33613277344531095,"width":4,"height":1,"rotationSpeed":1.4,"segmentsConfigId":"2"},{"type":2,"position":{"x":-30,"z":-18.14},"indicatorPosition":0.5178964207158568,"radius":8,"rotationSpeed":1,"segmentsConfigId":"1"},{"type":0,"position":{"x":-30.97,"z":-15.63},"indicatorPosition":0.5292941411717657,"width":3,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"1"},{"type":2,"position":{"x":-9.69,"z":-34.5},"indicatorPosition":0.8264347130573885,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"6"},{"type":2,"position":{"x":0.51,"z":-38.73},"indicatorPosition":0.9194161167766447,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"6"}]}]}},"12":{"path":[{"x":0,"z":0},{"x":-2.54,"z":-35.3},{"x":-38.26,"z":-37.68},{"x":-40.02,"z":-33.86},{"x":-38.03,"z":-29.78},{"x":39.69,"z":-31.46},{"x":41.58,"z":-35.33},{"x":39.48,"z":-38.27},{"x":3.01,"z":-36.93},{"x":-0.55,"z":-43.72},{"x":0,"z":-71.12}],"blocks":[{"x":0.778,"z":-27.511,"r":-1.468},{"x":0.248,"z":-31.044,"r":-1.367},{"x":0.857,"z":-26.677,"r":-1.485},{"x":0.68,"z":-28.32,"r":-1.44},{"x":-1.275,"z":-29.213,"r":-3.123},{"x":-0.391,"z":-29.23,"r":-3.121},{"x":0.043,"z":-31.953,"r":-1.33},{"x":-2.109,"z":-29.199,"r":-3.125},{"x":2.41,"z":-29.295,"r":-3.115},{"x":1.475,"z":-29.271,"r":-3.117},{"x":0.42,"z":-30.141,"r":-1.398},{"x":3.15,"z":-29.315,"r":-3.113}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":0.52,"z":-29.06},"indicatorPosition":0.1187762447510498,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":0,"position":{"x":-34.4,"z":-35.91},"indicatorPosition":0.29374125174965005,"width":6,"height":1,"rotationSpeed":1,"segmentsConfigId":"2"},{"type":2,"position":{"x":41.42,"z":-36.86},"indicatorPosition":0.6796640671865627,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":0},{"type":2,"position":{"x":-0.9,"z":-58.27},"indicatorPosition":0.9310137972405519,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"6"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":-32.34,"z":-35.61},"indicatorPosition":0.3645270945810838,"radius":10,"rotationSpeed":0.8,"segmentsConfigId":"5"},{"type":2,"position":{"x":0.7,"z":-29.22},"indicatorPosition":0.5022995400919816,"radius":4,"rotationSpeed":1.8,"segmentsConfigId":"0"},{"type":2,"position":{"x":35.66,"z":-36.13},"indicatorPosition":0.6490701859628074,"radius":10,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":2,"position":{"x":-0.99,"z":-49.96},"indicatorPosition":0.8970205958808238,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"7"},{"type":2,"position":{"x":-0.96,"z":-56.59},"indicatorPosition":0.9240151969606079,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"7"},{"type":2,"position":{"x":-0.59,"z":-63.69},"indicatorPosition":0.9530093981203759,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"7"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":0.6,"z":-29.23},"indicatorPosition":0.5018996200759848,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"1"},{"type":2,"position":{"x":0.6,"z":-29.23},"indicatorPosition":0.5018996200759848,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"7"},{"type":2,"position":{"x":-33.48,"z":-35.64},"indicatorPosition":0.35892821435712857,"radius":8,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":0,"position":{"x":-37.64,"z":-35.73},"indicatorPosition":0.3245350929814037,"width":3,"height":1,"rotationSpeed":1.5,"segmentsConfigId":0},{"type":2,"position":{"x":-16.62,"z":-29.21},"indicatorPosition":0.4319136172765447,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"6"},{"type":0,"position":{"x":21.14,"z":-34.67},"indicatorPosition":0.5870825834833033,"width":5,"height":1,"rotationSpeed":1,"segmentsConfigId":"3"},{"type":2,"position":{"x":41.3,"z":-36.47},"indicatorPosition":0.6778644271145771,"radius":3,"rotationSpeed":1,"segmentsConfigId":"4"},{"type":0,"position":{"x":-1.77,"z":-12.45},"indicatorPosition":0.05038992201559688,"width":3,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"0"},{"type":0,"position":{"x":3.22,"z":-12.31},"indicatorPosition":0.05118976204759048,"width":3,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":0},{"type":2,"position":{"x":-0.89,"z":-59.03},"indicatorPosition":0.9340131973605279,"radius":3,"rotationSpeed":1.5,"segmentsConfigId":"7"},{"type":2,"position":{"x":-0.91,"z":-59.03},"indicatorPosition":0.9340131973605279,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"7"}]}]}},"13":{"path":[{"x":0,"z":0},{"x":0,"z":-18.73},{"x":-0.578,"z":-43.096},{"x":-10.4,"z":-45.7},{"x":-18,"z":-40.59},{"x":-16,"z":-26.96},{"x":-8.07,"z":-23.977},{"x":9.474,"z":-24},{"x":13.444,"z":-28.181},{"x":15.449,"z":-42.678},{"x":24,"z":-46.075},{"x":32,"z":-41},{"x":30,"z":-27},{"x":20.472,"z":-24},{"x":8.211,"z":-28.679},{"x":7.566,"z":-39.864},{"x":7.6,"z":-48.603},{"x":7.6,"z":-61.567}],"blocks":[{"x":10.273,"z":-26.393,"r":-2.63},{"x":9.48,"z":-26.002,"r":-2.737},{"x":11.009,"z":-26.875,"r":-2.497},{"x":11.605,"z":-27.389,"r":-2.367},{"x":13.096,"z":-29.491,"r":-2.059},{"x":12.636,"z":-28.691,"r":-2.136},{"x":13.508,"z":-30.321,"r":-1.984},{"x":12.857,"z":-27.616,"r":-0.369},{"x":13.765,"z":-27.285,"r":-0.325},{"x":14.689,"z":-26.992,"r":-0.286},{"x":10.486,"z":-28.75,"r":-0.531},{"x":9.703,"z":-29.258,"r":-0.617},{"x":11.326,"z":-28.292,"r":-0.462},{"x":0.054,"z":-23.315,"r":-1.617},{"x":0.02,"z":-22.443,"r":-1.602},{"x":0.105,"z":-24.258,"r":-1.63},{"x":0.32,"z":-27.241,"r":-1.651},{"x":0.281,"z":-26.75,"r":-1.649},{"x":0.378,"z":-27.937,"r":-1.653},{"x":-1.522,"z":-25.212,"r":3.075},{"x":-2.355,"z":-25.272,"r":3.063},{"x":-0.727,"z":-25.164,"r":3.087},{"x":2,"z":-25.077,"r":3.133},{"x":1.07,"z":-25.093,"r":3.116},{"x":2.832,"z":-25.078,"r":-3.132},{"x":0.23,"z":-26.086,"r":-1.646}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":1,"position":{"x":-1.5,"z":-27.124},"indicatorPosition":0.122,"radius":3,"theta":2.670353755551324,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":2,"position":{"x":20.471,"z":-29.882},"indicatorPosition":0.775,"radius":7,"rotationSpeed":1.4,"segmentsConfigId":"2"},{"type":0,"position":{"x":5.873,"z":-55.05},"indicatorPosition":0.951,"width":3,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":0,"position":{"x":25.04,"z":-41.53},"indicatorPosition":0.6656668666266746,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"2"},{"type":2,"position":{"x":3.55,"z":-25.84},"indicatorPosition":0.46910617876424715,"radius":3,"rotationSpeed":1.3,"segmentsConfigId":"6"},{"type":2,"position":{"x":3.55,"z":-25.91},"indicatorPosition":0.46910617876424715,"radius":4,"rotationSpeed":-1.2,"segmentsConfigId":"6"},{"type":2,"position":{"x":-16.16,"z":-40.98},"indicatorPosition":0.3213357328534293,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":-15.69,"z":-34.86},"indicatorPosition":0.35112977404519097,"radius":3,"rotationSpeed":-1.4,"segmentsConfigId":"0"},{"type":0,"position":{"x":6.29,"z":-48.89},"indicatorPosition":0.9208158368326335,"width":3,"height":1,"rotationSpeed":1.3,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":0.93,"z":-23.78},"indicatorPosition":0.4579084183163367,"width":3,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"0"},{"type":2,"position":{"x":2.94,"z":-10.37},"indicatorPosition":0.04999000199960008,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"6"},{"type":2,"position":{"x":-11.98,"z":-34.43},"indicatorPosition":0.3567286542691462,"radius":8,"rotationSpeed":1.3,"segmentsConfigId":"2"},{"type":0,"position":{"x":-13.85,"z":-34.21},"indicatorPosition":0.35592881423715256,"width":3,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":2,"position":{"x":4.53,"z":-47.21},"indicatorPosition":0.9128174365126974,"radius":6,"rotationSpeed":1.3,"segmentsConfigId":"1"},{"type":1,"position":{"x":20.87,"z":-44.2},"indicatorPosition":0.6290741851629674,"radius":4,"theta":1.7278759594743862,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":0,"position":{"x":21.15,"z":-34.85},"indicatorPosition":0.7668466306738653,"width":5,"height":1,"rotationSpeed":-1.1,"segmentsConfigId":"3"}]}]}},"14":{"path":[{"x":0.99,"z":0},{"x":3.71,"z":-10.06},{"x":8.56,"z":-18.09},{"x":14.93,"z":-22.2},{"x":23.68,"z":-23.07},{"x":30.98,"z":-19.66},{"x":37.07,"z":-12.76},{"x":43.22,"z":-5.94},{"x":50.9,"z":-2.85},{"x":60.88,"z":-4.15},{"x":67.28,"z":-9.4},{"x":67.41,"z":-16.72},{"x":62.3,"z":-22.59},{"x":54.35,"z":-24.59},{"x":45.42,"z":-22.25},{"x":39.62,"z":-16.96},{"x":33.61,"z":-6.87},{"x":27.88,"z":-2.45},{"x":19.71,"z":-0.84},{"x":10.37,"z":-4.05},{"x":1.47,"z":-14.53},{"x":1.03,"z":-20.62},{"x":1.09,"z":-25.99}],"blocks":[{"x":2.936,"z":-9.968,"r":-1.887},{"x":2.754,"z":-9.396,"r":-1.872},{"x":3.2,"z":-10.74,"r":-1.91},{"x":3.46,"z":-11.46,"r":-1.94},{"x":3.63,"z":-11.89,"r":-1.96},{"x":4.526,"z":-13.871,"r":-2.015},{"x":4.225,"z":-13.227,"r":-1.999},{"x":4.82,"z":-14.47,"r":-2.03},{"x":5.537,"z":-15.844,"r":-2.076},{"x":5.235,"z":-15.286,"r":-2.057},{"x":5.541,"z":-10.494,"r":-0.848},{"x":6.126,"z":-9.844,"r":-0.824},{"x":4.972,"z":-11.157,"r":-0.873},{"x":4.401,"z":-11.859,"r":-0.899},{"x":2.923,"z":-13.887,"r":-0.984},{"x":2.5,"z":-14.551,"r":-1.019},{"x":3.422,"z":-13.16,"r":-0.951},{"x":2.117,"z":-15.204,"r":-1.06},{"x":1.75,"z":-15.906,"r":-1.114},{"x":36.058,"z":-12.732,"r":1.091},{"x":35.652,"z":-11.967,"r":1.074},{"x":36.457,"z":-13.51,"r":1.1},{"x":36.708,"z":-14.004,"r":1.102},{"x":37.913,"z":-16.323,"r":1.067},{"x":37.466,"z":-15.487,"r":1.088},{"x":38.365,"z":-17.118,"r":1.035},{"x":38.824,"z":-17.86,"r":0.991},{"x":38.626,"z":-12.874,"r":2.237},{"x":39.115,"z":-12.251,"r":2.235},{"x":38.184,"z":-13.431,"r":2.246},{"x":37.608,"z":-14.136,"r":2.268},{"x":35.925,"z":-16.127,"r":2.243},{"x":36.525,"z":-15.391,"r":2.267},{"x":35.338,"z":-16.873,"r":2.232},{"x":34.731,"z":-17.654,"r":2.232}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":54.12,"z":-15.61},"indicatorPosition":0.39172165566886624,"width":11.2,"height":1,"rotationSpeed":1,"segmentsConfigId":"1"},{"type":2,"position":{"x":3.86,"z":-12.09},"indicatorPosition":0.0633873225354929,"radius":4,"rotationSpeed":1.3,"segmentsConfigId":"2"}]}],"1":[{"name":"m","obstacles":[{"type":0,"position":{"x":20.8,"z":-13.96},"indicatorPosition":0.8022395520895821,"width":14,"height":1,"rotationSpeed":-0.7,"segmentsConfigId":"2"},{"type":2,"position":{"x":57.88,"z":-15.73},"indicatorPosition":0.5266946610677864,"radius":12,"rotationSpeed":1.2,"segmentsConfigId":"1"},{"type":1,"position":{"x":64.49,"z":-15.08},"indicatorPosition":0.48410317936412717,"radius":4,"theta":3.7699111843077517,"rotationSpeed":1.5,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":3.94,"z":-11.76},"indicatorPosition":0.0619876024795041,"radius":4,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":3.92,"z":-11.79},"indicatorPosition":0.0621875624875025,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"0"},{"type":2,"position":{"x":37.02,"z":-14.87},"indicatorPosition":0.28134373125374923,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"6"},{"type":2,"position":{"x":37.04,"z":-14.88},"indicatorPosition":0.28134373125374923,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"6"},{"type":2,"position":{"x":36.99,"z":-14.86},"indicatorPosition":0.28134373125374923,"radius":5,"rotationSpeed":-1.4,"segmentsConfigId":"6"},{"type":0,"position":{"x":20.25,"z":-14.07},"indicatorPosition":0.16976604679064186,"width":11.2,"height":1,"rotationSpeed":-1,"segmentsConfigId":"1"},{"type":1,"position":{"x":54.66,"z":-24.09},"indicatorPosition":0.5828834233153369,"radius":3,"theta":3.7699111843077517,"rotationSpeed":-1.5,"segmentsConfigId":"0"},{"type":1,"position":{"x":53.65,"z":-7.26},"indicatorPosition":0.385122975404919,"radius":3,"theta":3.612831551628262,"rotationSpeed":-1.5,"segmentsConfigId":"0"},{"type":0,"position":{"x":71.28,"z":-15.53},"indicatorPosition":0.48570285942811436,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"0"}]}]}},"15":{"path":[{"x":0,"z":0},{"x":0.32,"z":-5.29},{"x":10.83,"z":-15.12},{"x":11.88,"z":-18.3},{"x":10.63,"z":-21.63},{"x":-10.06,"z":-29.63},{"x":-12.01,"z":-32.67},{"x":-10.18,"z":-35.75},{"x":10.82,"z":-46.7},{"x":11.96,"z":-50.22},{"x":10.79,"z":-53.49},{"x":0.81,"z":-61.65},{"x":0,"z":-66.7}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":-7.38,"z":-34.7},"indicatorPosition":0.45910817836432716,"width":5,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"2"},{"type":2,"position":{"x":11.76,"z":-20.32},"indicatorPosition":0.22995400919816036,"radius":4,"rotationSpeed":1.4,"segmentsConfigId":"4"},{"type":1,"position":{"x":9.51,"z":-51.97},"indicatorPosition":0.7820435912817436,"radius":3,"theta":3.141592653589793,"rotationSpeed":1.2,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":2.15,"z":-14.31},"indicatorPosition":0.1209758048390322,"radius":4,"theta":4.084070449666731,"rotationSpeed":1.3,"segmentsConfigId":"0"},{"type":2,"position":{"x":-5.73,"z":-35.98},"indicatorPosition":0.5620875824835033,"radius":8,"rotationSpeed":1.1,"segmentsConfigId":"0"},{"type":2,"position":{"x":11.82,"z":-53.18},"indicatorPosition":0.793241351729654,"radius":4,"rotationSpeed":1.3,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":12.45,"z":-35.9},"indicatorPosition":0.7088582283543291,"width":12,"height":1,"rotationSpeed":-0.8,"segmentsConfigId":"1"},{"type":2,"position":{"x":5.85,"z":-12.51},"indicatorPosition":0.1367726454709058,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"0"},{"type":2,"position":{"x":5.85,"z":-12.51},"indicatorPosition":0.1367726454709058,"radius":3,"rotationSpeed":-1.5,"segmentsConfigId":"0"},{"type":1,"position":{"x":-8.05,"z":-34.8},"indicatorPosition":0.52749450109978,"radius":4,"theta":4.084070449666731,"rotationSpeed":-1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":9.21,"z":-60.29},"indicatorPosition":0.853629274145171,"radius":9,"rotationSpeed":-1,"segmentsConfigId":"6"},{"type":1,"position":{"x":9.17,"z":-60.23},"indicatorPosition":0.853629274145171,"radius":3,"theta":0.9424777960769379,"rotationSpeed":-1.5,"segmentsConfigId":"1"}]}]}},"16":{"path":[{"x":-3,"z":0},{"x":-3,"z":-5.96},{"x":-3,"z":-17.14},{"x":3.06,"z":-30.15},{"x":11.22,"z":-33.8},{"x":18.532,"z":-31.71},{"x":22.173,"z":-24.14},{"x":19.595,"z":-16.153},{"x":11.17,"z":-12.966},{"x":2.052,"z":-17.33},{"x":-10.73,"z":-33.26},{"x":-10.785,"z":-43.63},{"x":3.12,"z":-55.7},{"x":11.24,"z":-59.97},{"x":20.06,"z":-56.63},{"x":23.07,"z":-49.3},{"x":19.67,"z":-42.2},{"x":11.28,"z":-39.46},{"x":2.33,"z":-44.53},{"x":-3,"z":-72.32}],"blocks":[{"x":-0.598,"z":-26.372,"r":-1.99},{"x":-2.979,"z":-19.23,"r":-1.791},{"x":-2.813,"z":-19.933,"r":-1.813},{"x":-2.38,"z":-21.524,"r":-1.858},{"x":-2.599,"z":-20.755,"r":-1.837},{"x":-1.38,"z":-24.479,"r":-1.935},{"x":-1.674,"z":-23.683,"r":-1.914},{"x":-0.795,"z":-25.922,"r":-1.976},{"x":-1.07,"z":-25.265,"r":-1.957},{"x":1.026,"z":-20.18,"r":-0.712},{"x":0.459,"z":-20.68,"r":-0.731},{"x":-0.813,"z":-21.867,"r":-0.767},{"x":-0.182,"z":-21.268,"r":-0.75},{"x":-1.325,"z":-22.367,"r":-0.78},{"x":-3.032,"z":-24.129,"r":-0.821},{"x":-3.669,"z":-24.825,"r":-0.836},{"x":-2.42,"z":-23.481,"r":-0.806},{"x":-2.636,"z":-53.744,"r":-2.514},{"x":-3.286,"z":-53.269,"r":-2.504},{"x":-1.987,"z":-54.209,"r":-2.523},{"x":0.807,"z":-56.138,"r":-2.547},{"x":1.435,"z":-56.561,"r":-2.548},{"x":0.058,"z":-55.63,"r":-2.543},{"x":-0.237,"z":-53.453,"r":-1.341},{"x":-0.876,"z":-56.534,"r":-1.387},{"x":-0.45,"z":-54.403,"r":-1.357},{"x":-0.024,"z":-52.573,"r":-1.323},{"x":-0.768,"z":-55.965,"r":-1.38},{"x":-0.931,"z":-56.837,"r":-1.39},{"x":-1.294,"z":-54.697,"r":-2.531},{"x":-1.062,"z":-57.577,"r":-1.399},{"x":-2.144,"z":-22.291,"r":-1.878},{"x":-4.171,"z":-25.387,"r":-0.848},{"x":-1.21,"z":-58.455,"r":-1.407},{"x":2.05,"z":-56.975,"r":-2.548},{"x":0.147,"z":-51.908,"r":-1.307}],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":-4.16,"z":-22.598},"indicatorPosition":0.422,"width":3,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":2,"position":{"x":-0.574,"z":-54.957},"indicatorPosition":0.903,"radius":4,"rotationSpeed":1.3,"segmentsConfigId":"2"},{"type":1,"position":{"x":20.72,"z":-51.36},"indicatorPosition":0.7238552289542092,"radius":3,"theta":3.141592653589793,"rotationSpeed":-1.3,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":0,"position":{"x":0.868,"z":-23.481},"indicatorPosition":0.409,"width":3,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":"0"},{"type":0,"position":{"x":-3.968,"z":-22.436},"indicatorPosition":0.099,"width":3,"height":1,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":0,"position":{"x":12.23,"z":-38.67},"indicatorPosition":0.8010397920415917,"width":3.5,"height":1,"rotationSpeed":1.3,"segmentsConfigId":"1"},{"type":2,"position":{"x":18.98,"z":-18.38},"indicatorPosition":0.32273545290941813,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":1,"position":{"x":20.8,"z":-60.96},"indicatorPosition":0.6808638272345531,"radius":3,"theta":4.084070449666731,"rotationSpeed":1.3,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":-1.931,"z":-23.23},"indicatorPosition":0.105,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"1"},{"type":0,"position":{"x":14.23,"z":-25.98},"indicatorPosition":0.26454709058188364,"width":9,"height":1,"rotationSpeed":-1,"segmentsConfigId":"2"},{"type":2,"position":{"x":0.06,"z":-38.71},"indicatorPosition":0.5010997800439912,"radius":3,"rotationSpeed":-1.4,"segmentsConfigId":"6"},{"type":1,"position":{"x":1.273,"z":-54.437},"indicatorPosition":0.601,"radius":3,"theta":3.612831551628262,"rotationSpeed":-1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":16.35,"z":-52.31},"indicatorPosition":0.709258148370326,"radius":10,"rotationSpeed":1,"segmentsConfigId":"0"},{"type":0,"position":{"x":20.51,"z":-50.87},"indicatorPosition":0.7274545090981803,"width":3,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":"0"}]}]}},"17":{"path":[{"x":0,"z":0},{"x":3.57,"z":-35.97},{"x":50.37,"z":-38.85},{"x":54.29,"z":-75.02}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":3.69,"z":-37.6},"indicatorPosition":0.30713857228554287,"radius":5,"rotationSpeed":1.2,"segmentsConfigId":"7"},{"type":2,"position":{"x":3.7,"z":-38},"indicatorPosition":0,"radius":4,"rotationSpeed":-1.2,"segmentsConfigId":"7"},{"type":1,"position":{"x":49.25,"z":-43.1},"indicatorPosition":0.6982603479304139,"radius":3,"theta":2.356194490192345,"rotationSpeed":1.3,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":0,"position":{"x":3.49,"z":-21.19},"indicatorPosition":0.16916616676664667,"width":5,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":"2"},{"type":2,"position":{"x":27.94,"z":-39.14},"indicatorPosition":0.5068986202759448,"radius":4,"rotationSpeed":1.3,"segmentsConfigId":"1"},{"type":1,"position":{"x":51.49,"z":-58.08},"indicatorPosition":0.8328334333133374,"radius":4,"theta":2.9845130209103035,"rotationSpeed":1.4,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":7.04,"z":-33.55},"indicatorPosition":0.29414117176564686,"radius":10,"rotationSpeed":1,"segmentsConfigId":"0"},{"type":2,"position":{"x":3.92,"z":-37.55},"indicatorPosition":0.3083383323335333,"radius":3,"rotationSpeed":-1.4,"segmentsConfigId":"7"},{"type":0,"position":{"x":47.77,"z":-43.92},"indicatorPosition":0.6936612677464508,"width":6,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"2"},{"type":2,"position":{"x":54.61,"z":-70.26},"indicatorPosition":0.9302139572085583,"radius":4,"rotationSpeed":1.5,"segmentsConfigId":"1"}]}]}},"18":{"path":[{"x":0,"z":0},{"x":0.06,"z":-3.35},{"x":-2.63,"z":-7.07},{"x":-7.08,"z":-9},{"x":-57.46,"z":-12.25},{"x":-61.54,"z":-53.67}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":-10.99,"z":-7.91},"indicatorPosition":0.17036592681463708,"width":4,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":1,"position":{"x":-56.17,"z":-18.69},"indicatorPosition":0.6294741051789642,"radius":4,"theta":2.356194490192345,"rotationSpeed":-1.3,"segmentsConfigId":"0"}]}],"1":[{"name":"m","obstacles":[{"type":0,"position":{"x":-55.13,"z":-16.94},"indicatorPosition":0.6012797440511898,"width":4,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":"0"},{"type":2,"position":{"x":-52.96,"z":-18.48},"indicatorPosition":0.5884823035392921,"radius":11,"rotationSpeed":-1.2,"segmentsConfigId":"1"},{"type":1,"position":{"x":-7.47,"z":-7.57},"indicatorPosition":0.1305738852229554,"radius":4,"theta":3.141592653589793,"rotationSpeed":1.4,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":-14.32,"z":-8.16},"indicatorPosition":0.2019596080783843,"width":4,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":"0"},{"type":0,"position":{"x":-36.94,"z":-13.25},"indicatorPosition":0.40471905618876225,"width":4,"height":1,"rotationSpeed":1.3,"segmentsConfigId":"0"},{"type":1,"position":{"x":-63.08,"z":-16.65},"indicatorPosition":0.638872225554889,"radius":4,"theta":0.9424777960769379,"rotationSpeed":-1.3,"segmentsConfigId":"0"},{"type":0,"position":{"x":-59.02,"z":-38.47},"indicatorPosition":0.826634673065387,"width":4,"height":1,"rotationSpeed":1.3,"segmentsConfigId":"0"}]}]}},"19":{"path":[{"x":0.37,"z":0},{"x":0.17,"z":-8.88},{"x":-0.85,"z":-13.57},{"x":-4.41,"z":-16.16},{"x":-29.96,"z":-16.44},{"x":-34.03,"z":-17.05},{"x":-35.54,"z":-21.7},{"x":-35.38,"z":-27.91},{"x":-33.93,"z":-31.84},{"x":-29.15,"z":-32.51},{"x":-4.27,"z":-32.6},{"x":-1.11,"z":-34.54},{"x":0.03,"z":-38.61},{"x":0.34,"z":-52.06}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":0.46,"z":-18.91},"indicatorPosition":0.14417116576684663,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"0"},{"type":2,"position":{"x":-1.18,"z":-36.38},"indicatorPosition":0.8324335132973405,"radius":4,"rotationSpeed":1.4,"segmentsConfigId":"6"}]}],"1":[{"name":"m","obstacles":[{"type":1,"position":{"x":-12.75,"z":-16.44},"indicatorPosition":0.2409518096380724,"radius":3,"theta":2.9845130209103035,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":0,"position":{"x":-39,"z":-26.18},"indicatorPosition":0.48370325934813035,"width":4,"height":1,"rotationSpeed":1.3,"segmentsConfigId":"1"},{"type":2,"position":{"x":-13.87,"z":-34},"indicatorPosition":0.7208558288342332,"radius":3,"rotationSpeed":-1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":-14,"z":-34},"indicatorPosition":0,"radius":4,"rotationSpeed":1.3,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":2,"position":{"x":-1.92,"z":-16.94},"indicatorPosition":0.14697060587882424,"radius":3,"rotationSpeed":1.3,"segmentsConfigId":"1"},{"type":2,"position":{"x":-33.71,"z":-33.28},"indicatorPosition":0.5490901819636073,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":0,"position":{"x":-27.8,"z":-20.91},"indicatorPosition":0.367126574685063,"width":3,"height":1,"rotationSpeed":1.3,"segmentsConfigId":"0"},{"type":2,"position":{"x":-4.11,"z":-38.75},"indicatorPosition":0.8330333933213357,"radius":4,"rotationSpeed":-1.1,"segmentsConfigId":"7"}]}]}},"20":{"path":[{"x":0,"z":0},{"x":-0.05,"z":-5.9},{"x":0.61,"z":-10.36},{"x":3.25,"z":-13.04},{"x":38.74,"z":-14.63},{"x":40.11,"z":-18.68},{"x":36.06,"z":-23.42},{"x":-16.6,"z":-55.94},{"x":-17.21,"z":-61.17}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":0,"position":{"x":20.19,"z":-12.36},"indicatorPosition":0.2525494901019796,"width":4,"height":1,"rotationSpeed":-1,"segmentsConfigId":"0"},{"type":2,"position":{"x":8.25,"z":-41.57},"indicatorPosition":0.7182563487302539,"radius":10,"rotationSpeed":1,"segmentsConfigId":"1"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":1.55,"z":-13.43},"indicatorPosition":0.10477904419116177,"radius":4,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":39.94,"z":-19.56},"indicatorPosition":0.41871625674865026,"radius":3,"rotationSpeed":1.4,"segmentsConfigId":"6"},{"type":0,"position":{"x":15.43,"z":-33.08},"indicatorPosition":0.6400719856028795,"width":6,"height":1,"rotationSpeed":1.1,"segmentsConfigId":"3"},{"type":1,"position":{"x":-4.09,"z":-51.65},"indicatorPosition":0.8374325134973005,"radius":3,"theta":2.199114857512855,"rotationSpeed":-1.8,"segmentsConfigId":"0"}]}],"2":[{"name":"h","obstacles":[{"type":0,"position":{"x":18.96,"z":-24.91},"indicatorPosition":0.2401519696060788,"width":10,"height":1,"rotationSpeed":0.9,"segmentsConfigId":"1"},{"type":2,"position":{"x":39.89,"z":-19.25},"indicatorPosition":0.41611677664467106,"radius":4,"rotationSpeed":1.3,"segmentsConfigId":"6"},{"type":2,"position":{"x":40,"z":-19},"indicatorPosition":0.3929214157168566,"radius":3,"rotationSpeed":-1.3,"segmentsConfigId":"6"},{"type":0,"position":{"x":2.22,"z":-7.47},"indicatorPosition":0.057388522295540895,"width":3,"height":1,"rotationSpeed":-1.4,"segmentsConfigId":"0"},{"type":1,"position":{"x":3.17,"z":-48.58},"indicatorPosition":0.7776444711057788,"radius":4,"theta":3.9269908169872414,"rotationSpeed":-1.5,"segmentsConfigId":"0"}]}]}},"21":{"path":[{"x":0,"z":0},{"x":0.57,"z":-42.34},{"x":-2.56,"z":-44.33},{"x":-5.72,"z":-41.8},{"x":-6.24,"z":-2.69},{"x":-9.79,"z":-0.8},{"x":-13.43,"z":-3.24},{"x":-13.24,"z":-43.54},{"x":-11.53,"z":-47.28},{"x":-7.29,"z":-49.07},{"x":0.26,"z":-50.7},{"x":3.95,"z":-53.65},{"x":3.83,"z":-86.69}],"blocks":[],"obstaclesGroups":{"0":[{"name":"e","obstacles":[{"type":2,"position":{"x":-2.49,"z":-46},"indicatorPosition":0.24415116976604678,"radius":4,"rotationSpeed":1.2,"segmentsConfigId":"0"},{"type":0,"position":{"x":-9.85,"z":-6.64},"indicatorPosition":0.4991001799640072,"width":4,"height":1,"rotationSpeed":-1.2,"segmentsConfigId":"0"},{"type":0,"position":{"x":0.41,"z":-57.98},"indicatorPosition":0.8304339132173565,"width":5,"height":1,"rotationSpeed":1.2,"segmentsConfigId":"2"}]}],"1":[{"name":"m","obstacles":[{"type":2,"position":{"x":-2.5,"z":-48.6},"indicatorPosition":0.2439512097580484,"radius":7,"rotationSpeed":1.7,"segmentsConfigId":"2"},{"type":0,"position":{"x":-9.88,"z":-7.4},"indicatorPosition":0.5146970605878824,"width":5,"height":1,"rotationSpeed":-1.3,"segmentsConfigId":"2"},{"type":2,"position":{"x":4.83,"z":-73.71},"indicatorPosition":0.9138172365526894,"radius":3,"rotationSpeed":1.6,"segmentsConfigId":"6"}]}],"2":[{"name":"h","obstacles":[{"type":1,"position":{"x":-2.6,"z":-42.79},"indicatorPosition":0.260747850429914,"radius":4,"theta":4.084070449666731,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":1,"position":{"x":-3.15,"z":-55.12},"indicatorPosition":0.7824435112977405,"radius":4,"theta":4.084070449666731,"rotationSpeed":1.4,"segmentsConfigId":"0"},{"type":2,"position":{"x":-9.63,"z":-2.87},"indicatorPosition":0.4851029794041192,"radius":4,"rotationSpeed":2,"segmentsConfigId":"2"},{"type":0,"position":{"x":-18.47,"z":-25.97},"indicatorPosition":0.6140771845630874,"width":4,"height":1,"rotationSpeed":1.5,"segmentsConfigId":"0"},{"type":0,"position":{"x":8.12,"z":-74.13},"indicatorPosition":0.9152169566086783,"width":4,"height":1,"rotationSpeed":-1.5,"segmentsConfigId":"0"}]}]}}}');const rm={easy:0,medium:1,hard:2},om=JSON.parse('{"path":[{"x":0,"z":0},{"x":0,"z":-20}],"blocks":[],"obstaclesGroups":{"0":[{"name":"template","obstacles":[]}],"1":[{"name":"template","obstacles":[]}],"2":[{"name":"template","obstacles":[]}]}}'),sm=JSON.parse('{"nS":{"FK":{"t":{"x":0,"y":17.25,"z":9.8},"r":{"x":0,"y":14.25,"z":6.8}},"Wn":{"x":-1.1,"y":0,"z":0},"UZ":{"r":70,"t":90}},"hi":10,"X3":{"Hs":0.8,"Sq":0.6,"PY":2.5},"pH":{"NS":0.85,"$o":38,"DB":38,"_E":16.7},"MA":0.5,"rO":0.0001,"iH":0.01,"IT":1000,"qO":20,"fw":[{"stepsLimit":10,"easy":-3.5,"medium":3.5,"hard":0},{"stepsLimit":20,"easy":-3,"medium":2,"hard":1},{"stepsLimit":30,"easy":-1.5,"medium":0.5,"hard":1},{"stepsLimit":31,"easy":0,"medium":0,"hard":0}],"n$":3000,"e8":4500,"DX":1,"lD":{"0":1,"1":2,"2":3},"h5":10,"AI":4}');var am,lm,um=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"generate",value:function(e){for(var n=Object.keys(e),i=t.currentChunkIndex;i===t.currentChunkIndex;)i=Math.floor(Math.random()*n.length);return t.currentChunkIndex=i,{key:n[i],difficulty:dm.randomizeDifficulty()}}}],null&&rn(e.prototype,null),n&&rn(e,n),t}();(lm="currentChunkIndex")in(am=um)?Object.defineProperty(am,lm,{value:1,enumerable:!0,configurable:!0,writable:!0}):am[lm]=1;const cm=um;var hm=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"setupWeights",value:function(e,n){t.resetWeights(e),t.calculateCurrentWeights(n)}},{key:"resetWeights",value:function(e){for(var n in t.difficultySteps=t.parseDifficultyConfig(e),t.difficultySteps.sort((function(t,e){return t.stepsLimit-e.stepsLimit})),t.setNextDifficultyStep(),rm){var i=rm[n];t.difficultyWeights[i]=0}t.difficultyWeights[rm.easy]=100}},{key:"calculateCurrentWeights",value:function(e){t.chunkIndex=e;for(var n=t.currentDifficultyStep,i=0;t.difficultySteps.length>0&&t.checkCurrentDifficultyStepLimit();){i=n.stepsLimit,t.setNextDifficultyStep();var r=t.currentDifficultyStep.stepsLimit-n.stepsLimit;for(var o in rm){var s=rm[o],a=n[s]*r;t.difficultyWeights[s]+=a}n=t.currentDifficultyStep}var l=t.chunkIndex-i;for(var u in rm){var c=rm[u],h=t.currentDifficultyStep[c]*l;t.difficultyWeights[c]+=h}}},{key:"parseDifficultyConfig",value:function(t){var e,n=[],i=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return on(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?on(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(t);try{for(i.s();!(e=i.n()).done;){var r=e.value,o={};for(var s in o.stepsLimit=r.stepsLimit,rm){var a=rm[s],l=r[s];o[a]=l}n.push(o)}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"generateNext",value:function(){var e=t.generationStrategy.generate(im),n=e.key,i=e.difficulty;return t.updateDifficultyStep(),t.updateDifficulty(),t.chunkIndex+=1,{chunkConfig:im[n],difficulty:i,key:n}}},{key:"checkCurrentDifficultyStepLimit",value:function(){return t.chunkIndex>=t.currentDifficultyStep.stepsLimit}},{key:"updateDifficultyStep",value:function(){t.difficultySteps.length<=0||t.checkCurrentDifficultyStepLimit()&&t.setNextDifficultyStep()}},{key:"setNextDifficultyStep",value:function(){var e=t.difficultySteps;t.currentDifficultyStep=e.shift()}},{key:"updateDifficulty",value:function(){for(var e in rm){var n=rm[e],i=t.currentDifficultyStep[n];t.difficultyWeights[n]+=i}}},{key:"randomizeDifficulty",value:function(){for(var e=Math.floor(100*Math.random()),n=[rm.easy,rm.medium,rm.hard],i=rm.easy,r=0,o=0,s=!1;!s&&r<3;)i=n[r],s=e<(o+=t.difficultyWeights[i]),r+=1;return i}},{key:"generateEmptyChunk",value:function(){var t=JSON.parse(JSON.stringify(om)),e=20*Math.random()-10;return t.path[1].x=e,t.path[1].z=-sm.pH.$o,{chunkConfig:t,difficulty:rm.easy,key:"start"}}}],null&&sn(e.prototype,null),n&&sn(e,n),t}();an(hm,"chunkIndex",0),an(hm,"currentChunkIndex",0),an(hm,"difficultySteps",null),an(hm,"currentDifficultyStep",null),an(hm,"currentlist",null),an(hm,"difficultyWeights",{}),an(hm,"generationStrategy",cm);const dm=hm;var pm=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gameController=e,this.observer=new(Td()),jd.on("resize",this.handleResize,this)}var e,n;return e=t,(n=[{key:"init",value:function(){}},{key:"prepareToStart",value:function(t){}},{key:"handleResize",value:function(){}},{key:"tick",value:function(t){}}])&&ln(e.prototype,n),t}();!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(pm,"events",{intervalComplete:"intervalComplete"});const fm=pm;var mm=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"processAll",value:function(){for(;t.pool.length>0;)tm.processCurrentChunkSync()}},{key:"startNextTask",value:function(){var e=t.pool.shift(),n=e.curve,i=e.steps,r=e.offset,o=e.blocks,s=e.chunk;tm.create(n,i,r,o),tm.observer.once(tm.events.frenetFramesCompute,s.handleCreateDecorations,s),tm.observer.once(tm.events.generateTopUVs,s.handleCreateGrass,s),tm.observer.once(tm.events.complete,s.handleGenerationComplete,s)}},{key:"startAndSubscribe",value:function(){t.startNextTask(),tm.observer.once(tm.events.complete,this.handleChunkGenerationComplete)}},{key:"add",value:function(e,n,i,r,o){var s={curve:e,steps:n,offset:i,blocks:r,chunk:o};t.pool.push(s),t.state===t.states.idle&&(t.state=t.state.busy,t.startAndSubscribe())}},{key:"handleChunkGenerationComplete",value:function(){0!==t.pool.length?t.startAndSubscribe():t.state=t.states.idle}}],null&&un(e.prototype,null),n&&un(e,n),t}();cn(mm,"pool",[]),cn(mm,"states",{idle:0,busy:1}),cn(mm,"state",mm.states.idle);const gm=mm,ym={type:"change"},vm={type:"start"},xm={type:"end"};class bm extends Ad.EventDispatcher{constructor(t,e){function n(){return Math.pow(.95,M.zoomSpeed)}function i(t){I.theta-=t}function r(t){I.phi-=t}function o(t){M.object.isPerspectiveCamera?R/=t:M.object.isOrthographicCamera?(M.object.zoom=Math.max(M.minZoom,Math.min(M.maxZoom,M.object.zoom*t)),M.object.updateProjectionMatrix(),q=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),M.enableZoom=!1)}function s(t){M.object.isPerspectiveCamera?R*=t:M.object.isOrthographicCamera?(M.object.zoom=Math.max(M.minZoom,Math.min(M.maxZoom,M.object.zoom/t)),M.object.updateProjectionMatrix(),q=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),M.enableZoom=!1)}function a(t){L.set(t.clientX,t.clientY)}function l(t){k.set(t.clientX,t.clientY)}function u(){if(1===j.length)L.set(j[0].pageX,j[0].pageY);else{const t=.5*(j[0].pageX+j[1].pageX),e=.5*(j[0].pageY+j[1].pageY);L.set(t,e)}}function c(){if(1===j.length)k.set(j[0].pageX,j[0].pageY);else{const t=.5*(j[0].pageX+j[1].pageX),e=.5*(j[0].pageY+j[1].pageY);k.set(t,e)}}function h(){const t=j[0].pageX-j[1].pageX,e=j[0].pageY-j[1].pageY,n=Math.sqrt(t*t+e*e);V.set(0,n)}function d(t){if(1==j.length)D.set(t.pageX,t.pageY);else{const e=A(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);D.set(n,i)}z.subVectors(D,L).multiplyScalar(M.rotateSpeed);const e=M.domElement;i(2*Math.PI*z.x/e.clientHeight),r(2*Math.PI*z.y/e.clientHeight),L.copy(D)}function p(t){if(1===j.length)B.set(t.pageX,t.pageY);else{const e=A(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);B.set(n,i)}F.subVectors(B,k).multiplyScalar(M.panSpeed),X(F.x,F.y),k.copy(B)}function f(t){const e=A(t),n=t.pageX-e.x,i=t.pageY-e.y,r=Math.sqrt(n*n+i*i);N.set(0,r),U.set(0,Math.pow(N.y/V.y,M.zoomSpeed)),o(U.y),V.copy(N)}function m(t){!1!==M.enabled&&(0===j.length&&(M.domElement.setPointerCapture(t.pointerId),M.domElement.addEventListener("pointermove",g),M.domElement.addEventListener("pointerup",y)),function(t){j.push(t)}(t),"touch"===t.pointerType?function(t){switch(S(t),j.length){case 1:switch(M.touches.ONE){case Ad.TOUCH.ROTATE:if(!1===M.enableRotate)return;u(),E=T.TOUCH_ROTATE;break;case Ad.TOUCH.PAN:if(!1===M.enablePan)return;c(),E=T.TOUCH_PAN;break;default:E=T.NONE}break;case 2:switch(M.touches.TWO){case Ad.TOUCH.DOLLY_PAN:if(!1===M.enableZoom&&!1===M.enablePan)return;M.enableZoom&&h(),M.enablePan&&c(),E=T.TOUCH_DOLLY_PAN;break;case Ad.TOUCH.DOLLY_ROTATE:if(!1===M.enableZoom&&!1===M.enableRotate)return;M.enableZoom&&h(),M.enableRotate&&u(),E=T.TOUCH_DOLLY_ROTATE;break;default:E=T.NONE}break;default:E=T.NONE}E!==T.NONE&&M.dispatchEvent(vm)}(t):function(t){let e;switch(t.button){case 0:e=M.mouseButtons.LEFT;break;case 1:e=M.mouseButtons.MIDDLE;break;case 2:e=M.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ad.MOUSE.DOLLY:if(!1===M.enableZoom)return;!function(t){V.set(t.clientX,t.clientY)}(t),E=T.DOLLY;break;case Ad.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===M.enablePan)return;l(t),E=T.PAN}else{if(!1===M.enableRotate)return;a(t),E=T.ROTATE}break;case Ad.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===M.enableRotate)return;a(t),E=T.ROTATE}else{if(!1===M.enablePan)return;l(t),E=T.PAN}break;default:E=T.NONE}E!==T.NONE&&M.dispatchEvent(vm)}(t))}function g(t){!1!==M.enabled&&("touch"===t.pointerType?function(t){switch(S(t),E){case T.TOUCH_ROTATE:if(!1===M.enableRotate)return;d(t),M.update();break;case T.TOUCH_PAN:if(!1===M.enablePan)return;p(t),M.update();break;case T.TOUCH_DOLLY_PAN:if(!1===M.enableZoom&&!1===M.enablePan)return;!function(t){M.enableZoom&&f(t),M.enablePan&&p(t)}(t),M.update();break;case T.TOUCH_DOLLY_ROTATE:if(!1===M.enableZoom&&!1===M.enableRotate)return;!function(t){M.enableZoom&&f(t),M.enableRotate&&d(t)}(t),M.update();break;default:E=T.NONE}}(t):function(t){if(!1!==M.enabled)switch(E){case T.ROTATE:if(!1===M.enableRotate)return;!function(t){D.set(t.clientX,t.clientY),z.subVectors(D,L).multiplyScalar(M.rotateSpeed);const e=M.domElement;i(2*Math.PI*z.x/e.clientHeight),r(2*Math.PI*z.y/e.clientHeight),L.copy(D),M.update()}(t);break;case T.DOLLY:if(!1===M.enableZoom)return;!function(t){N.set(t.clientX,t.clientY),U.subVectors(N,V),U.y>0?o(n()):U.y<0&&s(n()),V.copy(N),M.update()}(t);break;case T.PAN:if(!1===M.enablePan)return;!function(t){B.set(t.clientX,t.clientY),F.subVectors(B,k).multiplyScalar(M.panSpeed),X(F.x,F.y),k.copy(B),M.update()}(t)}}(t))}function y(t){w(t),0===j.length&&(M.domElement.releasePointerCapture(t.pointerId),M.domElement.removeEventListener("pointermove",g),M.domElement.removeEventListener("pointerup",y)),M.dispatchEvent(xm),E=T.NONE}function v(t){w(t)}function x(t){!1!==M.enabled&&!1!==M.enableZoom&&E===T.NONE&&(t.preventDefault(),M.dispatchEvent(vm),function(t){t.deltaY<0?s(n()):t.deltaY>0&&o(n()),M.update()}(t),M.dispatchEvent(xm))}function b(t){!1!==M.enabled&&!1!==M.enablePan&&function(t){let e=!1;switch(t.code){case M.keys.UP:X(0,M.keyPanSpeed),e=!0;break;case M.keys.BOTTOM:X(0,-M.keyPanSpeed),e=!0;break;case M.keys.LEFT:X(M.keyPanSpeed,0),e=!0;break;case M.keys.RIGHT:X(-M.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),M.update())}(t)}function _(t){!1!==M.enabled&&t.preventDefault()}function w(t){delete G[t.pointerId];for(let e=0;e<j.length;e++)if(j[e].pointerId==t.pointerId)return void j.splice(e,1)}function S(t){let e=G[t.pointerId];void 0===e&&(e=new Ad.Vector2,G[t.pointerId]=e),e.set(t.pageX,t.pageY)}function A(t){const e=t.pointerId===j[0].pointerId?j[1]:j[0];return G[e.pointerId]}super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ad.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ad.MOUSE.ROTATE,MIDDLE:Ad.MOUSE.DOLLY,RIGHT:Ad.MOUSE.PAN},this.touches={ONE:Ad.TOUCH.ROTATE,TWO:Ad.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return C.phi},this.getAzimuthalAngle=function(){return C.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",b),this._domElementKeyEvents=t},this.saveState=function(){M.target0.copy(M.target),M.position0.copy(M.object.position),M.zoom0=M.object.zoom},this.reset=function(){M.target.copy(M.target0),M.object.position.copy(M.position0),M.object.zoom=M.zoom0,M.object.updateProjectionMatrix(),M.dispatchEvent(ym),M.update(),E=T.NONE},this.update=function(){const e=new Ad.Vector3,n=(new Ad.Quaternion).setFromUnitVectors(t.up,new Ad.Vector3(0,1,0)),r=n.clone().invert(),o=new Ad.Vector3,s=new Ad.Quaternion,a=2*Math.PI;return function(){const t=M.object.position;e.copy(t).sub(M.target),e.applyQuaternion(n),C.setFromVector3(e),M.autoRotate&&E===T.NONE&&i(2*Math.PI/60/60*M.autoRotateSpeed),M.enableDamping?(C.theta+=I.theta*M.dampingFactor,C.phi+=I.phi*M.dampingFactor):(C.theta+=I.theta,C.phi+=I.phi);let l=M.minAzimuthAngle,u=M.maxAzimuthAngle;return isFinite(l)&&isFinite(u)&&(l<-Math.PI?l+=a:l>Math.PI&&(l-=a),u<-Math.PI?u+=a:u>Math.PI&&(u-=a),C.theta=l<=u?Math.max(l,Math.min(u,C.theta)):C.theta>(l+u)/2?Math.max(l,C.theta):Math.min(u,C.theta)),C.phi=Math.max(M.minPolarAngle,Math.min(M.maxPolarAngle,C.phi)),C.makeSafe(),C.radius*=R,C.radius=Math.max(M.minDistance,Math.min(M.maxDistance,C.radius)),!0===M.enableDamping?M.target.addScaledVector(O,M.dampingFactor):M.target.add(O),e.setFromSpherical(C),e.applyQuaternion(r),t.copy(M.target).add(e),M.object.lookAt(M.target),!0===M.enableDamping?(I.theta*=1-M.dampingFactor,I.phi*=1-M.dampingFactor,O.multiplyScalar(1-M.dampingFactor)):(I.set(0,0,0),O.set(0,0,0)),R=1,!!(q||o.distanceToSquared(M.object.position)>P||8*(1-s.dot(M.object.quaternion))>P)&&(M.dispatchEvent(ym),o.copy(M.object.position),s.copy(M.object.quaternion),q=!1,!0)}}(),this.dispose=function(){M.domElement.removeEventListener("contextmenu",_),M.domElement.removeEventListener("pointerdown",m),M.domElement.removeEventListener("pointercancel",v),M.domElement.removeEventListener("wheel",x),M.domElement.removeEventListener("pointermove",g),M.domElement.removeEventListener("pointerup",y),null!==M._domElementKeyEvents&&M._domElementKeyEvents.removeEventListener("keydown",b)};const M=this,T={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let E=T.NONE;const P=1e-6,C=new Ad.Spherical,I=new Ad.Spherical;let R=1;const O=new Ad.Vector3;let q=!1;const L=new Ad.Vector2,D=new Ad.Vector2,z=new Ad.Vector2,k=new Ad.Vector2,B=new Ad.Vector2,F=new Ad.Vector2,V=new Ad.Vector2,N=new Ad.Vector2,U=new Ad.Vector2,j=[],G={},H=function(){const t=new Ad.Vector3;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),O.add(t)}}(),W=function(){const t=new Ad.Vector3;return function(e,n){!0===M.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(M.object.up,t)),t.multiplyScalar(e),O.add(t)}}(),X=function(){const t=new Ad.Vector3;return function(e,n){const i=M.domElement;if(M.object.isPerspectiveCamera){const r=M.object.position;t.copy(r).sub(M.target);let o=t.length();o*=Math.tan(M.object.fov/2*Math.PI/180),H(2*e*o/i.clientHeight,M.object.matrix),W(2*n*o/i.clientHeight,M.object.matrix)}else M.object.isOrthographicCamera?(H(e*(M.object.right-M.object.left)/M.object.zoom/i.clientWidth,M.object.matrix),W(n*(M.object.top-M.object.bottom)/M.object.zoom/i.clientHeight,M.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),M.enablePan=!1)}}();M.domElement.addEventListener("contextmenu",_),M.domElement.addEventListener("pointerdown",m),M.domElement.addEventListener("pointercancel",v),M.domElement.addEventListener("wheel",x,{passive:!1}),this.update()}}var _m=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).sceneBounds={top:0,bottom:0,height:0},t.backgroundOffsetScale={x:1,y:1},t.cameraOffset={x:0,y:0,z:0},t.spotLight=null,t.ambientLight=null,t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xn(t,e)}(e,t);var n,i,r=bn(e);return n=e,(i=[{key:"createChildren",value:function(){this.backgroundPlane=new Ad.Mesh(new Ad.PlaneGeometry,new Ad.MeshBasicMaterial({map:op("textures/grass-ground")})),this.backgroundPlane.material.map.wrapS=Ad.RepeatWrapping,this.backgroundPlane.material.map.wrapT=Ad.RepeatWrapping,this.backgroundPlane.rotation.x=.5*-Math.PI,this.add(this.backgroundPlane)}},{key:"addPlayer",value:function(t){this.add(t),this.spotLight.target=t}},{key:"createLights",value:function(){this.ambientLight=new Ad.AmbientLight(16777215,.9),this.add(this.ambientLight),this.spotLight=new Ad.SpotLight(16777215,.75,110,.5*Math.PI,1,2),this.add(this.spotLight)}},{key:"setCameraFromConfig",value:function(){var t=sm.nS.Wn;this.camera.rotation.set(t.x,t.y,t.z),this.calculateCameraBounds()}},{key:"handleResize",value:function(){var t=this.backgroundPlane.material.map;jd.isLandscape()?(this.setCameraOffset(sm.nS.FK.r),this.camera.fov=sm.nS.UZ.r,jd.aspectRatio<1.5&&(this.cameraOffset.y+=4)):(this.setCameraOffset(sm.nS.FK.t),this.camera.fov=sm.nS.UZ.t),this.backgroundPlane.scale.setScalar(this.sceneBounds.height*e.backgroundPlaneScale),t.repeat.set(.1*this.backgroundPlane.scale.x,.1*this.backgroundPlane.scale.z),this.backgroundOffsetScale.x=1/(t.repeat.x*e.backgroundPlaneScale),this.backgroundOffsetScale.y=1/(t.repeat.y*e.backgroundPlaneScale),this.camera.position.y=this.cameraOffset.y,this.camera.aspect=jd.width/jd.height,this.camera.updateProjectionMatrix()}},{key:"setCameraOffset",value:function(t){this.cameraOffset.x=t.x,this.cameraOffset.y=t.y,this.cameraOffset.z=t.z}},{key:"calculateCameraBounds",value:function(){var t=Math.max(sm.nS.UZ.r,sm.nS.UZ.t),e=Math.max(sm.nS.FK.r.y,sm.nS.FK.t.y),n=.5*t*(Math.PI/180),i=.5*Math.PI-Math.abs(this.camera.rotation.x),r=i+n,o=i-n,s=Math.tan(r)*e,a=Math.tan(o)*e;this.sceneBounds.top=-s,this.sceneBounds.bottom=-a,this.sceneBounds.height=Math.abs(this.sceneBounds.top-this.sceneBounds.bottom)}},{key:"init",value:function(){this.createChildren(),this.setCameraFromConfig(),this.createLights(),this.handleResize(),this.spotLight.position.y=70}},{key:"syncCamera",value:function(t){this.camera.position.x=this.cameraOffset.x+t.x,this.camera.position.z=this.cameraOffset.z+t.z}},{key:"syncBack",value:function(t){var e=this.backgroundPlane.material.map,n=this.camera.position;this.backgroundPlane.position.set(t.x,0,n.z+this.sceneBounds.bottom-.5*this.sceneBounds.height),e.offset.x=this.backgroundPlane.position.x*this.backgroundOffsetScale.x,e.offset.y=-this.backgroundPlane.position.z*this.backgroundOffsetScale.y}},{key:"syncLight",value:function(){this.spotLight.position.x=this.camera.position.x+10,this.spotLight.position.z=this.camera.position.z-20}}])&&vn(n.prototype,i),e}(function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=r.call(this),jd.on("resize",t.handleResize,mn(t)),t.createCamera(),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pn(t,e)}(e,t);var n,i,r=fn(e);return n=e,i=[{key:"handleRemove",value:function(){jd.off("resize",this.handleResize,this)}},{key:"createCamera",value:function(){this.camera=new Ad.PerspectiveCamera(90,1,.001,1e4),this.camera.position.set(0,5,20),this.add(this.camera)}},{key:"addCameraControls",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.controls=new bm(this.camera,$v.instance.view),this.controls.enableDamping=!0,this.controls.dampingFactor=.25,this.controls.enableZoom=!0,this.controls.enabled=t}},{key:"createLights",value:function(){this.add(new Ad.AmbientLight(16777215,.8));var t=new Ad.DirectionalLight(16777215,.2);t.position.set(0,50,50),this.add(t)}},{key:"createChildren",value:function(){}},{key:"handleResize",value:function(){if(this.camera)if(this.camera instanceof Ad.PerspectiveCamera)jd.isLandscape()?this.camera.fov=70:this.camera.fov=90,this.camera.aspect=jd.width/jd.height,this.camera.updateProjectionMatrix();else{var t=jd.gameWidth/jd.gameHeight;this.camera.left=-.5*this.cameraFrustumSize*t/2,this.camera.right=.5*this.cameraFrustumSize*t/2,this.camera.top=this.cameraFrustumSize/2,this.camera.bottom=-this.cameraFrustumSize/2,this.camera.updateProjectionMatrix()}}},{key:"render",value:function(){$v.instance.renderer3d.render(this,this.camera)}},{key:"tick",value:function(){this.render()}}],i&&dn(n.prototype,i),e}(Ad.Scene));!function(t,e,n){e in t?Object.defineProperty(t,e,{value:2,enumerable:!0,configurable:!0,writable:!0}):t[e]=2}(_m,"backgroundPlaneScale");const wm=_m;var Sm=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"init",value:function(){var e=$d,n=Jd;e["textures/shadows/stone2"]=e["textures/shadows/stone1"],n["textures/shadows/stone2"]=n["textures/shadows/stone1"];var i,r=wn(t.infinityCollection);try{for(r.s();!(i=r.n()).done;){var o=i.value;t.createShadow(o);var s=t.getDecoration(o,!0);s.traverse(t.applyTextureToMaterial),t.calculateDecorationSize(o,s)}}catch(t){r.e(t)}finally{r.f()}var a,l=wn(t.treeLeafs);try{for(l.s();!(a=l.n()).done;){var u=a.value;rp(u,!0).traverse(t.applyTextureToMaterial)}}catch(t){l.e(t)}finally{l.f()}rp("grass",!0).traverse(t.applyTextureToMaterial)}},{key:"applyTextureToMaterial",value:function(t){var e=op("textures/textures-palette");if(Array.isArray(t.material)){var n,i=wn(t.material);try{for(i.s();!(n=i.n()).done;)n.value.map=e}catch(t){i.e(t)}finally{i.f()}}else t.material&&(t.material.map=e)}},{key:"calculateDecorationSize",value:function(e,n){var i;i="tree"===e?n.getObjectByName("shadow"):n;var r=(new Ad.Box3).setFromObject(i),o=new Ad.Vector3;r.getSize(o).multiplyScalar(.01),n.name=e+"-parent",t.decorationSizes[n.name]=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.z,2))}},{key:"createShadow",value:function(e){var n="textures/shadows/"+e;if(function(t){return!!Jd[t]}(n)&&!t.shadows[e]){var i=1*t.shadowsScales[e],r=op(n),o=new Ad.PlaneGeometry(i,i),s=new Ad.MeshStandardMaterial({transparent:!0,map:r}),a=new Ad.Mesh(o,s);o.rotateX(.5*-Math.PI),a.position.copy(t.shadowOffset),a.name="shadow",t.shadows[e]=a}}},{key:"generateNext",value:function(){for(var e=t.prevDecoration;e===t.prevDecoration;){var n=Math.floor(Math.random()*t.infinityCollection.length);e=t.infinityCollection[n]}return t.prevDecoration=e,{decoration:t.getDecoration(e),shadow:t.getShadow(e)}}},{key:"getDecoration",value:function(e,n){return"tree"===e?t.generateTree(n):rp(e,n)}},{key:"generateTree",value:function(e){var n=Math.floor(Math.random()*t.treeLeafs.length),i=rp("tree-trunk",e);if(!e){var r=rp(t.treeLeafs[n]);i.add(r)}return i}},{key:"getShadow",value:function(e){var n=t.shadows[e];return n&&(n=n.clone()),n}}],null&&An(e.prototype,null),n&&An(e,n),t}();Mn(Sm,"infinityCollection",["can","stone1","gnome","stone2","stone3","stone4","tree","stone5","tree"]),Mn(Sm,"shadowsScales",{stone1:1.2,stone2:1.35,stone3:1.2,stone4:1.2,stone5:1.5,gnome:.9}),Mn(Sm,"treeLeafs",["tree-leafs1","tree-leafs2","tree-leafs3"]),Mn(Sm,"shadows",{}),Mn(Sm,"decorationSizes",{}),Mn(Sm,"prevDecoration",""),Mn(Sm,"shadowOffset",new Ad.Vector3(-.2,.05,.1));const Am=Sm;var Mm=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=o.call(this,n,i)).container=t,r.emitter=null,r.renderer=null,r.bindedSetRendedOrder=r.setRenderOrder.bind(In(r)),r.createEmitter(),r.createRenderer(),r.emitter.emit(.21),r}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pn(t,e)}(e,t);var n,i,r,o=Cn(e);return n=e,r=[{key:"init",value:function(){for(var t=1;t<6;t++){var n=new Ad.SpriteMaterial({map:op("textures/smoke/"+t)}),i=new Ad.Sprite(n);e.sprites.push(i)}}}],(i=[{key:"createEmitter",value:function(){this.emitter=new(dp().Emitter)(this),this.addEmitter(this.emitter),this.emitter.rate=new(dp().Rate)(5,.1),this.addEventListener("PARTICLE_CREATED",this.bindedSetRendedOrder),this.emitter.addInitialize(new(dp().Life)(1,1.2)),this.emitter.addInitialize(new(dp().Velocity)(12,new(dp().Vector3D)(0,1,0),30)),this.emitter.addInitialize(new(dp().Position)(new(dp().SphereZone)(0,0,0,.5))),this.emitter.addInitialize(new(dp().Body)(e.sprites)),this.emitter.addBehaviour(new(dp().Alpha)(1,0,1/0,dp().easeLinear)),this.emitter.addBehaviour(new(dp().RandomDrift)(2,0,2,1/0,1/0,dp().easeLinear)),this.emitter.addBehaviour(new(dp().Scale)(new(dp().Span)(.3,.5),0,1/0,dp().easeLinear))}},{key:"createRenderer",value:function(){this.renderer=new(dp().SpriteRender)(this.container),this.renderer.particlesBlendMode=Ad.NormalBlending,this.addRender(this.renderer)}},{key:"setRenderOrder",value:function(t){t.body.renderOrder=3}}])&&En(n.prototype,i),r&&En(n,r),e}(mp);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Mm,"sprites",[]);const Tm=Mm,Em=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"init",value:function(){}},{key:"tick",value:function(){}}])&&On(e.prototype,n),t}(),Pm=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=r.call(this),jd.on("resize",t.handleResize,kn(t)),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(e,t);var n,i,r=zn(e);return n=e,(i=[{key:"handleRemove",value:function(){jd.off("resize",this.handleResize,this)}},{key:"handleResize",value:function(t){}},{key:"tick",value:function(t){}}])&&Ln(n.prototype,i),e}($a),Cm=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).textStyles={fontFamily:$v.getSystemFont(),fontSize:70,fill:16777215,stroke:0,lineJoin:"round",strokeThickness:5},t.activeViews=[],t.boundingBox=new Oa(-50,-200,100,200),t.bindedHandleAnimationComplete=t.handleAnimationComplete.bind(jn(t)),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nn(t,e)}(e,t);var n,i,r=Un(e);return n=e,(i=[{key:"handleAnimationComplete",value:function(){this.activeViews.shift().destroy({children:!0})}},{key:"spawnScore",value:function(t){var e=new fh(t,this.textStyles);e.anchor.set(.5),e.alpha=0,this.addChild(e),this.activeViews.push(e),new qd(e).to({position:{y:-200},alpha:[1,1,0]},700).onComplete(this.bindedHandleAnimationComplete).start()}}])&&Vn(n.prototype,i),e}($a);var Im=function(t){function e(t,n,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=r.call(this,t,n,i)).value=0,o.currentValue=0,o.increment=0,o.timer=new yp(e.animationTime,0,e.animationTime/e.steps,!1),o.timer.stop(),o.timer.on("finish",o.handleFinish,Zn(o)).on("period",o.handlePeriod,Zn(o)),o}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,t);var n,i,r=Yn(e);return n=e,(i=[{key:"handlePeriod",value:function(){this.currentValue+=this.increment,this.text=this.currentValue}},{key:"handleFinish",value:function(){this.currentValue=this.value,this.text=this.currentValue}},{key:"addScore",value:function(t){this.value+=t,this.increment=Math.floor((this.value-this.currentValue)/e.steps),this.timer.restart()}},{key:"reset",value:function(){this.timer.stop(),this.value=0,this.text=0}}])&&Wn(n.prototype,i),e}(fh);Jn(Im,"animationTime",1e3),Jn(Im,"steps",17);const Rm=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).hand=t.addChild(new lp("tutorial-hand")),t.tween=new qd(t.scale).to({x:.8,y:.8},300).yoyo(!0).repeat(3),t.timer=new yp(3e3,1/0,3e3,!1),t.timer.on("repeat",t.playTapAnimation,ni(t)).stop(),t.bindedHandleHideAnimationComplete=t.bindedHandleHideAnimationComplete.bind(ni(t)),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,t);var n,i,r=ei(e);return n=e,(i=[{key:"resize",value:function(){var t=jd.gameWidth,e=jd.gameHeight;this.hand.scale.set(1),jd.isLandscape()?(this.hand.scale.set(Math.min(.5*t/this.hand.width,.23*e/this.hand.height)),this.position.y=.25*e):(this.hand.scale.set(Math.min(.3*t/this.hand.width,.4*e/this.hand.height)),this.position.y=.25*e)}},{key:"playTapAnimation",value:function(){this.tween.start()}},{key:"hide",value:function(){this.timer.off("repeat",this.playTapAnimation,this),this.timer.destroy(),this.tween.stop(),new qd(this).to({alpha:0},300).onComplete(this.bindedHandleHideAnimationComplete).start()}},{key:"bindedHandleHideAnimationComplete",value:function(){this.visible=!1}},{key:"startAnimation",value:function(){this.tween.start(),this.timer.restart()}}])&&$n(n.prototype,i),e}($a);var Om=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).bestScoreView=null,t.scoreAnimation=null,t.loseScreen=null,t.soundButton=null,t.currentScoreView=null,t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ai(t,e)}(e,t);var n,i,r=li(e);return n=e,i=[{key:"init",value:function(){this.createChildren(),this.handleResize(),this.turnListeners("on"),this.tutorial.startAnimation()}},{key:"createChildren",value:function(){this.eventsShader=new lp,this.scoreAnimation=new Cm,this.tutorial=new Rm,this.wheelProgressBar=new Rg,this.addChild(this.eventsShader,this.wheelProgressBar,this.scoreAnimation,this.tutorial)}},{key:"buildUI",value:function(t){var e=t.BestScoreView,n=t.LoseScreen,i=t.SoundButton;this.bestScoreView=new e,this.loseScreen=new n,this.soundButton=new i,this.currentScoreView=new fh("0",{fontFamily:$v.getSystemFont(),fontSize:82,fontWeight:"bold",fill:16777215,stroke:0,lineJoin:"round",strokeThickness:5}),this.currentScoreView.anchor.set(.5),window.famobi.hasFeature("external_mute")?this.addChild(this.bestScoreView,this.loseScreen,this.currentScoreView):this.addChild(this.bestScoreView,this.loseScreen,this.soundButton,this.currentScoreView),jd.on("resize",this.handleResizeUI,this),this.handleResizeUI()}},{key:"handleRemove",value:function(){si(ui(e.prototype),"handleRemove",this).call(this),jd.off("resize",this.handleResizeUI,this)}},{key:"turnListeners",value:function(){var t="on"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"off")?"on":"off";this.eventsShader[t]("pointerdown",this.handlePointerDown,this),this.eventsShader[t]("pointerup",this.handlePointerUp,this),this.eventsShader[t]("pointerupoutside",this.handlePointerUp,this),this.eventsShader[t]("pointercancel",this.handlePointerUp,this)}},{key:"handleResize",value:function(){var t=jd.gameWidth,e=jd.gameHeight,n=Math.min(.05*t,.05*e);this.eventsShader.width=t,this.eventsShader.height=e,this.wheelProgressBar.scale.set(1),jd.orientation===jd.LANDSCAPE?this.wheelProgressBar.scale.set(Math.min(.5*t/this.wheelProgressBar.width,.1*e/this.wheelProgressBar.height)):this.wheelProgressBar.scale.set(Math.min(.8*t/this.wheelProgressBar.width,.05*e/this.wheelProgressBar.height)),this.wheelProgressBar.position.y=.5*-e+n+.5*this.wheelProgressBar.height,this.scoreAnimation.scale.set(Math.min(.15*t/this.scoreAnimation.boundingBox.width,.15*e/this.scoreAnimation.boundingBox.height)),this.scoreAnimation.position.y=.1*-e,this.tutorial.resize()}},{key:"handleResizeUI",value:function(){var t=jd.gameWidth,e=jd.gameHeight,n=Math.min(.05*t,.05*e);this.loseScreen.resize(),this.currentScoreView.scale.set(1),jd.orientation===jd.LANDSCAPE?(this.bestScoreView.scale.set(Math.min(.2*t/this.bestScoreView.safeArea.width,.1*e/this.bestScoreView.safeArea.height)),this.currentScoreView.scale.set(Math.min(.35*t/this.currentScoreView.width,.1*e/this.currentScoreView.height)),this.bestScoreView.position.set(.5*-t+n+.5*this.bestScoreView.icon.width*this.bestScoreView.scale.x,.5*-e+n+.5*this.bestScoreView.icon.height*this.bestScoreView.scale.y),this.currentScoreView.position.y=.5*-e+.12*e+.5*this.currentScoreView.height):(this.bestScoreView.scale.set(Math.min(.35*t/this.bestScoreView.safeArea.width,.15*e/this.bestScoreView.safeArea.height)),this.currentScoreView.scale.set(Math.min(.25*t/this.currentScoreView.width,.05*e/this.currentScoreView.height)),this.bestScoreView.position.set(.5*-t+n+.5*this.bestScoreView.icon.width*this.bestScoreView.scale.x,.5*-e+.1*e+.5*this.bestScoreView.icon.height*this.bestScoreView.scale.y),this.currentScoreView.position.y=this.bestScoreView.position.y),this.soundButton.scale.copyFrom(this.bestScoreView.scale),this.soundButton.position.set(.5*t-n-.5*this.soundButton.width,this.bestScoreView.position.y)}},{key:"handlePointerDown",value:function(){this.emit(e.events.start)}},{key:"handlePointerUp",value:function(){this.emit(e.events.stop)}}],i&&oi(n.prototype,i),e}(Pm);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Om,"events",{start:"start",stop:"stop"});const qm=Om;var Lm=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=r.call(this)).bindedCompleteHideAnimation=n.completeHideAnimation.bind(fi(n)),n.currentTween=new qd,n.createChildren(t),n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&di(t,e)}(e,t);var n,i,r=pi(e);return n=e,i=[{key:"createChildren",value:function(t){this.icon=new lp(t),this.visible=!1,this.addChild(this.icon)}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;this.visible=!0,this.currentTween.stop(),this.currentTween=new qd(this.icon).to({alpha:1},t).start()}},{key:"hide",value:function(){this.currentTween.stop(),this.currentTween=new qd(this.icon).to({alpha:0},300).onComplete(this.bindedCompleteHideAnimation).start()}},{key:"completeHideAnimation",value:function(){this.visible=!1,this.emit(e.events.hideAnimationComplete)}}],i&&hi(n.prototype,i),e}($a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Lm,"events",{hideAnimationComplete:"hideAnimationComplete"});const Dm=Lm;var zm=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=r.call(this)).radius=t,n.progress=0,n.currentTween=new qd,n.bindedOnUpdate=n.onUpdate.bind(bi(n)),n.bindedEmitNext=n.emitNext.bind(bi(n)),n.lineStyle={width:.15*n.radius,color:8388515},n.outerLineStyle={width:.18*n.radius,color:0},n.createChildren(),n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vi(t,e)}(e,t);var n,i,r=xi(e);return n=e,(i=[{key:"createChildren",value:function(){this.back=new nh,this.back.lineStyle(this.outerLineStyle).moveTo(this.radius,0).arc(0,0,this.radius,0,2*Math.PI),this.back.lineStyle(.15*this.radius,422948).moveTo(this.radius,0).arc(0,0,this.radius,0,2*Math.PI),this.graphics=new nh,this.iconContainer=new $a,this.mowerIcon=new lp("ui/lawn-mower"),this.mowerIcon.rotation=.5*-Math.PI,this.mowerIcon.scale.set(.001*this.radius),this.mowerIcon.position.y=-this.radius,this.iconContainer.addChild(this.mowerIcon),this.addChild(this.back,this.graphics,this.iconContainer)}},{key:"show",value:function(t){this.currentTween.stop(),this.progress=0,this.currentTween=new qd(this).to({progress:1},t).onUpdate(this.bindedOnUpdate).onComplete(this.bindedEmitNext).start()}},{key:"onUpdate",value:function(){var t=.5*Math.PI,e=2*Math.PI*(1-this.progress)-t;this.graphics.clear(),this.graphics.lineStyle(this.lineStyle),this.graphics.moveTo(0,-this.radius),this.graphics.arc(0,0,this.radius,-t,e,!1),this.iconContainer.rotation=e+t}},{key:"emitNext",value:function(){this.emit(e.events.complete)}}])&&yi(n.prototype,i),e}($a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(zm,"events",{complete:"complete"});const km=zm;var Bm=function(t){function e(t,n,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=r.call(this,t,n,i)).style.baseFontSize=o.style.fontSize,o.style.baseFontFamily=o.style.fontFamily,o.extendStyleProps(),o.chooseFontFamily(),o}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ai(t,e)}(e,t);var n,i,r=Mi(e);return n=e,(i=[{key:"extendStyleProps",value:function(){this.style._autoFit=!!this.style.autoFit,this.style._autoFitPadding=this.style.autoFitPadding||0,this.style._autoFitWidth=this.style.autoFitWidth||0,this.style._autoFitHeight=this.style.autoFitHeight||0,this.style._adjustFontFamily=!!this.style.adjustFontFamily,this.style._adjustFontFamilyRegExp=this.style.adjustFontFamilyRegExp instanceof RegExp?this.style.adjustFontFamilyRegExp:void 0,Object.defineProperty(this.style,"autoFit",{get:function(){return this._autoFit},set:function(t){t=!!t,this._autoFit!==t&&(this._autoFit=t,this.styleID++)}}),Object.defineProperty(this.style,"autoFitPadding",{get:function(){return this._autoFitPadding},set:function(t){t=parseFloat(t),isNaN(t)&&(t=0),this._autoFitPadding!==t&&(this._autoFitPadding=t,this.styleID++)}}),Object.defineProperty(this.style,"fontSize",{get:function(){return this._fontSize},set:function(t){t=parseFloat(t),isNaN(t)&&(t=0),this._fontSize!==t&&(this.baseFontSize=t,this._fontSize=t,this.styleID++)}}),Object.defineProperty(this.style,"autoFitWidth",{get:function(){return this._autoFitWidth},set:function(t){t=parseFloat(t),isNaN(t)&&(t=0),this._autoFitWidth!==t&&(this._autoFitWidth=t,this.styleID++)}}),Object.defineProperty(this.style,"autoFitHeight",{get:function(){return this._autoFitHeight},set:function(t){t=parseFloat(t),isNaN(t)&&(t=0),this._autoFitHeight!==t&&(this._autoFitHeight=t,this.styleID++)}}),Object.defineProperty(this.style,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this.baseFontFamily=t,this._fontFamily=t,this.styleID++)}}),Object.defineProperty(this.style,"adjustFontFamily",{get:function(){return this._adjustFontFamily},set:function(t){t=!!t,this._adjustFontFamily!==t&&(this._adjustFontFamily=t,this.styleID++)}}),Object.defineProperty(this,"text",{get:function(){return this._text},set:function(t){t=String(""===t||null==t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0,this.chooseFontFamily())}}),Object.defineProperty(this.style,"adjustFontFamilyRegExp",{get:function(){return this._adjustFontFamilyRegExp},set:function(t){t instanceof RegExp?this._adjustFontFamilyRegExp!==t&&(this._adjustFontFamilyRegExp=t,this.styleID++):console.warn("adjustFontFamilyRegExp is not an instance of RegExp")}})}},{key:"chooseFontFamily",value:function(){var t=null,n=null;this.style.adjustFontFamily?(n=e.ADJUST_FONT_FAMILY_REGEXP,this.style.adjustFontFamilyRegExp&&(n=this.style.adjustFontFamilyRegExp),t=n.test(this.text)?this.style.baseFontFamily:e.SYSTEM_FONT):t=this.style.baseFontFamily,t!==this.style.fontFamily&&(this.style._fontFamily=t,this.style.styleID++)}},{key:"fitText",value:function(){var t=this.style.autoFitWidth;t||(t=this.parent.width/this.parent.scale.x),t-=2*this.style.autoFitPadding;var e=this.style.autoFitHeight;if(e||(e=this.parent.height/this.parent.scale.y),e-=2*this.style.autoFitPadding,t<2||e<2)this.style.fontSize=1;else{var n=this.style.clone();n.fontSize=this.style.baseFontSize;for(var i=!0,r=0;i;){var o=hh.measureText(this.text,n);o.width<=t&&o.height<=e?i=!1:(n.fontSize--,n.fontSize<=1?i=!1:r++)}r>20&&(console.warn("ExtText. Potentially suboptimal use: the number of fit attempts exceeds 20. Current: "+r),console.warn("Base font size: "+this.style.baseFontSize),console.warn("Selected font size: "+n.fontSize),console.warn(this.text)),this.style.fontSize=n.fontSize}}},{key:"updateText",value:function(t){this.localStyleID===this._style.styleID&&!this.dirty&&t||(this.style.autoFit&&this.parent?this.fitText():this.style.fontSize=this.style.baseFontSize,this.chooseFontFamily()),fh.prototype.updateText.call(this,t)}}])&&Si(n.prototype,i),e}(fh);Ei(Bm,"ADJUST_FONT_FAMILY_REGEXP",/^[\u0000-\u007f]+$/),Ei(Bm,"SYSTEM_FONT","-apple-system,BlinkMacSystemFont,Roboto,Helvetica,Arial,sans-serif");const Fm=Bm;var Vm=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).createChildren(),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ii(t,e)}(e,t);var n,i,r=Ri(e);return n=e,i=[{key:"createChildren",value:function(){this.icon=new lp("lead"),this.score=new Fm("0",{fontFamily:$v.getSystemFont(),fontSize:60,fontWeight:"bold",fill:16687623,stroke:0,lineJoin:"round",strokeThickness:5,autoFit:!0,autoFitWidth:300-(this.icon.width+50),autoFitHeight:this.icon.height}),this.score.anchor.set(0,.5),this.addChild(this.icon,this.score),this.score.position.x=.5*this.icon.width+25,this.safeArea=new Oa(0,0,300,this.icon.height)}},{key:"setScore",value:function(t){this.score.text=t}}],i&&Ci(n.prototype,i),e}($a);const Nm=Vm;var Um=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).alpha=0,t.visible=!1,t.currentTween=new qd,t.bestScoreTween=new qd,t.bindedCompleteHideAnimation=t.completeHideAnimation.bind(ki(t)),t.createChildren(),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Di(t,e)}(e,t);var n,i,r=zi(e);return n=e,i=[{key:"createChildren",value:function(){this.back=new nh,this.back.beginFill(0,.6).drawRect(-2,-2,4,4).endFill(),this.bestScore=new Nm,this.bestScore.alpha=0,this.retryButton=new Dm("ui/buttons/retry"),this.reviveButton=new Dm("ui/buttons/ad"),this.reviveButton.icon.alpha=0,this.radialProgressBar=new km(200),this.reviveButton.addChild(this.radialProgressBar),this.addChild(this.back,this.bestScore,this.retryButton,this.reviveButton)}},{key:"resize",value:function(){var t=jd.gameWidth,e=jd.gameHeight;this.back.width=t,this.back.height=e,jd.orientation===jd.LANDSCAPE?(this.retryButton.scale.set(Math.min(.09*t/this.retryButton.icon.width,.27*e/this.retryButton.icon.height)),this.reviveButton.scale.copyFrom(this.retryButton.scale),this.radialProgressBar.scale.set(.75),this.reviveButton.position.y=.075*e):(this.retryButton.scale.set(Math.min(.27*t/this.retryButton.icon.width,.12*e/this.retryButton.icon.height)),this.reviveButton.scale.set(Math.min(.27*t/this.retryButton.icon.width,.09*e/this.retryButton.icon.height)),this.radialProgressBar.scale.set(.85),this.reviveButton.position.y=0),this.resizeCurrentScore();var n=(.85*e-(this.retryButton.height+this.bestScore.height))/3;this.retryButton.position.y=.5*e-.5*this.retryButton.height-n,this.bestScore.position.y=this.retryButton.position.y-.5*this.retryButton.height-.5*this.bestScore.height-n}},{key:"resizeCurrentScore",value:function(){var t=jd.gameWidth,e=jd.gameHeight,n=jd.isLandscape()?.25*t:.55*t;this.bestScore.scale.set(Math.min(n/this.bestScore.safeArea.width,.14*e/this.bestScore.safeArea.height)),this.bestScore.position.x=.5*-this.bestScore.width+.5*this.bestScore.icon.width*this.bestScore.scale.x}},{key:"show",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.showReviveButton:this.setReadyToShowRetryButton;this.visible=!0,this.currentTween.stop(),this.currentTween=new qd(this).to({alpha:1},150).start(),this.bestScore.setScore(t),this.bestScore.alpha=0,this.resizeCurrentScore(),new yp(500).once("complete",e,this)}},{key:"showReviveButton",value:function(){this.reviveButton.show(500),this.reviveButton.interactive=!0,this.reviveButton.once("pointerdown",this.handleRevive,this),this.radialProgressBar.show(sm.n$),this.radialProgressBar.once(km.events.complete,this.hideReviveButton,this)}},{key:"hideReviveButton",value:function(){this.reviveButton.off("pointerdown",this.handleRevive,this),this.reviveButton.hide(),this.reviveButton.once(Dm.events.hideAnimationComplete,this.setReadyToShowRetryButton,this)}},{key:"handleRevive",value:function(){this.radialProgressBar.off(km.events.complete,this.hideReviveButton,this),this.emit(e.events.revive)}},{key:"setReadyToShowRetryButton",value:function(){this.emit(e.events.readyToShowRetryButton)}},{key:"showBestScore",value:function(){this.bestScoreTween=new qd(this.bestScore).to({alpha:1},300).start()}},{key:"showRetryButton",value:function(){this.retryButton.show(),this.retryButton.interactive=!0,this.retryButton.once("pointerdown",this.emitRetry,this)}},{key:"hide",value:function(){this.currentTween.stop(),this.currentTween=new qd(this).to({alpha:0},150).onComplete(this.bindedCompleteHideAnimation).start(),this.retryButton.hide(),this.reviveButton.hide(),this.bestScoreTween.stop()}},{key:"emitRetry",value:function(){window.famobi.showInterstitialAd({eventId:"button:result:restart",callback:()=>{this.emit(e.events.retry)}})}},{key:"completeHideAnimation",value:function(){this.visible=!1}}],i&&Li(n.prototype,i),e}($a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Um,"events",{readyToShowRetryButton:"readyToShowRetryButton",retry:"retry",revive:"revive"});const jm=Um;var Gm=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).enabled=!0,t.createChildren(),t.updateView(),t.interactive=!0,t.on("pointerdown",t.toggle,ji(t)),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ni(t,e)}(e,t);var n,i,r=Ui(e);return n=e,(i=[{key:"createChildren",value:function(){this.onStateIcon=new lp("ui/buttons/sound-on"),this.offStateIcon=new lp("ui/buttons/sound-off"),this.addChild(this.onStateIcon,this.offStateIcon)}},{key:"toggle",value:function(){this.enabled=!this.enabled,this.updateView(),this.emit(e.events.toggle,this.enabled)}},{key:"setState",value:function(t){this.enabled=!!t,this.updateView()}},{key:"updateView",value:function(){this.onStateIcon.visible=this.enabled,this.offStateIcon.visible=!this.enabled}}])&&Vi(n.prototype,i),e}($a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Gm,"events",{toggle:"toggle"});const Hm=Gm;var Wm=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gameController=e,this.bindedShowResults=this.showResults.bind(this),this.bindedHandleRewardedAdd=this.handleRewardedAdd.bind(this)}var e,n,i,r;return e=t,n=[{key:"init",value:function(){var e,n,i=$v.instance.platformApi;i.on(i.events.pauseRequested,this.pause,this),i.on(i.events.resumeRequested,this.resume,this),this.gameController.bestScore=i.localStorage.getItem(t.localStorageKeys.bestScore)||0,this.gameController.buildUI({BestScoreView:Nm,LoseScreen:jm,SoundButton:Hm}),this.gameController.gameWindow.soundButton.on(Hm.events.toggle,this.toggleSounds,this),window.dirty=this,window.famobi.onRequest("enableAudio",(function(){window.dirtyMute&&(window.dirtyMute=!1,dirty.toggleSounds())})),window.famobi.onRequest("disableAudio",(function(){window.dirtyMute||(window.dirtyMute=!0,dirty.toggleSounds())})),null!==(e=i.localStorage.getItem(t.localStorageKeys.muted))&&void 0!==e&&e&&this.gameController.gameWindow.soundButton.toggle(),this.gameController.observer.on(hg.events.addScore,this.handleAddScore,this),this.gameController.observer.on(hg.events.bestScore,this.handleSaveBestScore,this);var r=null!==(n=Number(i.localStorage.getItem(t.localStorageKeys.completedIntervals)))&&void 0!==n?n:0;this.gameController.gameMode.prepareToStart(r),this.gameController.gameMode.observer.on(fm.events.intervalComplete,this.handleCompleteInterval,this),this.start()}},{key:"start",value:function(){this.gameController.observer.once(hg.events.lose,this.showLoseScreen,this),this.gameController.observer.once(hg.events.startGame,this.logLevelStartEvent,this),this.gameController.start()}},{key:"logLevelStartEvent",value:function(){$v.instance.platformApi.levelStart("")}},{key:"pause",value:function(){$v.instance.pause("platform")}},{key:"resume",value:function(){$v.instance.resume("platform")}},{key:"handleAddScore",value:function(){this.gameController.gameWindow.currentScoreView.text=this.gameController.score,$v.instance.platformApi.updateScore(this.gameController.score)}},{key:"handleSaveBestScore",value:function(){this.gameController.gameWindow.bestScoreView.setScore(this.gameController.bestScore),$v.instance.platformApi.localStorage.setItem(t.localStorageKeys.bestScore,this.gameController.bestScore)}},{key:"handleCompleteInterval",value:function(e){$v.instance.platformApi.localStorage.setItem(t.localStorageKeys.completedIntervals,e)}},{key:"toggleSounds",value:function(){var e=$v.instance.platformApi.localStorage;this.gameController.toggleSounds(),Wd.enabled?e.removeItem(t.localStorageKeys.muted):e.setItem(t.localStorageKeys.muted,!0)}},{key:"showLoseScreen",value:function(){var t=$v.instance.platformApi.hasRewardedAd(),e=this.gameController.gameWindow.loseScreen,n=jm.events,i=n.readyToShowRetryButton,r=n.revive;e.once(i,this.handleLose,this),e.once(r,this.requestRewardedAdd,this),this.gameController.showLoseScreen(t)}},{key:"requestRewardedAdd",value:function(){$v.instance.platformApi.rewardedAd(this.bindedHandleRewardedAdd)}},{key:"handleRewardedAdd",value:function(t){if(t.rewardGranted){var e=this.gameController.gameWindow.loseScreen,n=jm.events.readyToShowRetryButton;e.off(n,this.handleLose,this),this.gameController.handleRevive(),this.gameController.hideLoseScreenAndShowBestScore(),this.gameController.gameWindow.wheelProgressBar.reset(),this.gameController.observer.once(hg.events.lose,this.showLoseScreen,this)}else this.gameController.gameWindow.loseScreen.hideReviveButton()}},{key:"handleLose",value:function(){var t=this.gameController.gameWindow.loseScreen,e=jm.events.revive;t.off(e,this.requestRewardedAdd,this);var n=$v.instance.platformApi;n.forcedLevelEnd(n.levelEndResultTypes.fail,this.gameController.score).then(this.bindedShowResults)}},{key:"showResults",value:function(){this.gameController.gameWindow.loseScreen.showBestScore(),new yp(2e3).once("finish",this.logLevelFailedEvent,this)}},{key:"logLevelFailedEvent",value:(i=regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.gameController.gameWindow.loseScreen,n=jm.events.retry,i=$v.instance.platformApi,t.next=5,i.levelFail("",i.reasonTypes.dead,this.gameController.score);case 5:e.once(n,this.handleRetry,this),this.gameController.gameWindow.loseScreen.showRetryButton();case 7:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,e=arguments;return new Promise((function(n,r){function o(t){Hi(a,n,r,o,s,"next",t)}function s(t){Hi(a,n,r,o,s,"throw",t)}var a=i.apply(t,e);o(void 0)}))},function(){return r.apply(this,arguments)})},{key:"handleRetry",value:function(){this.gameController.handleRetry(),this.gameController.hideLoseScreenAndShowBestScore(),this.gameController.gameWindow.currentScoreView.text=0,this.gameController.gameWindow.wheelProgressBar.reset(),this.start()}},{key:"tick",value:function(t){}}],n&&Wi(e.prototype,n),t}();!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(Wm,"localStorageKeys",{muted:"muted",bestScore:"bestScore",completedIntervals:"completedIntervals"});const Xm=Wm;var Ym=t(9842);const Zm=JSON.parse('{"0":[[{"rotation":0}],[{"rotation":0},{"rotation":3.14159}],[{"rotation":0},{"rotation":2.0944},{"rotation":4.1888}],[{"rotation":0},{"rotation":1.5708},{"rotation":3.14159},{"rotation":4.7124}]],"1":[[{"rotation":0}],[{"rotation":0},{"rotation":3.14159}],[{"rotation":0},{"rotation":2.0944},{"rotation":4.1888}],[{"rotation":0},{"rotation":1.5708},{"rotation":3.14159},{"rotation":4.7124}]],"2":[[{"rotation":0.7854,"theta":1.5708}],[{"rotation":0.7854,"theta":1.5708},{"rotation":3.927,"theta":1.5708}],[{"rotation":1.5708,"theta":3.14159}],[{"rotation":1.5708,"theta":2.47853},{"rotation":4.7124,"theta":2.47853}],[{"rotation":0.7854,"theta":4.7124}],[{"rotation":1.5708,"theta":2.6704},{"rotation":3.927,"theta":1.021},{"rotation":5.4978,"theta":1.021}],[{"rotation":0,"theta":0.3142},{"rotation":3.14159,"theta":0.3142}],[{"rotation":0,"theta":0.3142}]]}');var Qm=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=null,this.body=null,this.bodyPosition=null,this.rotationSpeed=0,this.boundingBox=null,this.tickBehavior=this.updateViewRotationBehavior}var e,n;return e=t,n=[{key:"activatePhysBody",value:function(){this.tickBehavior=this.updateViewAndBodyRotationBehavior,Ym.Composite.rotate(this.body,-this.view.rotation.y,this.bodyPosition)}},{key:"deactivatePhysBody",value:function(){this.tickBehavior=this.updateViewRotationBehavior}},{key:"updateViewRotationBehavior",value:function(t){var e=t*this.rotationSpeed;return this.view.rotation.y+=e,e}},{key:"updateViewAndBodyRotationBehavior",value:function(t){var e=this.updateViewRotationBehavior(t);Ym.Composite.rotate(this.body,-e,this.bodyPosition)}},{key:"updateBlankBehavior",value:function(t){}},{key:"playDestroyAnimation",value:function(){this.tickBehavior=this.updateBlankBehavior;var e=t.segmentsMaterial.clone(),n=t.cylinderMaterial.clone();e.transparent=!0,n.transparent=!0;var i=1;new yp(500).once("finish",this.hideAfterDestroyAnimation,this);var r,o=Xi(this.view.children);try{for(o.s();!(r=o.n()).done;){var s=r.value,a=(8*Math.random()+2)*i,l=5*Math.random();i*=-1,s.material===t.segmentsMaterial?s.material=e:s.material===t.cylinderMaterial&&(s.material=n),s.material&&new qd(s.material).to({opacity:0},475).start(),new qd(s).to({position:{x:(a<0?"":"+")+a,y:l,z:"-5"},rotation:{x:2*Math.random()-1,z:2*Math.random()-1}},500).start()}}catch(t){o.e(t)}finally{o.f()}}},{key:"hideAfterDestroyAnimation",value:function(){var t,e=Xi(this.view.children);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.material&&n.material.dispose()}}catch(t){e.e(t)}finally{e.f()}this.view.visible=!1}},{key:"tick",value:function(t){this.tickBehavior(t)}}],n&&Zi(e.prototype,n),t}();Qi(Qm,"physWorldScale",sm.hi),Qi(Qm,"rotationSpeedFactor",.001),Qi(Qm,"thickness",1),Qi(Qm,"cylinderRadius",1),Qi(Qm,"cylinderColor",16010059),Qi(Qm,"segmentsColor",3179263),Qi(Qm,"segmentsMaterial",new Ad.MeshStandardMaterial({color:Qm.segmentsColor})),Qi(Qm,"cylinderMaterial",new Ad.MeshStandardMaterial({color:Qm.cylinderColor})),Qi(Qm,"cylinderGeometry",new Ad.CylinderGeometry(Qm.cylinderRadius,Qm.cylinderRadius,1.25,14,1,!1));const Jm=Qm,Km=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.min={x:e.x-.5*n,z:e.z-.5*i},this.max={x:e.x+.5*n,z:e.z+.5*i}}var e,n;return e=t,(n=[{key:"containsPoint",value:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.z<this.min.z||t.z>this.max.z)}}])&&Ji(e.prototype,n),t}(),$m=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=r.call(this)).cylinder=null,i.rotationSpeed=t.rotationSpeed*Jm.rotationSpeedFactor||0,i.create(t,n),i}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&er(t,e)}(e,t);var n,i,r=nr(e);return n=e,(i=[{key:"create",value:function(t,e){this.body=Ym.Composite.create({label:"arc"}),this.view=new Ad.Group,this.cylinder=new Ad.Mesh(Jm.cylinderGeometry,Jm.cylinderMaterial),this.view.add(this.cylinder);var n,i=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.createSegment(t,r)}}catch(t){i.e(t)}finally{i.f()}this.boundingBox=new Km(t.position,2*t.radius,2*t.radius),this.view.position.set(t.position.x,0,t.position.z),this.bodyPosition=Ym.Vector.create(t.position.x*Jm.physWorldScale,t.position.z*Jm.physWorldScale),Ym.Composite.translate(this.body,this.bodyPosition)}},{key:"createSegment",value:function(t,e){var n=new Ad.Shape,i=Math.ceil(t.theta/(Math.PI/12));n.absarc(0,0,t.radius,.5*-t.theta,.5*t.theta),n.lineTo(0,0);var r=n.extractPoints(i).shape,o=Ym.Bodies.fromVertices(Ym.Vertices.centre(r).x*Jm.physWorldScale,0,r,{isStatic:!0}),s=new Ad.ExtrudeGeometry(n,{curveSegments:i,depth:Jm.thickness,bevelEnabled:!1,steps:1});s.translate(0,0,.5*-Jm.thickness),s.rotateX(.5*-Math.PI);var a=new Ad.Mesh(s,Jm.segmentsMaterial);a.rotation.y=e.rotation,Ym.Body.scale(o,Jm.physWorldScale,Jm.physWorldScale),Ym.Body.rotate(o,-1*e.rotation,Ym.Vector.create(0,0)),Ym.Composite.add(this.body,o),this.view.add(a)}}])&&tr(n.prototype,i),e}(Jm);var tg=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=r.call(this)).rotationSpeed=t.rotationSpeed*Jm.rotationSpeedFactor||0,i.create(t,n),i}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ar(t,e)}(e,t);var n,i,r=lr(e);return n=e,(i=[{key:"create",value:function(t,e){this.body=Ym.Composite.create({label:"circle"}),this.view=new Ad.Group;var n,i=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return or(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?or(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.createSegment(t,r)}}catch(t){i.e(t)}finally{i.f()}this.view.position.set(t.position.x,0,t.position.z),this.bodyPosition=Ym.Vector.create(t.position.x*Jm.physWorldScale,t.position.z*Jm.physWorldScale),this.boundingBox=new Km(t.position,2*t.radius,2*t.radius),Ym.Composite.translate(this.body,this.bodyPosition)}},{key:"createSegment",value:function(t,n){var i=new Ad.Shape,r=Math.ceil(n.theta/(Math.PI/12));i.absarc(0,0,t.radius-e.lineWeight,.5*-n.theta,.5*n.theta),i.absarc(0,0,t.radius,.5*n.theta,.5*-n.theta,!0);var o=i.extractPoints(r).shape,s=Ym.Bodies.fromVertices(Ym.Vertices.centre(o).x*Jm.physWorldScale,0,o,{isStatic:!0},!1,.01,.02),a=new Ad.ExtrudeGeometry(i,{curveSegments:r,depth:Jm.thickness,bevelEnabled:!1,steps:1});a.rotateX(.5*-Math.PI),a.translate(0,.5*-Jm.thickness,0);var l=new Ad.Mesh(a,Jm.segmentsMaterial);l.rotation.y=n.rotation,Ym.Body.scale(s,Jm.physWorldScale,Jm.physWorldScale),Ym.Body.rotate(s,-1*n.rotation,Ym.Vector.create(0,0)),Ym.Composite.add(this.body,s),this.view.add(l)}}])&&sr(n.prototype,i),e}(Jm);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:.6,enumerable:!0,configurable:!0,writable:!0}):t[e]=.6}(tg,"lineWeight");const eg=tg;var ng=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=r.call(this)).cylinder=null,i.rotationSpeed=t.rotationSpeed*Jm.rotationSpeedFactor||0,i.create(t,n),i}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pr(t,e)}(e,t);var n,i,r=fr(e);return n=e,(i=[{key:"create",value:function(t,e){this.body=Ym.Composite.create({label:"rectangle"}),this.view=new Ad.Group,this.cylinder=new Ad.Mesh(Jm.cylinderGeometry,Jm.cylinderMaterial),this.view.add(this.cylinder);var n,i=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return hr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=Ym.Bodies.rectangle(.5*t.width*Jm.physWorldScale,0,t.width*Jm.physWorldScale,t.height*Jm.physWorldScale,{isStatic:!0}),s=new Ad.BoxGeometry(t.width,Jm.thickness,t.height),a=new Ad.Mesh(s,Jm.segmentsMaterial);a.position.x+=.5*t.width,a.position.applyAxisAngle(Ad.Object3D.DefaultUp,r.rotation),a.rotation.y=r.rotation,Ym.Body.rotate(o,-1*r.rotation,Ym.Vector.create(0,0)),Ym.Composite.add(this.body,o),this.view.add(a)}}catch(t){i.e(t)}finally{i.f()}var l=2*Math.max(t.width,t.height);this.boundingBox=new Km(t.position,l,l),this.view.position.set(t.position.x,0,t.position.z),this.bodyPosition=Ym.Vector.create(t.position.x*Jm.physWorldScale,t.position.z*Jm.physWorldScale),Ym.Composite.translate(this.body,this.bodyPosition)}}])&&dr(n.prototype,i),e}(Jm);const ig=ng;var rg={};rg[0]=ig,rg[1]=$m,rg[2]=eg;var og=t(7563),sg=function(t){function e(t,n,i,r){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=o.call(this)).road=null,s.roadBack=null,s.mainGrass=null,s.sideGrass=null,s.obstacles=[],s.bodiesLookupTable={},s.indicators=[],s.curve=null,s.curveLength=0,s.geometrySteps=0,s.firstCurvePoint=null,s.lastCurvePoint=null,s.difficulty=i,s.isUseSubstractionBlocks=!!t.blocks.length,s.debugInfo={key:r,obstaclesGroupName:""},s.blocksBoundingBoxes=[],s.decorationsBoundingBoxes=[],s.frenetFrames=null,s.extrudePoints=null,s.createRoad(t.path,t.blocks,n),s.createObstacles(t.obstaclesGroups[i]),s}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_r(t,e)}(e,t);var n,i,r,o=wr(e);return n=e,i=[{key:"createRoad",value:function(t,e,n){var i=this.generateCurve(t),r=new Ad.CatmullRomCurve3(i);this.curve=r,this.curveLength=r.getLength(),this.geometrySteps=Math.floor(.77*this.curveLength),this.firstCurvePoint=r.getPointAt(0),this.lastCurvePoint=r.getPointAt(1);var o,s=yr(e);try{for(s.s();!(o=s.n()).done;){var a=o.value;this.blocksBoundingBoxes.push(new Km(new Ad.Vector3(a.x,0,a.z),3,3))}}catch(t){s.e(t)}finally{s.f()}gm.add(r,this.geometrySteps,(new Ad.Vector3).copy(n),e,this)}},{key:"handleGenerationComplete",value:function(t){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}}(t,e)||vr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,3),i=n[0],r=n[1],o=n[2];console.log("vertices amount: ",i.geometry.attributes.position.count+o.geometry.attributes.position.count+r.geometry.attributes.position.count),console.log("mainGrass: "+i.geometry.attributes.position.count),console.log("middleGrass: "+r.geometry.attributes.position.count),console.log("sideGrass: "+o.geometry.attributes.position.count),this.add(i,r,o),this.road=r,this.mainGrass=i,this.sideGrass=o,this.dispatchEvent({type:e.events.generationComplete})}},{key:"generateCurve",value:function(t){var n=[],i=e.connectionLength/2,r=t.length;n.push(new Ad.Vector3(t[0].x,0,t[0].z-0*i)),n.push(new Ad.Vector3(t[0].x,0,t[0].z-1*i));for(var o=0;o<r;o++)n.push(new Ad.Vector3(t[o].x,0,t[o].z-2*i));return n.push(new Ad.Vector3(t[r-1].x,0,t[r-1].z-3*i)),n.push(new Ad.Vector3(t[r-1].x,0,t[r-1].z-4*i)),n}},{key:"createObstacles",value:function(t){var n=Math.floor(Math.random()*t.length);og.parse(location.search).group&&(n=t.findIndex((function(t){var e=t.name;return og.parse(location.search).group==e}))),-1==n&&(n=0);var i=t[n],r=i.obstacles;this.debugInfo.obstaclesGroupName=i.name;var o,s=yr(r);try{for(s.s();!(o=s.n()).done;){var a=o.value,l=this.createObstacle(a);this.obstacles.push(l),this.indicators.push(a.indicatorPosition);var u,c=yr(Ym.Composite.allBodies(l.body));try{for(c.s();!(u=c.n()).done;){var h=u.value;this.bodiesLookupTable[h.id]=l}}catch(t){c.e(t)}finally{c.f()}}}catch(t){s.e(t)}finally{s.f()}this.indicators.sort(e.sortIndicators)}},{key:"createObstacle",value:function(t){var e=function(t){return new(0,rg[t.type])(t,Zm[t.type][t.segmentsConfigId])}(t);return e.view.position.y=1.5,this.add(e.view),e}},{key:"handleCreateDecorations",value:function(t,n){var i=sm.h5,r=new Ad.Vector3,o=new Ad.Vector3,s=0,a=-1,l=Am.generateNext(),u=l,c=u.decoration,h=u.shadow,d=Am.decorationSizes[c.name],p=3-.5*d,f=.5+.5*d;for(this.frenetFrames=t,this.extrudePoints=n;s<this.curveLength;){var m=Math.min(t.binormals.length-1,Math.floor(s/this.curveLength*(t.binormals.length-1))),g=Math.random()*(p-f)+f;g*=a,o.copy(t.binormals[m]).multiplyScalar(g),r.copy(n[m]).add(o),r.y=1;var y=e.checkIntersectionWithObstacles(r,this.obstacles);y||(y=e.checkIntersectionWithBoundingBoxes(r,this.decorationsBoundingBoxes)),y||(y=e.checkIntersectionWithBoundingBoxes(r,this.blocksBoundingBoxes)),y||(c.scale.setScalar(.01),c.position.copy(r),c.rotation.y=Math.random()*Math.PI*2,this.add(c),h&&(h.position.copy(r).add(Am.shadowOffset),h.rotation.y=c.rotation.y,this.add(h)),this.decorationsBoundingBoxes.push(new Km(r,d,d)),c=(l=Am.generateNext()).decoration,h=l.shadow,p=3-.5*(d=Am.decorationSizes[c.name]),f=.5+.5*d),s+=i,a*=-1}}},{key:"handleCreateGrass",value:function(){for(var t=sm.AI,n=new Ad.Vector3,i=new Ad.Vector3,r=0,o=-1;r<this.curveLength;){var s=Math.min(this.frenetFrames.binormals.length-1,Math.floor(r/this.curveLength*(this.frenetFrames.binormals.length-1))),a=1.9*Math.random()+.8;if(a*=o,i.copy(this.frenetFrames.binormals[s]).multiplyScalar(a),n.copy(this.extrudePoints[s]).add(i),n.y=1,!e.checkIntersectionWithBoundingBoxes(n,this.blocksBoundingBoxes)){var l=rp("grass");l.scale.setScalar(.02),l.position.copy(n),l.rotation.y=Math.random()*Math.PI*2,this.add(l)}r+=t,o*=-1}this.frenetFrames=null,this.extrudePoints=null}},{key:"updateRoadMaterialUniforms",value:function(t){return this.road.material.uniforms.currentPoint.value=t*this.geometrySteps}},{key:"onStart",value:function(){this.road.material=tm.middleMaterials.current,this.isUseSubstractionBlocks&&this.addRoadBack()}},{key:"onEnd",value:function(){this.road.material=tm.middleMaterials.previous,this.isUseSubstractionBlocks&&this.removeRoadBack()}},{key:"addRoadBack",value:function(){this.road.renderOrder=1,this.roadBack=this.road.clone(),this.roadBack.material=tm.middleMaterials.previous,this.roadBack.renderOrder=0,this.add(this.roadBack)}},{key:"removeRoadBack",value:function(){this.remove(this.roadBack),this.roadBack=null}},{key:"tick",value:function(t){var e,n=yr(this.obstacles);try{for(n.s();!(e=n.n()).done;)e.value.tick(t)}catch(t){n.e(t)}finally{n.f()}}},{key:"destroy",value:function(){}}],r=[{key:"sortIndicators",value:function(t,e){return t-e}},{key:"checkIntersectionWithBoundingBoxes",value:function(t,e){var n,i=!1,r=yr(e);try{for(r.s();!(n=r.n()).done&&!(i=n.value.containsPoint(t)););}catch(t){r.e(t)}finally{r.f()}return i}},{key:"checkIntersectionWithObstacles",value:function(t,e){var n,i=!1,r=yr(e);try{for(r.s();!(n=r.n()).done&&!(i=n.value.boundingBox.containsPoint(t)););}catch(t){r.e(t)}finally{r.f()}return i}}],i&&br(n.prototype,i),r&&br(n,r),e}(Ad.Group);Ar(sg,"events",{generationComplete:"generationComplete"}),Ar(sg,"connectionLength",2);const ag=sg;var lg=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"subscribe",value:function(){var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Mr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(t.usedKeys);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.pressedKeys[i]=!1}}catch(t){n.e(t)}finally{n.f()}t.source.addEventListener("keydown",t.onKeyDown),t.source.addEventListener("keyup",t.onKeyUp)}},{key:"unsubscribe",value:function(){t.source.removeEventListener("keydown",t.onKeyDown),t.source.removeEventListener("keyup",t.onKeyUp)}},{key:"onKeyDown",value:function(e){-1!==t.usedKeys.indexOf(e.code)&&!0!==t.pressedKeys[e.code]&&(t.pressedKeys[e.code]=!0,t.pressedKeysAmount+=1,t.observer.emit(t.events.start))}},{key:"onKeyUp",value:function(e){-1!==t.usedKeys.indexOf(e.code)&&(t.pressedKeys[e.code]=!1,t.pressedKeysAmount-=1,t.pressedKeysAmount>0||t.observer.emit(t.events.stop))}}],null&&Tr(e.prototype,null),n&&Tr(e,n),t}();Er(lg,"source",document),Er(lg,"observer",new(Td())),Er(lg,"usedKeys",["KeyW","Space","ArrowUp"]),Er(lg,"events",{start:"start",stop:"stop"}),Er(lg,"pressedKeys",{}),Er(lg,"pressedKeysAmount",0);const ug=lg;var cg=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).gameWindow=new qm,t.gameScene=new wm,t.gameMode=new dg(Dr(t)),t.platform=new Xm(Dr(t)),t.warningSubscribed=!1,t.score=0,t.bestScore=0,t.scoreInterval=sm.qO,t.observer=new(Td()),t.chunks=[],t.matterEngine=Ym.Engine.create({positionIterations:0,velocityIterations:0,constraintIterations:0,gravity:{x:0,y:0}}),t.player=null,t.playerLocalDistance=0,t.playerLocalProgress=0,t.enemyControlDistance=sm.pH.DB,t.enemyLocalDistance=0,t.enemyDistance=sm.pH.$o,t.enemyDistanceSpawnOffset=0,t.warningHided=!0,t.enemy=null,t.enemyStarted=!1,t.chunkIndex=0,t.enemyChunkIndex=0,t.gameStarted=!1,t.playerImmortalityEnabled=!1,t.bindedHandleLose=t.handleLose.bind(Dr(t)),jd.on("resize",t.handleResize,Dr(t)),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qr(t,e)}(e,t);var n,i,r=Lr(e);return n=e,i=[{key:"init",value:function(){console.log("controller init"),this.player=new Cg,this.enemy=new Ig,this.gameWindow.init(),this.gameScene.init(),this.gameMode.init(),ug.subscribe(),$v.instance.showWindow(this.gameWindow),$v.instance.showScene(this.gameScene),this.gameScene.addPlayer(this.player.view),Ym.Composite.add(this.matterEngine.world,this.player.body),this.gameScene.add(this.enemy.view),this.crurrentChunk=this.chunks[0],this.platform.init()}},{key:"buildUI",value:function(t){this.gameWindow.buildUI(t),this.gameWindow.bestScoreView.setScore(this.bestScore)}},{key:"start",value:function(){this.subscribeOnFirstInteraction(),this.turnControlsListeners("on")}},{key:"subscribeOnFirstInteraction",value:function(){this.gameWindow.once("start",this.startGame,this),ug.observer.once(ug.events.start,this.startGame,this)}},{key:"turnControlsListeners",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"off";this.gameWindow[t](qm.events.start,this.handlePlayerStart,this),this.gameWindow[t](qm.events.stop,this.handlePlayerStop,this),ug.observer[t](ug.events.start,this.handlePlayerStart,this),ug.observer[t](ug.events.stop,this.handlePlayerStop,this)}},{key:"startGame",value:function(){ug.observer.off(ug.events.start,this.startGame,this),this.gameWindow.off(qm.events.start,this.startGame,this),this.observer.once(e.events.catch,this.handleLose,this),Ym.Events.on(this.matterEngine,"collisionStart",this.bindedHandleLose),this.gameStarted=!0,this.player.engineSound.play(),this.score=0,this.gameWindow.tutorial.hide(),this.subscribeToShowWarning(),this.warningSubscribed=!0,this.observer.emit(e.events.startGame)}},{key:"toggleSounds",value:function(){Wd.enabled=!Wd.enabled,!0===Wd.enabled?Wd.soundsOn():Wd.soundsOff()}},{key:"handlePlayerStart",value:function(){this.player.start()}},{key:"handlePlayerStop",value:function(){this.player.stop()}},{key:"toggleWarningSubscription",value:function(){this.warningSubscribed=!this.warningSubscribed,this.warningSubscribed?this.subscribeToHideWarning():this.subscribeToShowWarning()}},{key:"subscribeToShowWarning",value:function(){this.observer.off(e.events.hideWarning,this.hideWarningEffect,this),this.observer.on(e.events.showWarning,this.showWarningEffect,this)}},{key:"subscribeToHideWarning",value:function(){this.observer.on(e.events.hideWarning,this.hideWarningEffect,this),this.observer.off(e.events.showWarning,this.showWarningEffect,this)}},{key:"unsubscribeFromWarinig",value:function(){this.observer.off(e.events.hideWarning,this.hideWarningEffect,this),this.observer.off(e.events.showWarning,this.showWarningEffect,this),this.warningSubscribed=!1}},{key:"showWarningEffect",value:function(){this.toggleWarningSubscription(),this.gameMode.showWarningEffect()}},{key:"hideWarningEffect",value:function(){this.toggleWarningSubscription(),this.gameMode.hideWarningEffect()}},{key:"handleCompleteInterval",value:function(t){this.gameWindow.scoreAnimation.spawnScore(t),this.addScore(t)}},{key:"handleBeatObstacle",value:function(t){this.gameWindow.scoreAnimation.spawnScore(t),this.addScore(t)}},{key:"addScore",value:function(t){this.score+=t,this.score>this.bestScore&&(this.bestScore=this.score,this.observer.emit(e.events.bestScore)),this.observer.emit(e.events.addScore)}},{key:"handleLose",value:function(t){if(this.playerImmortalityEnabled){var n=t.pairs[0],i=n.bodyA.id===this.player.body.id?n.bodyB:n.bodyA,r=this.chunks[this.chunkIndex].bodiesLookupTable[i.parent.id];return r.playDestroyAnimation(),this.removeObstacleFromMatterEngine(r),void Wd.playSingle("obstacle-break",!1,.85)}Wd.play("mower-crush"),Ym.Events.off(this.matterEngine,"collisionStart",this.bindedHandleLose),this.observer.off(e.events.catch,this.handleLose,this),this.setBrokenPlayerView(),this.turnControlsListeners("off"),this.handlePlayerStop(),this.unsubscribeFromWarinig(),this.hideWarningEffect(),this.player.engineSound.stop(),new yp(sm.IT).once("finish",this.handleDestroyAnimationComplete,this)}},{key:"handleDestroyAnimationComplete",value:function(){this.observer.emit(e.events.lose)}},{key:"showLoseScreen",value:function(t){this.gameWindow.loseScreen.show(Math.floor(this.bestScore),t),Wd.play("lose-screen",!1,.9),this.gameWindow.bestScoreView.visible=!1}},{key:"handleRetry",value:function(){this.gameMode.retry(),this.gameStarted=!1}},{key:"hideLoseScreenAndShowBestScore",value:function(){this.gameWindow.loseScreen.hide(),this.gameWindow.bestScoreView.visible=!0}},{key:"handleRevive",value:function(){this.player.playReplairAnimation(),this.hideWarning(),this.resetEnemy(),new yp(500).once("finish",this.resumeGameAfterReviveAnimation,this),Wd.play("sheild")}},{key:"resumeGameAfterReviveAnimation",value:function(){this.turnControlsListeners("on"),this.subscribeToShowWarning(),this.gameMode.handleRevive(),this.warningSubscribed=!0,this.observer.once(e.events.catch,this.handleLose,this),Ym.Events.on(this.matterEngine,"collisionStart",this.bindedHandleLose),this.setPlayerImmortal(sm.e8),this.player.engineSound.play()}},{key:"createChunks",value:function(t){var e,n=Cr(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.createChunks(i)}}catch(t){n.e(t)}finally{n.f()}}},{key:"createChunk",value:function(t){var n=new ag(t.chunkConfig,e.chunkOffset,t.difficulty,t.key),i=n.lastCurvePoint,r=n.firstCurvePoint;n.position.x=e.chunkOffset.x-r.x,n.position.z=e.chunkOffset.z,e.chunkOffset.x=n.position.x+i.x,e.chunkOffset.z=n.position.z+i.z,this.chunks.push(n),this.gameScene.add(n)}},{key:"setBrokenPlayerView",value:function(){this.player.brokenView.position.copy(this.player.view.position),this.player.brokenView.position.y+=.2,this.player.brokenView.rotation.y=this.player.view.rotation.y,this.player.playDestroyAnimation(),this.gameScene.add(this.player.brokenView),this.gameScene.remove(this.player.view)}},{key:"setNormalPlayerView",value:function(){this.gameScene.remove(this.player.brokenView),this.gameScene.add(this.player.view)}},{key:"setInitialValues",value:function(){this.setNormalPlayerView(),this.hideWarning(),this.resetEnemy(),this.playerStarted=!1,this.playerLocalDistance=0,this.playerLocalProgress=0,e.chunkOffset.set(0,0,0)}},{key:"setPlayerImmortal",value:function(t){this.playerImmortalityEnabled=!0,new yp(t).once("complete",this.disableImmortality,this),this.player.shield.show()}},{key:"disableImmortality",value:function(){this.playerImmortalityEnabled=!1}},{key:"setEnemyBehindPlayer",value:function(){for(var t=this.playerLocalDistance,e=0;e<=this.chunkIndex;e++)t+=this.chunks[e].curveLength;for(this.enemyDistance=Math.min(t,sm.pH.$o+this.enemyDistanceSpawnOffset),this.enemyLocalDistance=this.playerLocalDistance-this.enemyDistance,this.enemyChunkIndex=this.chunkIndex;this.enemyLocalDistance<0;)this.enemyChunkIndex-=1,this.enemyChunkIndex<0?(this.enemyChunkIndex=0,this.enemyLocalDistance=0):this.enemyLocalDistance=this.chunks[this.enemyChunkIndex].curveLength+this.enemyLocalDistance}},{key:"resetEnemy",value:function(){this.enemy.resetView(),this.enemyDistance=sm.pH.$o,this.enemyControlDistance=sm.pH.DB,this.enemyStarted=!1}},{key:"removeObstaclesFromMatterEngine",value:function(t){var e,n=Cr(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.removeObstacleFromMatterEngine(i)}}catch(t){n.e(t)}finally{n.f()}}},{key:"removeObstacleFromMatterEngine",value:function(t){Ym.Composite.remove(this.matterEngine.world,t.body),t.deactivatePhysBody()}},{key:"handleMoveToNextChunk",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.chunks[this.chunkIndex].onStart();var i,r=Cr(this.chunks[this.chunkIndex].obstacles);try{for(r.s();!(i=r.n()).done;){var o=i.value;Ym.Composite.add(this.matterEngine.world,o.body),o.activatePhysBody()}}catch(t){r.e(t)}finally{r.f()}for(var s=0,a=0;a<t;a++){var l=this.chunkIndex-(a+1),u=this.chunks[l];u.onEnd(),this.removeObstaclesFromMatterEngine(u.obstacles),s+=sm.lD[u.difficulty]*u.indicators.length}s>0&&!n&&this.handleBeatObstacle(s),this.observer.emit(e.events.nextChunk)}},{key:"checkPlayerLocalProgress",value:function(){for(var t=sm.pH.$o-this.playerLocalDistance,e=0;e<=this.chunkIndex;e++)t-=this.chunks[e].curveLength;return t<0}},{key:"checkFirstChunkIndex",value:function(){return this.chunkIndex>0}},{key:"checkSecondChunkPosition",value:function(){var t=this.chunks[1];return t.position.z+t.lastCurvePoint.z>this.gameScene.sceneBounds.bottom+this.gameScene.camera.position.z}},{key:"checkLastChunkPosition",value:function(){return this.chunks[this.chunks.length-1].position.z>this.gameScene.sceneBounds.top+this.gameScene.camera.position.z}},{key:"shiftChunk",value:function(){var t=this.chunks.shift();return this.chunkIndex-=1,this.enemyChunkIndex-=1,this.gameScene.remove(t),t}},{key:"updatePlayer",value:function(t){var e=t*this.player.speed;this.playerLocalDistance+=e,this.scoreInterval-=e,this.enemyDistance+=e,this.enemyControlDistance=Math.min(this.enemyControlDistance+e,sm.pH.DB);for(var n=0;this.playerLocalDistance>=this.chunks[this.chunkIndex+n].curveLength;)this.playerLocalDistance-=this.chunks[this.chunkIndex+n].curveLength,n+=1;this.chunkIndex+=n;var i=this.chunks[this.chunkIndex],r=this.playerLocalDistance/i.curveLength,o=i.curve.getPointAt(r),s=o.clone().add(i.position),a=i.curve.getTangentAt(r);if(this.playerLocalProgress=r,this.player.setPosition(s,o,a),n>0&&this.handleMoveToNextChunk(n),i.updateRoadMaterialUniforms(r+1),this.scoreInterval<=0){var l=sm.DX;this.scoreInterval+=sm.qO,this.handleCompleteInterval(l)}}},{key:"checkNextIndicator",value:function(){var t=this.chunks[this.chunkIndex];if(!(t.indicators.length<=0)){var e=t.indicators[0];if(this.playerLocalProgress>e){var n=sm.lD[t.difficulty];t.indicators.shift(),this.handleBeatObstacle(n)}}}},{key:"startEnemy",value:function(){this.enemyStarted=!0,this.warningHided=!1,this.setEnemyBehindPlayer(),this.enemy.needsCheckVisibilityOnSpawn=!0,this.enemy.isOutOfScene=!1,this.enemy.view.children[0].material.opacity=0,this.updateEnemyPosition(),this.observer.emit(e.events.showWarning)}},{key:"hideWarning",value:function(){this.warningHided=!0,this.enemyControlDistance=0,this.enemyDistanceSpawnOffset=0,this.observer.emit(e.events.hideWarning)}},{key:"updateEnemy",value:function(t){var n=this.enemy.view.children[0];n.rotation.x-=this.enemy.rotationSpeed*t;var i=t*this.enemy.speed;this.enemyLocalDistance+=i,this.enemyDistance-=i;for(var r=0;this.enemyChunkIndex+r<this.chunks.length&&this.enemyLocalDistance>=this.chunks[this.enemyChunkIndex+r].curveLength;)this.enemyLocalDistance-=this.chunks[this.enemyChunkIndex+r].curveLength,r+=1;this.enemyChunkIndex+=r,n.material.opacity=1,this.updateEnemyPosition(),this.enemyDistance>sm.pH.$o+this.enemyDistanceSpawnOffset?(this.warningHided||this.hideWarning(),this.enemyStarted=!this.enemy.isOutOfScene,this.enemyStarted||(n.material.opacity=0)):this.enemyDistance<=2&&this.observer.emit(e.events.catch)}},{key:"updateEnemyPosition",value:function(){var t=this.chunks[this.enemyChunkIndex];if(t){var e=this.enemyLocalDistance/t.curveLength,n=t.curve.getPointAt(e).add(t.position),i=t.curve.getTangentAt(e),r=-Math.atan2(-i.z,-i.x)+.5*Math.PI;this.enemy.view.position.copy(n),this.enemy.view.rotation.y=r,this.enemy.view.position.y=1.5}}},{key:"updateProgressBar",value:function(t){if(this.warningHided){var e=this.enemyControlDistance/sm.pH.DB;this.gameWindow.wheelProgressBar.updateWheelDistanceImitation(Math.min(1,Math.max(0,1-e)))}else if(this.enemy.needsCheckVisibilityOnSpawn)this.gameWindow.wheelProgressBar.updateTransitionState(this.enemy.speed*t/this.enemyDistance);else{var n=this.enemyDistance/(sm.pH.$o+this.enemyDistanceSpawnOffset);this.gameWindow.wheelProgressBar.updateProgress(Math.min(1,Math.max(0,1-n)))}}},{key:"handleResize",value:function(){this.gameScene.syncCamera(this.player.view.position),this.gameScene.syncBack(this.player.view.position)}},{key:"tick",value:function(t){Or(zr(e.prototype),"tick",this).call(this),this.gameMode.tick(t),this.platform.tick(t),this.updateProgressBar(t);var n,i=Cr(this.chunks);try{for(i.s();!(n=i.n()).done;)n.value.tick(t)}catch(t){i.e(t)}finally{i.f()}!1!==this.gameStarted&&(this.player.updateSpeed(t),this.player.speed>0&&(this.updatePlayer(t),this.gameScene.syncCamera(this.player.view.position),this.gameScene.syncBack(this.player.view.position),this.gameScene.syncLight(),this.checkLastChunkPosition()&&this.observer.emit(e.events.newChunk),this.checkNextIndicator()),Ym.Engine.update(this.matterEngine,t),this.enemyControlDistance-=t*this.enemy.speed,this.warningHided&&this.enemyControlDistance<=0&&this.startEnemy(),this.enemyStarted&&(this.enemy.needsCheckVisibilityOnSpawn&&!this.enemy.isOutOfScene?(this.enemyDistanceSpawnOffset+=1,this.setEnemyBehindPlayer(),this.updateEnemyPosition()):(this.enemy.needsCheckVisibilityOnSpawn=!1,this.updateEnemy(t))),this.checkFirstChunkIndex()&&this.checkPlayerLocalProgress()&&this.checkSecondChunkPosition()&&this.shiftChunk(),this.enemy.isOutOfScene=!0)}}],i&&Rr(n.prototype,i),e}(Em);kr(cg,"chunkOffset",new Ad.Vector3(0,0,0)),kr(cg,"events",{nextChunk:"nextChunk",newChunk:"newChunk",showWarning:"showWarning",hideWarning:"hideWarning",catch:"catch",lose:"lose",addScore:"addScore",bestScore:"bestScore",startGame:"startGame"});const hg=cg,dg=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=r.call(this,t)).completedChunks=0,n.warningContainer=null,n.leafsEffect=null,n.warningSign=null,n}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ur(t,e)}(e,t);var n,i,r=jr(e);return n=e,(i=[{key:"createChildren",value:function(){this.warningContainer=new $a,this.leafsEffect=new nm(this.warningContainer),this.warningSign=new lp("warning"),this.warningSign.alpha=0,this.warningSignTween=new qd(this.warningSign).to({alpha:1},300).yoyo(!0).repeat(6)}},{key:"init",value:function(){Nr(Gr(e.prototype),"init",this).call(this),this.createChildren(),this.handleResize(),Tm.init(),tm.init(),Am.init(),this.gameController.gameWindow.addChild(this.warningContainer,this.warningSign),this.gameController.gameScene.add(this.gameController.player.particlesEffect.container),this.gameController.gameScene.add(this.gameController.player.smokeEffectContainer)}},{key:"prepareToStart",value:function(t){Nr(Gr(e.prototype),"prepareToStart",this).call(this,t),this.completedChunks=t,dm.setupWeights(sm.fw,this.completedChunks),this.createStartChunks(),this.gameController.observer.once(hg.events.nextChunk,this.handleCompleteEmptyChunk,this)}},{key:"createStartChunks",value:function(){this.gameController.observer.on(hg.events.newChunk,this.handleNewChunk,this);var t=dm.generateNext();this.gameController.createChunk(t),t=dm.generateEmptyChunk(),this.gameController.createChunk(t),gm.processAll();var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Fr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(this.gameController.chunks[0].obstacles);try{for(n.s();!(e=n.n()).done;)e.value.view.visible=!1}catch(t){n.e(t)}finally{n.f()}for(this.gameController.chunkIndex=1,this.gameController.handleMoveToNextChunk(1,!0),this.gameController.updatePlayer(0),this.gameController.enemyLocalDistance=this.gameController.chunks[0].curveLength-this.gameController.enemyDistance,this.gameController.enemyChunkIndex=0,this.gameController.updateEnemy(0),this.gameController.gameScene.syncCamera(this.gameController.player.view.position),this.gameController.gameScene.syncBack(this.gameController.player.view.position),this.gameController.gameScene.syncLight();this.gameController.checkLastChunkPosition();)t=dm.generateNext(),this.gameController.createChunk(t);gm.processAll()}},{key:"handleNewChunk",value:function(){this.gameController.createChunk(dm.generateNext())}},{key:"handleCompleteEmptyChunk",value:function(){this.gameController.observer.on(hg.events.nextChunk,this.handleCompleteChunk,this)}},{key:"handleCompleteChunk",value:function(){this.completedChunks+=1,this.observer.emit(fm.events.intervalComplete,this.completedChunks)}},{key:"showWarningEffect",value:function(){this.leafsEffect.show(),this.warningSignTween.start(),Wd.playSingle("leaves-wind",!1,.85)}},{key:"hideWarningEffect",value:function(){this.warningSignTween.stop(),this.warningSign.alpha=0,this.leafsEffect.hide()}},{key:"handleResize",value:function(){Nr(Gr(e.prototype),"handleResize",this).call(this);var t=jd.gameWidth,n=jd.gameHeight;this.leafsEffect.resize(),this.warningContainer.position.set(.5*-t,.5*n-this.leafsEffect.spawnZone.height),this.warningSign.scale.set(1),this.warningSign.scale.set(Math.min(.3*t/this.warningSign.width,.1*n/this.warningSign.height)),this.warningSign.position.y=this.warningContainer.position.y-.5*this.warningSign.height}},{key:"retry",value:function(){for(var t=this.gameController.chunks;t.length>0;){var e=this.gameController.shiftChunk();this.gameController.removeObstaclesFromMatterEngine(e.obstacles)}this.gameController.observer.off(hg.events.nextChunk,this.handleCompleteEmptyChunk,this),this.gameController.observer.off(hg.events.nextChunk,this.handleCompleteChunk,this),this.gameController.setInitialValues(),this.gameController.gameScene.setCameraFromConfig(),this.prepareToStart(this.completedChunks)}},{key:"handleRevive",value:function(){this.gameController.setNormalPlayerView()}},{key:"tick",value:function(t){tm.next()}}])&&Vr(n.prototype,i),e}(fm);var pg=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=r.call(this,t,n),e.body.geometry.rotateX(.5*Math.PI),i.container=new Ad.Group,i.emitter=null,i.pointA=null,i.pointB=null,i.lineZonePosition=null,i.velocityInitialize=null,i.lifeInitialize=null,i.bindedRotateParticle=i.rotateParticle.bind(Qr(i)),i.createEmitter(),i.createRenderer(),i}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yr(t,e)}(e,t);var n,i,r=Zr(e);return n=e,(i=[{key:"createEmitter",value:function(){this.emitter=new(dp().Emitter)(this),this.emitter.p.y=.36,this.addEventListener("PARTICLE_CREATED",this.bindedRotateParticle),this.emitter.rate=new(dp().Rate)(5,.07),this.addEmitter(this.emitter),this.lifeInitialize=new(dp().Life)(e.lifetimeInitValue,e.lifetimeInitValue+e.lifetimeRandomValue),this.emitter.addInitialize(this.lifeInitialize),this.velocityInitialize=new(dp().Velocity)(e.velocityInitValue,new(dp().Vector3D)(1.5,.34,0),30),this.emitter.addInitialize(this.velocityInitialize);var t=rp("grass-particle-1").getObjectByName("grass-particle-1"),n=rp("grass-particle-2").getObjectByName("grass-particle-2");t.material.side=Ad.DoubleSide,n.material.side=Ad.DoubleSide,this.emitter.addInitialize(new(dp().Body)([t,e.body,n])),this.pointA={x:.54,z:-.4},this.pointB={x:.54,z:0},this.lineZonePosition=new(dp().LineZone)(this.pointA.x,0,this.pointA.z,this.pointB.x,0,this.pointB.z),this.emitter.addInitialize(new(dp().Position)(this.lineZonePosition)),this.emitter.addBehaviour(new(dp().Gravity)(.08,1/0,dp().easeLinear)),this.emitter.addBehaviour(new(dp().Color)("#107d2e","#50e21b",1/0,dp().easeLinear)),this.emitter.addBehaviour(new(dp().Scale)(.6,1.2,1/0,dp().easeLinear))}},{key:"createRenderer",value:function(){this.renderer=new(dp().MeshRender)(this.container),this.renderer.particlesBlendMode=Ad.NormalBlending,this.addRender(this.renderer)}},{key:"updatePositionAndRotation",value:function(t,n,i){var r=Math.cos(-n),o=Math.sin(-n);this.emitter.p.x=t.x,this.emitter.p.z=t.z,this.emitter.rotation.y=n,this.lineZonePosition.x1=this.pointA.x*r-this.pointA.z*o,this.lineZonePosition.x2=this.pointB.x*r-this.pointB.z*o,this.lineZonePosition.z1=this.pointA.z*r+this.pointA.x*o,this.lineZonePosition.z2=this.pointB.z*r+this.pointB.x*o,this.velocityInitialize.radiusPan.a=e.velocityInitValue+e.velocityMaxExtraValue*i,this.lifeInitialize.lifePan.a=Math.max(e.lifetimeMinValue,e.lifetimeInitValue*(1-i)),this.lifeInitialize.lifePan.b=this.lifeInitialize.lifePan.a+e.lifetimeRandomValue}},{key:"rotateParticle",value:function(t){t.rotation.y=this.emitter.rotation.y+(.1*Math.random()-.2)}},{key:"start",value:function(){this.emitter.emit(1/0)}},{key:"stop",value:function(){this.emitter.stopEmit()}},{key:"update",value:function(t){if(this.elapsed=t/1e3,this.elapsed>0){var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Wr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wr(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(this.emitters);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.update(this.elapsed),i.totalEmitTimes>0&&i.currentEmitTime>i.totalEmitTimes&&i.stopEmit()}}catch(t){n.e(t)}finally{n.f()}}}}])&&Xr(n.prototype,i),e}(mp);Kr(pg,"body",new Ad.Mesh(new Ad.PlaneGeometry(.18,.12),new Ad.MeshStandardMaterial({side:Ad.DoubleSide}))),Kr(pg,"velocityInitValue",3.8),Kr(pg,"velocityMaxExtraValue",5),Kr(pg,"lifetimeInitValue",.7),Kr(pg,"lifetimeRandomValue",.1),Kr(pg,"lifetimeMinValue",.25);const fg=pg;var mg=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=rp("shield"),this.view.renderOrder=2,this.animatedMaterial=null,this.flashingTimer=null,this.textureTween=null,this.timer=null,this.bindedHide=this.hide.bind(this),this.setTexture(),this.setAnimationTweens(),this.setTimer(),this.hide()}var e,n;return e=t,(n=[{key:"setTexture",value:function(){var t=this.view.getObjectByName("shield-a"),e=this.view.getObjectByName("shield-b"),n=this.view.getObjectByName("shield-c"),i=op("textures/shield-a"),r=op("textures/shield-b"),o=op("textures/shield-c");this.animatedMaterial=n.material,this.animatedTexture=o,o.wrapS=Ad.RepeatWrapping,t.material.map=i,t.material.transparent=!0,e.material.map=r,e.material.transparent=!0,n.material.map=o,n.material.transparent=!0}},{key:"setAnimationTweens",value:function(){this.flashingTimer=new yp(t.flashTime,t.flashRepeats,t.flashTime,!1).on("repeat",this.handleFlash,this).stop(),this.textureTween=new qd(this.animatedTexture.offset).to({x:-3},sm.e8).onComplete(this.bindedHide)}},{key:"setTimer",value:function(){var e=sm.e8-t.flashRepeats*t.flashTime;this.timer=new yp(e,0,e,!1).on("finish",this.startFlashingAnimation,this).stop()}},{key:"handleFlash",value:function(){this.view.visible=!this.view.visible}},{key:"show",value:function(){this.view.visible=!0,this.animatedTexture.offset.x=0,this.view.visible=!0,this.timer.restart(),this.textureTween.start()}},{key:"startFlashingAnimation",value:function(){this.flashingTimer.restart()}},{key:"hide",value:function(){this.view.visible=!1}}])&&$r(e.prototype,n),t}();to(mg,"flashRepeats",10),to(mg,"flashTime",100);const gg=mg,yg=0,vg=1,xg=2,bg=3,_g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.player=e}var e,n;return e=t,(n=[{key:"onEnter",value:function(){}},{key:"onExit",value:function(){}},{key:"update",value:function(){}}])&&eo(e.prototype,n),t}(),wg=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r.apply(this,arguments)}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ro(t,e)}(e,t);var n,i,r=oo(e);return n=e,(i=[{key:"onEnter",value:function(){this.player.speed=0}}])&&io(n.prototype,i),e}(_g),Sg=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r.apply(this,arguments)}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uo(t,e)}(e,t);var n,i,r=co(e);return n=e,(i=[{key:"onEnter",value:function(){var t=(this.player.maxSpeed-this.player.speed)/this.player.acceleration,e=Math.min(this.player.engineSound.volume(),.99);this.player.engineSound.fade(e,1,t)}},{key:"update",value:function(t){this.player.speed=this.player.speed+this.player.acceleration*t,this.player.speed>=this.player.maxSpeed&&this.player.setState(xg)}}])&&lo(n.prototype,i),e}(_g),Ag=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r.apply(this,arguments)}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mo(t,e)}(e,t);var n,i,r=go(e);return n=e,(i=[{key:"onEnter",value:function(){this.player.speed=this.player.maxSpeed}}])&&fo(n.prototype,i),e}(_g),Mg=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r.apply(this,arguments)}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bo(t,e)}(e,t);var n,i,r=_o(e);return n=e,(i=[{key:"onEnter",value:function(){var t=this.player.speed/this.player.breakingForce,e=Math.max(this.player.engineSound.volume(),this.player.idleEngineVolume+.01);this.player.engineSound.fade(e,this.player.idleEngineVolume,t)}},{key:"update",value:function(t){this.player.speed=this.player.speed-this.player.breakingForce*t,this.player.speed<=0&&this.player.setState(yg)}}])&&xo(n.prototype,i),e}(_g),Tg={rightWheel:{objectName:"wheel-r-f",to:{position:{y:[60,150,60,-30],x:[140,160,180,200]},rotation:{x:[.5*Math.PI,1*Math.PI,1.4*Math.PI,1.5*Math.PI]}}},leftWheel:{objectName:"wheel-l-f",to:{position:{y:[60,110,60,-30],x:[-130,-150,-190,-230]},rotation:{x:[.5*-Math.PI,1*-Math.PI,1.3*Math.PI,1.5*-Math.PI]}}},rightRearWheel:{objectName:"wheel-r-r",to:{position:{x:[130,140,200,220],z:[-20,-50,-60]},rotation:{y:1.5*Math.PI,z:.5*Math.PI}}},leftHandle:{objectName:"handle-l",to:{position:{y:[200,400,0],x:[-40,-60,-105]},rotation:{y:[.17*Math.PI,.15*Math.PI,0],z:.24*-Math.PI}}},rightHandle:{objectName:"handle-r",to:{position:{y:[100,200,0],x:[-40,-60,-95]},rotation:{z:.25*-Math.PI}}},middleHandle:{objectName:"handle-m",to:{position:{y:[60,120,0],x:[-50,-60,-75]},rotation:{z:.23*-Math.PI,x:[.7*-Math.PI,.5*-Math.PI]}}}},Eg={rightWheel:{objectName:"wheel-r-f",to:{position:{x:[200,180,160,104],y:[-30,160,160,-40],z:-120},rotation:{x:[1.5*Math.PI,1*Math.PI,0],y:[.7*-Math.PI,.3*-Math.PI,0]}}},leftWheel:{objectName:"wheel-l-f",to:{position:{x:[-230,-190,-150,-104],y:[60,110,60,-39],z:-120},rotation:{x:1.5*Math.PI,y:0,z:0}}},rightRearWheel:{objectName:"wheel-r-r",to:{position:{x:[220,200,140,104],z:[-60,-50,-20,90]},rotation:{y:0,z:0}}},leftHandle:{objectName:"handle-l",to:{position:{x:[-105,-60,0],y:[200,400,0]},rotation:{x:.7*-Math.PI,y:0,z:0}}},rightHandle:{objectName:"handle-r",to:{position:{x:[-95,-60,0],y:[100,200,0]},rotation:{x:.7*-Math.PI}}},middleHandle:{objectName:"handle-m",to:{position:{x:[-75,-60,0],y:[60,120,0]},rotation:{z:0,x:[.25*-Math.PI,.7*-Math.PI]}}}};var Pg=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).speed=0,t.maxSpeed=sm.iH*sm.X3.PY,t.acceleration=sm.rO*sm.X3.Hs,t.breakingForce=sm.rO*sm.X3.Sq,t.view=null,t.brokenView=null,t.repairAnimationTweens=[],t.destroyAnimationTweens=[],t.initialValues=[],t.body=null,t.particlesEffect=null,t.smokeEffectContainer=null,t.idleEngineVolume=.2,t.engineSound=Wd.create("mower-engine",{loop:!0,autoPlay:!1,volume:t.idleEngineVolume}),t.currentState=null,t.states={},t.createChildren(),t.createDestroyAnimation(),t.createRepairAnimation(),t.createParticlesEffect(),t.createStates(),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eo(t,e)}(e,t);var n,i,r=Po(e);return n=e,i=[{key:"createChildren",value:function(){this.view=rp("lawn-mover"),this.view.scale.setScalar(.005),this.view.renderOrder=1,this.brokenView=rp("lawn-mover-broken"),this.brokenView.scale.setScalar(.005),this.shield=new gg,this.view.add(this.shield.view),this.body=Ym.Bodies.rectangle(0,0,.91*sm.hi,1.4*sm.hi,{isStatic:!1,isSensor:!0}),this.smokeEffectContainer=new Ad.Group}},{key:"createDestroyAnimation",value:function(){for(var t in Tg){var e=Tg[t],n=this.brokenView.getObjectByName(e.objectName);this.destroyAnimationTweens.push(new qd(n).to(e.to,500)),this.initialValues.push({object:n,position:(new Ad.Vector3).copy(n.position),rotation:(new Ad.Euler).copy(n.rotation)})}}},{key:"createRepairAnimation",value:function(){var t,e=Ao(this.destroyAnimationTweens);try{for(e.s();!(t=e.n()).done;)t.value.end()}catch(t){e.e(t)}finally{e.f()}for(var n in Eg){var i=Eg[n],r=this.brokenView.getObjectByName(i.objectName);this.repairAnimationTweens.push(new qd(r).to(i.to,500))}}},{key:"createParticlesEffect",value:function(){this.particlesEffect=new fg,this.particlesEffect.container.position.y=1}},{key:"createStates",value:function(){this.states[yg]=new wg(this),this.states[vg]=new Sg(this),this.states[xg]=new Ag(this),this.states[bg]=new Mg(this),this.currentState=this.states[yg]}},{key:"setState",value:function(t){this.currentState.onExit(),this.currentState=this.states[t],this.currentState.onEnter()}},{key:"playDestroyAnimation",value:function(){this.setState(yg),this.engineSound.volume(this.idleEngineVolume),new Tm(this.smokeEffectContainer);var t,e=Ao(this.initialValues);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.object.position.copy(n.position),n.object.rotation.copy(n.rotation)}}catch(t){e.e(t)}finally{e.f()}var i,r=Ao(this.destroyAnimationTweens);try{for(r.s();!(i=r.n()).done;)i.value.start()}catch(t){r.e(t)}finally{r.f()}}},{key:"playReplairAnimation",value:function(){var t,e=Ao(this.repairAnimationTweens);try{for(e.s();!(t=e.n()).done;)t.value.start()}catch(t){e.e(t)}finally{e.f()}}},{key:"setPosition",value:function(t,e,n){var i=-Math.atan2(-n.z,-n.x)+.5*Math.PI;this.view.position.copy(t),this.view.rotation.y=i,this.view.position.y=1.01,Ym.Body.setPosition(this.body,{x:e.x*sm.hi,y:e.z*sm.hi}),Ym.Body.setAngle(this.body,-i),this.particlesEffect.updatePositionAndRotation(this.view.position,this.view.rotation.y,this.speed/this.maxSpeed),this.smokeEffectContainer.position.copy(this.view.position)}},{key:"start",value:function(){this.setState(vg),this.particlesEffect.start()}},{key:"stop",value:function(){this.setState(bg),this.particlesEffect.stop()}},{key:"updateSpeed",value:function(t){this.currentState.update(t)}}],i&&To(n.prototype,i),e}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));const Cg=Pg,Ig=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.speed=sm.iH*sm.pH.NS,this.rotationSpeed=sm.pH._E*this.speed,this.view=null,this.isOutOfScene=!0,this.needsCheckVisibilityOnSpawn=!1,this.bindedOnAfterRender=this.onAfterRender.bind(this),this.createChildren()}var e,n;return e=t,(n=[{key:"createChildren",value:function(){this.view=rp("wheel"),this.view.scale.setScalar(.007),this.view.renderOrder=1;var t=this.view.getObjectByName("wheel");t.material.map=op("textures/wheel"),t.material.transparent=!0,t.material.opacity=0,t.material.shines=2,t.onAfterRender=this.bindedOnAfterRender}},{key:"resetView",value:function(){this.view.getObjectByName("wheel").material.opacity=0}},{key:"onAfterRender",value:function(){this.isOutOfScene=!1}}])&&Io(e.prototype,n),t}(),Rg=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=r.call(this)).distance=0,t.transitionDistance=0,t.distanceForFakeAnimation=0,t.wheelStartPosition=0,t.createChildren(),t.reset(),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qo(t,e)}(e,t);var n,i,r=Lo(e);return n=e,(i=[{key:"createChildren",value:function(){this.grassLine=new lp("wheel-progress/line"),this.mower=new lp("wheel-progress/mower");var t=this.grassLine.width+this.mower.width;this.grassLine.position.x=.5*-t+.5*this.grassLine.width,this.mower.position.set(.5*-t+this.grassLine.width+.42*this.mower.width,.5*-this.mower.height),this.wheel=new lp("wheel-progress/wheel"),this.wheel.position.y=.5*-this.wheel.height,this.shadow=new lp("wheel-progress/shad"),this.shadow.position.y=.5*-this.shadow.height;var e=this.grassLine.width-this.shadow.width;this.distance=e*sm.MA,this.distanceForFakeAnimation=e-this.distance,this.wheelStartPosition=.5*-t+.5*this.shadow.width,this.shadow.addChild(this.wheel),this.addChild(this.grassLine,this.mower,this.shadow)}},{key:"reset",value:function(){this.updateWheelDistanceImitation(0),this.transitionDistance=0}},{key:"updateProgress",value:function(t){var e=this.transitionDistance+t*(this.distance-this.transitionDistance);this.shadow.position.x=this.wheelStartPosition+this.distanceForFakeAnimation+e}},{key:"updateTransitionState",value:function(t){this.transitionDistance+=this.distance*t,this.shadow.position.x=this.wheelStartPosition+this.distanceForFakeAnimation+this.transitionDistance}},{key:"updateWheelDistanceImitation",value:function(t){this.transitionDistance=Math.max(0,this.transitionDistance-.001*this.distance),this.shadow.position.x=this.wheelStartPosition+this.distanceForFakeAnimation*t+this.transitionDistance}}])&&Oo(n.prototype,i),e}($a),Og=JSON.parse('{"images":[{"name":"textures/grass-center","url":"assets/infinity/images/textures/grass-center.png","ext":"png"},{"name":"textures/grass-ground","url":"assets/infinity/images/textures/grass-ground.png","ext":"png"},{"name":"textures/grass-side","url":"assets/infinity/images/textures/grass-side.png","ext":"png"},{"name":"textures/grass","url":"assets/infinity/images/textures/grass.png","ext":"png"},{"name":"textures/shadows/gnome","url":"assets/infinity/images/textures/shadows/gnome.png","ext":"png"},{"name":"textures/shadows/stone1","url":"assets/infinity/images/textures/shadows/stone1.png","ext":"png"},{"name":"textures/shadows/stone3","url":"assets/infinity/images/textures/shadows/stone3.png","ext":"png"},{"name":"textures/shadows/stone4","url":"assets/infinity/images/textures/shadows/stone4.png","ext":"png"},{"name":"textures/shadows/stone5","url":"assets/infinity/images/textures/shadows/stone5.png","ext":"png"},{"name":"textures/shield-a","url":"assets/infinity/images/textures/shield-a.png","ext":"png"},{"name":"textures/shield-b","url":"assets/infinity/images/textures/shield-b.png","ext":"png"},{"name":"textures/shield-c","url":"assets/infinity/images/textures/shield-c.png","ext":"png"},{"name":"textures/smoke/1","url":"assets/infinity/images/textures/smoke/1.png","ext":"png"},{"name":"textures/smoke/2","url":"assets/infinity/images/textures/smoke/2.png","ext":"png"},{"name":"textures/smoke/3","url":"assets/infinity/images/textures/smoke/3.png","ext":"png"},{"name":"textures/smoke/4","url":"assets/infinity/images/textures/smoke/4.png","ext":"png"},{"name":"textures/smoke/5","url":"assets/infinity/images/textures/smoke/5.png","ext":"png"},{"name":"textures/textures-palette","url":"assets/infinity/images/textures/textures-palette.png","ext":"png"},{"name":"textures/wheel","url":"assets/infinity/images/textures/wheel.png","ext":"png"},{"name":"tutorial-hand","url":"assets/infinity/images/tutorial-hand.png","ext":"png"},{"name":"ui/buttons/ad","url":"assets/infinity/images/ui/buttons/ad.png","ext":"png"},{"name":"ui/buttons/retry","url":"assets/infinity/images/ui/buttons/retry.png","ext":"png"},{"name":"ui/buttons/sound-off","url":"assets/infinity/images/ui/buttons/sound-off.png","ext":"png"},{"name":"ui/buttons/sound-on","url":"assets/infinity/images/ui/buttons/sound-on.png","ext":"png"},{"name":"ui/lawn-mower","url":"assets/infinity/images/ui/lawn-mower.png","ext":"png"}],"atlases":[{"name":"infinity-atlas","url":"assets/infinity/atlases/infinity-atlas.json","ext":"json"},{"name":"infinity-atlas","url":"assets/infinity/atlases/infinity-atlas.png","ext":"png"}],"sounds":[{"name":"leaves-wind","url":"assets/infinity/sounds/leaves-wind.mp3","ext":"mp3"},{"name":"lose-screen","url":"assets/infinity/sounds/lose-screen.mp3","ext":"mp3"},{"name":"mower-crush","url":"assets/infinity/sounds/mower-crush.mp3","ext":"mp3"},{"name":"mower-engine","url":"assets/infinity/sounds/mower-engine.mp3","ext":"mp3"},{"name":"obstacle-break","url":"assets/infinity/sounds/obstacle-break.mp3","ext":"mp3"},{"name":"sheild","url":"assets/infinity/sounds/sheild.mp3","ext":"mp3"}],"fonts":[],"spine":[],"models":[{"name":"can","url":"assets/infinity/models/can.fbx","ext":"fbx"},{"name":"gnome","url":"assets/infinity/models/gnome.fbx","ext":"fbx"},{"name":"grass-particle-1","url":"assets/infinity/models/grass-particle-1.fbx","ext":"fbx"},{"name":"grass-particle-2","url":"assets/infinity/models/grass-particle-2.fbx","ext":"fbx"},{"name":"grass","url":"assets/infinity/models/grass.fbx","ext":"fbx"},{"name":"lawn-mover-broken","url":"assets/infinity/models/lawn-mover-broken.fbx","ext":"fbx"},{"name":"lawn-mover","url":"assets/infinity/models/lawn-mover.fbx","ext":"fbx"},{"name":"shield","url":"assets/infinity/models/shield.fbx","ext":"fbx"},{"name":"stone1","url":"assets/infinity/models/stone1.fbx","ext":"fbx"},{"name":"stone2","url":"assets/infinity/models/stone2.fbx","ext":"fbx"},{"name":"stone3","url":"assets/infinity/models/stone3.fbx","ext":"fbx"},{"name":"stone4","url":"assets/infinity/models/stone4.fbx","ext":"fbx"},{"name":"stone5","url":"assets/infinity/models/stone5.fbx","ext":"fbx"},{"name":"tree-leafs1","url":"assets/infinity/models/tree-leafs1.fbx","ext":"fbx"},{"name":"tree-leafs2","url":"assets/infinity/models/tree-leafs2.fbx","ext":"fbx"},{"name":"tree-leafs3","url":"assets/infinity/models/tree-leafs3.fbx","ext":"fbx"},{"name":"tree-trunk","url":"assets/infinity/models/tree-trunk.fbx","ext":"fbx"},{"name":"wheel","url":"assets/infinity/models/wheel.fbx","ext":"fbx"}]}');var qg=t(1513),Lg=t.n(qg),Dg={},zg=function(t){return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},kg=function(t){return new Worker(t)};try{URL.revokeObjectURL(zg(""))}catch(Ss){zg=function(t){return"data:application/javascript;charset=UTF-8,"+encodeURI(t)},kg=function(t){return new Worker(t,{type:"module"})}}var Bg=Uint8Array,Fg=Uint16Array,Vg=Uint32Array,Ng=new Bg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ug=new Bg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jg=new Bg([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gg=function(t,e){for(var n=new Fg(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new Vg(n[30]);for(i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)r[o]=o-n[i]<<5|i;return[n,r]},Hg=Gg(Ng,2),Wg=Hg[0],Xg=Hg[1];Wg[28]=258,Xg[258]=28;for(var Yg=Gg(Ug,0),Zg=Yg[0],Qg=Yg[1],Jg=new Fg(32768),Kg=0;Kg<32768;++Kg){var $g=(43690&Kg)>>>1|(21845&Kg)<<1;$g=(61680&($g=(52428&$g)>>>2|(13107&$g)<<2))>>>4|(3855&$g)<<4,Jg[Kg]=((65280&$g)>>>8|(255&$g)<<8)>>>1}var ty=function(t,e,n){for(var i=t.length,r=0,o=new Fg(e);r<i;++r)++o[t[r]-1];var s,a=new Fg(e);for(r=0;r<e;++r)a[r]=a[r-1]+o[r-1]<<1;if(n){s=new Fg(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var u=r<<4|t[r],c=e-t[r],h=a[t[r]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)s[Jg[h]>>>l]=u}else for(s=new Fg(i),r=0;r<i;++r)t[r]&&(s[r]=Jg[a[t[r]-1]++]>>>15-t[r]);return s},ey=new Bg(288);for(Kg=0;Kg<144;++Kg)ey[Kg]=8;for(Kg=144;Kg<256;++Kg)ey[Kg]=9;for(Kg=256;Kg<280;++Kg)ey[Kg]=7;for(Kg=280;Kg<288;++Kg)ey[Kg]=8;var ny=new Bg(32);for(Kg=0;Kg<32;++Kg)ny[Kg]=5;var iy=ty(ey,9,0),ry=ty(ey,9,1),oy=ty(ny,5,0),sy=ty(ny,5,1),ay=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ly=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(7&e)&n},uy=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},cy=function(t){return(t/8|0)+(7&t&&1)},hy=function(t,e,n){(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length);var i=new(t instanceof Fg?Fg:t instanceof Vg?Vg:Bg)(n-e);return i.set(t.subarray(e,n)),i},dy=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new Bg(0);var r=!e||n,o=!n||n.i;n||(n={}),e||(e=new Bg(3*i));var s=function(t){var n=e.length;if(t>n){var i=new Bg(Math.max(2*n,t));i.set(e),e=i}},a=n.f||0,l=n.p||0,u=n.b||0,c=n.l,h=n.d,d=n.m,p=n.n,f=8*i;do{if(!c){n.f=a=ly(t,l,1);var m=ly(t,l+1,3);if(l+=3,!m){var g=t[(E=cy(l)+4)-4]|t[E-3]<<8,y=E+g;if(y>i){if(o)throw"unexpected EOF";break}r&&s(u+g),e.set(t.subarray(E,y),u),n.b=u+=g,n.p=l=8*y;continue}if(1==m)c=ry,h=sy,d=9,p=5;else{if(2!=m)throw"invalid block type";var v=ly(t,l,31)+257,x=ly(t,l+10,15)+4,b=v+ly(t,l+5,31)+1;l+=14;for(var _=new Bg(b),w=new Bg(19),S=0;S<x;++S)w[jg[S]]=ly(t,l+3*S,7);l+=3*x;var A=ay(w),M=(1<<A)-1,T=ty(w,A,1);for(S=0;S<b;){var E,P=T[ly(t,l,M)];if(l+=15&P,(E=P>>>4)<16)_[S++]=E;else{var C=0,I=0;for(16==E?(I=3+ly(t,l,3),l+=2,C=_[S-1]):17==E?(I=3+ly(t,l,7),l+=3):18==E&&(I=11+ly(t,l,127),l+=7);I--;)_[S++]=C}}var R=_.subarray(0,v),O=_.subarray(v);d=ay(R),p=ay(O),c=ty(R,d,1),h=ty(O,p,1)}if(l>f){if(o)throw"unexpected EOF";break}}r&&s(u+131072);for(var q=(1<<d)-1,L=(1<<p)-1,D=l;;D=l){var z=(C=c[uy(t,l)&q])>>>4;if((l+=15&C)>f){if(o)throw"unexpected EOF";break}if(!C)throw"invalid length/literal";if(z<256)e[u++]=z;else{if(256==z){D=l,c=null;break}var k=z-254;if(z>264){var B=Ng[S=z-257];k=ly(t,l,(1<<B)-1)+Wg[S],l+=B}var F=h[uy(t,l)&L],V=F>>>4;if(!F)throw"invalid distance";if(l+=15&F,O=Zg[V],V>3&&(B=Ug[V],O+=uy(t,l)&(1<<B)-1,l+=B),l>f){if(o)throw"unexpected EOF";break}r&&s(u+131072);for(var N=u+k;u<N;u+=4)e[u]=e[u-O],e[u+1]=e[u+1-O],e[u+2]=e[u+2-O],e[u+3]=e[u+3-O];u=N}}n.l=c,n.p=D,n.b=u,c&&(a=1,n.m=d,n.d=h,n.n=p)}while(!a);return u==e.length?e:hy(e,0,u)},py=function(t,e,n){n<<=7&e;var i=e/8|0;t[i]|=n,t[i+1]|=n>>>8},fy=function(t,e,n){n<<=7&e;var i=e/8|0;t[i]|=n,t[i+1]|=n>>>8,t[i+2]|=n>>>16},my=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,o=n.slice();if(!r)return[wy,0];if(1==r){var s=new Bg(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort((function(t,e){return t.f-e.f})),n.push({s:-1,f:25001});var a=n[0],l=n[1],u=0,c=1,h=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};c!=r-1;)a=n[n[u].f<n[h].f?u++:h++],l=n[u!=c&&n[u].f<n[h].f?u++:h++],n[c++]={s:-1,f:a.f+l.f,l:a,r:l};var d=o[0].s;for(i=1;i<r;++i)o[i].s>d&&(d=o[i].s);var p=new Fg(d+1),f=gy(n[c-1],p,0);if(f>e){i=0;var m=0,g=f-e,y=1<<g;for(o.sort((function(t,e){return p[e.s]-p[t.s]||t.f-e.f}));i<r;++i){var v=o[i].s;if(!(p[v]>e))break;m+=y-(1<<f-p[v]),p[v]=e}for(m>>>=g;m>0;){var x=o[i].s;p[x]<e?m-=1<<e-p[x]++-1:++i}for(;i>=0&&m;--i){var b=o[i].s;p[b]==e&&(--p[b],++m)}f=e}return[new Bg(p),f]},gy=function(t,e,n){return-1==t.s?Math.max(gy(t.l,e,n+1),gy(t.r,e,n+1)):e[t.s]=n},yy=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Fg(++e),i=0,r=t[0],o=1,s=function(t){n[i++]=t},a=1;a<=e;++a)if(t[a]==r&&a!=e)++o;else{if(!r&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(r),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(r);o=1,r=t[a]}return[n.subarray(0,i),e]},vy=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},xy=function(t,e,n){var i=n.length,r=cy(e+2);t[r]=255&i,t[r+1]=i>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var o=0;o<i;++o)t[r+o+4]=n[o];return 8*(r+4+i)},by=function(t,e,n,i,r,o,s,a,l,u,c){py(e,c++,n),++r[256];for(var h=my(r,15),d=h[0],p=h[1],f=my(o,15),m=f[0],g=f[1],y=yy(d),v=y[0],x=y[1],b=yy(m),_=b[0],w=b[1],S=new Fg(19),A=0;A<v.length;++A)S[31&v[A]]++;for(A=0;A<_.length;++A)S[31&_[A]]++;for(var M=my(S,7),T=M[0],E=M[1],P=19;P>4&&!T[jg[P-1]];--P);var C,I,R,O,q=u+5<<3,L=vy(r,ey)+vy(o,ny)+s,D=vy(r,d)+vy(o,m)+s+14+3*P+vy(S,T)+(2*S[16]+3*S[17]+7*S[18]);if(q<=L&&q<=D)return xy(e,c,t.subarray(l,l+u));if(py(e,c,1+(D<L)),c+=2,D<L){C=ty(d,p,0),I=d,R=ty(m,g,0),O=m;var z=ty(T,E,0);for(py(e,c,x-257),py(e,c+5,w-1),py(e,c+10,P-4),c+=14,A=0;A<P;++A)py(e,c+3*A,T[jg[A]]);c+=3*P;for(var k=[v,_],B=0;B<2;++B){var F=k[B];for(A=0;A<F.length;++A){var V=31&F[A];py(e,c,z[V]),c+=T[V],V>15&&(py(e,c,F[A]>>>5&127),c+=F[A]>>>12)}}}else C=iy,I=ey,R=oy,O=ny;for(A=0;A<a;++A)if(i[A]>255){V=i[A]>>>18&31,fy(e,c,C[V+257]),c+=I[V+257],V>7&&(py(e,c,i[A]>>>23&31),c+=Ng[V]);var N=31&i[A];fy(e,c,R[N]),c+=O[N],N>3&&(fy(e,c,i[A]>>>5&8191),c+=Ug[N])}else fy(e,c,C[i[A]]),c+=I[i[A]];return fy(e,c,C[256]),c+I[256]},_y=new Vg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),wy=new Bg(0),Sy=function(t,e,n,i,r,o){var s=t.length,a=new Bg(i+s+5*(1+Math.ceil(s/7e3))+r),l=a.subarray(i,a.length-r),u=0;if(!e||s<8)for(var c=0;c<=s;c+=65535){var h=c+65535;h<s?u=xy(l,u,t.subarray(c,h)):(l[c]=o,u=xy(l,u,t.subarray(c,s)))}else{for(var d=_y[e-1],p=d>>>13,f=8191&d,m=(1<<n)-1,g=new Fg(32768),y=new Fg(m+1),v=Math.ceil(n/3),x=2*v,b=function(e){return(t[e]^t[e+1]<<v^t[e+2]<<x)&m},_=new Vg(25e3),w=new Fg(288),S=new Fg(32),A=0,M=0,T=(c=0,0),E=0,P=0;c<s;++c){var C=b(c),I=32767&c,R=y[C];if(g[I]=R,y[C]=I,E<=c){var O=s-c;if((A>7e3||T>24576)&&O>423){u=by(t,l,0,_,w,S,M,T,P,c-P,u),T=A=M=0,P=c;for(var q=0;q<286;++q)w[q]=0;for(q=0;q<30;++q)S[q]=0}var L=2,D=0,z=f,k=I-R&32767;if(O>2&&C==b(c-k))for(var B=Math.min(p,O)-1,F=Math.min(32767,c),V=Math.min(258,O);k<=F&&--z&&I!=R;){if(t[c+L]==t[c+L-k]){for(var N=0;N<V&&t[c+N]==t[c+N-k];++N);if(N>L){if(L=N,D=k,N>B)break;var U=Math.min(k,N-2),j=0;for(q=0;q<U;++q){var G=c-k+q+32768&32767,H=G-g[G]+32768&32767;H>j&&(j=H,R=G)}}}k+=(I=R)-(R=g[I])+32768&32767}if(D){_[T++]=268435456|Xg[L]<<18|Qg[D];var W=31&Xg[L],X=31&Qg[D];M+=Ng[W]+Ug[X],++w[257+W],++S[X],E=c+L,++A}else _[T++]=t[c],++w[t[c]]}}u=by(t,l,o,_,w,S,M,T,P,c-P,u),!o&&7&u&&(u=xy(l,u+1,wy))}return hy(a,0,i+cy(u)+r)},Ay=function(){for(var t=new Vg(256),e=0;e<256;++e){for(var n=e,i=9;--i;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),My=function(){var t=-1;return{p:function(e){for(var n=t,i=0;i<e.length;++i)n=Ay[255&n^e[i]]^n>>>8;t=n},d:function(){return~t}}},Ty=function(){var t=1,e=0;return{p:function(n){for(var i=t,r=e,o=n.length,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)r+=i+=n[s];i=(65535&i)+15*(i>>16),r=(65535&r)+15*(r>>16)}t=i,e=r},d:function(){return(255&(t%=65521))<<24|t>>>8<<16|(255&(e%=65521))<<8|e>>>8}}},Ey=function(t,e,n,i,r){return Sy(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,i,!r)},Py=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},Cy=function(t,e,n){for(var i=t(),r=t.toString(),o=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<i.length;++s){var a=i[s],l=o[s];if("function"==typeof a){e+=";"+l+"=";var u=a.toString();if(a.prototype)if(-1!=u.indexOf("[native code]")){var c=u.indexOf(" ",8)+1;e+=u.slice(c,u.indexOf("(",c))}else for(var h in e+=u,a.prototype)e+=";"+l+".prototype."+h+"="+a.prototype[h].toString();else e+=u}else n[l]=a}return[e,n]},Iy=[],Ry=function(t,e,n,i){var r;if(!Iy[n]){for(var o="",s={},a=t.length-1,l=0;l<a;++l)o=(r=Cy(t[l],o,s))[0],s=r[1];Iy[n]=Cy(t[a],o,s)}var u=Py({},Iy[n][1]);return function(t,e,n,i,r){var o=kg(Dg[e]||(Dg[e]=zg(t)));return o.onerror=function(t){return r(t.error,null)},o.onmessage=function(t){return r(null,t.data)},o.postMessage(n,i),o}(Iy[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,u,function(t){var e=[];for(var n in t)(t[n]instanceof Bg||t[n]instanceof Fg||t[n]instanceof Vg)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e}(u),i)},Oy=function(){return[Bg,Fg,Vg,Ng,Ug,jg,Wg,Zg,ry,sy,Jg,ty,ay,ly,uy,cy,hy,dy,Vo,By,Fy]},qy=function(){return[Bg,Fg,Vg,Ng,Ug,jg,Xg,Qg,iy,ey,oy,ny,Jg,_y,wy,ty,py,fy,my,gy,yy,vy,xy,by,cy,hy,Sy,Ey,Bo,By]},Ly=function(){return[Xy,Qy,Wy,My,Ay]},Dy=function(){return[Yy,Zy]},zy=function(){return[Jy,Wy,Ty]},ky=function(){return[Ky]},By=function(t){return postMessage(t,[t.buffer])},Fy=function(t){return t&&t.size&&new Bg(t.size)},Vy=function(t,e,n,i,r,o){var s=Ry(n,i,r,(function(t,e){s.terminate(),o(t,e)}));return s.postMessage([t,e],e.consume?[t.buffer]:[]),function(){s.terminate()}},Ny=function(t){return t.ondata=function(t,e){return postMessage([t,e],[t.buffer])},function(e){return t.push(e.data[0],e.data[1])}},Uy=function(t,e,n,i,r){var o,s=Ry(t,i,r,(function(t,n){t?(s.terminate(),e.ondata.call(e,t)):(n[1]&&s.terminate(),e.ondata.call(e,t,n[0],n[1]))}));s.postMessage(n),e.push=function(t,n){if(o)throw"stream finished";if(!e.ondata)throw"no stream handler";s.postMessage([t,o=n],[t.buffer])},e.terminate=function(){s.terminate()}},jy=function(t,e){return t[e]|t[e+1]<<8},Gy=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Hy=function(t,e){return Gy(t,e)+4294967296*Gy(t,e+4)},Wy=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},Xy=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&Wy(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var i=0;i<=n.length;++i)t[i+10]=n.charCodeAt(i)}},Yy=function(t){if(31!=t[0]||139!=t[1]||8!=t[2])throw"invalid gzip data";var e=t[3],n=10;4&e&&(n+=t[10]|2+(t[11]<<8));for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[n++]);return n+(2&e)},Zy=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Qy=function(t){return 10+(t.filename&&t.filename.length+1||0)},Jy=function(t,e){var n=e.level,i=0==n?0:n<6?1:9==n?3:2;t[0]=120,t[1]=i<<6|(i?32-2*i:1)},Ky=function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"},$y=function(){function t(t,e){e||"function"!=typeof t||(e=t,t={}),this.ondata=e,this.o=t||{}}return t.prototype.p=function(t,e){this.ondata(Ey(t,this.o,0,0,!e),e)},t.prototype.push=function(t,e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=e,this.p(t,e||!1)},t}(),tv=function(t,e){Uy([qy,function(){return[Ny,$y]}],this,zo.call(this,t,e),(function(t){var e=new $y(t.data);onmessage=Ny(e)}),6)},ev=function(){function t(t){this.s={},this.p=new Bg(0),this.ondata=t}return t.prototype.e=function(t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var e=this.p.length,n=new Bg(e+t.length);n.set(this.p),n.set(t,e),this.p=n},t.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,n=dy(this.p,this.o,this.s);this.ondata(hy(n,e,this.s.b),this.d),this.o=hy(n,this.s.b-32768),this.s.b=this.o.length,this.p=hy(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}(),nv=function(t){this.ondata=t,Uy([Oy,function(){return[Ny,ev]}],this,0,(function(){var t=new ev;onmessage=Ny(t)}),7)},iv=function(){function t(t,e){this.c=My(),this.l=0,this.v=1,$y.call(this,t,e)}return t.prototype.push=function(t,e){$y.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t),this.l+=t.length;var n=Ey(t,this.o,this.v&&Qy(this.o),e&&8,!e);this.v&&(Xy(n,this.o),this.v=0),e&&(Wy(n,n.length-8,this.c.d()),Wy(n,n.length-4,this.l)),this.ondata(n,e)},t}(),rv=function(t,e){Uy([qy,Ly,function(){return[Ny,$y,iv]}],this,zo.call(this,t,e),(function(t){var e=new iv(t.data);onmessage=Ny(e)}),8)},ov=function(){function t(t){this.v=1,ev.call(this,t)}return t.prototype.push=function(t,e){if(ev.prototype.e.call(this,t),this.v){var n=this.p.length>3?Yy(this.p):4;if(n>=this.p.length&&!e)return;this.p=this.p.subarray(n),this.v=0}if(e){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}ev.prototype.c.call(this,e)},t}(),sv=function(t){this.ondata=t,Uy([Oy,Dy,function(){return[Ny,ev,ov]}],this,0,(function(){var t=new ov;onmessage=Ny(t)}),9)},av=function(){function t(t,e){this.c=Ty(),this.v=1,$y.call(this,t,e)}return t.prototype.push=function(t,e){$y.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t);var n=Ey(t,this.o,this.v&&2,e&&4,!e);this.v&&(Jy(n,this.o),this.v=0),e&&Wy(n,n.length-4,this.c.d()),this.ondata(n,e)},t}(),lv=function(t,e){Uy([qy,zy,function(){return[Ny,$y,av]}],this,zo.call(this,t,e),(function(t){var e=new av(t.data);onmessage=Ny(e)}),10)},uv=function(){function t(t){this.v=1,ev.call(this,t)}return t.prototype.push=function(t,e){if(ev.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}if(e){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}ev.prototype.c.call(this,e)},t}(),cv=function(t){this.ondata=t,Uy([Oy,ky,function(){return[Ny,ev,uv]}],this,0,(function(){var t=new uv;onmessage=Ny(t)}),11)},hv=function(){function t(t){this.G=ov,this.I=ev,this.Z=uv,this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(t,e);else{if(this.p&&this.p.length){var n=new Bg(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length)}else this.p=t;if(this.p.length>2){var i=this,r=function(){i.ondata.apply(i,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(r):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(r):new this.Z(r),this.s.push(this.p,e),this.p=null}}},t}(),dv=function(){function t(t){this.G=sv,this.I=nv,this.Z=cv,this.ondata=t}return t.prototype.push=function(t,e){hv.prototype.push.call(this,t,e)},t}(),pv=function(t,e,n,i){for(var r in t){var o=t[r],s=e+r;o instanceof Bg?n[s]=[o,i]:Array.isArray(o)?n[s]=[o[0],Py(i,o[1])]:pv(o,s+"/",n,i)}},fv="undefined"!=typeof TextEncoder&&new TextEncoder,mv="undefined"!=typeof TextDecoder&&new TextDecoder,gv=0;try{mv.decode(wy,{stream:!0}),gv=1}catch(Ss){}var yv=function(t){for(var e="",n=0;;){var i=t[n++],r=(i>127)+(i>223)+(i>239);if(n+r>t.length)return[e,hy(t,n-1)];r?3==r?(i=((15&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536,e+=String.fromCharCode(55296|i>>10,56320|1023&i)):e+=1&r?String.fromCharCode((31&i)<<6|63&t[n++]):String.fromCharCode((15&i)<<12|(63&t[n++])<<6|63&t[n++]):e+=String.fromCharCode(i)}},vv=function(){function t(t){this.ondata=t,gv?this.t=new TextDecoder:this.p=wy}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(e=!!e,this.t){if(this.ondata(this.t.decode(t,{stream:!0}),e),e){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var n=new Bg(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length);var i=yv(n),r=i[0],o=i[1];if(e){if(o.length)throw"invalid utf-8 data";this.p=null}else this.p=o;this.ondata(r,e)}},t}(),xv=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Jo(t),this.d=e||!1)},t}(),bv=function(t){return 1==t?3:t<6?2:9==t?1:0},_v=function(t,e){return e+30+jy(t,e+26)+jy(t,e+28)},wv=function(t,e,n){var i=jy(t,e+28),r=Ko(t.subarray(e+46,e+46+i),!(2048&jy(t,e+8))),o=e+46+i,s=Gy(t,e+20),a=n&&4294967295==s?Sv(t,o):[s,Gy(t,e+24),Gy(t,e+42)],l=a[0],u=a[1],c=a[2];return[jy(t,e+10),l,u,r,o+jy(t,e+30)+jy(t,e+32),c]},Sv=function(t,e){for(;1!=jy(t,e);e+=4+jy(t,e+2));return[Hy(t,e+12),Hy(t,e+4),Hy(t,e+20)]},Av=function(t){var e=0;if(t)for(var n in t){var i=t[n].length;if(i>65535)throw"extra field too long";e+=i+4}return e},Mv=function(t,e,n,i,r,o,s,a){var l=i.length,u=n.extra,c=a&&a.length,h=Av(u);Wy(t,e,null!=s?33639248:67324752),e+=4,null!=s&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(null==o&&8),t[e++]=r&&8,t[e++]=255&n.compression,t[e++]=n.compression>>8;var d=new Date(null==n.mtime?Date.now():n.mtime),p=d.getFullYear()-1980;if(p<0||p>119)throw"date not in range 1980-2099";if(Wy(t,e,p<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>>1),e+=4,null!=o&&(Wy(t,e,n.crc),Wy(t,e+4,o),Wy(t,e+8,n.size)),Wy(t,e+12,l),Wy(t,e+14,h),e+=16,null!=s&&(Wy(t,e,c),Wy(t,e+6,n.attrs),Wy(t,e+10,s),e+=14),t.set(i,e),e+=l,h)for(var f in u){var m=u[f],g=m.length;Wy(t,e,+f),Wy(t,e+2,g),t.set(m,e+4),e+=4+g}return c&&(t.set(a,e),e+=c),e},Tv=function(t,e,n,i,r){Wy(t,e,101010256),Wy(t,e+8,n),Wy(t,e+10,n),Wy(t,e+12,i),Wy(t,e+16,r)},Ev=function(){function t(t){this.filename=t,this.c=My(),this.size=0,this.compression=0}return t.prototype.process=function(t,e){this.ondata(null,t,e)},t.prototype.push=function(t,e){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(t),this.size+=t.length,e&&(this.crc=this.c.d()),this.process(t,e||!1)},t}(),Pv=function(){function t(t,e){var n=this;e||(e={}),Ev.call(this,t),this.d=new $y(e,(function(t,e){n.ondata(null,t,e)})),this.compression=8,this.flag=bv(e.level)}return t.prototype.process=function(t,e){try{this.d.push(t,e)}catch(t){this.ondata(t,null,e)}},t.prototype.push=function(t,e){Ev.prototype.push.call(this,t,e)},t}(),Cv=function(){function t(t,e){var n=this;e||(e={}),Ev.call(this,t),this.d=new tv(e,(function(t,e,i){n.ondata(t,e,i)})),this.compression=8,this.flag=bv(e.level),this.terminate=this.d.terminate}return t.prototype.process=function(t,e){this.d.push(t,e)},t.prototype.push=function(t,e){Ev.prototype.push.call(this,t,e)},t}(),Iv=function(){function t(t){this.ondata=t,this.u=[],this.d=1}return t.prototype.add=function(t){var e=this;if(2&this.d)throw"stream finished";var n=Jo(t.filename),i=n.length,r=t.comment,o=r&&Jo(r),s=i!=t.filename.length||o&&r.length!=o.length,a=i+Av(t.extra)+30;if(i>65535)throw"filename too long";var l=new Bg(a);Mv(l,0,t,n,s);var u=[l],c=function(){for(var t=0,n=u;t<n.length;t++){var i=n[t];e.ondata(null,i,!1)}u=[]},h=this.d;this.d=0;var d=this.u.length,p=Py(t,{f:n,u:s,o:o,t:function(){t.terminate&&t.terminate()},r:function(){if(c(),h){var t=e.u[d+1];t?t.r():e.d=1}h=1}}),f=0;t.ondata=function(n,i,r){if(n)e.ondata(n,i,r),e.terminate();else if(f+=i.length,u.push(i),r){var o=new Bg(16);Wy(o,0,134695760),Wy(o,4,t.crc),Wy(o,8,f),Wy(o,12,t.size),u.push(o),p.c=f,p.b=a+f+16,p.crc=t.crc,p.size=t.size,h&&p.r(),h=1}else h&&c()},this.u.push(p)},t.prototype.end=function(){var t=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&t.d&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3},t.prototype.e=function(){for(var t=0,e=0,n=0,i=0,r=this.u;i<r.length;i++)n+=46+(l=r[i]).f.length+Av(l.extra)+(l.o?l.o.length:0);for(var o=new Bg(n+22),s=0,a=this.u;s<a.length;s++){var l=a[s];Mv(o,t,l,l.f,l.u,l.c,e,l.o),t+=46+l.f.length+Av(l.extra)+(l.o?l.o.length:0),e+=l.b}Tv(o,t,this.u.length,n,e),this.ondata(null,o,!0),this.d=2},t.prototype.terminate=function(){for(var t=0,e=this.u;t<e.length;t++)e[t].t();this.d=2},t}(),Rv=function(){function t(){}return t.prototype.push=function(t,e){this.ondata(null,t,e)},t.compression=0,t}(),Ov=function(){function t(){var t=this;this.i=new ev((function(e,n){t.ondata(null,e,n)}))}return t.prototype.push=function(t,e){try{this.i.push(t,e)}catch(n){this.ondata(n,t,e)}},t.compression=8,t}(),qv=function(){function t(t,e){var n=this;e<32e4?this.i=new ev((function(t,e){n.ondata(null,t,e)})):(this.i=new nv((function(t,e,i){n.ondata(t,e,i)})),this.terminate=this.i.terminate)}return t.prototype.push=function(t,e){this.i.terminate&&(t=hy(t,0)),this.i.push(t,e)},t.compression=8,t}(),Lv=function(){function t(t){this.onfile=t,this.k=[],this.o={0:Rv},this.p=wy}return t.prototype.push=function(t,e){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var i=Math.min(this.c,t.length),r=t.subarray(0,i);if(this.c-=i,this.d?this.d.push(r,!this.c):this.k[0].push(r),(t=t.subarray(i)).length)return this.push(t,e)}else{var o=0,s=0,a=void 0,l=void 0;this.p.length?t.length?((l=new Bg(this.p.length+t.length)).set(this.p),l.set(t,this.p.length)):l=this.p:l=t;for(var u=l.length,c=this.c,h=c&&this.d,d=function(){var t,e=Gy(l,s);if(67324752==e){o=1,a=s,p.d=null,p.c=0;var i=jy(l,s+6),r=jy(l,s+8),h=2048&i,d=8&i,f=jy(l,s+26),m=jy(l,s+28);if(u>s+30+f+m){var g=[];p.k.unshift(g),o=2;var y,v=Gy(l,s+18),x=Gy(l,s+22),b=Ko(l.subarray(s+30,s+=30+f),!h);4294967295==v?(t=d?[-2]:Sv(l,s),v=t[0],x=t[1]):d&&(v=-1),s+=m,p.c=v;var _={name:b,compression:r,start:function(){if(!_.ondata)throw"no callback";if(v){var t=n.o[r];if(!t)throw"unknown compression type "+r;(y=v<0?new t(b):new t(b,v,x)).ondata=function(t,e,n){_.ondata(t,e,n)};for(var e=0,i=g;e<i.length;e++){var o=i[e];y.push(o,!1)}n.k[0]==g&&n.c?n.d=y:y.push(wy,!0)}else _.ondata(null,wy,!0)},terminate:function(){y&&y.terminate&&y.terminate()}};v>=0&&(_.size=v,_.originalSize=x),p.onfile(_)}return"break"}if(c){if(134695760==e)return a=s+=12+(-2==c&&8),o=3,p.c=0,"break";if(33639248==e)return a=s-=4,o=3,p.c=0,"break"}},p=this;s<u-4&&"break"!==d();++s);if(this.p=wy,c<0){var f=o?l.subarray(0,a-12-(-2==c&&8)-(134695760==Gy(l,a-16)&&4)):l.subarray(0,s);h?h.push(f,!!o):this.k[+(2==o)].push(f)}if(2&o)return this.push(l.subarray(s),e);this.p=l.subarray(s)}if(e){if(this.c)throw"invalid zip file";this.p=null}},t.prototype.register=function(t){this.o[t.compression]=t},t}();class Dv extends Ad.Curve{constructor(t,e,n,i,r){super(),this.degree=t,this.knots=e,this.controlPoints=[],this.startKnot=i||0,this.endKnot=r||this.knots.length-1;for(let t=0;t<n.length;++t){const e=n[t];this.controlPoints[t]=new Ad.Vector4(e.x,e.y,e.z,e.w)}}getPoint(t,e=new Ad.Vector3){const n=e,i=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=function(t,e,n,i){const r=is(t,i,e),o=function(t,e,n,i){const r=[],o=[],s=[];r[0]=1;for(let a=1;a<=n;++a){o[a]=e-i[t+1-a],s[a]=i[t+a]-e;let n=0;for(let t=0;t<a;++t){const e=s[t+1],i=o[a-t],l=r[t]/(e+i);r[t]=n+e*l,n=i*l}r[a]=n}return r}(r,i,t,e),s=new Ad.Vector4(0,0,0,0);for(let e=0;e<=t;++e){const i=n[r-t+e],a=o[e],l=i.w*a;s.x+=i.x*l,s.y+=i.y*l,s.z+=i.z*l,s.w+=i.w*a}return s}(this.degree,this.knots,this.controlPoints,i);return 1!==r.w&&r.divideScalar(r.w),n.set(r.x,r.y,r.z)}getTangent(t,e=new Ad.Vector3){const n=e,i=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),r=function(t,e,n,i,r){const o=function(t,e,n,i,r){const o=r<t?r:t,s=[],a=is(t,i,e),l=function(t,e,n,i,r){const o=[];for(let t=0;t<=n;++t)o[t]=0;const s=[];for(let t=0;t<=i;++t)s[t]=o.slice(0);const a=[];for(let t=0;t<=n;++t)a[t]=o.slice(0);a[0][0]=1;const l=o.slice(0),u=o.slice(0);for(let i=1;i<=n;++i){l[i]=e-r[t+1-i],u[i]=r[t+i]-e;let n=0;for(let t=0;t<i;++t){const e=u[t+1],r=l[i-t];a[i][t]=e+r;const o=a[t][i-1]/a[i][t];a[t][i]=n+e*o,n=r*o}a[i][i]=n}for(let t=0;t<=n;++t)s[0][t]=a[t][n];for(let t=0;t<=n;++t){let e=0,r=1;const l=[];for(let t=0;t<=n;++t)l[t]=o.slice(0);l[0][0]=1;for(let o=1;o<=i;++o){let i=0;const u=t-o,c=n-o;t>=o&&(l[r][0]=l[e][0]/a[c+1][u],i=l[r][0]*a[u][c]);const h=t-1<=c?o-1:n-t;for(let t=u>=-1?1:-u;t<=h;++t)l[r][t]=(l[e][t]-l[e][t-1])/a[c+1][u+t],i+=l[r][t]*a[u+t][c];t<=c&&(l[r][o]=-l[e][o-1]/a[c+1][t],i+=l[r][o]*a[t][c]),s[o][t]=i;const d=e;e=r,r=d}}let c=n;for(let t=1;t<=i;++t){for(let e=0;e<=n;++e)s[t][e]*=c;c*=n-t}return s}(a,i,t,o,e),u=[];for(let t=0;t<n.length;++t){const e=n[t].clone(),i=e.w;e.x*=i,e.y*=i,e.z*=i,u[t]=e}for(let e=0;e<=o;++e){const n=u[a-t].clone().multiplyScalar(l[e][0]);for(let i=1;i<=t;++i)n.add(u[a-t+i].clone().multiplyScalar(l[e][i]));s[e]=n}for(let t=o+1;t<=r+1;++t)s[t]=new Ad.Vector4(0,0,0);return s}(t,e,n,i,r);return function(t){const e=t.length,n=[],i=[];for(let r=0;r<e;++r){const e=t[r];n[r]=new Ad.Vector3(e.x,e.y,e.z),i[r]=e.w}const r=[];for(let t=0;t<e;++t){const e=n[t].clone();for(let n=1;n<=t;++n)e.sub(r[t-n].clone().multiplyScalar(rs(t,n)*i[n]));r[t]=e.divideScalar(i[0])}return r}(o)}(this.degree,this.knots,this.controlPoints,i,1);return n.copy(r[1]).normalize(),n}}let zv,kv,Bv;class Fv extends Ad.Loader{constructor(t){super(t)}load(t,e,n,i){const r=this,o=""===r.path?Ad.LoaderUtils.extractUrlBase(t):r.path,s=new Ad.FileLoader(this.manager);s.setPath(r.path),s.setResponseType("arraybuffer"),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(n){try{e(r.parse(n,o))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)}parse(t,e){if(function(t){const e="Kaydara FBX Binary  \0";return t.byteLength>=21&&e===hs(t,0,21)}(t))zv=(new Gv).parse(t);else{const e=hs(t);if(!function(t){function e(e){const n=t[e-1];return t=t.slice(i+e),i++,n}const n=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let i=0;for(let t=0;t<20;++t)if(e(1)===n[t])return!1;return!0}(e))throw new Error("THREE.FBXLoader: Unknown format.");if(os(e)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+os(e));zv=(new jv).parse(e)}const n=new Ad.TextureLoader(this.manager).setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);return new Vv(n,this.manager).parse(zv)}}class Vv{constructor(t,e){this.textureLoader=t,this.manager=e}parse(){kv=this.parseConnections();const t=this.parseImages(),e=this.parseTextures(t),n=this.parseMaterials(e),i=this.parseDeformers(),r=(new Nv).parse(i);return this.parseScene(i,r,n),Bv}parseConnections(){const t=new Map;return"Connections"in zv&&zv.Connections.connections.forEach((function(e){const n=e[0],i=e[1],r=e[2];t.has(n)||t.set(n,{parents:[],children:[]});const o={ID:i,relationship:r};t.get(n).parents.push(o),t.has(i)||t.set(i,{parents:[],children:[]});const s={ID:n,relationship:r};t.get(i).children.push(s)})),t}parseImages(){const t={},e={};if("Video"in zv.Objects){const n=zv.Objects.Video;for(const i in n){const r=n[i];if(t[parseInt(i)]=r.RelativeFilename||r.Filename,"Content"in r){const t=r.Content instanceof ArrayBuffer&&r.Content.byteLength>0,o="string"==typeof r.Content&&""!==r.Content;if(t||o){const t=this.parseImage(n[i]);e[r.RelativeFilename||r.Filename]=t}}}}for(const n in t){const i=t[n];void 0!==e[i]?t[n]=e[i]:t[n]=t[n].split("\\").pop()}return t}parseImage(t){const e=t.Content,n=t.RelativeFilename||t.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();let r;switch(i){case"bmp":r="image/bmp";break;case"jpg":case"jpeg":r="image/jpeg";break;case"png":r="image/png";break;case"tif":r="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),r="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof e)return"data:"+r+";base64,"+e;{const t=new Uint8Array(e);return window.URL.createObjectURL(new Blob([t],{type:r}))}}parseTextures(t){const e=new Map;if("Texture"in zv.Objects){const n=zv.Objects.Texture;for(const i in n){const r=this.parseTexture(n[i],t);e.set(parseInt(i),r)}}return e}parseTexture(t,e){const n=this.loadTexture(t,e);n.ID=t.id,n.name=t.attrName;const i=t.WrapModeU,r=t.WrapModeV,o=void 0!==i?i.value:0,s=void 0!==r?r.value:0;if(n.wrapS=0===o?Ad.RepeatWrapping:Ad.ClampToEdgeWrapping,n.wrapT=0===s?Ad.RepeatWrapping:Ad.ClampToEdgeWrapping,"Scaling"in t){const e=t.Scaling.value;n.repeat.x=e[0],n.repeat.y=e[1]}if("Translation"in t){const e=t.Translation.value;n.offset.x=e[0],n.offset.y=e[1]}return n}loadTexture(t,e){let n;const i=this.textureLoader.path,r=kv.get(t.id).children;let o;void 0!==r&&r.length>0&&void 0!==e[r[0].ID]&&(n=e[r[0].ID],0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));const s=t.FileName.slice(-3).toLowerCase();if("tga"===s){const e=this.manager.getHandler(".tga");null===e?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),o=new Ad.Texture):(e.setPath(this.textureLoader.path),o=e.load(n))}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),o=new Ad.Texture):o=this.textureLoader.load(n);return this.textureLoader.setPath(i),o}parseMaterials(t){const e=new Map;if("Material"in zv.Objects){const n=zv.Objects.Material;for(const i in n){const r=this.parseMaterial(n[i],t);null!==r&&e.set(parseInt(i),r)}}return e}parseMaterial(t,e){const n=t.id,i=t.attrName;let r=t.ShadingModel;if("object"==typeof r&&(r=r.value),!kv.has(n))return null;const o=this.parseParameters(t,e,n);let s;switch(r.toLowerCase()){case"phong":s=new Ad.MeshPhongMaterial;break;case"lambert":s=new Ad.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',r),s=new Ad.MeshPhongMaterial}return s.setValues(o),s.name=i,s}parseParameters(t,e,n){const i={};t.BumpFactor&&(i.bumpScale=t.BumpFactor.value),t.Diffuse?i.color=(new Ad.Color).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(i.color=(new Ad.Color).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(i.displacementScale=t.DisplacementFactor.value),t.Emissive?i.emissive=(new Ad.Color).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(i.emissive=(new Ad.Color).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(i.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(i.opacity=parseFloat(t.Opacity.value)),i.opacity<1&&(i.transparent=!0),t.ReflectionFactor&&(i.reflectivity=t.ReflectionFactor.value),t.Shininess&&(i.shininess=t.Shininess.value),t.Specular?i.specular=(new Ad.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(i.specular=(new Ad.Color).fromArray(t.SpecularColor.value));const r=this;return kv.get(n).children.forEach((function(t){const n=t.relationship;switch(n){case"Bump":i.bumpMap=r.getTexture(e,t.ID);break;case"Maya|TEX_ao_map":i.aoMap=r.getTexture(e,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":i.map=r.getTexture(e,t.ID),void 0!==i.map&&(i.map.encoding=Ad.sRGBEncoding);break;case"DisplacementColor":i.displacementMap=r.getTexture(e,t.ID);break;case"EmissiveColor":i.emissiveMap=r.getTexture(e,t.ID),void 0!==i.emissiveMap&&(i.emissiveMap.encoding=Ad.sRGBEncoding);break;case"NormalMap":case"Maya|TEX_normal_map":i.normalMap=r.getTexture(e,t.ID);break;case"ReflectionColor":i.envMap=r.getTexture(e,t.ID),void 0!==i.envMap&&(i.envMap.mapping=Ad.EquirectangularReflectionMapping,i.envMap.encoding=Ad.sRGBEncoding);break;case"SpecularColor":i.specularMap=r.getTexture(e,t.ID),void 0!==i.specularMap&&(i.specularMap.encoding=Ad.sRGBEncoding);break;case"TransparentColor":case"TransparencyFactor":i.alphaMap=r.getTexture(e,t.ID),i.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n)}})),i}getTexture(t,e){return"LayeredTexture"in zv.Objects&&e in zv.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),e=kv.get(e).children[0].ID),t.get(e)}parseDeformers(){const t={},e={};if("Deformer"in zv.Objects){const n=zv.Objects.Deformer;for(const i in n){const r=n[i],o=kv.get(parseInt(i));if("Skin"===r.attrType){const e=this.parseSkeleton(o,n);e.ID=i,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),e.geometryID=o.parents[0].ID,t[i]=e}else if("BlendShape"===r.attrType){const t={id:i};t.rawTargets=this.parseMorphTargets(o,n),t.id=i,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),e[i]=t}}}return{skeletons:t,morphTargets:e}}parseSkeleton(t,e){const n=[];return t.children.forEach((function(t){const i=e[t.ID];if("Cluster"!==i.attrType)return;const r={ID:t.ID,indices:[],weights:[],transformLink:(new Ad.Matrix4).fromArray(i.TransformLink.a)};"Indexes"in i&&(r.indices=i.Indexes.a,r.weights=i.Weights.a),n.push(r)})),{rawBones:n,bones:[]}}parseMorphTargets(t,e){const n=[];for(let i=0;i<t.children.length;i++){const r=t.children[i],o=e[r.ID],s={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;s.geoID=kv.get(parseInt(r.ID)).children.filter((function(t){return void 0===t.relationship}))[0].ID,n.push(s)}return n}parseScene(t,e,n){Bv=new Ad.Group;const i=this.parseModels(t.skeletons,e,n),r=zv.Objects.Model,o=this;i.forEach((function(t){const e=r[t.ID];o.setLookAtProperties(t,e),kv.get(t.ID).parents.forEach((function(e){const n=i.get(e.ID);void 0!==n&&n.add(t)})),null===t.parent&&Bv.add(t)})),this.bindSkeleton(t.skeletons,e,i),this.createAmbientLight(),Bv.traverse((function(t){if(t.userData.transformData){t.parent&&(t.userData.transformData.parentMatrix=t.parent.matrix,t.userData.transformData.parentMatrixWorld=t.parent.matrixWorld);const e=ls(t.userData.transformData);t.applyMatrix4(e),t.updateWorldMatrix()}}));const s=(new Uv).parse();1===Bv.children.length&&Bv.children[0].isGroup&&(Bv.children[0].animations=s,Bv=Bv.children[0]),Bv.animations=s}parseModels(t,e,n){const i=new Map,r=zv.Objects.Model;for(const o in r){const s=parseInt(o),a=r[o],l=kv.get(s);let u=this.buildSkeleton(l,t,s,a.attrName);if(!u){switch(a.attrType){case"Camera":u=this.createCamera(l);break;case"Light":u=this.createLight(l);break;case"Mesh":u=this.createMesh(l,e,n);break;case"NurbsCurve":u=this.createCurve(l,e);break;case"LimbNode":case"Root":u=new Ad.Bone;break;default:u=new Ad.Group}u.name=a.attrName?Ad.PropertyBinding.sanitizeNodeName(a.attrName):"",u.ID=s}this.getTransformData(u,a),i.set(s,u)}return i}buildSkeleton(t,e,n,i){let r=null;return t.parents.forEach((function(t){for(const o in e){const s=e[o];s.rawBones.forEach((function(e,o){if(e.ID===t.ID){const t=r;r=new Ad.Bone,r.matrixWorld.copy(e.transformLink),r.name=i?Ad.PropertyBinding.sanitizeNodeName(i):"",r.ID=n,s.bones[o]=r,null!==t&&r.add(t)}}))}})),r}createCamera(t){let e,n;if(t.children.forEach((function(t){const e=zv.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new Ad.Object3D;else{let t=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(t=1);let i=1;void 0!==n.NearPlane&&(i=n.NearPlane.value/1e3);let r=1e3;void 0!==n.FarPlane&&(r=n.FarPlane.value/1e3);let o=window.innerWidth,s=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(o=n.AspectWidth.value,s=n.AspectHeight.value);const a=o/s;let l=45;void 0!==n.FieldOfView&&(l=n.FieldOfView.value);const u=n.FocalLength?n.FocalLength.value:null;switch(t){case 0:e=new Ad.PerspectiveCamera(l,a,i,r),null!==u&&e.setFocalLength(u);break;case 1:e=new Ad.OrthographicCamera(-o/2,o/2,s/2,-s/2,i,r);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+t+"."),e=new Ad.Object3D}}return e}createLight(t){let e,n;if(t.children.forEach((function(t){const e=zv.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new Ad.Object3D;else{let t;t=void 0===n.LightType?0:n.LightType.value;let i=16777215;void 0!==n.Color&&(i=(new Ad.Color).fromArray(n.Color.value));let r=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(r=0);let o=0;void 0!==n.FarAttenuationEnd&&(o=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const s=1;switch(t){case 0:e=new Ad.PointLight(i,r,o,s);break;case 1:e=new Ad.DirectionalLight(i,r);break;case 2:let t=Math.PI/3;void 0!==n.InnerAngle&&(t=Ad.MathUtils.degToRad(n.InnerAngle.value));let a=0;void 0!==n.OuterAngle&&(a=Ad.MathUtils.degToRad(n.OuterAngle.value),a=Math.max(a,1)),e=new Ad.SpotLight(i,r,o,t,a,s);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),e=new Ad.PointLight(i,r)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(e.castShadow=!0)}return e}createMesh(t,e,n){let i,r=null,o=null;const s=[];return t.children.forEach((function(t){e.has(t.ID)&&(r=e.get(t.ID)),n.has(t.ID)&&s.push(n.get(t.ID))})),s.length>1?o=s:s.length>0?o=s[0]:(o=new Ad.MeshPhongMaterial({color:13421772}),s.push(o)),"color"in r.attributes&&s.forEach((function(t){t.vertexColors=!0})),r.FBX_Deformer?(i=new Ad.SkinnedMesh(r,o),i.normalizeSkinWeights()):i=new Ad.Mesh(r,o),i}createCurve(t,e){const n=t.children.reduce((function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t}),null),i=new Ad.LineBasicMaterial({color:3342591,linewidth:1});return new Ad.Line(n,i)}getTransformData(t,e){const n={};"InheritType"in e&&(n.inheritType=parseInt(e.InheritType.value)),n.eulerOrder="RotationOrder"in e?us(e.RotationOrder.value):"ZYX","Lcl_Translation"in e&&(n.translation=e.Lcl_Translation.value),"PreRotation"in e&&(n.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(n.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(n.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(n.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(n.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(n.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(n.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(n.rotationPivot=e.RotationPivot.value),t.userData.transformData=n}setLookAtProperties(t,e){"LookAtProperty"in e&&kv.get(t.ID).children.forEach((function(e){if("LookAtProperty"===e.relationship){const n=zv.Objects.Model[e.ID];if("Lcl_Translation"in n){const e=n.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(e),Bv.add(t.target)):t.lookAt((new Ad.Vector3).fromArray(e))}}}))}bindSkeleton(t,e,n){const i=this.parsePoseNodes();for(const r in t){const o=t[r];kv.get(parseInt(o.ID)).parents.forEach((function(t){if(e.has(t.ID)){const e=t.ID;kv.get(e).parents.forEach((function(t){n.has(t.ID)&&n.get(t.ID).bind(new Ad.Skeleton(o.bones),i[t.ID])}))}}))}}parsePoseNodes(){const t={};if("Pose"in zv.Objects){const e=zv.Objects.Pose;for(const n in e)if("BindPose"===e[n].attrType&&e[n].NbPoseNodes>0){const i=e[n].PoseNode;Array.isArray(i)?i.forEach((function(e){t[e.Node]=(new Ad.Matrix4).fromArray(e.Matrix.a)})):t[i.Node]=(new Ad.Matrix4).fromArray(i.Matrix.a)}}return t}createAmbientLight(){if("GlobalSettings"in zv&&"AmbientColor"in zv.GlobalSettings){const t=zv.GlobalSettings.AmbientColor.value,e=t[0],n=t[1],i=t[2];if(0!==e||0!==n||0!==i){const t=new Ad.Color(e,n,i);Bv.add(new Ad.AmbientLight(t,1))}}}}class Nv{parse(t){const e=new Map;if("Geometry"in zv.Objects){const n=zv.Objects.Geometry;for(const i in n){const r=kv.get(parseInt(i)),o=this.parseGeometry(r,n[i],t);e.set(parseInt(i),o)}}return e}parseGeometry(t,e,n){switch(e.attrType){case"Mesh":return this.parseMeshGeometry(t,e,n);case"NurbsCurve":return this.parseNurbsGeometry(e)}}parseMeshGeometry(t,e,n){const i=n.skeletons,r=[],o=t.parents.map((function(t){return zv.Objects.Model[t.ID]}));if(0===o.length)return;const s=t.children.reduce((function(t,e){return void 0!==i[e.ID]&&(t=i[e.ID]),t}),null);t.children.forEach((function(t){void 0!==n.morphTargets[t.ID]&&r.push(n.morphTargets[t.ID])}));const a=o[0],l={};"RotationOrder"in a&&(l.eulerOrder=us(a.RotationOrder.value)),"InheritType"in a&&(l.inheritType=parseInt(a.InheritType.value)),"GeometricTranslation"in a&&(l.translation=a.GeometricTranslation.value),"GeometricRotation"in a&&(l.rotation=a.GeometricRotation.value),"GeometricScaling"in a&&(l.scale=a.GeometricScaling.value);const u=ls(l);return this.genGeometry(e,s,r,u)}genGeometry(t,e,n,i){const r=new Ad.BufferGeometry;t.attrName&&(r.name=t.attrName);const o=this.parseGeoNode(t,e),s=this.genBuffers(o),a=new Ad.Float32BufferAttribute(s.vertex,3);if(a.applyMatrix4(i),r.setAttribute("position",a),s.colors.length>0&&r.setAttribute("color",new Ad.Float32BufferAttribute(s.colors,3)),e&&(r.setAttribute("skinIndex",new Ad.Uint16BufferAttribute(s.weightsIndices,4)),r.setAttribute("skinWeight",new Ad.Float32BufferAttribute(s.vertexWeights,4)),r.FBX_Deformer=e),s.normal.length>0){const t=(new Ad.Matrix3).getNormalMatrix(i),e=new Ad.Float32BufferAttribute(s.normal,3);e.applyNormalMatrix(t),r.setAttribute("normal",e)}if(s.uvs.forEach((function(t,e){let n="uv"+(e+1).toString();0===e&&(n="uv"),r.setAttribute(n,new Ad.Float32BufferAttribute(s.uvs[e],2))})),o.material&&"AllSame"!==o.material.mappingType){let t=s.materialIndex[0],e=0;if(s.materialIndex.forEach((function(n,i){n!==t&&(r.addGroup(e,i-e,t),t=n,e=i)})),r.groups.length>0){const e=r.groups[r.groups.length-1],n=e.start+e.count;n!==s.materialIndex.length&&r.addGroup(n,s.materialIndex.length-n,t)}0===r.groups.length&&r.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(r,t,n,i),r}parseGeoNode(t,e){const n={};if(n.vertexPositions=void 0!==t.Vertices?t.Vertices.a:[],n.vertexIndices=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(n.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(n.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(n.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){n.uv=[];let e=0;for(;t.LayerElementUV[e];)t.LayerElementUV[e].UV&&n.uv.push(this.parseUVs(t.LayerElementUV[e])),e++}return n.weightTable={},null!==e&&(n.skeleton=e,e.rawBones.forEach((function(t,e){t.indices.forEach((function(i,r){void 0===n.weightTable[i]&&(n.weightTable[i]=[]),n.weightTable[i].push({id:e,weight:t.weights[r]})}))}))),n}genBuffers(t){const e={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,i=0,r=!1,o=[],s=[],a=[],l=[],u=[],c=[];const h=this;return t.vertexIndices.forEach((function(d,p){let f,m=!1;d<0&&(d^=-1,m=!0);let g=[],y=[];if(o.push(3*d,3*d+1,3*d+2),t.color){const e=as(p,n,d,t.color);a.push(e[0],e[1],e[2])}if(t.skeleton){if(void 0!==t.weightTable[d]&&t.weightTable[d].forEach((function(t){y.push(t.weight),g.push(t.id)})),y.length>4){r||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),r=!0);const t=[0,0,0,0],e=[0,0,0,0];y.forEach((function(n,i){let r=n,o=g[i];e.forEach((function(e,n,i){if(r>e){i[n]=r,r=e;const s=t[n];t[n]=o,o=s}}))})),g=t,y=e}for(;y.length<4;)y.push(0),g.push(0);for(let t=0;t<4;++t)u.push(y[t]),c.push(g[t])}if(t.normal){const e=as(p,n,d,t.normal);s.push(e[0],e[1],e[2])}t.material&&"AllSame"!==t.material.mappingType&&(f=as(p,n,d,t.material)[0]),t.uv&&t.uv.forEach((function(t,e){const i=as(p,n,d,t);void 0===l[e]&&(l[e]=[]),l[e].push(i[0]),l[e].push(i[1])})),i++,m&&(h.genFace(e,t,o,f,s,a,l,u,c,i),n++,i=0,o=[],s=[],a=[],l=[],u=[],c=[])})),e}genFace(t,e,n,i,r,o,s,a,l,u){for(let c=2;c<u;c++)t.vertex.push(e.vertexPositions[n[0]]),t.vertex.push(e.vertexPositions[n[1]]),t.vertex.push(e.vertexPositions[n[2]]),t.vertex.push(e.vertexPositions[n[3*(c-1)]]),t.vertex.push(e.vertexPositions[n[3*(c-1)+1]]),t.vertex.push(e.vertexPositions[n[3*(c-1)+2]]),t.vertex.push(e.vertexPositions[n[3*c]]),t.vertex.push(e.vertexPositions[n[3*c+1]]),t.vertex.push(e.vertexPositions[n[3*c+2]]),e.skeleton&&(t.vertexWeights.push(a[0]),t.vertexWeights.push(a[1]),t.vertexWeights.push(a[2]),t.vertexWeights.push(a[3]),t.vertexWeights.push(a[4*(c-1)]),t.vertexWeights.push(a[4*(c-1)+1]),t.vertexWeights.push(a[4*(c-1)+2]),t.vertexWeights.push(a[4*(c-1)+3]),t.vertexWeights.push(a[4*c]),t.vertexWeights.push(a[4*c+1]),t.vertexWeights.push(a[4*c+2]),t.vertexWeights.push(a[4*c+3]),t.weightsIndices.push(l[0]),t.weightsIndices.push(l[1]),t.weightsIndices.push(l[2]),t.weightsIndices.push(l[3]),t.weightsIndices.push(l[4*(c-1)]),t.weightsIndices.push(l[4*(c-1)+1]),t.weightsIndices.push(l[4*(c-1)+2]),t.weightsIndices.push(l[4*(c-1)+3]),t.weightsIndices.push(l[4*c]),t.weightsIndices.push(l[4*c+1]),t.weightsIndices.push(l[4*c+2]),t.weightsIndices.push(l[4*c+3])),e.color&&(t.colors.push(o[0]),t.colors.push(o[1]),t.colors.push(o[2]),t.colors.push(o[3*(c-1)]),t.colors.push(o[3*(c-1)+1]),t.colors.push(o[3*(c-1)+2]),t.colors.push(o[3*c]),t.colors.push(o[3*c+1]),t.colors.push(o[3*c+2])),e.material&&"AllSame"!==e.material.mappingType&&(t.materialIndex.push(i),t.materialIndex.push(i),t.materialIndex.push(i)),e.normal&&(t.normal.push(r[0]),t.normal.push(r[1]),t.normal.push(r[2]),t.normal.push(r[3*(c-1)]),t.normal.push(r[3*(c-1)+1]),t.normal.push(r[3*(c-1)+2]),t.normal.push(r[3*c]),t.normal.push(r[3*c+1]),t.normal.push(r[3*c+2])),e.uv&&e.uv.forEach((function(e,n){void 0===t.uvs[n]&&(t.uvs[n]=[]),t.uvs[n].push(s[n][0]),t.uvs[n].push(s[n][1]),t.uvs[n].push(s[n][2*(c-1)]),t.uvs[n].push(s[n][2*(c-1)+1]),t.uvs[n].push(s[n][2*c]),t.uvs[n].push(s[n][2*c+1])}))}addMorphTargets(t,e,n,i){if(0===n.length)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const r=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const o=zv.Objects.Geometry[n.geoID];void 0!==o&&r.genMorphGeometry(t,e,o,i,n.name)}))}))}genMorphGeometry(t,e,n,i,r){const o=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],s=void 0!==n.Vertices?n.Vertices.a:[],a=void 0!==n.Indexes?n.Indexes.a:[],l=3*t.attributes.position.count,u=new Float32Array(l);for(let t=0;t<a.length;t++){const e=3*a[t];u[e]=s[3*t],u[e+1]=s[3*t+1],u[e+2]=s[3*t+2]}const c={vertexIndices:o,vertexPositions:u},h=this.genBuffers(c),d=new Ad.Float32BufferAttribute(h.vertex,3);d.name=r||n.attrName,d.applyMatrix4(i),t.morphAttributes.position.push(d)}parseNormals(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,i=t.Normals.a;let r=[];return"IndexToDirect"===n&&("NormalIndex"in t?r=t.NormalIndex.a:"NormalsIndex"in t&&(r=t.NormalsIndex.a)),{dataSize:3,buffer:i,indices:r,mappingType:e,referenceType:n}}parseUVs(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,i=t.UV.a;let r=[];return"IndexToDirect"===n&&(r=t.UVIndex.a),{dataSize:2,buffer:i,indices:r,mappingType:e,referenceType:n}}parseVertexColors(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,i=t.Colors.a;let r=[];return"IndexToDirect"===n&&(r=t.ColorIndex.a),{dataSize:4,buffer:i,indices:r,mappingType:e,referenceType:n}}parseMaterialIndices(t){const e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const i=t.Materials.a,r=[];for(let t=0;t<i.length;++t)r.push(t);return{dataSize:1,buffer:i,indices:r,mappingType:e,referenceType:n}}parseNurbsGeometry(t){if(void 0===Dv)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new Ad.BufferGeometry;const e=parseInt(t.Order);if(isNaN(e))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new Ad.BufferGeometry;const n=e-1,i=t.KnotVector.a,r=[],o=t.Points.a;for(let t=0,e=o.length;t<e;t+=4)r.push((new Ad.Vector4).fromArray(o,t));let s,a;if("Closed"===t.Form)r.push(r[0]);else if("Periodic"===t.Form){s=n,a=i.length-1-s;for(let t=0;t<n;++t)r.push(r[t])}const l=new Dv(n,i,r,s,a).getPoints(12*r.length);return(new Ad.BufferGeometry).setFromPoints(l)}}class Uv{parse(){const t=[],e=this.parseClips();if(void 0!==e)for(const n in e){const i=e[n],r=this.addClip(i);t.push(r)}return t}parseClips(){if(void 0===zv.Objects.AnimationCurve)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const e=this.parseAnimationLayers(t);return this.parseAnimStacks(e)}parseAnimationCurveNodes(){const t=zv.Objects.AnimationCurveNode,e=new Map;for(const n in t){const i=t[n];if(null!==i.attrName.match(/S|R|T|DeformPercent/)){const t={id:i.id,attr:i.attrName,curves:{}};e.set(t.id,t)}}return e}parseAnimationCurves(t){const e=zv.Objects.AnimationCurve;for(const n in e){const i={id:e[n].id,times:e[n].KeyTime.a.map(ss),values:e[n].KeyValueFloat.a},r=kv.get(i.id);if(void 0!==r){const e=r.parents[0].ID,n=r.parents[0].relationship;n.match(/X/)?t.get(e).curves.x=i:n.match(/Y/)?t.get(e).curves.y=i:n.match(/Z/)?t.get(e).curves.z=i:n.match(/d|DeformPercent/)&&t.has(e)&&(t.get(e).curves.morph=i)}}}parseAnimationLayers(t){const e=zv.Objects.AnimationLayer,n=new Map;for(const i in e){const e=[],r=kv.get(parseInt(i));void 0!==r&&(r.children.forEach((function(n,i){if(t.has(n.ID)){const r=t.get(n.ID);if(void 0!==r.curves.x||void 0!==r.curves.y||void 0!==r.curves.z){if(void 0===e[i]){const t=kv.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID;if(void 0!==t){const r=zv.Objects.Model[t.toString()];if(void 0===r)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const o={modelName:r.attrName?Ad.PropertyBinding.sanitizeNodeName(r.attrName):"",ID:r.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Bv.traverse((function(t){t.ID===r.id&&(o.transform=t.matrix,t.userData.transformData&&(o.eulerOrder=t.userData.transformData.eulerOrder))})),o.transform||(o.transform=new Ad.Matrix4),"PreRotation"in r&&(o.preRotation=r.PreRotation.value),"PostRotation"in r&&(o.postRotation=r.PostRotation.value),e[i]=o}}e[i]&&(e[i][r.attr]=r)}else if(void 0!==r.curves.morph){if(void 0===e[i]){const t=kv.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID,r=kv.get(t).parents[0].ID,o=kv.get(r).parents[0].ID,s=kv.get(o).parents[0].ID,a=zv.Objects.Model[s],l={modelName:a.attrName?Ad.PropertyBinding.sanitizeNodeName(a.attrName):"",morphName:zv.Objects.Deformer[t].attrName};e[i]=l}e[i][r.attr]=r}}})),n.set(parseInt(i),e))}return n}parseAnimStacks(t){const e=zv.Objects.AnimationStack,n={};for(const i in e){const r=kv.get(parseInt(i)).children;r.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=t.get(r[0].ID);n[i]={name:e[i].attrName,layer:o}}return n}addClip(t){let e=[];const n=this;return t.layer.forEach((function(t){e=e.concat(n.generateTracks(t))})),new Ad.AnimationClip(t.name,-1,e)}generateTracks(t){const e=[];let n=new Ad.Vector3,i=new Ad.Quaternion,r=new Ad.Vector3;if(t.transform&&t.transform.decompose(n,i,r),n=n.toArray(),i=(new Ad.Euler).setFromQuaternion(i,t.eulerOrder).toArray(),r=r.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){const i=this.generateVectorTrack(t.modelName,t.T.curves,n,"position");void 0!==i&&e.push(i)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){const n=this.generateRotationTrack(t.modelName,t.R.curves,i,t.preRotation,t.postRotation,t.eulerOrder);void 0!==n&&e.push(n)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){const n=this.generateVectorTrack(t.modelName,t.S.curves,r,"scale");void 0!==n&&e.push(n)}if(void 0!==t.DeformPercent){const n=this.generateMorphTrack(t);void 0!==n&&e.push(n)}return e}generateVectorTrack(t,e,n,i){const r=this.getTimesForAllAxes(e),o=this.getKeyframeTrackValues(r,e,n);return new Ad.VectorKeyframeTrack(t+"."+i,r,o)}generateRotationTrack(t,e,n,i,r,o){void 0!==e.x&&(this.interpolateRotations(e.x),e.x.values=e.x.values.map(Ad.MathUtils.degToRad)),void 0!==e.y&&(this.interpolateRotations(e.y),e.y.values=e.y.values.map(Ad.MathUtils.degToRad)),void 0!==e.z&&(this.interpolateRotations(e.z),e.z.values=e.z.values.map(Ad.MathUtils.degToRad));const s=this.getTimesForAllAxes(e),a=this.getKeyframeTrackValues(s,e,n);void 0!==i&&((i=i.map(Ad.MathUtils.degToRad)).push(o),i=(new Ad.Euler).fromArray(i),i=(new Ad.Quaternion).setFromEuler(i)),void 0!==r&&((r=r.map(Ad.MathUtils.degToRad)).push(o),r=(new Ad.Euler).fromArray(r),r=(new Ad.Quaternion).setFromEuler(r).invert());const l=new Ad.Quaternion,u=new Ad.Euler,c=[];for(let t=0;t<a.length;t+=3)u.set(a[t],a[t+1],a[t+2],o),l.setFromEuler(u),void 0!==i&&l.premultiply(i),void 0!==r&&l.multiply(r),l.toArray(c,t/3*4);return new Ad.QuaternionKeyframeTrack(t+".quaternion",s,c)}generateMorphTrack(t){const e=t.DeformPercent.curves.morph,n=e.values.map((function(t){return t/100})),i=Bv.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new Ad.NumberKeyframeTrack(t.modelName+".morphTargetInfluences["+i+"]",e.times,n)}getTimesForAllAxes(t){let e=[];if(void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort((function(t,e){return t-e})),e.length>1){let t=1,n=e[0];for(let i=1;i<e.length;i++){const r=e[i];r!==n&&(e[t]=r,n=r,t++)}e=e.slice(0,t)}return e}getKeyframeTrackValues(t,e,n){const i=n,r=[];let o=-1,s=-1,a=-1;return t.forEach((function(t){if(e.x&&(o=e.x.times.indexOf(t)),e.y&&(s=e.y.times.indexOf(t)),e.z&&(a=e.z.times.indexOf(t)),-1!==o){const t=e.x.values[o];r.push(t),i[0]=t}else r.push(i[0]);if(-1!==s){const t=e.y.values[s];r.push(t),i[1]=t}else r.push(i[1]);if(-1!==a){const t=e.z.values[a];r.push(t),i[2]=t}else r.push(i[2])})),r}interpolateRotations(t){for(let e=1;e<t.values.length;e++){const n=t.values[e-1],i=t.values[e]-n,r=Math.abs(i);if(r>=180){const o=r/180,s=i/o;let a=n+s;const l=t.times[e-1],u=(t.times[e]-l)/o;let c=l+u;const h=[],d=[];for(;c<t.times[e];)h.push(c),c+=u,d.push(a),a+=s;t.times=ds(t.times,e,h),t.values=ds(t.values,e,d)}}}}class jv{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,e){this.currentProp=t,this.currentPropName=e}parse(t){this.currentIndent=0,this.allNodes=new Wv,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const e=this,n=t.split(/[\r\n]+/);return n.forEach((function(t,i){const r=t.match(/^[\s\t]*;/),o=t.match(/^[\s\t]*$/);if(r||o)return;const s=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),a=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=t.match("^\\t{"+(e.currentIndent-1)+"}}");s?e.parseNodeBegin(t,s):a?e.parseNodeProperty(t,a,n[++i]):l?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)})),this.allNodes}parseNodeBegin(t,e){const n=e[1].trim().replace(/^"/,"").replace(/"$/,""),i=e[2].split(",").map((function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")})),r={name:n},o=this.parseNodeAttr(i),s=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,r):n in s?("PoseNode"===n?s.PoseNode.push(r):void 0!==s[n].id&&(s[n]={},s[n][s[n].id]=s[n]),""!==o.id&&(s[n][o.id]=r)):"number"==typeof o.id?(s[n]={},s[n][o.id]=r):"Properties70"!==n&&(s[n]="PoseNode"===n?[r]:r),"number"==typeof o.id&&(r.id=o.id),""!==o.name&&(r.attrName=o.name),""!==o.type&&(r.attrType=o.type),this.pushStack(r)}parseNodeAttr(t){let e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));let n="",i="";return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),i=t[2]),{id:e,name:n,type:i}}parseNodeProperty(t,e,n){let i=e[1].replace(/^"/,"").replace(/"$/,"").trim(),r=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===i&&","===r&&(r=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===i){const t=r.split(",").slice(1),e=parseInt(t[0]),n=parseInt(t[1]);let s=r.split(",").slice(3);s=s.map((function(t){return t.trim().replace(/^"/,"")})),i="connections",r=[e,n],function(t,e){for(let n=0,i=t.length,r=e.length;n<r;n++,i++)t[i]=e[n]}(r,s),void 0===o[i]&&(o[i]=[])}"Node"===i&&(o.id=r),i in o&&Array.isArray(o[i])?o[i].push(r):"a"!==i?o[i]=r:o.a=r,this.setCurrentProp(o,i),"a"===i&&","!==r.slice(-1)&&(o.a=cs(r))}else this.parseNodeSpecialProperty(t,i,r)}parseNodePropertyContinued(t){const e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=cs(e.a))}parseNodeSpecialProperty(t,e,n){const i=n.split('",').map((function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")})),r=i[0],o=i[1],s=i[2],a=i[3];let l=i[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=cs(l)}this.getPrevNode()[r]={type:o,type2:s,flag:a,value:l},this.setCurrentProp(this.getPrevNode(),r)}}class Gv{parse(t){const e=new Hv(t);e.skip(23);const n=e.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const i=new Wv;for(;!this.endOfContent(e);){const t=this.parseNode(e,n);null!==t&&i.add(t.name,t)}return i}endOfContent(t){return t.size()%16==0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,e){const n={},i=e>=7500?t.getUint64():t.getUint32(),r=e>=7500?t.getUint64():t.getUint32();e>=7500?t.getUint64():t.getUint32();const o=t.getUint8(),s=t.getString(o);if(0===i)return null;const a=[];for(let e=0;e<r;e++)a.push(this.parseProperty(t));const l=a.length>0?a[0]:"",u=a.length>1?a[1]:"",c=a.length>2?a[2]:"";for(n.singleProperty=1===r&&t.getOffset()===i;i>t.getOffset();){const i=this.parseNode(t,e);null!==i&&this.parseSubNode(s,n,i)}return n.propertyList=a,"number"==typeof l&&(n.id=l),""!==u&&(n.attrName=u),""!==c&&(n.attrType=c),""!==s&&(n.name=s),n}parseSubNode(t,e,n){if(!0===n.singleProperty){const t=n.propertyList[0];Array.isArray(t)?(e[n.name]=n,n.a=t):e[n.name]=t}else if("Connections"===t&&"C"===n.name){const t=[];n.propertyList.forEach((function(e,n){0!==n&&t.push(e)})),void 0===e.connections&&(e.connections=[]),e.connections.push(t)}else if("Properties70"===n.name)Object.keys(n).forEach((function(t){e[t]=n[t]}));else if("Properties70"===t&&"P"===n.name){let t=n.propertyList[0],i=n.propertyList[1];const r=n.propertyList[2],o=n.propertyList[3];let s;0===t.indexOf("Lcl ")&&(t=t.replace("Lcl ","Lcl_")),0===i.indexOf("Lcl ")&&(i=i.replace("Lcl ","Lcl_")),s="Color"===i||"ColorRGB"===i||"Vector"===i||"Vector3D"===i||0===i.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],e[t]={type:i,type2:r,flag:o,value:s}}else void 0===e[n.name]?"number"==typeof n.id?(e[n.name]={},e[n.name][n.id]=n):e[n.name]=n:"PoseNode"===n.name?(Array.isArray(e[n.name])||(e[n.name]=[e[n.name]]),e[n.name].push(n)):void 0===e[n.name][n.id]&&(e[n.name][n.id]=n)}parseProperty(t){const e=t.getString(1);let n;switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return n=t.getUint32(),t.getArrayBuffer(n);case"S":return n=t.getUint32(),t.getString(n);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const i=t.getUint32(),r=t.getUint32(),o=t.getUint32();if(0===r)switch(e){case"b":case"c":return t.getBooleanArray(i);case"d":return t.getFloat64Array(i);case"f":return t.getFloat32Array(i);case"i":return t.getInt32Array(i);case"l":return t.getInt64Array(i)}void 0===Ss&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const s=Yo(new Uint8Array(t.getArrayBuffer(o))),a=new Hv(s.buffer);switch(e){case"b":case"c":return a.getBooleanArray(i);case"d":return a.getFloat64Array(i);case"f":return a.getFloat32Array(i);case"i":return a.getInt32Array(i);case"l":return a.getInt64Array(i)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+e)}}}class Hv{constructor(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(t){const e=[];for(let n=0;n<t;n++)e.push(this.getBoolean());return e}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt32());return e}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),2147483648&e?(e=4294967295&~e,t=4294967295&~t,4294967295===t&&(e=e+1&4294967295),t=t+1&4294967295,-(4294967296*e+t)):4294967296*e+t}getInt64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt64());return e}getUint64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),4294967296*e+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat32());return e}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat64());return e}getArrayBuffer(t){const e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}getString(t){let e=[];for(let n=0;n<t;n++)e[n]=this.getUint8();const n=e.indexOf(0);return n>=0&&(e=e.slice(0,n)),Ad.LoaderUtils.decodeText(new Uint8Array(e))}}class Wv{add(t,e){this[t]=e}}const Xv=[],Yv=new Ad.Euler,Zv=new Ad.Vector3,Qv=[{name:"Loader",dependency:Tc},{name:"FBXLoader",dependency:Fv}],Jv=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.assets=e}var e,n;return e=t,(n=[{key:"filterAssets",value:function(t,e){this.assets[t]=this.assets[t].filter((function(t){return!t.url.includes(e)}))}}])&&ps(e.prototype,n),t}();var Kv=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=a.call(this,{width:e.size.width,height:e.size.height,transparent:!0,antialias:!0})).pausers=new Set,t.gameController=null,t.assetsPreloader=null,t.assetsManager=null,t.platformMediator=null,t.currentWindow=null,t.platformApi=null,e.instance=bs(t),t.container=document.querySelector("#game"),t.renderer3d=null,t.currentScene=null,t.create3DRenderer(),t.view.style.position="absolute",t.view.style.left="0",t.view.style.top="0",t.container.appendChild(t.view),Nd.Tween.prototype._start=Nd.Tween.prototype.start,Nd.Tween.prototype.start=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.liveTime;return Nd.Tween.prototype._start.call(this,t)},jd.init(),jd.on("resize",t.handleResize,bs(t)),jd.start(),t.init(),t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vs(t,e)}(e,t);var n,i,r,o,s,a=xs(e);return n=e,i=[{key:"create3DRenderer",value:function(){var t=new Ad.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});t.shadowMap.enabled=!0,t.shadowMap.type=Ad.PCFSoftShadowMap,t.domElement.style.position="absolute",t.domElement.style.left="0",t.domElement.style.top="0",this.container.appendChild(t.domElement),this.renderer3d=t}},{key:"init",value:(s=gs(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return bp.injectOptionalDependencies(Qv),this.platformApi=new vp,window.platformApi=this.platformApi,Ym.Common.setDecomp(Lg()),this.assetsManager=new Jv(Og),this.gameController=new hg,e=this.assetsManager.assets,tp=e,this.assetsPreloader=new bp(this.assetsManager.assets,{doNotWaitForSounds:!0}),t.next=10,this.preloadAssets();case 10:Wd.init(this.assetsManager.assets.sounds),jd.on("visibilityChange",this.handleVisibilityChange,this),this.gameController.init(),this.ticker.add(this.tick,this);case 14:case"end":return t.stop()}var e}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"preloadAssets",value:(o=gs(regeneratorRuntime.mark((function t(){var e,n,i,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("preloader-progress"),n=function(t){e.innerText="".concat(t,"%"),r.platformApi.setLoadingProgress(t)},i=new Promise((function(t){r.assetsPreloader.once("complete",t)})),this.assetsPreloader.on("progress",n),this.assetsPreloader.load(),t.next=7,i;case 7:this.assetsPreloader.off("progress",n),n(100),e.remove();case 10:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"handleResize",value:function(t){this.renderer.resize(t.width,t.height),this.view.style.width=jd.width+"px",this.view.style.height=jd.height+"px",this.renderer3d.setSize(t.width,t.height),this.renderer3d.setPixelRatio(Math.max(1,window.devicePixelRatio/2)),this.renderer3d.domElement.style.width=jd.width+"px",this.renderer3d.domElement.style.height=jd.height+"px",this.currentWindow&&this.currentWindow.position.set(t.width/2,t.height/2)}},{key:"handleVisibilityChange",value:function(t){var e="visibilityChange";t.hidden?this.pause(e):this.resume(e)}},{key:"showWindow",value:function(t){this.currentWindow&&(this.currentWindow.handleRemove(),this.stage.removeChild(this.currentWindow)),this.stage.addChild(t),this.currentWindow=t,t.position.set(jd.gameWidth/2,jd.gameHeight/2)}},{key:"showScene",value:function(t){this.currentScene&&this.currentScene.handleRemove(),this.currentScene=t}},{key:"pause",value:function(t){this.pausers.add(t),Wd.mute()}},{key:"resume",value:function(t){this.pausers.delete(t),this.paused||Wd.unmute()}},{key:"tick",value:function(){if(!this.paused){var t=this.ticker.elapsedMS;t>42&&(t=42),e.liveTime+=t,Nd.update(e.liveTime),cp.update(t),mp.update(t),yp.update(t),this.gameController.tick(t),this.currentWindow&&this.currentWindow.tick(t),this.currentScene&&this.currentScene.tick(t)}}},{key:"paused",get:function(){return this.pausers.size>0}}],r=[{key:"getSystemFont",value:function(){return"-apple-system,BlinkMacSystemFont,Roboto,Helvetica,Arial,sans-serif"}}],i&&ys(n.prototype,i),r&&ys(n,r),e}(ac);ws(Kv,"size",{width:960,height:960}),ws(Kv,"liveTime",0),ws(Kv,"instance",null),ws(Kv,"observer",new(Td()));const $v=Kv;window.runGame=function(){new $v}})()})();