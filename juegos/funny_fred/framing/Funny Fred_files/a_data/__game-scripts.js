var RopeController=pc.createScript("ropeController");RopeController.attributes.add("segmentCount",{type:"number",default:10,min:3,title:"Number of Segments"}),RopeController.attributes.add("startEntity",{type:"entity",title:"Start Entity"}),RopeController.attributes.add("endEntity",{type:"entity",title:"End Entity"}),RopeController.attributes.add("segmentPrefab",{type:"asset",title:"Segment Prefab"}),RopeController.attributes.add("pivotA",{title:"Pivot",type:"vec3",default:[0,.1,0]}),RopeController.attributes.add("pivotB",{title:"Connected Pivot",type:"vec3",default:[0,.1,0]}),RopeController.attributes.add("destroyDelay",{type:"number",default:100,title:"Segment Destruction Delay"}),RopeController.attributes.add("segmentWeightMin",{type:"number",default:5,title:"Minimum Segment Weight"}),RopeController.attributes.add("actionID",{type:"number",default:0,title:"Action ID"}),RopeController.prototype.update=function(t){this.init()},RopeController.prototype.init=function(){if(!this.isInit){this.isInit=!0,this.ropeSegments=[];for(var t=0;t<this.segmentCount;t++){var e=this.segmentPrefab.resource.instantiate();this.ropeSegments.push(e),this.entity.addChild(e),e.setPosition(this.startEntity.getPosition());var i=this.segmentWeightMin+(this.segmentCount-1)-t;if(e.rigidbody.mass=i,(0==t?this.startEntity:this.ropeSegments[t-1]).script.pointToPointConstraint.entityB=e,t==this.segmentCount-1){var o=e.script.pointToPointConstraint;o.pivotA=this.pivotA,o.pivotB=this.pivotB,o.entityB=this.endEntity}}}},RopeController.prototype.reset=function(t){this.ropeSegments.forEach((t=>{t.children.forEach((t=>{t.destroy()}))}));var e=this.ropeSegments.indexOf(t);this.ropeSegments[e].destroy(),this.destroySegmentWithDelay(e)},RopeController.prototype.destroySegmentWithDelay=function(t){var e=this;setTimeout((function(){e.ropeSegments[t].destroy(),++t<e.segmentCount&&e.destroySegmentWithDelay(t)}),this.destroyDelay)};var PointToPointConstraint=pc.createScript("pointToPointConstraint");PointToPointConstraint.attributes.add("pivotA",{title:"Pivot",type:"vec3",default:[0,0,0]}),PointToPointConstraint.attributes.add("entityB",{title:"Connected Entity",type:"entity"}),PointToPointConstraint.attributes.add("pivotB",{title:"Connected Pivot",type:"vec3",default:[0,0,0]}),PointToPointConstraint.attributes.add("breakingThreshold",{title:"Break Threshold",type:"number",default:34e37}),PointToPointConstraint.attributes.add("enableCollision",{title:"Enable Collision",type:"boolean",default:!0}),PointToPointConstraint.attributes.add("debugRender",{title:"Debug Render",type:"boolean",default:!1}),PointToPointConstraint.attributes.add("debugColor",{title:"Debug Color",type:"rgb",default:[1,0,0]}),PointToPointConstraint.prototype.initialize=function(){this.createConstraint(),this.on("attr",(function(t,i,n){"pivotA"===t||"entityB"===t||"pivotB"===t?this.createConstraint():"breakingThreshold"===t&&(this.constraint.setBreakingImpulseThreshold(this.breakingThreshold),this.activate())})),this.on("enable",(function(){this.createConstraint()})),this.on("disable",(function(){this.destroyConstraint()})),this.on("destroy",(function(){this.destroyConstraint()}))},PointToPointConstraint.prototype.createConstraint=function(){this.constraint&&this.destroyConstraint();var t,i,n=this.entity.rigidbody.body,o=new Ammo.btVector3(this.pivotA.x,this.pivotA.y,this.pivotA.z);this.entityB&&this.entityB.rigidbody?(t=this.entityB.rigidbody.body,i=new Ammo.btVector3(this.pivotB.x,this.pivotB.y,this.pivotB.z),this.constraint=new Ammo.btPoint2PointConstraint(n,t,o,i)):this.constraint=new Ammo.btPoint2PointConstraint(n,o),this.app.systems.rigidbody.dynamicsWorld.addConstraint(this.constraint,!this.enableCollision),this.activate()},PointToPointConstraint.prototype.destroyConstraint=function(){this.constraint&&(this.app.systems.rigidbody.dynamicsWorld.removeConstraint(this.constraint),Ammo.destroy(this.constraint),this.constraint=null)},PointToPointConstraint.prototype.activate=function(){this.entity.rigidbody.activate(),this.entityB&&this.entityB.rigidbody.activate()},PointToPointConstraint.prototype.update=function(t){var i;this.debugRender&&(i=new pc.Vec3,this.entity.getWorldTransform().transformPoint(this.pivotA,i),this.app.renderLine(this.entity.getPosition(),i,this.debugColor),this.entityB&&this.app.renderLine(this.entityB.getPosition(),i,this.debugColor))};var PlayerController=pc.createScript("playerController");PlayerController.attributes.add("runSpeed",{type:"number",default:3,min:1,title:"Player Speed"}),PlayerController.attributes.add("model",{type:"entity",title:"Player Model"}),PlayerController.attributes.add("trigger",{type:"entity",title:"Player Trigger"}),PlayerController.attributes.add("rope",{type:"entity",title:"Player Rope"}),PlayerController.prototype.update=function(){if(this.init(),this.stage>0)switch(this.currentPosition=this.entity.getPosition(),this.stage){case 1:this.distanceToDoor("x")?this.linearVelocity(this.directionToDoor("x")):(this.unblockLines(),this.linearVelocityReset(),this.door.openDoor(this),this.stage=4);break;case 2:Math.abs(this.entity.rigidbody.linearVelocity.y)<=.5?this.linearVelocity(new pc.Vec3(-1,0,0)):(this.linearVelocityReset(),this.modelRotate(),this.animator(2));break;case 3:Math.abs(this.entity.rigidbody.linearVelocity.y)<=.5?this.linearVelocity(new pc.Vec3(1,0,0)):(this.linearVelocityReset(),this.modelRotate(),this.animator(2));break;case 4:if(this.distanceToDoor("z"))this.linearVelocity(this.directionToDoor("z"));else{this.linearVelocityReset();var t=new pc.Vec3(0,-90,0);this.model.tween(this.model.getLocalEulerAngles()).rotate(t,.25,pc.Linear).start(),this.animator(3),this.stage=-1}break;case 5:Math.abs(this.entity.rigidbody.linearVelocity.y)<=.5?(this.animator(3),this.linearVelocityReset()):(this.animator(2),this.modelRotate(.1,-30,90))}},PlayerController.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem,this.entity.rigidbody.on("collisionstart",this.onCollisionStart,this),this.trigger.collision.on("triggerenter",this.onTriggerEnter,this),this.currentPosition=this.entity.getPosition(),this.door=this.app.root.findByName("Door").script.doorComponent,this.doorPosition=this.door.playerPoint.getPosition(),this.stage=0)},PlayerController.prototype.onCollisionStart=function(t){var e=t.other;if(!this.gameSystem.isFail&&e.tags.has("Ground")){var i=e.script.groundComponent;this.stage=i.groundType,this.destroyRope(),this.animator(1)}else e.tags.has("Jump")?(e.collision.enabled=!1,this.jump(e.script.jumpComponent)):e.tags.has("Idle")&&(this.destroyRope(),this.stage=5)},PlayerController.prototype.onTriggerEnter=function(t){t.tags.has("Damage")?this.fail():t.tags.has("Hole")&&(this.fail(!0),this.gameSystem.playSound("Water"))},PlayerController.prototype.jump=function(t){this.entity.rigidbody.enabled=!1;var e=t.isRight?.35:-.35,i=this.entity.getLocalPosition(),o=new pc.Vec3(i.x+e,i.y,i.z),n=this;this.entity.tween(i).to(o,.75/this.runSpeed,pc.Linear).on("complete",(function(){n.animator(6),t.jump(),i=n.entity.getLocalPosition(),o=new pc.Vec3(i.x,i.y-.1,i.z),n.entity.tween(i).to(o,.7,pc.Linear).on("complete",(function(){i=n.entity.getLocalPosition(),o=new pc.Vec3(i.x+t.upPoint.x,i.y+t.upPoint.y,i.z),n.entity.tween(i).to(o,.65,pc.Linear).on("complete",(function(){i=n.entity.getLocalPosition(),o=new pc.Vec3(i.x+t.downPoint.x,i.y-t.downPoint.y,i.z),n.entity.tween(i).to(o,.25,pc.Linear).on("complete",(function(){n.entity.rigidbody.enabled=!0})).start()})).start(),n.gameSystem.playSound("Landing")})).start()})).start()},PlayerController.prototype.fail=function(t=!1){this.gameSystem.isFail||(this.destroyRope(),this.stage=0,this.gameSystem.isFail=!0,this.door.openDoor(this,!0),this.linearVelocityReset(),t?(this.animator(7),this.gameSystem.createEffect(2,this.entity)):(this.animator(5),this.gameSystem.createEffect(1,this.entity)),this.gameSystem.playSound("Lose"))},PlayerController.prototype.distanceToDoor=function(t){var e="x"==t?this.doorPosition.x-this.currentPosition.x:this.doorPosition.z-this.currentPosition.z;return Math.abs(e)>.2},PlayerController.prototype.directionToDoor=function(t){return("x"==t?new pc.Vec3(this.doorPosition.x,this.doorPosition.y,this.currentPosition.z):this.doorPosition).clone().sub(this.currentPosition).normalize()},PlayerController.prototype.linearVelocity=function(t){var e=t.scale(this.runSpeed);this.entity.rigidbody.linearVelocity=new pc.Vec3(e.x,this.entity.rigidbody.linearVelocity.y,e.z),this.modelRotate()},PlayerController.prototype.linearVelocityReset=function(){this.entity.rigidbody.linearVelocity=new pc.Vec3(0,this.entity.rigidbody.linearVelocity.y,0)},PlayerController.prototype.unblockLines=function(){var t=this.entity.rigidbody.linearFactor.x,e=new pc.Vec3(t,this.entity.rigidbody.linearFactor.y,t);this.entity.rigidbody.linearFactor=e},PlayerController.prototype.modelRotate=function(t=.1,e=-90,i=90){var o=0,n=this.entity.rigidbody.linearVelocity.x,r=this.entity.rigidbody.linearVelocity.z;o=Math.abs(n)>Math.abs(r)?n>0?i:e:r<0?180:0;var s=new pc.Vec3(0,o,0);this.model.tween(this.model.getLocalEulerAngles()).rotate(s,t,pc.Linear).start()},PlayerController.prototype.animator=function(t){this.entity.anim.speed=this.runSpeed,this.entity.anim.setInteger("stateID",t)},PlayerController.prototype.applyImpulse=function(){this.entity.rigidbody.applyImpulse(0,-1,0)},PlayerController.prototype.destroyRope=function(){if(!this.isRope){this.isRope=!0;var t=this.rope.getLocalPosition(),e=new pc.Vec3(t.x,t.y-.4,t.z),i=this;this.rope.tween(t).to(e,.5,pc.BounceOut).on("complete",(function(){i.rope.destroy()})).start(),this.gameSystem.playSound("Landing")}};var RopeCutting=pc.createScript("ropeCutting");RopeCutting.prototype.update=function(t){this.init()},RopeCutting.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem,this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.mouseUp,this),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.touchEnd,this)))},RopeCutting.prototype.mouseDown=function(t){this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.mouseMove,this)},RopeCutting.prototype.mouseMove=function(t){this.doRaycast(t.x,t.y)},RopeCutting.prototype.mouseUp=function(t){this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.mouseMove,this)},RopeCutting.prototype.touchStart=function(t){this.app.touch.on(pc.EVENT_TOUCHMOVE,this.touchMove,this)},RopeCutting.prototype.touchMove=function(t){1===t.touches.length&&this.doRaycast(t.touches[0].x,t.touches[0].y),t.event.preventDefault()},RopeCutting.prototype.touchEnd=function(t){this.app.touch.off(pc.EVENT_TOUCHMOVE,this.touchMove,this)},RopeCutting.prototype.doRaycast=function(t,o){if(!this.gameSystem.isFail&&!this.gameSystem.paused){var i=this.entity.getPosition(),e=this.entity.camera.screenToWorld(t,o,this.entity.camera.farClip),p=this.app.systems.rigidbody.raycastFirst(i,e);if(p){var s=p.entity;if("RopeTrigger"==s.name){var n=s.parent,a=n.parent.script.ropeController;a.reset(n);var h=a.endEntity.script.playerController;h&&h.applyImpulse();var c=a.endEntity.script.platformComponent;c&&c.action(a.actionID);var r=a.endEntity.script.cellComponent;r&&r.action();var u=a.endEntity.script.tramplinComponent;u&&u.action(),this.gameSystem.destroyTutorial(),this.gameSystem.playSound("Knife")}}}};var DoorComponent=pc.createScript("doorComponent");DoorComponent.attributes.add("girl",{type:"entity",title:"Girl"}),DoorComponent.attributes.add("openPoint",{type:"entity",title:"Open Point"}),DoorComponent.attributes.add("openAngle",{type:"number",title:"Open Angle"}),DoorComponent.attributes.add("playerPoint",{type:"entity",title:"Player Point"}),DoorComponent.attributes.add("girlPoint",{type:"entity",title:"Girl Point"}),DoorComponent.attributes.add("effectPoint",{type:"entity",title:"Effect Point"}),DoorComponent.prototype.update=function(t){this.init()},DoorComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem)},DoorComponent.prototype.openDoor=function(t,e=!1){this.player=t,this.isFail=e;var o=new pc.Vec3(0,0,this.openAngle);this.openPoint.tween(this.openPoint.getLocalEulerAngles()).rotate(o,.5,pc.Linear).start();var n=this.girl.getLocalPosition(),i=this.girlPoint.getLocalPosition(),a=new pc.Vec3(i.x,n.y,i.z),r=this;this.girl.tween(n).to(a,1,pc.Linear).on("complete",(function(){r.isFail?(r.animator(3),r.gameSystem.createEffect(3,r.girl),r.girl.tween(r.girl.getLocalEulerAngles()).rotate(new pc.Vec3(0,90,0),2,pc.Linear).on("complete",(function(){r.gameSystem.levelFailed()})).start(),r.gameSystem.playSound("Cry")):(r.girl.tween(r.girl.getLocalEulerAngles()).rotate(new pc.Vec3(0,90,0),.25,pc.Linear).on("complete",(function(){r.animator(2),r.player.animator(4),r.girl.tween(r.girl.getLocalEulerAngles()).rotate(new pc.Vec3(0,90,0),2,pc.Linear).on("complete",(function(){r.gameSystem.levelCompleted()})).start(),r.gameSystem.createEffect(0,r.girl),r.gameSystem.createEffect(0,r.playerPoint),r.gameSystem.createEffect(4,r.effectPoint),r.gameSystem.playSound("Kiss")})).start(),r.cameraZoom(.45),r.gameSystem.playSound("Win"))})).start()},DoorComponent.prototype.cameraZoom=function(t){var e=this.gameSystem.mainCamera,o=e.getLocalPosition(),n=this.entity.getLocalPosition().clone(),i=new pc.Vec3(n.x+.35,n.y/2,o.z);e.tween(o).to(i,t,pc.Linear).start();var a=e.camera,r={fov:a.fov};e.tween(r).to({fov:25},t,pc.Linear).on("update",(function(){a.fov=r.fov})).start(),this.gameSystem.settingsPanel.enabled=!1,this.gameSystem.effectCamera.enabled=!1},DoorComponent.prototype.animator=function(t){this.girl.anim.setInteger("stateID",t)};var GroundComponent=pc.createScript("groundComponent");GroundComponent.attributes.add("groundType",{type:"number",enum:[{Floor:1},{Left:2},{Right:3}],default:1,title:"Ground Type"});var PlatformComponent=pc.createScript("platformComponent");PlatformComponent.attributes.add("platformType",{type:"number",enum:[{Rotate:1},{Hand:2}],default:1,title:"Platform Type"}),PlatformComponent.attributes.add("rotateDuration",{type:"number",title:"Rotate Duration"}),PlatformComponent.attributes.add("rotateAngle",{type:"number",title:"Rotate Angle"}),PlatformComponent.attributes.add("targetPosition",{type:"vec3",title:"Platform Position"}),PlatformComponent.attributes.add("endPosition",{type:"vec3",title:"Platform Position End"}),PlatformComponent.attributes.add("state",{type:"number",default:0,title:"Platform State"}),PlatformComponent.attributes.add("disableActionID",{type:"number",title:"Disable ActionID"}),PlatformComponent.attributes.add("disableZones",{type:"entity",array:!0,title:"Disable Zones"}),PlatformComponent.attributes.add("tagList",{type:"string",array:!0,title:"Tag List"}),PlatformComponent.attributes.add("cell",{type:"entity",title:"Cell Entity"}),PlatformComponent.attributes.add("dog",{type:"entity",title:"Dog Entity"}),PlatformComponent.attributes.add("isFall",{type:"boolean",title:"Rotate Fall"}),PlatformComponent.prototype.action=function(t){switch(this.platformType){case 1:var e=new pc.Vec3(0,0,this.rotateAngle),o=this;if(this.entity.tween(this.entity.getLocalEulerAngles()).rotate(e,this.rotateDuration,pc.Linear).on("complete",(function(){o.setTag(0)})).start(),this.disableZones.forEach((t=>t.script.attackZoneComponent.collisionOff(!0))),this.cell&&this.cell.script.cellComponent.updateState(),this.isFall){var i=this.entity.getLocalPosition(),n=new pc.Vec3(i.x,this.targetPosition.y,i.z);this.entity.tween(i).to(n,this.rotateDuration,pc.Linear).on("complete",(function(){})).start()}break;case 2:if(0==this.state){var a=0==t?this.rotateAngle:-this.rotateAngle,s=(e=new pc.Vec3(0,0,a),i=this.entity.getLocalPosition(),0==t?this.targetPosition.x:-this.targetPosition.x);n=new pc.Vec3(i.x+s,this.targetPosition.y,this.targetPosition.z),o=this;this.rotationTween=this.entity.tween(this.entity.getLocalEulerAngles()).delay(.1).rotate(e,this.rotateDuration,pc.Linear).start(),this.positionTween=this.entity.tween(i).delay(.1).to(n,this.rotateDuration,pc.Linear).on("complete",(function(){o.state=2,o.disableActionID==t&&o.disableZones.forEach((t=>t.script.attackZoneComponent.collisionOff())),o.dog&&o.dog.script.dogComponent.action(),o.setTag(0)})).start(),this.state=1}else if(1==this.state){this.rotationTween.stop(),this.positionTween.stop();var r=this.rotateDuration;o=this;this.entity.tween(this.entity.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,0),r,pc.Linear).start(),this.entity.tween(this.entity.getLocalPosition()).to(o.endPosition,r,pc.BounceOut).on("complete",(function(){o.setTag(1)})).start(),o.state=2}}},PlatformComponent.prototype.setTag=function(t){this.entity.tags.clear(),this.tagList.lenght<t+1||this.entity.tags.add(this.tagList[t])};var GameSystem=pc.createScript("gameSystem");GameSystem.attributes.add("levelStart",{type:"number",min:1,title:"Level Number"}),GameSystem.attributes.add("effectList",{type:"asset",array:!0,title:"Effect List"}),GameSystem.attributes.add("mainCamera",{type:"entity",title:"Main Camera"}),GameSystem.attributes.add("effectCamera",{type:"entity",title:"Effect Camera"}),GameSystem.attributes.add("cameraPosition",{type:"vec3",title:"Camera Position"}),GameSystem.attributes.add("cameraFov",{type:"number",title:"Camera Fov"}),GameSystem.attributes.add("background",{type:"asset",title:"Background Asset"}),GameSystem.attributes.add("tutorialAsset",{type:"asset",title:"Tutorial Asset"}),GameSystem.attributes.add("audio",{type:"entity",title:"Audio List"}),GameSystem.attributes.add("settingsPanel",{type:"entity",title:"Settings Panel"}),GameSystem.attributes.add("soundButton",{type:"entity",title:"Sound Button"}),GameSystem.attributes.add("back",{type:"entity",title:"Background"}),GameSystem.attributes.add("levelText",{type:"entity",title:"Level Text"}),GameSystem.attributes.add("materialList",{type:"asset",array:!0,title:"Material List"}),document.addEventListener("visibilitychange",(function(){if("visible"===document.visibilityState){var t=pc.Application.getApplication().root.findByName("GameSystem").script.gameSystem;if(t){if(t.paused)return;t.audio.sound.play("Music")}}})),GameSystem.prototype.update=function(t){this.init()},GameSystem.prototype.init=function(){if(!this.isInit){this.isInit=!0,this.isTutorial=!0,this.paused=!1,this.mute=!1,this.levelList=[25,22,43,27,44,16,29,8,42,17,6,32,41,3,20,24,38,34,48,15,7,28,14,35,33,13,31,4,11,50,18,9,5,39,37,40,10,26,45,12,22,49,30,47,19,21,46,36,15,23];var t=window.devicePixelRatio||1;this.app.graphicsDevice.maxPixelRatio=t,this.soundButton.button.on("click",this.soundUpdate,this),this.famobiRequest()}},GameSystem.prototype.famobiRequest=function(){let createFamobiRequestHandlers=()=>{if(window.famobi){window.famobi.localStorage.getItem("muted")&&(this.mute=!0,this.audio.sound.volume=0,this.updateUI());var t=window.famobi.localStorage.getItem("level"),e=null==t?1:t;this.createLevel(e)}else setTimeout(createFamobiRequestHandlers,1e3)};createFamobiRequestHandlers()},GameSystem.prototype.pauseGame=function(){this.paused||(this.paused=!0,this.app.timeScale=0,this.audio.sound.volume=0,window.famobi_analytics.trackEvent("EVENT_PAUSE"))},GameSystem.prototype.resumeGame=function(){this.paused&&(this.paused=!1,this.app.timeScale=1,this.mute||(this.audio.sound.volume=1),window.famobi_analytics.trackEvent("EVENT_RESUME"))},GameSystem.prototype.createLevel=function(t){this.levelStart=t,this.isFail=!1;var e=this.app.assets.find("Level "+this.getLevelIndex(t));e&&(this.level&&(this.level.destroy(),this.cloud.destroy()),this.cloud=this.background.resource.instantiate(),this.entity.addChild(this.cloud),this.level=e.resource.instantiate(),this.entity.addChild(this.level),this.cameraReset(),this.audio.sound.stop("Hit"),this.audio.sound.stop("Kiss"),window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:"Level "+this.levelStart}),window.famobi.playerReady(),this.addTutorial()),this.levelText.element.text=this.levelStart},GameSystem.prototype.levelCompleted=function(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"LEVELEND",result:"success"}),this.levelStart++,window.famobi.localStorage.setItem("level",this.levelStart),this.audio.sound.stop("Hit"),this.audio.sound.stop("Kiss");var t=this;setTimeout(function(){Promise.all([window.famobi_analytics.trackEvent("EVENT_LEVELSUCCESS",{levelName:"Level "+this.levelStart}),window.famobi.showInterstitialAd()]).then((function(){t.createLevel(t.levelStart)}))}.bind(this),2e3)},GameSystem.prototype.levelFailed=function(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"LEVELEND",result:"fail"}),this.audio.sound.stop("Hit"),this.audio.sound.stop("Kiss");var t=this;setTimeout(function(){Promise.all([window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:"Level "+this.levelStart,reason:"dead"}),window.famobi.showInterstitialAd()]).then((function(){t.createLevel(t.levelStart)}))}.bind(this),2e3)},GameSystem.prototype.cameraReset=function(){this.mainCamera.camera.fov=this.cameraFov,this.mainCamera.setPosition(this.cameraPosition),this.effectCamera.enabled=!0,this.settingsPanel.enabled=!0},GameSystem.prototype.destroyTutorial=function(){this.tutorial&&this.tutorial.destroy()},GameSystem.prototype.createEffect=function(t,e){var i=this.effectList[t].resource.instantiate();switch(e.addChild(i),t){case 3:i.setLocalPosition(new pc.Vec3(-.2,.4,.5));break;case 1:i.setLocalPosition(new pc.Vec3(0,.65,0));break;default:i.setLocalPosition(new pc.Vec3(0,0,0))}},GameSystem.prototype.addTutorial=function(){this.isTutorial&&(this.tutorial=this.tutorialAsset.resource.instantiate(),this.level.addChild(this.tutorial),this.isTutorial=!1)},GameSystem.prototype.playSound=function(t){this.audio.sound.play(t)},GameSystem.prototype.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},GameSystem.prototype.getLevelIndex=function(t){for(var e=t<1?1:t,i=0;e>50;)e-=50,i++;return i>0&&(e=this.levelList[e-1]),e},GameSystem.prototype.soundUpdate=function(){if(!this.paused){this.mute=!this.mute;var t=this.mute?0:1;this.audio.sound.volume=t,this.updateUI(),this.mute?window.famobi.localStorage.setItem("muted",!0):window.famobi.localStorage.removeItem("muted")}},GameSystem.prototype.updateUI=function(){this.soundButton.element.texture=this.materialList[this.audio.sound.volume].resource};var CellComponent=pc.createScript("cellComponent");CellComponent.attributes.add("positionY",{type:"number",array:!0,title:"Position Y"}),CellComponent.attributes.add("fallTime",{type:"number",array:!0,title:"Fall time"}),CellComponent.attributes.add("destroyTime",{type:"number",title:"Destroy time"}),CellComponent.attributes.add("place",{type:"entity",title:"Place"}),CellComponent.attributes.add("partList",{type:"entity",array:!0,title:"Parts without physics"}),CellComponent.attributes.add("partPhysicsList",{type:"entity",array:!0,title:"Parts with physics"}),CellComponent.prototype.update=function(t){this.init()},CellComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.stateID=0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem)},CellComponent.prototype.action=function(){var t=this.entity.getLocalPosition(),e=new pc.Vec3(t.x,this.positionY[this.stateID],t.z),i=this;this.entity.tween(t).to(e,this.fallTime[this.stateID],pc.Linear).on("complete",(function(){i.destroyCell(i),i.placeActivate(i)})).start()},CellComponent.prototype.placeActivate=function(t){var e=t.place.getLocalPosition(),i=new pc.Vec3(e.x,e.y-.15,e.z);t.place.tween(e).to(i,.1,pc.Linear).on("complete",(function(){var e=t.place.getChildren()[0].script.dogComponent;e&&e.action();var i=t.place.getChildren()[0].script.catComponent;i&&i.action();var o=t.place.getChildren()[0].script.policemanComponent;o&&o.action(),t.entity.collision.enabled=!1,t.gameSystem.playSound("Landing")})).start()},CellComponent.prototype.destroyCell=function(t){t.partList.forEach((t=>t.destroy())),t.partPhysicsList.forEach((t=>{t.addComponent("rigidbody",{type:"dynamic",mass:10}),t.rigidbody.applyImpulse(0,25,50)})),t.entity.tween(t.entity.getLocalPosition()).to(t.entity.getLocalPosition(),t.destroyTime,pc.Linear).on("complete",(function(){t.partPhysicsList.forEach((t=>t.destroy()))})).start()},CellComponent.prototype.updateState=function(){this.stateID++};var DogComponent=pc.createScript("dogComponent");DogComponent.attributes.add("speed",{type:"number",title:"Dog Speed"}),DogComponent.attributes.add("target",{type:"entity",title:"Target"}),DogComponent.attributes.add("offset",{type:"number",title:"Target Offset"}),DogComponent.attributes.add("model",{type:"entity",title:"Model"}),DogComponent.attributes.add("effectPoint",{type:"entity",title:"Effect Point"}),DogComponent.attributes.add("isFall",{type:"boolean",default:!1,title:"Fall Active"}),DogComponent.attributes.add("fallTime",{type:"number",title:"Fall Time"}),DogComponent.attributes.add("fallList",{type:"vec3",array:!0,title:"Fall List"}),DogComponent.prototype.update=function(t){this.init()},DogComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem,this.entity.collision.on("triggerenter",this.onTriggerEnter,this))},DogComponent.prototype.onTriggerEnter=function(t){t.tags.has("Player")&&(t.script.playerController.fail(),this.attack(t))},DogComponent.prototype.action=function(){var t=this.target.getPosition().x-this.entity.getPosition().x,e=t<0?-120:120,o=new pc.Vec3(0,e,0);this.offsetPosition=t<0?this.offset:-this.offset;var i=this;this.model.tween(this.model.getLocalEulerAngles()).rotate(o,.1,pc.Linear).on("complete",(function(){i.isFall?i.fall():i.enemyAttack()})).start()},DogComponent.prototype.fall=function(){var t=this.entity.getLocalPosition(),e=new pc.Vec3(t.x+this.fallList[0].x,t.y,t.z),o=t.distance(e),i=this;this.positionTween=this.entity.tween(t).to(e,o/this.speed,pc.Linear).on("complete",(function(){t=i.entity.getLocalPosition(),e=new pc.Vec3(t.x,t.y+i.fallList[1].y,t.z),i.positionTween=i.entity.tween(t).to(e,i.fallTime,pc.Linear).on("complete",(function(){i.enemyAttack()})).start(),i.animator(4)})).start(),this.animator(1)},DogComponent.prototype.enemyAttack=function(){var t=this.entity.getLocalPosition(),e=this.target.getLocalPosition(),o=new pc.Vec3(e.x+this.offsetPosition,t.y,t.z),i=t.distance(e),n=this;this.positionTween=this.entity.tween(t).to(o,i/this.speed,pc.Linear).on("complete",(function(){var t=n.target.script.neighbourComponent;t&&t.stun();var e=n.target.script.catComponent;e&&e.stun(),n.animator(2),n.gameSystem.createEffect(5,n.effectPoint),n.entity.collision.enabled=!1})).start(),this.animator(1)},DogComponent.prototype.attack=function(t){var e=t.getPosition().x-this.entity.getPosition().x<0?-120:120,o=new pc.Vec3(0,e,0),i=this;this.model.tween(this.model.getLocalEulerAngles()).rotate(o,.1,pc.Linear).on("complete",(function(){i.animator(2)})).start(),this.positionTween&&this.positionTween.stop()},DogComponent.prototype.animator=function(t){this.entity.anim.setInteger("stateID",t)};var NeighbourComponent=pc.createScript("neighbourComponent");NeighbourComponent.attributes.add("speed",{type:"number",default:1,min:.25,title:"Run Speed"}),NeighbourComponent.attributes.add("fallPosition",{type:"number",title:"Fall Position Y"}),NeighbourComponent.attributes.add("model",{type:"entity",title:"Model"}),NeighbourComponent.prototype.update=function(t){this.init()},NeighbourComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem,this.entity.collision.on("triggerenter",this.onTriggerEnter,this))},NeighbourComponent.prototype.onTriggerEnter=function(t){t.tags.has("Player")?(this.attack(t),t.script.playerController.fail()):t.tags.has("Hole")&&(this.animator(4),this.gameSystem.createEffect(2,this.entity),this.gameSystem.playSound("Water"))},NeighbourComponent.prototype.moveToPoint=function(t){var e=t.getPosition().x-this.entity.getPosition().x<0?-90:90,i=new pc.Vec3(0,e,0),o=this;this.model.tween(this.model.getLocalEulerAngles()).rotate(i,.1,pc.Linear).on("complete",(function(){var e=o.entity.getLocalPosition(),i=t.getLocalPosition(),n=new pc.Vec3(i.x,e.y,e.z),s=e.distance(i);o.entity.tween(e).to(n,s/o.speed,pc.Linear).on("complete",(function(){o.animator(5,1)})).start(),o.animator(2)})).start(),this.isMove=!0},NeighbourComponent.prototype.fall=function(){if(!this.isMove){this.animator(3);var t=this.entity.getLocalPosition(),e=new pc.Vec3(t.x,this.fallPosition,t.z),i=t.distance(e);this.entity.tween(t).to(e,i/this.speed,pc.Linear).on("complete",(function(){})).start();var o=this.model.getLocalPosition(),n=new pc.Vec3(o.x,o.y,0);this.model.tween(o).to(n,i/this.speed,pc.Linear).start()}},NeighbourComponent.prototype.stun=function(){this.entity.collision.enabled=!1,this.animator(1)},NeighbourComponent.prototype.attack=function(t){if(!this.gameSystem.isFail){var e=this.model,i=t.getPosition().clone().sub(e.getPosition()),o=Math.atan2(i.z,i.x)*pc.math.RAD_TO_DEG,n=new pc.Vec3(0,120-o,0);e.tween(e.getEulerAngles()).rotate(n,.1,pc.Linear).start(),this.animator(5,1),this.gameSystem.playSound("Hit")}},NeighbourComponent.prototype.animator=function(t,e=this.speed){this.entity.anim.speed=e,this.entity.anim.setInteger("stateID",t)};var AttackZoneComponent=pc.createScript("attackZoneComponent");AttackZoneComponent.attributes.add("attackTag",{type:"string",title:"Attack Tag"}),AttackZoneComponent.attributes.add("attacking",{type:"entity",title:"Character attacking"}),AttackZoneComponent.prototype.update=function(t){this.init()},AttackZoneComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.entity.collision.on("triggerenter",this.onTriggerEnter,this))},AttackZoneComponent.prototype.onTriggerEnter=function(t){if(t.tags.has(this.attackTag)){var n=this.attacking.script.neighbourComponent;n&&n.moveToPoint(t)}},AttackZoneComponent.prototype.collisionOff=function(t=!1){if(this.entity.collision.enabled=!1,t){var n=this.attacking.script.neighbourComponent;n&&n.fall();var o=this.attacking.script.banditComponent;o&&o.fall()}};var CatComponent=pc.createScript("catComponent");CatComponent.attributes.add("target",{type:"entity",title:"Target"}),CatComponent.prototype.update=function(t){this.init()},CatComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem)},CatComponent.prototype.action=function(){var t=this.target.script.dogComponent;t&&t.action()},CatComponent.prototype.stun=function(){this.animator(3),this.gameSystem.createEffect(1,this.entity)},CatComponent.prototype.animator=function(t){this.entity.anim.setInteger("stateID",t)};var JumpComponent=pc.createScript("jumpComponent");JumpComponent.attributes.add("isRight",{type:"boolean",default:!0,title:"Jump right"}),JumpComponent.attributes.add("upPoint",{type:"vec2",title:"Point up"}),JumpComponent.attributes.add("downPoint",{type:"vec2",title:"Point down"}),JumpComponent.prototype.jump=function(){var t=new pc.Vec3(0,0,-15),e=this;this.entity.tween(this.entity.getLocalEulerAngles()).rotate(t,.75,pc.Linear).on("complete",(function(){e.entity.tween(e.entity.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,0),.5,pc.BounceOut).on("complete",(function(){})).start()})).start()};var BanditComponent=pc.createScript("banditComponent");BanditComponent.attributes.add("fallPosition",{type:"number",title:"Fall Position Y"}),BanditComponent.attributes.add("fallTime",{type:"number",title:"Fall Time"}),BanditComponent.attributes.add("tramplin",{type:"entity",title:"Tramplin"}),BanditComponent.attributes.add("model",{type:"entity",title:"Model"}),BanditComponent.prototype.update=function(t){this.init()},BanditComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem,this.entity.collision.on("triggerenter",this.onTriggerEnter,this))},BanditComponent.prototype.onTriggerEnter=function(t){t.tags.has("Player")&&(this.attack(t),t.script.playerController.fail())},BanditComponent.prototype.attack=function(t){if(!this.gameSystem.isFail){var n=this.model,e=t.getPosition().clone().sub(n.getPosition()),i=Math.atan2(e.z,e.x)*pc.math.RAD_TO_DEG,o=new pc.Vec3(0,120-i,0);n.tween(n.getEulerAngles()).rotate(o,.1,pc.Linear).start(),this.animator(5),this.gameSystem.playSound("Hit")}},BanditComponent.prototype.fall=function(){this.animator(6);var t=this.entity.getLocalPosition(),n=new pc.Vec3(t.x,this.fallPosition,t.z),e=this;this.entity.tween(t).to(n,this.fallTime,pc.Linear).on("complete",(function(){e.animator(0),e.tramplin&&e.jump(e.tramplin.script.tramplinComponent)})).start()},BanditComponent.prototype.jump=function(t){var n=t.entity.getLocalPosition(),e=this.model.getLocalPosition(),i=new pc.Vec3(e.x,e.y,0),o=e.distance(i)/2,a=this;this.model.tween(e).to(i,o,pc.Linear).on("complete",(function(){e=a.entity.getLocalPosition(),i=new pc.Vec3(n.x+t.startPoint.x,e.y+t.startPoint.y,e.z+t.startPoint.z),o=e.distance(i)/2;var p=i.x-e.x<0?-90:90,c=new pc.Vec3(0,p,0);a.model.tween(a.model.getLocalEulerAngles()).rotate(c,.1,pc.Linear).on("complete",(function(){a.entity.tween(e).to(i,.25,pc.Linear).on("complete",(function(){e=a.entity.getLocalPosition(),i=new pc.Vec3(n.x+t.endPoint.x,e.y+t.endPoint.y,e.z+t.endPoint.z),o=e.distance(i)/2,a.entity.tween(e).to(i,o,pc.Linear).on("complete",(function(){e=a.entity.getLocalPosition(),i=new pc.Vec3(n.x+t.jumpPoint.x,e.y+t.jumpPoint.y,e.z+t.jumpPoint.z),o=e.distance(i)/2,a.entity.tween(e).to(i,o,pc.Linear).on("complete",(function(){a.animator(2,2);var n=t.component.script.jumpComponent;n.jump(),e=a.entity.getLocalPosition(),i=new pc.Vec3(e.x,e.y-.1,e.z),a.entity.tween(e).to(i,.7,pc.Linear).on("complete",(function(){e=a.entity.getLocalPosition(),i=new pc.Vec3(e.x+n.upPoint.x,e.y+n.upPoint.y,e.z),a.entity.tween(e).to(i,.65,pc.Linear).on("complete",(function(){e=a.entity.getLocalPosition(),i=new pc.Vec3(e.x+n.downPoint.x,e.y-n.downPoint.y,e.z),a.entity.tween(e).to(i,.4,pc.Linear).on("complete",(function(){a.animator(0),c=new pc.Vec3(0,0,0),a.model.tween(a.model.getLocalEulerAngles()).rotate(c,.1,pc.Linear).on("complete",(function(){})).start()})).start()})).start(),a.gameSystem.playSound("Landing")})).start()})).start()})).start()})).start()})).start()})).start(),a.animator(4,2.5*o)},BanditComponent.prototype.stun=function(){this.entity.collision.enabled=!1,this.animator(1),this.gameSystem.createEffect(1,this.entity)},BanditComponent.prototype.animator=function(t,n=1){this.entity.anim.speed=n,this.entity.anim.setInteger("stateID",t)};var PolicemanComponent=pc.createScript("policemanComponent");PolicemanComponent.attributes.add("speed",{type:"number",title:"Policeman Speed"}),PolicemanComponent.attributes.add("target",{type:"entity",title:"Target"}),PolicemanComponent.attributes.add("offset",{type:"number",title:"Target Offset"}),PolicemanComponent.attributes.add("model",{type:"entity",title:"Model"}),PolicemanComponent.attributes.add("effectPoint",{type:"entity",title:"Effect Point"}),PolicemanComponent.prototype.update=function(t){this.init()},PolicemanComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem)},PolicemanComponent.prototype.action=function(){if(this.isAttack()){var t=this.target.getPosition().x-this.entity.getPosition().x,e=t<0?-100:100,i=new pc.Vec3(0,e,0);this.offsetPosition=t<0?this.offset:-this.offset;var n=this;this.model.tween(this.model.getLocalEulerAngles()).rotate(i,.1,pc.Linear).on("complete",(function(){var t=n.entity.getLocalPosition(),e=n.target.getLocalPosition(),i=new pc.Vec3(e.x+n.offsetPosition,t.y,t.z),o=t.distance(e);n.entity.tween(t).to(i,o/n.speed/2,pc.Linear).on("complete",(function(){var t=n.target.script.banditComponent;t&&t.stun(),n.animator(5),n.gameSystem.createEffect(5,n.effectPoint)})).start(),n.animator(4)})).start()}},PolicemanComponent.prototype.isAttack=function(){var t=this.target.getPosition().y-this.entity.getPosition().y;return Math.abs(t)<.2},PolicemanComponent.prototype.animator=function(t){this.entity.anim.speed=this.speed,this.entity.anim.setInteger("stateID",t)};var TutorialComponent=pc.createScript("tutorialComponent");TutorialComponent.attributes.add("startPosition",{type:"vec3",title:"Position Start"}),TutorialComponent.attributes.add("endPosition",{type:"vec3",title:"Position End"}),TutorialComponent.prototype.update=function(t){this.init()},TutorialComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.app.root.findByName("Player").addChild(this.entity),this.tweening())},TutorialComponent.prototype.tweening=function(){this.entity.setLocalPosition(this.startPosition),this.entity.setLocalScale(new pc.Vec3(0,0,0));var t=this;this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(1,1,1),.5,pc.Linear).on("complete",(function(){t.entity.tween(t.entity.getLocalPosition()).to(t.endPosition,.75,pc.Linear).on("complete",(function(){t.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(0,0,0),.25,pc.Linear).on("complete",(function(){t.tweening()})).start()})).start()})).start()};var CloudComponent=pc.createScript("cloudComponent");CloudComponent.attributes.add("offset",{type:"number",title:"Cloud Offset"}),CloudComponent.attributes.add("speed",{type:"number",title:"Cloud Speed"}),CloudComponent.prototype.update=function(t){this.init()},CloudComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.tweening())},CloudComponent.prototype.tweening=function(){var t=this.entity.getLocalPosition(),e=new pc.Vec3(t.x,t.y+this.offset,t.z),n=this;this.entity.tween(t).to(e,this.speed,pc.Linear).on("complete",(function(){t=this.entity.getLocalPosition(),e=new pc.Vec3(t.x,t.y-n.offset,t.z),n.entity.tween(t).to(e,n.speed,pc.Linear).on("complete",(function(){n.tweening()})).start()})).start()};var TramplinComponent=pc.createScript("tramplinComponent");TramplinComponent.attributes.add("positionY",{type:"number",title:"Position Y"}),TramplinComponent.attributes.add("fallTime",{type:"number",title:"Fall time"}),TramplinComponent.attributes.add("character",{type:"entity",title:"Character"}),TramplinComponent.attributes.add("startPoint",{type:"vec3",title:"Start Point Offset"}),TramplinComponent.attributes.add("endPoint",{type:"vec3",title:"End Point Offset"}),TramplinComponent.attributes.add("jumpPoint",{type:"vec3",title:"Jump Point Offset"}),TramplinComponent.attributes.add("component",{type:"entity",title:"Jump component"}),TramplinComponent.prototype.update=function(t){this.init()},TramplinComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem)},TramplinComponent.prototype.action=function(){var t=this.entity.getLocalPosition(),n=new pc.Vec3(t.x,this.positionY,t.z),e=this;this.entity.tween(t).to(n,this.fallTime,pc.Linear).on("complete",(function(){e.characterActivate(),e.gameSystem.playSound("Landing")})).start()},TramplinComponent.prototype.characterActivate=function(){var t=this.character.script.banditComponent;t&&t.jump(this)};var SettingsComponent=pc.createScript("settingsComponent");SettingsComponent.attributes.add("settingsButton",{type:"entity",title:"Settings Button"}),SettingsComponent.attributes.add("soundButton",{type:"entity",title:"Sound Button"}),SettingsComponent.attributes.add("back",{type:"entity",title:"Background"}),SettingsComponent.attributes.add("materialList",{type:"asset",array:!0,title:"Material List"}),SettingsComponent.prototype.update=function(t){this.init()},SettingsComponent.prototype.init=function(){this.isInit||(this.isInit=!0,this.gameSystem=this.app.root.findByName("GameSystem").script.gameSystem,this.settingsButton.button.on("click",this.backUpdate,this),this.soundButton.button.on("click",this.soundUpdate,this),this.backUpdate())},SettingsComponent.prototype.backUpdate=function(){this.back.enabled=!this.back.enabled},SettingsComponent.prototype.soundUpdate=function(){if(!this.gameSystem.paused){this.gameSystem.mute=!this.gameSystem.mute;var t=this.gameSystem.mute?0:1;this.gameSystem.audio.sound.volume=t,this.soundButton.element.texture=this.materialList[t].resource}};if("launch.playcanvas.com"===window.location.hostname){let a=window.location.href;a.includes("play.staging.gc.famobi.com")||(window.location.href=`https://play.staging.gc.famobi.com/playcanvas/?overwrite_html5_link=${a}/A-PLAYCANVAS-DEV&aid=A-PLAYCANVAS-DEV`)}pc.script.createLoadingScreen((function(n){var e,t,i,a,r,o=void 0,l=document.createElement("canvas"),s=0,getCoordinate=function(n){return n-=90,{x:(l.width/2-t)*Math.cos(n*Math.PI/180)+l.width/2,y:(l.width/2-t)*Math.sin(n*Math.PI/180)+l.width/2}};a="\n            .fam_bgr {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            margin: 0;\n            padding: 0;\n            border: 0;\n            background-color: #fff;\n            }\n\n            #progress_bar {\n            position: absolute;\n            margin-top: 2rem;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%,-50%);\n            z-index: 0;\n            }\n\n            .splash_wrapper {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%,-50%);\n            }\n\n            .logo_wrapper {\n            width: 12rem;\n            height: 18rem;\n            margin-left: 1.813rem;\n            perspective: 5.625rem;\n            filter: drop-shadow(0.625rem 0.625rem 0.5rem #a3a3a3);\n            }\n\n            .title_wrapper {\n            position: absolute;\n            width: 15.625rem;\n            height: 4.375rem;\n            z-index: 1;\n            }\n\n            span {\n            margin: 0.188rem;\n            position: absolute;\n            }  \n\n            .row_1 {\n            top: 0;\n            }\n\n            .row_2 {\n            top: 6rem;\n            }\n\n            .row_3 {\n            top: 12rem;\n            }\n\n            .col_1 {\n            left: 0;\n            }\n\n            .col_2 {\n            left: 6rem;\n            }\n\n            .order_0 {\n            z-index: 3;\n            }\n\n            .order_1 {\n            z-index: 2;\n            }\n\n            .order_2 {\n            z-index: 1;\n            }\n\n            .square {\n            width: 5.625rem;\n            height: 5.625rem;\n            }\n\n            .triangle {\n            width: 0;\n            height: 0;\n            border-style: solid;\n            border-width: 2.813rem 0 2.813rem 3.75rem;\n            border-color: transparent transparent transparent #F07E00;\n            }\n\n            .blue {\n            background-color: #0194C6;\n            }\n\n            .orange {\n            background-color: #F07E00;\n            }\n\n            .grey {\n            background-color: #3D3D3B;\n            }\n\n            .ani_shiftright {\n            opacity: 0;\n            animation-name: shift-right;\n            animation-duration: 0.5s; \n            animation-timing-function: ease-out; \n            animation-fill-mode: forwards;\n            }\n\n            .ani_shiftdown {\n            opacity: 0;\n            animation-name: shift-down;\n            animation-duration: 0.5s;\n            animation-timing-function: ease-out; \n            animation-fill-mode: forwards;\n            }\n\n            .ani_title {\n            opacity: 0;\n            animation-name: title;\n            animation-duration: 1.7s;\n            animation-delay: 1.5s;\n            animation-timing-function: ease-out; \n            animation-fill-mode: forwards;\n            }\n\n            .ani_delay {\n            animation-duration: 0.5s;\n            animation-delay: 0.5s;\n            }\n\n            .ani_delay_long {\n            animation-duration: 0.5s;\n            animation-delay: 0.7s;\n            }\n\n            .ani_speed_fast {\n            animation-duration: 0.2s;\n            }\n\n            .ani_speed_medium {\n            animation-duration: 0.5s;\n            }\n\n            .ani_speed_slow {\n            animation-duration: 0.7s;\n            }\n\n            @keyframes shift-right { \n            0% {\n                opacity: 0;\n                margin-left: -5.625rem;\n            }\n            100% {\n                opacity: 1;\n                margin-left: 0.188rem;\n            }\n            }\n\n            @keyframes shift-down { \n            0% {\n                opacity: 0;\n                margin-top: -5.625rem;\n            }\n            100% {\n                opacity: 1;\n                margin-top: 0.188rem;\n            }\n            }\n\n            @keyframes title { \n            0% {\n                opacity: 0;\n                margin-top: -5.625rem;\n            }\n            100% {\n                opacity: 1;\n                margin-top: 0.188rem;\n            }\n            }\n        ",(r=document.createElement("style")).type="text/css",r.styleSheet?r.styleSheet.cssText=a:r.appendChild(document.createTextNode(a)),document.head.appendChild(r),function(){var n=document.createElement("div");n.id="application-splash-wrapper",n.innerHTML='\n            <div class="fam_bgr">\n                <div class="splash_wrapper">\n                    <div class="logo_wrapper">\n                    <span class="square blue row_1 col_1 order_0"></span>\n                    <span class="square blue row_1 col_2  order_1 ani_shiftright"></span>\n                    <span class="square orange row_2 col_1 order_1 ani_shiftdown"></span>\n                    <span class="triangle row_2 col_2 order_1 ani_shiftright ani_delay_long ani_speed_fast"></span>\n                    <span class="square grey row_3 col_1 order_2 ani_shiftdown ani_delay_long ani_speed_fast"></span>\n                    </div>\n                    <div class=\'title_wrapper ani_title\'>\n                    <svg width="100%" height="100%" viewBox="0 0 125 33" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">\n                        <g transform="matrix(1,0,0,1,-52.25,-46.5)">\n                            <path d="M65.7,65.4L58,65.4L58,77.6L53.3,77.6L53.3,50.6L68.7,50.6L68.7,54.7L58,54.7L58,61.2L65.7,61.2L65.7,65.4Z" style="fill:rgb(51,51,51);fill-rule:nonzero;"/>\n                            <path d="M82,77.6L81.7,75L81.5,75C80.8,75.9 79.8,76.7 78.5,77.2C77.2,77.8 75.9,78 74.6,78C72.9,78 71.5,77.5 70.6,76.5C69.6,75.5 69.1,74.2 69.1,72.6C69.1,71.5 69.3,70.5 69.8,69.6C70.3,68.7 71,68 71.9,67.4C72.8,66.8 73.9,66.3 75.1,66C76.4,65.7 77.8,65.5 79.3,65.5L81.1,65.5L81.1,64.9C81.1,63.8 80.8,63.1 80.1,62.6C79.4,62.1 78.3,61.9 76.8,61.9C74.8,61.9 73,62.3 71.4,63.2L70.5,59.8C72.3,58.7 74.5,58.2 77.1,58.2C79.8,58.2 81.9,58.8 83.3,59.9C84,60.4 84.5,61.1 84.9,61.9C85.3,62.7 85.5,63.7 85.5,64.8L85.5,77.6L82,77.6ZM76.4,74.5C77.3,74.5 78.1,74.3 79,73.9C79.9,73.5 80.6,72.9 81.1,72.2L81.1,68.5L80.3,68.5C78.1,68.5 76.4,68.8 75.4,69.4C74.4,70 73.9,70.9 73.9,72.1C74,73.7 74.8,74.5 76.4,74.5Z" style="fill:rgb(51,51,51);fill-rule:nonzero;"/>\n                            <path d="M103.2,77.6L103.2,65.2C103.2,63 102.3,61.9 100.5,61.9C100.1,61.9 99.6,62 99.1,62.1C98.6,62.3 98.1,62.5 97.6,62.8C97.1,63.1 96.7,63.5 96.3,64C95.9,64.5 95.6,65 95.5,65.6L95.5,77.6L91,77.6L91,58.8L94.5,58.8L94.7,61.6L94.9,61.6C95.4,60.5 96.3,59.6 97.5,59C98.7,58.4 99.9,58.2 101.3,58.2C102.6,58.2 103.7,58.5 104.8,59C105.8,59.5 106.6,60.4 107.1,61.6C107.6,60.5 108.5,59.6 109.7,59.1C110.9,58.5 112.1,58.3 113.5,58.3C114.4,58.3 115.2,58.4 116,58.6C116.8,58.8 117.5,59.2 118,59.7C118.6,60.2 119,60.9 119.4,61.7C119.7,62.5 119.9,63.6 119.9,64.8L119.9,77.6L115.4,77.6L115.4,65.2C115.4,63 114.5,61.9 112.7,61.9C112.3,61.9 111.8,62 111.3,62.1C110.8,62.3 110.3,62.5 109.8,62.8C109.3,63.1 108.9,63.5 108.5,64C108.1,64.5 107.8,65 107.7,65.6L107.7,77.6L103.2,77.6Z" style="fill:rgb(51,51,51);fill-rule:nonzero;"/>\n                            <path d="M133.5,58.2C135.2,58.2 136.6,58.5 137.8,59C139,59.6 140,60.3 140.8,61.2C141.6,62.1 142.1,63.2 142.5,64.4C142.9,65.6 143.1,66.9 143.1,68.2C143.1,69.5 142.9,70.8 142.5,72C142.1,73.2 141.6,74.2 140.8,75.1C140,76 139,76.7 137.9,77.2C136.7,77.7 135.3,78 133.7,78C132,78 130.6,77.7 129.4,77.2C128.2,76.7 127.2,75.9 126.4,75C125.6,74.1 125,73 124.6,71.8C124.2,70.6 124,69.3 124,68C124,66.7 124.2,65.4 124.6,64.2C125,63 125.6,62 126.3,61C127.1,60.1 128.1,59.4 129.3,58.8C130.5,58.5 131.9,58.2 133.5,58.2ZM133.6,74.7C134.4,74.7 135.1,74.5 135.7,74.2C136.3,73.9 136.8,73.4 137.2,72.8C137.6,72.2 137.9,71.5 138,70.8C138.2,70 138.3,69.2 138.3,68.4C138.3,67.5 138.2,66.7 138,65.9C137.8,65.1 137.5,64.4 137.1,63.8C136.7,63.2 136.2,62.7 135.6,62.3C135,61.9 134.3,61.7 133.4,61.7C132.6,61.7 131.9,61.9 131.4,62.2C130.8,62.5 130.4,63 130,63.6C129.6,64.2 129.4,64.8 129.2,65.6C129,66.4 128.9,67.2 128.9,68C128.9,68.9 129,69.7 129.2,70.5C129.4,71.3 129.7,72 130.1,72.6C130.5,73.2 131,73.7 131.6,74.1C132.1,74.5 132.8,74.7 133.6,74.7Z" style="fill:rgb(51,51,51);fill-rule:nonzero;"/>\n                            <path d="M157.9,78.1C156.4,78.1 155.2,77.8 154.2,77.2C153.2,76.6 152.4,75.9 151.6,75L151.4,75L151.1,77.6L147.5,77.6L147.5,47.4L152,47.4L152,60.7C152.6,59.9 153.5,59.3 154.5,58.9C155.5,58.5 156.7,58.2 158,58.2C159.4,58.2 160.7,58.5 161.7,59C162.8,59.5 163.6,60.3 164.4,61.2C165.1,62.1 165.6,63.1 166,64.3C166.3,65.5 166.5,66.7 166.5,68C166.5,69.4 166.3,70.8 165.9,72C165.5,73.2 164.9,74.3 164.2,75.2C163.5,76.1 162.5,76.8 161.5,77.3C160.4,77.8 159.2,78.1 157.9,78.1ZM157.3,74.7C158.1,74.7 158.8,74.5 159.4,74.1C160,73.7 160.5,73.2 160.9,72.6C161.3,72 161.6,71.3 161.8,70.5C162,69.7 162.1,68.9 162.1,68.1C162.1,67.3 162,66.4 161.8,65.7C161.6,64.9 161.3,64.2 160.9,63.6C160.5,63 159.9,62.5 159.3,62.2C158.7,61.9 157.9,61.7 157.1,61.7C156.3,61.7 155.5,61.9 154.7,62.3C153.9,62.7 153,63.4 152.2,64.4L152.2,72.2C152.5,72.6 152.9,73 153.3,73.3C153.7,73.6 154.2,73.9 154.7,74.1C155.2,74.3 155.7,74.5 156.2,74.6C156.7,74.7 156.9,74.7 157.3,74.7Z" style="fill:rgb(51,51,51);fill-rule:nonzero;"/>\n                            <path d="M170.4,52.8C170.4,52.4 170.5,52.1 170.6,51.7C170.7,51.3 171,51 171.2,50.7C171.5,50.4 171.8,50.2 172.1,50C172.4,49.8 172.8,49.8 173.2,49.8C173.6,49.8 173.9,49.9 174.3,50C174.7,50.2 175,50.4 175.3,50.7C175.6,51 175.8,51.3 176,51.7C176.2,52.1 176.2,52.4 176.2,52.8C176.2,53.2 176.1,53.6 176,53.9C175.8,54.2 175.6,54.5 175.3,54.8C175,55.1 174.7,55.3 174.3,55.4C173.9,55.5 173.6,55.6 173.2,55.6C172.4,55.6 171.7,55.3 171.2,54.7C170.6,54.3 170.4,53.6 170.4,52.8ZM175.5,77.6L171,77.6L171,58.8L175.5,58.8L175.5,77.6Z" style="fill:rgb(51,51,51);fill-rule:nonzero;"/>\n                        </g>\n                    </svg>\n                    </div>\n                    <div id="progress_bar"></div>\n                </div>\n            </div>\n        ',document.body.appendChild(n);var a=document.getElementById("progress_bar"),r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;l.width=r/3,l.height=l.width,e=l.getContext("2d"),t=l.width/10,(i=e.createLinearGradient(0,0,l.width,0)).addColorStop("0","#cce7ff"),i.addColorStop("0.5","#005095"),i.addColorStop("1","#cce7ff"),e.strokeStyle=i,a.appendChild(l)}(),n.on("preload:end",(function(){n.off("preload:progress")})),n.on("preload:progress",(function(n){n=Math.min(1,Math.max(0,n)),window&&window.famobi&&window.famobi.setPreloadProgress&&(window.famobi.setPreloadProgress(100*n),1===n&&window.famobi.gameReady()),function(n){if(!e)return;o&&clearInterval(o);let t=(n-s)/10;o=setInterval((()=>{s<n?s+=t:clearInterval(o);var a=3.6*s;e.clearRect(0,0,l.width,l.height),e.beginPath(),e.lineWidth=10;var r=getCoordinate(0);e.moveTo(r.x,r.y),e.strokeStyle=i;for(var d=0;d<a;d++){var C=getCoordinate(d);e.lineTo(C.x,C.y)}e.stroke(),e.beginPath(),e.strokeStyle="#c9c9c9";for(var m=a;m<360;m++){var p=getCoordinate(m);e.lineTo(p.x,p.y)}e.stroke()}),50)}(100*n)})),n.on("start",(function(){var n=document.getElementById("application-splash-wrapper");n.parentElement.removeChild(n)}))}));pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);if(this._add.length){for(let t=0;t<this._add.length;t++)this._tweens.indexOf(this._add[t])>-1||this._tweens.push(this._add[t]);this._add.length=0}}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,s;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,s))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,void 0!==this._properties.w?(this._fromQuat.copy(this.target),this._toQuat.set(i,e,s,this._properties.w)):(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),this._toQuat.setFromEulerAngles(i,e,s)))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=0===this.duration?1:this.time/this.duration,r=this.easing(n);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},BounceIn=function(t){return 1-BounceOut(1-t)};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,s=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=s*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*.5+1)}}}()),function(){pc.AppBase.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.AppBase.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.AppBase.getApplication();t&&t.addTweenManager()}();var FamobiSafeArea=pc.createScript("famobiSafeArea");FamobiSafeArea.attributes.add("forceBodyBackgroundColor",{type:"boolean",default:!0,title:"Change <body> background",default:!0}),FamobiSafeArea.attributes.add("bodyBackgroundColor",{type:"rgba",title:"Body Background Color",description:"Background color of body element (where the banner should be displayed). Make sure the checkbox above is checked!",default:[0,0,0,1]}),FamobiSafeArea.attributes.add("debugConfig",{type:"json",title:"Debug / Testing Mode",description:"Force safe areas to be applied to the UI. Useful testing layouts without a device.",schema:[{name:"enabled",type:"boolean",default:!1},{name:"top",type:"number",default:0},{name:"bottom",type:"number",default:0},{name:"left",type:"number",default:0},{name:"right",type:"number",default:0}]}),FamobiSafeArea.prototype.initialize=function(){this.app.graphicsDevice.on("resizecanvas",this._onCanvasResize,this),this.on("attr:debugConfig",(function(e,t){this._updateCanvasSizeAndPosition()}),this),this.on("attr:bodyBackgroundColor",(function(e,t){this._backgroundColorUpdate()}),this),this.on("destroy",(function(){this.app.graphicsDevice.off("resizecanvas",this._onCanvasResize,this)}),this),window.famobi&&"function"==typeof window.famobi.onOffsetChange&&window.famobi.onOffsetChange((e=>this._onCanvasResize())),window.visualViewport?(this.useVisualViewport=!0,window.visualViewport.addEventListener("resize",this._onCanvasResize.bind(this))):(this.useVisualViewport=!1,window.addEventListener("resize",this._onCanvasResize.bind(this),!0)),this._onCanvasResize()},FamobiSafeArea.prototype._onCanvasResize=function(){this._updateCanvasSizeAndPosition(),(pc.platform.ios||pc.platform.mobile)&&setTimeout((()=>this._updateCanvasSizeAndPosition()),1500)},FamobiSafeArea.prototype._updateCanvasSizeAndPosition=function(){let e=0,t=0,i=0,o=0;if(this.debugConfig.enabled)e=this.debugConfig.top,t=this.debugConfig.bottom,i=this.debugConfig.left,o=this.debugConfig.right;else{if(!window.famobi||!window.famobi.getOffsets)return console.warn("FamobiSafeArea: window.famobi.getOffsets is not defined!");const a=window.famobi.getOffsets();e=a.top,t=a.bottom,i=a.left,o=a.right}const a=window.innerHeight,n=window.innerWidth-i-o,s=a-e-t;this.app.setCanvasResolution(pc.RESOLUTION_FIXED,n,s),this.app.graphicsDevice.canvas.style.width=n+"px",this.app.graphicsDevice.canvas.style.height=s+"px",this.app.graphicsDevice.canvas.style.left=i+"px",this.app.graphicsDevice.canvas.style.right=o+"px",this.app.graphicsDevice.canvas.style.top=e+"px",this.app.graphicsDevice.canvas.style.bottom=t+"px",this.debugConfig.enabled&&console.log(`Canvas size set to ${n}x${s} (window ${window.innerWidth}x${window.innerHeight})`),this.app.fire("famobi:resizeCanvas",n,s),this._backgroundColorUpdate()},FamobiSafeArea.prototype._backgroundColorUpdate=function(){if(!this.forceBodyBackgroundColor)return;const e=this.app.graphicsDevice.canvas.parentElement;e&&(e.style.backgroundColor=this.bodyBackgroundColor.toString())},FamobiSafeArea.prototype.update=function(e){},pc.CameraComponent.prototype.screenToWorld=function(e,t,i,o){const a=this.system.app.graphicsDevice,n=a.width/a.maxPixelRatio,s=a.height/a.maxPixelRatio;return this._camera.screenToWorld(e,t,i,n,s,o)},pc.CameraComponent.prototype.worldToScreen=function(e,t){const i=this.system.app.graphicsDevice,o=i.width/i.maxPixelRatio,a=i.height/i.maxPixelRatio;return this._camera.worldToScreen(e,o,a,t)};