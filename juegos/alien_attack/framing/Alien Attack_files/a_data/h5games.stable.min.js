!function(e){let VERSION="1.7.7",H5GAMES={logs:[],score:null,progress:null,preloadProgress:null,highscore:null,levels:[],i18n:null,trigger:{startGame:null,gameOver:null},STATES:{INITIALIZATION:0,LOADING:1,IDLESTATE:2,GAMEPLAY:3,UNDEFINED:4},currentState:null,isLevelBased:!1,_isPaused:!1,_isMuted:!1,init:function(e){return SETTINGS.init(e),new Promise(e=>{let t=()=>{if("undefined"==typeof h5config)throw Error("h5config is undefined");if("object"==typeof h5config&&"presets"in h5config&&"level"in h5config.presets&&(H5GAMES.isLevelBased=!0),void 0===window.ReactNativeWebView&&console.debug("window.ReactNativeWebView is undefined"),VALIDATOR.isValid("requests")&&VALIDATOR.isValid("presets")&&VALIDATOR.isValid("trackstats")&&VALIDATOR.isValid("event","init")){window.famobi=window.famobi||FAMOBI,void 0!==window.famobi_gameJS&&Array.isArray(window.famobi_gameJS)&&window.famobi_gameJS.unshift(()=>{try{window.famobi.adapters.add("special","getScore",()=>{REPORT.post({adapter:"special",event:"getScore",data:{score:H5GAMES.score}})}),window.famobi.adapters.add("special","getHighscore",()=>{REPORT.post({adapter:"special",event:"getHighscore",data:{score:H5GAMES.highscore}})})}catch(e){console.debug(e)}});let t=h5config.requests||{};this.i18n=h5config.i18n||{},VALIDATOR.required.requests.forEach(e=>{void 0===this["_"+e]&&(this["_"+e]=()=>{console.warn("Function '"+e+"' has not yet been implemented by you!")}),void 0!==t[e]&&"function"==typeof t[e]&&"function(){}"!==t[e].toString().replace(/\s/g,"")&&(h5games["_"+e]=t[e])}),null===document.body?document.addEventListener("DOMContentLoaded",function(){console.debug("DOMContentLoaded"),SETTINGS.options.controls&&MENU.show()}):SETTINGS.options.controls&&MENU.show(),console.debug("Sending data and waiting for response...");let s=t=>{let a=(t||{}).detail||{};if(console.debug("Data received"),window.removeEventListener("dataReceived",s),console.debug("Retrieving data..."),console.debug(a),"presets"in a){delete a.presets.allowVerboseMessages;let r;for(let n in a.presets||{}){if(!(n in h5config.presets))break;-999===a.presets[n]&&"number"===(r=h5config.presets[n]).type&&Number.isInteger(r.min)&&Number.isInteger(r.max)&&(console.debug("replacing preset.%s with random value [%s, %s]",n,r.min,r.max),a.presets[n]=Math.round(Math.random()*(r.max-r.min))+r.min)}}VALIDATOR.isValid("properties",{properties:a})&&(PROPERTIES.presets=a.presets||{},"level"in PROPERTIES.presets&&this.levels.push(PROPERTIES.presets.level),VALIDATOR.isValid("event","dataReceived")&&this.loadGameJS().then(function(){e({})},function(t){SETTINGS.options.alert&&alert(t),e({error:t})})),this.storage.init()};if(window.addEventListener("dataReceived",s),REPORT.post({adapter:"api",event:"created",data:{presets:h5config.presets||{},trackstats:h5config.trackstats||{}}},!0),SETTINGS.options.data){let a="In test mode, which you are currently in, receiving the data is simulated with the content of h5config.test:";console.warn(a),console.table(h5config.test||{}),TOOLS.loadFile("//cdn.jsdelivr.net/npm/sweetalert2@11").then(()=>{}).catch(e=>{}).finally(()=>{setTimeout(()=>{window.dispatchEvent(new CustomEvent("dataReceived",{detail:h5config.test}))},500)})}window.addEventListener("message",e=>{console.debug("message",e);let t;try{t=JSON.parse(e.data)}catch(s){console.debug(s)}if("object"==typeof t&&void 0!==window.famobi)switch(console.debug("message.action",t.action),t.action){case"h5Event":window.dispatchEvent(new CustomEvent("h5Event",{detail:t}));break;case"requestAction":window.famobi.requestAction(t.data);break;case"onReceiveData":window.dispatchEvent(new CustomEvent("dataReceived",{detail:{presets:window.famobi.config.features.forced_mode||{}}}));break;case"setForcedMode":let a={};try{a=JSON.parse(t.data)}catch(r){console.debug(r)}window.famobi.config.features.forced_mode=a,"enabled"===window.famobi.config.features.forced_mode.allowVerboseMessages&&(REPORT.isVerboseMessagesAllowed=!0),SETTINGS.options.revive=!0,SETTINGS.options.rewarded=!0;break;case"setVolume":break;case"getFamobiJson":REPORT.post({adapter:"special",event:t.action,data:{game_info:{presets:h5config.presets||{},trackstats:h5config.trackstats||{}}}});break;case"getScore":REPORT.post({adapter:"special",event:t.action,data:{score:this.score}});break;case"getHighscore":REPORT.post({adapter:"special",event:t.action,data:{score:this.highscore}});break;case"getLevel":REPORT.post({adapter:"special",event:t.action,data:{level:this.getLevel()}});break;default:console.debug("Couldn't handle message:",t),REPORT.post({adapter:"debug",event:"error",data:{msg:"Couldn't handle message:",data:t}})}})}};"undefined"!=typeof h5config?t():(console.info("Loading h5config.js..."),TOOLS.loadFile("h5config.js").then(e=>{if(void 0===e){t();return}TOOLS.loadFile("scripts/project/h5config.js").then(()=>{t()})}))})},gameReady:function(){},playerReady:function(){VALIDATOR.isValid("event","playerReady")&&(REPORT.reset(),console.debug("[VALIDATOR] reset 'previousScore'"),VALIDATOR.previousScore=null,console.debug("[VALIDATOR] reset 'previousProgress'"),VALIDATOR.previousProgress=null,REPORT.post({adapter:"player",event:"ready",data:!0}))},sendScore:function(e){VALIDATOR.isValid("event",{event:"sendScore",score:e})&&(this.score=e,this.highscore=Math.max(this.highscore,this.score),REPORT.postScore({adapter:"analytics",event:"trackEvent",data:{event:"EVENT_LIVESCORE",params:{liveScore:e}}}))},sendProgress:function(e){VALIDATOR.isValid("event",{event:"sendProgress",progress:e})&&(this.progress=e,REPORT.postProgress({adapter:"analytics",event:"trackEvent",data:{event:"EVENT_CUSTOM",params:{eventName:"EVENT_LIVEPROGRESS",liveProgress:e}}}))},gameOver:function(){return new Promise((e,t)=>{if(VALIDATOR.isValid("event",{event:"gameOver"})){REPORT.dispatchEvent({event:"gameOver"}),REPORT.post({adapter:"analytics",event:"trackStats",data:{key:"game_over",options:{score:H5GAMES.score},amount:1}});let s=t=>{window.removeEventListener("reviveGranted",s),!1===t.detail?H5GAMES.stopGame():VALIDATOR.isValid("event",{event:"reviveGranted"})&&(console.debug("Revive granted"),e())};window.addEventListener("reviveGranted",s),SETTINGS.options.test&&(SETTINGS.options.revive?(console.warn("In test mode, which you are currently in, the decision about a possible revive must be made manually.\nNote: If the parameter revive=0 is used, a gameOver will result in an immediate stop of the game."),"undefined"==typeof Swal?window.dispatchEvent(new CustomEvent("reviveGranted",{detail:confirm("You lost! Do you want to be revived?")})):Swal.fire({title:"You lost! Do you want to be revived?",showDenyButton:!0,confirmButtonText:"Yes, do it!",denyButtonText:"Please kill me!",didDestroy(){window.dispatchEvent(new CustomEvent("reviveGranted",{detail:!1}))}}).then(e=>{window.dispatchEvent(new CustomEvent("reviveGranted",{detail:e.isConfirmed}))})):window.dispatchEvent(new CustomEvent("reviveGranted",{detail:!1})))}else t()})},levelEnd:function(){VALIDATOR.isValid("event",{event:"levelEnd"})&&(REPORT.dispatchEvent({event:"levelEnd"}),REPORT.post({adapter:"analytics",event:"trackStats",data:{key:"level_end",options:{score:H5GAMES.score},amount:1}}))},track:function(e,t,s){Number.isInteger(t)&&(s=t,t={}),VALIDATOR.isValid("event",{event:"track",key:e,options:t,amount:s})&&REPORT.postTrack({adapter:"analytics",event:"trackStats",data:{key:e,options:t,amount:s}})},startGame:function(){return new Promise((e,t)=>{VALIDATOR.isValid("event",{event:"startGame"})?(this.score=null,this.progress=null,this.highscore=null,this.trigger.startGame=()=>{H5GAMES.trigger.startGame=null,setTimeout(()=>{e()},500)},REPORT.dispatchEvent({event:"startGame"}),REPORT.post({adapter:"game",event:"ready",data:!0}),SETTINGS.options.start?(console.warn("In test mode, which you are currently in, the promise is automatically resolved.\nNote: If you want to manually resolve the promise, you must invoke the game with the parameter start=0."),this.trigger.startGame()):SETTINGS.options.test&&console.warn("In test mode, which you are currently in, the promise has to be triggered manually via the menu, since the game was started with the parameter start=0")):t()})},stopGame:function(){this.event("stopGame")},pauseGame:function(){this.event("pauseGame")},resumeGame:function(){this.event("resumeGame")},muteGame:function(){this.event("muteGame")},unmuteGame:function(){this.event("unmuteGame")},nextLevel:function(e,t){let s=e=>{null!==e&&(e=e.length&&0>e.indexOf("'")&&0>e.indexOf('"')?parseInt(e):e.replace(/['"]+/g,""),this.event({event:"nextLevel",level:e}))};!0===t?"undefined"!=typeof Swal?Swal.fire({title:"Enter the next level",input:"text",inputLabel:"e.g. 50, \"level21\" or '120'",inputValidator(e){setTimeout(()=>{s(e)},500)}}):s(prompt("Enter the next level (e.g. 50 or &#34;level21&#34;):")):this.event({event:"nextLevel",level:e})},event:function(evt){if(VALIDATOR.isValid("event",evt)){if("string"==typeof evt)switch(eval("this._"+evt+"()"),evt){case"pauseGame":this._isPaused=!0;break;case"resumeGame":this._isPaused=!1;break;case"muteGame":this._isMuted=!0;break;case"unmuteGame":this._isMuted=!1}else{let args=[];Object.keys(evt).forEach(e=>{"event"!==e?args.push(evt[e]):"nextLevel"===evt.event&&void 0!==evt.level&&H5GAMES.levels.push(evt.level)}),eval("this._"+evt.event+"("+args.join(",")+")")}}},getPresets:function(e,t){t=!1!==e&&!1!==t;let s={},a;if("string"==typeof e&&e.length){try{a=t?h5config.presets[e].default:null}catch(r){a=null}return void 0!==(PROPERTIES.presets||{})[e]?(PROPERTIES.presets||{})[e]:a}for(preset in h5config.presets)s[preset]=void 0!==(PROPERTIES.presets||{})[preset]?(PROPERTIES.presets||{})[preset]:t?h5config.presets[preset].default:void 0,void 0===s[preset]&&delete s[preset];return s},log:function(e,t){},getSettings:function(){return{init:function(){}}},getMenu:function(){return MENU},getLevel:function(){let e=this.levels.at(-1);return void 0!==e?e:this.getPresets("level")},setState:function(e){let t={0:{name:"INITIALIZATION",color:"#DEECFF",icon:ICONS.get("bellhop")},1:{name:"LOADING",color:"#FFEBE6",icon:ICONS.get("hourglass")},2:{name:"IDLE STATE",color:"#FFFAE6",icon:ICONS.get("sleep")},3:{name:"GAMEPLAY",color:"#E3FCEE",icon:ICONS.get("joystick")}};switch(e){case 0:case 1:case 2:case 3:case 4:null!==this.currentState&&4!==this.currentState&&console.groupEnd(`${t[this.currentState].icon} %c${t[this.currentState].name}`,"background: "+t[this.currentState].color+"; color: black; display: block;"),this.currentState=e,4!==this.currentState&&console.group(`${t[this.currentState].icon} %c${t[this.currentState].name}`,"background: "+t[this.currentState].color+"; color: black; display: block;")}},getConfigPath:function(){return"undefined"==typeof c3_runtimeInterface||void 0===c3_runtimeInterface._GetLocalRuntime||c3_runtimeInterface._GetLocalRuntime().IsPreview()?"h5config.js":"scripts/project/h5config.js"},loadGameJS:function(){return new Promise((e,t)=>{if(void 0!==window.h5games_gameJS){if(!Array.isArray(window.h5games_gameJS)){t("Error: 'h5games_gameJS' must be an array");return}console.debug("[h5games_gameJS] loading scripts..."),window.h5games_gameJS.push(()=>{e()}),window.h5games_gameJS.reduce((e,t)=>e.then(()=>new Promise((e,s)=>{let a=document.createElement("script");"function"==typeof t?(console.debug("calling function..."),t(),e()):(console.debug("loading %s...",t),a.src=t,document.body.appendChild(a),a.onload=()=>{e()},a.onerror=()=>{s("Error: Loading '"+t+"' failed (h5games_gameJS)")})})),Promise.resolve())}else console.debug("[h5games_gameJS] object not found"),e()})},__:function(e){let t=SETTINGS.lang;if("object"==typeof this.i18n){if(t in this.i18n&&e in this.i18n[t])return this.i18n[t][e];if("default"in this.i18n&&e in this.i18n.default)return this.i18n.default[e]}return console.warn("No translation found for '%s'",e),null},hasRewardedAd:function(){return SETTINGS.options.rewarded},rewardedAd:function(){return new Promise((e,t)=>{if(VALIDATOR.isValid("event",{event:"rewardedAd"})){REPORT.dispatchEvent({event:"rewardedAd"}),REPORT.post({adapter:"analytics",event:"trackStats",data:{key:"rewarded_ad"}});let s=t=>{window.removeEventListener("rewardedAdEnded",s),VALIDATOR.isValid("event",{event:"rewardedAdEnded"})&&(console.debug("Revive"+(t.detail.isRewardGranted?"granted":"denied")),e(t.detail))};window.addEventListener("rewardedAdEnded",s),SETTINGS.options.test&&(SETTINGS.options.rewarded?(console.warn("In test mode, which you are currently in, the decision about a possible reward must be made manually.\nNote: If the parameter rewarded=0 is used, h5games.hasRewardedAd() will return false."),"undefined"==typeof Swal?window.dispatchEvent(new CustomEvent("rewardedAdEnded",{detail:{isRewardGranted:confirm("Rewarded ad ended. Should a reward be granted?")}})):Swal.fire({title:"Rewarded ad ended. Should a reward be granted?",showDenyButton:!0,confirmButtonText:"Yes, please!",denyButtonText:"No, absolutely not!",didDestroy(){window.dispatchEvent(new CustomEvent("rewardedAdEnded",{detail:!1}))}}).then(e=>{window.dispatchEvent(new CustomEvent("rewardedAdEnded",{detail:{isRewardGranted:e.isConfirmed}}))})):window.dispatchEvent(new CustomEvent("rewardedAdEnded",{detail:{isRewardGranted:!1}})))}else t()})},sendPreloadProgress:function(e){VALIDATOR.isValid("event",{event:"sendPreloadProgress",preloadProgress:e})&&(this.preloadProgress=e,REPORT.postPreloadProgress({adapter:"game",event:"preloadProgress",data:{preloadProgress:e}}))},isPaused:function(){return this._isPaused},isMuted:function(){return this._isMuted},isIdleState:function(){return this.currentState===this.STATES.IDLESTATE},isGameplay:function(){return this.currentState===this.STATES.GAMEPLAY},storage:{savegame:{},key:"savegame",init:function(){if(void 0!==window.localStorage)try{this.savegame=JSON.parse(window.localStorage.getItem(this.key)||"{}")}catch(e){this.savegame={}}},setItem:function(e,t){if(void 0===t){console.error("TypeError: Failed to execute 'setItem' on 'Storage': 2 arguments required, but only 1 present.");return}this.savegame[e]=String(t),this.save()},getItem:function(e){if(void 0===e){console.error("TypeError: Failed to execute 'getItem' on 'Storage': 1 argument required, but only 0 present.");return}return void 0!==this.savegame[e]?this.savegame[e]:null},removeItem:function(e){if(void 0===e){console.error("TypeError: Failed to execute 'removeItem' on 'Storage': 1 argument required, but only 0 present.");return}delete this.savegame[e],this.save()},clear:function(){this.savegame={},this.save()},save:function(){void 0!==window.localStorage&&(Object.keys(this.savegame).length?window.localStorage.setItem(this.key,JSON.stringify(this.savegame)):window.localStorage.removeItem("savegame"))}}};window.h5games=H5GAMES;let SETTINGS={lang:null,options:{test:!1,data:!1,console:!1,alert:!1,start:!1,debug:!1,controls:!1,validation:!1,revive:!1,reward:!1,message:!0,events:!1},init:function(e){let t={params:{}};if("object"==typeof e&&!Array.isArray(e)&&Object.keys(e))for(let s in t.get=function(e){return this.params[e]||null},Object.keys(e))t.params[Object.keys(e)[s]]=""+e[Object.keys(e)[s]];let a=Object.keys(t.params).length?t:new URLSearchParams(window.location.search||""),r;try{r=new URL(window.location.href).searchParams.get("locale")}catch(n){console.error(n)}if(this.lang=a.get("lang")||r||(navigator.language||navigator.userLanguage).substr(0,2),("test"===a.get("env")||"undefined"!=typeof c3_runtimeInterface&&void 0!==c3_runtimeInterface._GetLocalRuntime&&c3_runtimeInterface._GetLocalRuntime().IsPreview())&&(this.options.test=!0),this.options.debug=["true","1"].includes(a.get("_debug")),this.options.validation=["true","1"].includes(a.get("validation")),this.options.revive=["true","1"].includes(a.get("revive")),this.options.rewarded=["true","1"].includes(a.get("rewarded")),this.options.test){this.options.validation=!0;let o="";o="[TESTMODE] LiteAPI v"+VERSION,["data","console","alert","start","revive","rewarded","controls","message","events"].forEach(e=>{this.options[e]=!(["false","0"].includes(a.get(e))||!1===window["c3_properties_"+e]),o+="\n"+e+": "+this.options[e]}),o+="\nlang: "+this.lang,this.options.alert&&alert(o),this.options.console&&console.log(o)}else"function"==typeof window.alert&&(window.alert=function(){});this.options.debug||(console.debug=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"debug")}),this.options.console||(console.warn=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"warn")},console.info=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"info")},console.log=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"log")},console.error=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"error")},console.group=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"group")},console.groupEnd=function(){let e=Array.prototype.slice.call(arguments);h5games.log(e,"groupEnd")})}},EVENTS={init:function(){window.addEventListener("h5Event",e=>{e=e||{detail:{name:null}};let t=e.detail.name;switch(t){case"startGame":"function"==typeof H5GAMES.trigger.startGame&&H5GAMES.trigger.startGame();break;case"restartGame":case"stopGame":H5GAMES.stopGame();break;case"nextLevel":H5GAMES.nextLevel(e.detail.level);break;case"muteGame":H5GAMES.muteGame();break;case"unmuteGame":H5GAMES.unmuteGame();break;case"pauseGame":H5GAMES.pauseGame();break;case"resumeGame":H5GAMES.resumeGame();break;case"reviveGranted":window.dispatchEvent(new CustomEvent("reviveGranted"));break;case"getScore":REPORT.post({adapter:"special",event:"getScore",data:{score:H5GAMES.score}});break;case"getHighscore":REPORT.post({adapter:"special",event:"getHighscore",data:{score:H5GAMES.highscore}});break;case"getLevel":REPORT.post({adapter:"special",event:"getLevel",data:{level:H5GAMES.getLevel()}});break;case"onReceiveData":window.dispatchEvent(new CustomEvent("dataReceived",{detail:{presets:window.famobi.config.features.forced_mode||{}}}));break;case"setForcedMode":let s={};try{s=JSON.parse(e.detail.presets)}catch(a){console.debug(a)}window.famobi.config.features.forced_mode=s,"enabled"===window.famobi.config.features.forced_mode.allowVerboseMessages&&(alert("fuck you, colin!"),REPORT.isVerboseMessagesAllowed=!0);break;default:console.log(t)}},!1),SETTINGS.options.revive=!0,SETTINGS.options.rewarded=!0}};EVENTS.init();let REPORT={isWindowTop:null,isVerboseMessagesAllowed:!1,trackstats:{locked:!1,a:{ids:{},stats:{}},b:{ids:{},stats:{}}},score:null,progress:null,preloadProgress:null,reset:function(){console.debug("[REPORT] reset score..."),this.score=null,console.debug("[REPORT] reset trackstats"),this.trackstats={locked:!1,a:{ids:{},stats:{}},b:{ids:{},stats:{}}}},init:function(){this.trackstats.interval=setInterval(()=>{if(!this.trackstats.locked){if(this.trackstats.locked=!0,[this.trackstats.a,this.trackstats.b]=[this.trackstats.b,this.trackstats.a],Object.keys(this.trackstats.b.stats).length){for(let e in this.trackstats.b.stats)this.post({adapter:"analytics",event:"trackStats",data:this.trackstats.b.stats[e]});this.trackstats.b={ids:{},stats:{}}}this.trackstats.locked=!1}},750)},postTrack:function(e){let t=this.getID(e.data);this.trackstats.a.ids[t]=this.trackstats.a.ids[t]||0,this.trackstats.a.ids[t]+=e.data.amount||1,e.data.amount=this.trackstats.a.ids[t],this.trackstats.a.stats[t]=e.data},getID:function(e){let t=e.key;return Object.keys(e.options||{}).sort().forEach(s=>{t+="_"+s+"_"+e.options[s]}),t},postScore:function(e){if(this.score===e.data.params.liveScore){console.debug("The value of 'score' (%s) is the same as the previous one and is therefore not sent.",this.score);return}this.score=e.data.params.liveScore,REPORT.dispatchEvent({event:"sendScore",score:this.score}),this.post(e)},postProgress:function(e){if(this.progress===e.data.params.liveProgress){console.debug("The value of 'progress' (%s) is the same as the previous one and is therefore not sent.",this.progress);return}this.progress=e.data.params.liveProgress,REPORT.dispatchEvent({event:"sendProgress",score:this.progress}),this.post(e)},postPreloadProgress:function(e){if(null!==this.preloadProgress&&this.preloadProgress>=e.data.preloadProgress){this.preloadProgress>e.data.preloadProgress?console.debug("The value of 'preloadProgress' (%s) is smaller than the previous one (%s) and is therefore not sent.",e.data.preloadProgress,this.preloadProgress):console.debug("The value of 'preloadProgress' (%s) is the same as the previous one (%s) and is therefore not sent.",e.data.preloadProgress,this.preloadProgress);return}this.preloadProgress=e.data.preloadProgress,REPORT.dispatchEvent({event:"sendPreloadProgress",score:this.preloadProgress}),this.post(e)},post:function(e,t){if(null===this.isWindowTop&&window==window.top?(console.debug("[REPORT] window is window.top: postMessage is skipped"),this.isWindowTop=!0):this.isWindowTop=!1,e="string"==typeof e?e:JSON.stringify(e),SETTINGS.options.message){if(void 0!==window.ReactNativeWebView)try{window.ReactNativeWebView.postMessage(e)}catch(s){console.debug(s)}if(!0!==t&&(this.isWindowTop||!this.isVerboseMessagesAllowed)){console.debug("[postMessage|skipped]",e);return}console.debug("[postMessage]",e);try{window.top.postMessage(e,"*")}catch(a){console.debug(a)}}},dispatchEvent:function(e,t){SETTINGS.options.events&&("object"==typeof e&&(t=e,e="h5CustomEvent"),e=e||"h5CustomEvent",t=t||{},window.dispatchEvent(new CustomEvent(e,{detail:t})))}};REPORT.init();let FAMOBI={adapters:{add:function(){},run:function(e,t){switch(e){case"special":switch(t){case"getScore":REPORT.post({adapter:"special",event:"getScore",data:{score:H5GAMES.score}});break;case"getHighscore":REPORT.post({adapter:"special",event:"getHighscore",data:{score:H5GAMES.highscore}});break;case"getLevel":REPORT.post({adapter:"special",event:"getLevel",data:{level:H5GAMES.getLevel()}})}break;case"request":switch(t){case"startGame":"function"==typeof H5GAMES.trigger.startGame&&H5GAMES.trigger.startGame();break;case"restartGame":case"stopGame":H5GAMES.stopGame();break;case"pauseGameplay":H5GAMES.pauseGame();break;case"resumeGameplay":H5GAMES.resumeGame();break;case"muteGame":case"disableAudio":case"disableMusic":H5GAMES.muteGame();break;case"unmuteGame":case"enableAudio":case"enableMusic":H5GAMES.unmuteGame();break;case"nextLevel":H5GAMES.nextLevel(arguments[2])}}}},requestAction:function(e){this.adapters.run("request",e)},config:{features:{}}};window.onReceiveData=function(){window.dispatchEvent(new CustomEvent("dataReceived",{detail:{presets:window.famobi.config.features.forced_mode||{}}}))};let PROPERTIES={presets:{},configs:{},savegame:{}},TOOLS={loadFile(e){return new Promise((t,s)=>{let a=document.createElement("script"),r=!1;a.type="text/javascript",a.src=e,a.async=!0,a.onerror=e=>{t(e,a)},a.onload=a.onreadystatechange=()=>{r||this.readyState&&"complete"!=this.readyState||(r=!0,t())};let n=document.getElementsByTagName("script")[0];n.parentElement.insertBefore(a,n)})}},ERROR_HANDLER={},ICONS={icons:{flame:128293,robot:129302,handshake:129309,rocket:128640,muted:128263,unmuted:128265,finish:127937,coffee:9749,noentry:9940,party:127881,trophy:127942,skull:128128,biceps:128170,clapper:127916,satellite:128225,scream:128561,warning:9888,error:128683,pause:9208,resume:9199,stop:9209,menu:9776,flag:128681,gear:9881,joystick:128377,hourglass:9203,bellhop:128718,sleep:128164,ladder:129692,tornado:127786,pill:128138,toy:129528},get:function(e){if(e in this.icons)return String.fromCodePoint(this.icons[e])}},MENU={buttons:{dataReceived:{icon:ICONS.get("handshake"),fnc:"window.dispatchEvent(new CustomEvent('dataReceived', {detail: h5config.test}));"},startGame:{icon:ICONS.get("rocket"),fnc:"if(typeof h5games.trigger.startGame === 'function'){h5games.trigger.startGame()}",title:"resolve startGame"},pauseGame:{icon:ICONS.get("pause"),fnc:"h5games.pauseGame();"},resumeGame:{icon:ICONS.get("resume"),fnc:"h5games.resumeGame();"},muteGame:{icon:ICONS.get("muted"),fnc:"h5games.muteGame();"},unmuteGame:{icon:ICONS.get("unmuted"),fnc:"h5games.unmuteGame();"},reviveGranted:{icon:ICONS.get("pill"),fnc:"window.dispatchEvent(new CustomEvent('reviveGranted'));"},levelEnd:{icon:ICONS.get("finish"),fnc:"h5games.levelEnd();"},nextLevel:{icon:ICONS.get("tornado"),fnc:"h5games.nextLevel(null, true);"},stopGame:{icon:ICONS.get("stop"),fnc:"h5games.stopGame();"}},show:function(){if(H5GAMES.isLevelBased||delete this.buttons.nextLevel,null!==document.getElementById("h5-games-tester")){console.debug("menu already exists");return}let e=`<style>
			    #h5-games-tester{position:absolute;top:0;left:0;display:flex;z-index:99990}#h5-games-tester .toggleButton{height:3rem;padding:7.5px;margin-top:10px;background-color:rgba(18,18,18,.7);border:none;cursor:pointer;border-top-right-radius:7.5px;border-bottom-right-radius:7.5px}#h5-games-tester .buttons{display:none;flex-direction:column;padding:10px;background-color:rgba(18,18,18,.7);border-bottom-right-radius:10px}#h5-games-tester .button{height:4rem;margin-bottom:2px;padding:14px;cursor:pointer;background-color:#1a2028;border:1px solid rgba(255,255,255,.5);border-radius:5px;font-size:30px}#h5-games-tester .button:last-of-type{margin-bottom:0}#h5-games-tester .button:active{transform:scale(.975)}#h5-games-tester .button-icon{height:100%;width:100%}
				</style>`;document.head.insertAdjacentHTML("beforeend",e);let t='<div id="h5-games-tester"><div class="buttons">';for(let s in this.buttons)t+=`<button class="button ${s}Btn" title="${MENU.buttons[s].title||s}" onClick="javascript: ${MENU.buttons[s].fnc}">${MENU.buttons[s].icon}</button>`;t+=`</div><button class="toggleButton" onclick="javascript:document.querySelector('.buttons').style.display=document.querySelector('.buttons').style.display !== 'flex'?'flex':'none';">${ICONS.get("menu")}</button></div>`,document.body.insertAdjacentHTML("beforeend",t)}};class ValidationError extends Error{constructor(e){let t="";"object"==typeof e&&("errors"in e&&e.errors.length&&(t+=""+e.errors.length+" Error(s) found:",t+="\n"+ICONS.get("error")+" ",t+=e.errors.join("\n"+ICONS.get("error")+" ")),"warnings"in e&&e.warnings.length&&(t+="\n\n"+e.warnings.length+" Warning(s) found:",t+="\n"+ICONS.get("warning")+" ",t+=e.warnings.join("\n"+ICONS.get("warning")+" "))),super(e=t),this.name="ValidationError",SETTINGS.options.alert&&("undefined"!=typeof Swal?Swal.fire({icon:"error",title:"Oops... Something went wrong!",text:e,footer:'<a target="_blank" href="//famobi.atlassian.net/wiki/spaces/LIT/pages/1915256835/API">Why do I have this issue?</a>'}):alert(e)),console.warn(e),REPORT.post({adapter:"debug",event:"error",data:{msg:"ValidationError",data:e}})}}let VALIDATOR={reserved:{trackstats:["game_over","level_end"]},required:{requests:["stopGame","pauseGame","resumeGame","muteGame","unmuteGame","nextLevel"],presets:{params:["description","type","default"],types:["number","boolean","string","array"]},trackstats:{params:["description"]},trackstats_param:{params:["type"],types:["number","boolean","string","array"]}},allowed:{presets:{params:["description","type","min","max","values","default"],types:["number","boolean","string","array"]},trackstats:{params:["description","params"]},trackstats_param:{params:["type","values","min","max"]}},logs:{requests:[]},previousScore:null,previousProgress:null,previousPreloadProgress:null,events:{init:{once:!0,next:["dataReceived"],background:"#DEECFF"},dataReceived:{once:!0,next:["startGame","sendPreloadProgress"],background:"#FFEBE6"},playerReady:{once:!0,next:["track","sendScore","gameOver","sendProgress","stopGame","levelEnd","rewardedAd"],background:"#E3FCEE"},track:{next:["track","sendScore","sendProgress","gameOver","stopGame","levelEnd","rewardedAd"],background:"#E3FCEE"},sendScore:{next:["track","sendScore","sendProgress","gameOver","stopGame","levelEnd","rewardedAd"],background:"#E3FCEE"},sendProgress:{next:["track","sendScore","sendProgress","gameOver","stopGame","levelEnd","rewardedAd"],background:"#E3FCEE"},gameOver:{next:["reviveGranted","stopGame"],background:"#E3FCEE"},reviveGranted:{next:["track","sendScore","sendProgress","gameOver","stopGame","levelEnd","rewardedAd"],background:"#FFEBE6"},rewardedAdEnded:{next:["track","sendScore","sendProgress","gameOver","stopGame","levelEnd","rewardedAd"],background:"#FFEBE6"},levelEnd:{once:!0,next:["stopGame","nextLevel"],background:"#E3FCEE"},nextLevel:{once:!0,next:[],reset:["init","dataReceived"],background:"#E3FCEE"},startGame:{once:!0,next:["playerReady"],background:"#FFFAE6"},pauseGame:{next:null,background:"#E3FCEE"},resumeGame:{next:null,background:"#E3FCEE"},muteGame:{next:null,background:"#E3FCEE"},unmuteGame:{next:null,background:"#E3FCEE"},stopGame:{once:!0,next:[],reset:["init","dataReceived"],background:"#E3FCEE"},rewardedAd:{next:["rewardedAdEnded"],background:"#E3FCEE"},sendPreloadProgress:{next:["startGame","sendPreloadProgress"],background:"#E3FCEE"}},event_history:[],isValid:function(e,t){if(!1===SETTINGS.options.validation)return!0;t=t||{},console.debug("Validation of %s...",e),console.debug(e,t);let s={};switch(e){case"properties":let a=t.properties||{};VALIDATOR.properties(a,e=>{s=e});break;case"presets":let r=t.presets||h5config.presets||{};VALIDATOR.presets(r,e=>{s=e});break;case"trackstats":let n=h5config.trackstats||{};VALIDATOR.trackstats(n,e=>{s=e});break;case"requests":let o=h5config.requests||{};VALIDATOR.requests(o,e=>{s=e});break;case"event":let i="string"==typeof t?t:t.event;VALIDATOR.event(i,t,e=>{s=e});break;default:s.errors.push("Unknown validation type: "+e)}if(s.errors=s.errors||[],s.warnings=s.warnings||[],s.warnings.length&&s.warnings.forEach(e=>{console.warn(e)}),!s.errors.length)return!0;try{throw new ValidationError(s)}catch(d){}return!1},requests:function(e,t){console.debug("Checking requests...");let s=this.required.requests,a=[],r=[];if("undefined"!=typeof c3_runtimeInterface){console.debug("skipped"),t({errors:a,warnings:r});return}s.forEach(t=>{void 0!==e[t]&&"function"==typeof e[t]?"nextLevel"===t?H5GAMES.isLevelBased&&"function(level){}"===e[t].toString().replace(/\s/g,"")&&r.push(`Function '${t}' is empty`):"function(){}"===e[t].toString().replace(/\s/g,"")&&r.push(`Function '${t}' is empty`):r.push(`Function '${t}' is missing`)}),t({errors:a,warnings:r})},presets:function(e,t){console.debug("Checking presets...");let s=[],a=[];0===Object.keys(e).length?console.warn("No presets found"):Object.keys(e).forEach(t=>{this.validate("presets",{obj:e[t],name:t},e=>{s=s.concat(e.errors)})}),t({errors:s,warnings:a})},trackstats:function(e,t){console.debug("Checking trackstats...");let s=[],a=[],r={};Object.keys(e).length||console.warn("No trackstats found"),Object.keys(e).forEach(t=>{VALIDATOR.reserved.trackstats.includes(t)&&s.push("Invalid key: trackstats."+t+" is reserved"),this.validate("trackstats",{obj:e[t],name:t},e=>{s=s.concat(e.errors)}),Object.keys(r=e[t].params||{}).length&&(console.debug("Checking trackstats."+t+".params..."),Object.keys(r).forEach(e=>{this.validate("trackstats_param",{obj:r[e],name:e,path:"trackstats."+t+".params"},e=>{s=s.concat(e.errors)})}))}),t({errors:s,warnings:a})},track:function(e,t){let s=[],a=[],r=e.key,n=e.options,o=e.amount,i=function(e){s.push(`${e} (h5games.track)`)};return("string"==typeof r&&r.length||i("Invalid or missing key"),h5config.trackstats=h5config.trackstats||{},r in h5config.trackstats)?("number"==typeof n&&("object"==typeof o||void 0===o)&&([n,o]=[o,n]),n=n||{},o=o||1,Object.keys(h5config.trackstats[r].params||{}).length!==Object.keys(n).length)?(i(`Trackstat '${r}' expects ${Object.keys(h5config.trackstats[r].params||{}).length} parameter(s) for the options.`),t({errors:s,warnings:a})):void(Object.keys(n).forEach(e=>{if(Object.keys(h5config.trackstats[r].params||{}).includes(e)){if("values"in h5config.trackstats[r].params[e]&&!h5config.trackstats[r].params[e].values.includes(n[e]))i(`Not supported value '${n[e]}' for option '${e}'. Available values are: ${h5config.trackstats[r].params[e].values.join(", ")}`);else switch(h5config.trackstats[r].params[e].type){case"number":n[e]>=h5config.trackstats[r].params[e].min||i(`The value '${n[e]}' of '${e}' (trackstats.${r}) falls below the specified minimum value of '${h5config.trackstats[r].params[e].min}'`),h5config.trackstats[r].params[e].max&&!(n[e]<=h5config.trackstats[r].params[e].max)&&i(`The value '${n[e]}' of '${e}' (trackstats.${r}) exceeds the specified maximum value of '${h5config.trackstats[r].params[e].max}'`);break;case"string":!h5config.trackstats[r].params[e].values.includes(n[e])&&i(`The value '${n[e]}' of '${e}' (trackstats.${r}) is not one of the specified values: ${h5config.trackstats[r].params[e].values.join(", ")}`)}}else i(`The option '${e}' is not specified. Available options are: ${Object.keys(h5config.trackstats[r].params||{}).join(", ")}`)}),Number.isInteger(o)&&o>=0||i('The value for "amount" must be an integer and >= 0.'),t({errors:s,warnings:a})):(i(`Trackstat '${r}' is not supported`),t({errors:s,warnings:a}))},event:function(e,t,s){let a=[],r=[],n=function(t){a.push(`${t} (h5games.${e})`),s({errors:a})},o=(function(){return this.event_history.at(-1)||null}).bind(this),i=(function(){return o()?this.events[o()].next:["init"]}).bind(this);if(!Object.keys(this.events).includes(e))return n(`Unknown event '${e}'.
The event must be one of the following: `+Object.keys(this.events).join(", "));if(!0===this.events[e].once&&this.event_history.includes(e))return n(`The event '${e}' must not be called more than once.`);if(null!==this.events[e].next){if(!i().length)return n(`Unexpected event '${e}'. No further events are possible.`);if(!i().includes(e))return"track"===e?(t.key=t.key||"",n(`Unexpected event '${e}${"("+(t.key.length?'"'+t.key+'"':"")+")"}'. Waiting for: ${i().join(" or ")}`)):n(`Unexpected event '${e}'. Waiting for: ${i().join(" or ")}`)}switch(e){case"sendScore":if(!(Number.isInteger(t.score)&&t.score>=0))return n("The value for 'score' must be an integer and greater than or equal to 0");this.previousScore===t.score?r.push("The value for 'score' must be different from the previous one. Send 'score' only if its value has changed"):this.previousScore=t.score;break;case"sendProgress":if(!(Number.isInteger(t.progress)&&t.progress>=0&&t.progress<=100))return n("The value for 'progress' must be an integer and between 0 and 100");this.previousProgress===t.progress?r.push("The value for 'progress' must be different from the previous one. Send 'progress' only if its value has changed"):this.previousProgress=t.progress;break;case"sendPreloadProgress":if(!(Number.isInteger(t.preloadProgress)&&t.preloadProgress>=0&&t.preloadProgress<=100))return n("The value for 'preloadProgress' must be an integer and between 0 and 100");null!==this.previousPreloadProgress&&this.previousPreloadProgress>=t.preloadProgress?this.previousPreloadProgress===t.preloadProgress?r.push("The value for 'preloadProgress' must be different from the previous one. Send 'preloadProgress' only if its value has changed"):r.push("The value for 'preloadProgress' must be greater than the previous one."):this.previousPreloadProgress=t.preloadProgress;break;case"track":this.track(t,e=>{a=a.concat(e.errors),r=r.concat(e.warnings)});break;case"nextLevel":if(!("level"in h5config.presets))return n(`Unexpected event '${e}'. Due to the missing preset "level", the game is not classified as "level-based"`);if(void 0===t.level)return n("Missing parameter: level");if(typeof t.level!==h5config.presets.level.type)return n(`Mismatched types: The passed level is of type '${typeof t.level}' and does not match the specified type '${h5config.presets.level.type}'`);switch(typeof t.level){case"string":break;case"number":if(!(t.level>=h5config.presets.level.min))return n(`The passed level '${t.level}' falls below the specified minimum value of '${h5config.presets.level.min}'`),!1;if(h5config.presets.level.max&&!(t.level<=h5config.presets.level.max))return n(`The passed level '${t.level}' exceeds the specified maximum value of '${h5config.presets.level.max}'`),!1}break;case"rewardedAd":if(!H5GAMES.hasRewardedAd())return n("Since h5games.hasRewarded() returns false, calling h5games.rewardedAd() is not allowed"),!1}if(!a.length){switch(null!==this.events[e].next&&this.event_history.push(e),e){case"init":H5GAMES.setState(H5GAMES.STATES.INITIALIZATION);break;case"dataReceived":H5GAMES.setState(H5GAMES.STATES.LOADING);break;case"startGame":H5GAMES.setState(H5GAMES.STATES.IDLESTATE);break;case"playerReady":case"reviveGranted":H5GAMES.setState(H5GAMES.STATES.GAMEPLAY);break;case"levelEnd":case"stopGame":H5GAMES.setState(H5GAMES.STATES.UNDEFINED)}let d="";switch(console.group("[Game Event]"),e){case"gameOver":break;case"sendScore":d="("+t.score+")";break;case"sendProgress":d="("+t.progress+")";break;case"sendPreloadProgress":d="("+t.preloadProgress+")";break;case"nextLevel":d=void 0!==t.level?"("+t.level+")":""}if(console.log(`%c ${e.toUpperCase()}${d} `,"background: "+this.events[e].background+"; color: black; display: block;"),"track"===e&&SETTINGS.options.console&&(console.log("key: ",t.key),void 0!==t.amount&&console.log("amount: ",t.amount),void 0!==t.options)){if(Object.keys(t.options||{}).length){for(let l in console.group("options:"),t.options)console.log(`${l}: ${t.options[l]}`);console.groupEnd("options:")}else console.log("options: ",t.options)}console.groupEnd("[Game Event]"),this.events[e].reset&&(console.debug("reset: ",this.events[e].reset),this.event_history=[].concat(this.events[e].reset))}s({errors:a,warnings:r})},properties:function(e,t){let s=[],a,r=function(e){s.push(`${e} (properties.${a})`)};(e=e||{}).presets=e.presets||{};let n=function(t){if(a="preset",!(t in(h5config.presets||{})))return r(`'${t}' not found in specified presets`),!1;let s=Array.isArray(e.presets[t])?"array":typeof e.presets[t];if(s!==h5config.presets[t].type)return r(`'${t}' is of type '${s}'. However, the specified type is '${h5config.presets[t].type}'`),!1;switch(h5config.presets[t].type){case"number":if(-999===e.presets[t])break;if(!(e.presets[t]>=h5config.presets[t].min))return r(`The value '${e.presets[t]}' of '${t}' falls below the specified minimum value of '${h5config.presets[t].min}'`),!1;if(h5config.presets[t].max&&!(e.presets[t]<=h5config.presets[t].max))return r(`The value '${e.presets[t]}' of '${t}' exceeds the specified maximum value of '${h5config.presets[t].max}'`),!1;break;case"string":if(!h5config.presets[t].values.includes(e.presets[t]))return r(`The value '${e.presets[t]}' of '${t}' is not one of the specified values: ${h5config.presets[t].values.join(", ")}`),!1;break;case"array":e.presets[t].forEach(e=>{if(!h5config.presets[t].values.includes(e))return r(`The value '${e}' of '${t}' is not one of the specified values: ${h5config.presets[t].values.join(", ")}`),!1})}return!0};console.debug("Checking properties..."),Object.keys(e.presets).length?Object.keys(e.presets).forEach(e=>{n(e)}):console.info("No presets were set externally (or via h5config.test)"),t({errors:s})},validate:function(e,t,s){let a=[],r=function(t){let s=i||e;a.push(`${t} (${s}.${o})`)},n=(t=t||{}).obj,o=t.name,i=t.path;RegExp("^[a-z#_]*$").test(o)||r("Invalid name"),0===Object.keys(n).length&&r("Empty");let d=JSON.parse(JSON.stringify(this.required));switch(n.type){case"array":case"string":d[e].params.includes("values")||d[e].params.push("values");break;case"number":d[e].params.includes("min")||d[e].params.push("min")}d[e].params.forEach(e=>{Object.keys(n).includes(e)||r(`Required parameter '${e}' is missing`)}),Object.keys(n).forEach(t=>{if(!this.allowed[e].params.includes(t)){r(`Unsupported parameter '${t}'. Available values are: ${this.allowed[e].params.join(", ")}`);return}switch(t){case"description":"string"==typeof n[t]&&n[t].length||r(`Invalid or empty parameter '${t}'`);break;case"type":d[e].types.includes(n[t])||r(`Invalid or empty parameter '${t}'. Available values are: ${d[e].types.join(", ")}`);break;case"max":("number"!=typeof n[t]||n[t]<n.min)&&r(`Invalid or empty parameter '${t}'. Must be of type 'number' and greater than or equal to 'min'`);break;case"min":"number"!=typeof n[t]&&r(`Invalid or empty parameter '${t}'. Must be of type 'number'`);break;case"default":switch(n.type){case"number":typeof n[t]!==n.type&&r(`Invalid or empty parameter '${t}'. Must be of type '${n.type}'`),typeof n.max===n.type?(typeof n[t]!==n.type||n[t]<n.min||n[t]>n.max)&&r(`Invalid or empty parameter '${t}'. Must be of type 'number' and between 'min' (${n.min}) and 'max' (${n.max})`):(typeof n[t]!==n.type||n[t]<n.min)&&r(`Invalid or empty parameter '${t}'. Must be of type 'number' and greater than or equal to 'min' (${n.min})`);break;case"boolean":typeof n[t]!==n.type&&r(`Invalid or empty parameter '${t}'. Must be of type '${n.type}'`);break;case"array":if(Array.isArray(n[t]))for(let s=0;s<n[t].length;s++)(n.values||[]).includes(n[t][s])||r(`Invalid parameter '${t}'. Must be one of the specified 'values'`);else r(`Invalid parameter '${t}'. Must be of type '${n.type}'`);break;case"string":typeof n[t]===n.type&&(n.values||[]).includes(n[t])||r(`Invalid or empty parameter '${t}'. Must be of type '${n.type}' and one of the specified 'values'`);break;default:(void 0===n[t]||(n[t],0))&&r(`Invalid or empty parameter '${t}'`)}break;case"values":Array.isArray(n[t])&&n[t].length||r(`Invalid or empty parameter '${t}'`);break;case"params":"object"==typeof n[t]&&Object.keys(n[t]).length||r(`Invalid or empty parameter '${t}'`)}}),s({errors:a})}}}();