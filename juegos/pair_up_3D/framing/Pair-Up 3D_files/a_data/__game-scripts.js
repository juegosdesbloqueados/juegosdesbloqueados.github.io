function detectCurrentLevel(){var e,t,a,n;return PlayerManager.instance.userData.userScore>=1e5?(e="Guru",t="",a=1,n=""):PlayerManager.instance.userData.userScore>=5e4?(e="Expert",t="Guru",a=(PlayerManager.instance.userData.userScore-5e4)/5e4,n=1e5):PlayerManager.instance.userData.userScore>=1e4?(e="Professional",t="Expert",a=(PlayerManager.instance.userData.userScore-1e4)/4e4,n=5e4):PlayerManager.instance.userData.userScore>=5e3?(e="Semi-Pro",t="Professional",a=(PlayerManager.instance.userData.userScore-5e3)/5e3,n=1e4):PlayerManager.instance.userData.userScore>=1e3?(e="Competent",t="Semi-Pro",a=(PlayerManager.instance.userData.userScore-1e3)/4e3,n=5e3):PlayerManager.instance.userData.userScore>=500?(e="Advanced",t="Competent",a=(PlayerManager.instance.userData.userScore-500)/500,n=1e3):PlayerManager.instance.userData.userScore>=100?(e="Beginner",t="Advanced",a=(PlayerManager.instance.userData.userScore-100)/400,n=500):PlayerManager.instance.userData.userScore>=0&&(e="Amateur",t="Beginner",a=PlayerManager.instance.userData.userScore/100,n=100),[e,t,a,n]}function randomInRange(e,t){return Math.random()*(t-e)+e}function shuffle(e){let t,a=e.length;for(;0!=a;)t=Math.floor(Math.random()*a),a--,[e[a],e[t]]=[e[t],e[a]];return e}function slideTop(){let e=LevelUpbanner.instance.levelUpUI;e.tween(e.getLocalPosition()).to(new pc.Vec3(0,240,0),1,pc.SineOut).on("complete",function(){e.enabled=!1}).start()}function renderLoop(e){return secondsPassed=(e-oldTimeStamp)/1e3,oldTimeStamp=e,totalSeconds+=secondsPassed,totalSeconds>1/120?(canvasRender.render(),totalSeconds=0,void window.requestAnimationFrame(renderLoop)):void window.requestAnimationFrame(renderLoop)}function createSpawnAssetsRandomIndexArray(){let e=PlayerManager.instance.spawnObjectCountByUserScore();for(spawnAssetRandomIndexes=[];spawnAssetRandomIndexes.length<e;){var t=Math.floor(Math.random()*e);-1===spawnAssetRandomIndexes.indexOf(t)&&spawnAssetRandomIndexes.push(t)}}function helperModelItem(e){return"LivingRoom"==e?"LivingItem":"Kitchen"==e?"KitchenItem":"KidsRoom"==e?"KidsItem":"Food"==e?"FoodItem":"FarmersMarket"==e?"FarmersItem":"Cellar"==e?"CellarItem":"HobbyRoom"==e?"HobbyItem":"School"==e?"SchoolItem":"Sport"==e?"SportItem":"Bedroom"==e?"BedroomItem":void 0}function attentionPreloadKey(e){return"FarmersMarket"==e?"FarmersItem":"LivingRoom"==e?"LivingItem":"Kitchen"==e?"KitchenItem":"KidsRoom"==e?"KidsItem":"Food"==e?"FoodItem":"Cellar"==e?"CellarItem":void 0}async function prepareMiniGameData(e,t){var a=[];if(6==e){var n=GameManager.instance.eventData.assetTag.split(",");let e=n[Math.floor(Math.random()*n.length)];var o=app.assets.find("LinkGameData.json").resource[e].toString().split(","),s=GameManager.instance.eventData.assetName.split(",");for(j=0;j<o.length;j++)for(i=0;i<s.length;i++){if(s[i]==o[j]){s.splice(i,1);break}"Music"==e&&"HobbyRoom"==s[i]&&s.splice(i,1)}let r=shuffle(s),c=r.slice(0,2);randomSpawnArray1=app.assets.findByTag(helperModelItem(r[0])),randomSpawnArray2=app.assets.findByTag(helperModelItem(r[1])),a.push(e+"Item"),randomSpawnArray1.length>26?a.push(helperModelItem(r[0])):(a.push(helperModelItem(r[0])),a.push(helperModelItem(r[1]))),GameManager.instance.eventData.matchKey=e,GameManager.instance.eventData.spawnedArrayList=c,t(a)}else if(4==e){let e=GameManager.instance.eventData.assetTag.split(","),n=e[Math.floor(Math.random()*e.length)],i=app.assets.find("AttentionGameData.json").resource[n];for(var r=[];r.length<3;){var c=Math.floor(Math.random()*i.length);-1===r.indexOf(i[c])&&r.push(i[c])}findByAttentionObjects=[...r],GameManager.instance.eventData.matchKey=r,GameManager.instance.eventData.assetTag=n,t(a=helperModelItem(n))}else t(a=GameManager.instance.eventData.assetTag+"Item")}function clearCacheFunction(){window.famobi?(window.famobi.localStorage.removeItem("level"),window.famobi.localStorage.removeItem("levelID"),window.famobi.localStorage.removeItem("levelName"),window.famobi.localStorage.removeItem("levelItem"),window.famobi.localStorage.removeItem("time"),window.famobi.localStorage.removeItem("objectCount"),window.famobi.localStorage.removeItem("assetName"),window.famobi.localStorage.removeItem("unlockLevel"),window.famobi.localStorage.removeItem("score"),window.famobi.localStorage.removeItem("player"),window.famobi.localStorage.removeItem("lastTimeBar"),window.famobi.localStorage.removeItem("matchItems"),window.famobi.localStorage.removeItem("isContinue"),window.famobi.localStorage.removeItem("backupLevelData"),window.famobi.localStorage.removeItem("extraInfo"),window.famobi.localStorage.removeItem("interruption"),window.famobi.localStorage.removeItem("minObjectCount"),window.famobi.localStorage.removeItem("levelRoom"),window.famobi.localStorage.removeItem("levelRoom"),window.famobi.localStorage.removeItem("version"),window.famobi.localStorage.removeItem("testDrive"),window.famobi.localStorage.removeItem("customEventPlayed")):(localStorage.removeItem("level"),localStorage.removeItem("levelID"),localStorage.removeItem("levelName"),localStorage.removeItem("levelItem"),localStorage.removeItem("time"),localStorage.removeItem("objectCount"),localStorage.removeItem("assetName"),localStorage.removeItem("unlockLevel"),localStorage.removeItem("score"),localStorage.removeItem("player"),localStorage.removeItem("lastTimeBar"),localStorage.removeItem("matchItems"),localStorage.removeItem("isContinue"),localStorage.removeItem("backupLevelData"),localStorage.removeItem("extraInfo"),localStorage.removeItem("interruption"),localStorage.removeItem("minObjectCount"),localStorage.removeItem("levelRoom"),localStorage.removeItem("levelRoom"),localStorage.removeItem("version"),localStorage.removeItem("testDrive"),localStorage.removeItem("customEventPlayed"))}function clearUserData(){window.famobi?(window.famobi.localStorage.removeItem("PairUp:PlayerData"),window.famobi.localStorage.removeItem("PairUp:isNewUser")):(localStorage.removeItem("PairUp:PlayerData"),localStorage.removeItem("PairUp:isNewUser"))}function setFillMode(){pc.platform.mobile&&(pc.Application.getApplication().setCanvasFillMode(pc.FILLMODE_FILL_WINDOW),document.getElementById("application-canvas").style.height="100%",document.getElementById("application-canvas").style.margin=0)}function loadScene(e,t,a,n){var i=pc.Application.getApplication(),o=i.scenes.find(e);if(o){var s=o.loaded;i.scenes.loadSceneData(o,function(e,o){if(e)a&&a.call(n,e);else{for(var r=null,c=i.root.children;c.length>0;)c[0].destroy();t.settings&&i.scenes.loadSceneSettings(o,function(e){e&&a&&a.call(n,e)}),t.hierarchy&&i.scenes.loadSceneHierarchy(o,function(e,t){e?a&&a(e):r=t}),s||i.scenes.unloadSceneData(o),a&&a.call(n,null,r)}})}else a&&a.call(n,"Scene not found: "+e)}var Log=function(e,t){this.prefix=e+": ",this.enabled=void 0===t||t};Log.prototype.info=function(e){this.enabled&&console.log(this.prefix+e)},Log.prototype.error=function(e){this.enabled&&console.error(this.prefix+e)},Log.prototype.warn=function(e){this.enabled&&console.warn(this.prefix+e)};var GameData=pc.createScript("gameData");GameData.prototype.initialize=function(){GameData.instance=this},GameData.prototype.getLevelData=function(e){let t,a,n,i,o,s;switch(e){case 1:t="Hobby Room - 1",a=5,n=60,i="HobbyItem",o="HobbyRoom",s="Hobby Room";break;case 2:t="Hobby Room - 2",a=6,n=60,i="HobbyItem",o="HobbyRoom",s="Hobby Room";break;case 3:t="Hobby Room - 3",a=7,n=60,i="HobbyItem",o="HobbyRoom",s="Hobby Room";break;case 4:t="Kids Room - 1",a=7,n=60,i="KidsItem",o="KidsRoom",s="Kids Room";break;case 5:t="Kids Room - 2",a=8,n=60,i="KidsItem",o="KidsRoom",s="Kids Room";break;case 6:t="School",a=8,n=60,i="SchoolItem",o="School",s="School";break;case 7:t="Farmers Market",a=9,n=60,i="FarmersItem",o="FarmersMarket",s="Farmers Market";break;case 8:t="Bedroom",a=9,n=60,i="BedroomItem",o="Bedroom",s="Bedroom";break;case 9:t="Cellar",a=10,n=60,i="CellarItem",o="Cellar",s="Cellar";break;case 10:t="Kitchen",a=10,n=60,i="KitchenItem",o="Kitchen",s="Kitchen";break;case 11:t="Food Court",a=11,n=60,i="FoodItem",o="Food",s="Food Court";break;case 12:t="Gym",a=11,n=60,i="SportItem",o="Sport",s="Gym";break;case 13:t="Living Room",a=12,n=60,i="LivingItem",o="LivingRoom",s="Living Room"}return{levelName:t,objectCount:a,time:n,levelItem:i,levelTemplate:o,levelRoom:s,levelID:e}},GameData.prototype.getMiniGameData=function(e){let t,a,n,i,o,s;switch(e){case 1:t="Math Game",a=10,n=60,i="School",o="Number",s={Key:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10,10:11,11:12,12:13,13:14,14:15,15:16,16:17,17:18,18:19}};break;case 2:t="Word Game",a=26,n=60,i="School",o="Alphabet",s={TiKey:["UMBRELLA","VACCINE","DOCTOR","MICROSCOPE","HEARTBEAT","MOUTH","TOOTH","LUNGS","THOUGHT","SLEEPING","UNDERWEAR","GLASSES","SNEAKERS","FOOTPRINT","TOOTHBRUSH","MIRROR","EXTINGUISHER","FAUCET","BATHTUB","TEMPERATURE","LIFEBUOY","STROLLER","ARMCHAIR","NOTEBOOK","FOLDER","SUITCASE","BRIEFCASE","WALLET","HANDBAG","LOLLYPOP","BALLOON","SNOWMAN","GHOST","MEDICINE","PILL","ELEPHANT","PENGUIN","TORTOISE","DOLPHIN","SNAIL","BAT","SPIDER","BUTTERFLY","RABBIT","SQUIRREL","HORSE","PIG","DEER","HOUSE","TEMPLE","CHURCH","TOWER","CASTLE","GARAGE","COFFEE","PIZZA","CHEESE","BREAD","CROISSANT","CANDY","COCKTAIL","BEER","SOUP","WINE","APPLE","CHERRY","PEAR","GRAPE","PINEAPPLE","LEMON","CARROT","MUSHROOM","HAMBURGER","FLOWER","LEAF","FENCE","MOUNTAIN","ISLAND","CART","DOLLAR","PUZZLE","DICE","GUITAR","PIANO","VOLLEYBALL","FOOTBALL","BASKETBALL","BOWLING","RACKET","HAMMER","SCISSORS","RULER","PINCERS","SAW","DRILL","MAGNIFIER","WRENCH","CHAIN","PENCIL","PEN"]};break;case 4:t="Attention Game",a=40,n=60,i="School",o="LivingRoom,Kitchen,KidsRoom,Food,FarmersMarket,Cellar",s={LivingRoom:["Armchair","Chair","FlowerPot","FurnitureSofa","TV"],Kitchen:["Blender","Microwave","Roller","Skimmer","Spoon"],KidsRoom:["Babytoys","Bird","Controller","Kite","RacoonPlush"],"Hobby Room":["Bell","Casette","ElectroGuitar","Saxophone","Tumba"],Food:["Creepe","HamEgg","IcecreamCherry","OrangeJuice","Turkey"],FarmersMarket:["Cherry","DragonFruit","PineApple","Raddish","WaterMelon"],Cellar:["BestCorn","CannedSalmon","Cereal","VitaminJuice","VitaminZero"]};break;case 6:t="Link Game",a=40,n=60,i="Bedroom,Cellar,FarmersMarket,Food,HobbyRoom,KidsRoom,Kitchen,LivingRoom,School,Sport",o="Music,Toys,Sitting,Drinking,Electricity,Junk Food",s={Music:{0:"HobbyRoom"},Toys:{0:"KidsRoom"},Sitting:{0:"LivingRoom"},Drinking:{0:"Kitchen",1:"Food",2:"Cellar"},Electricity:{0:"LivingRoom",1:"Kitchen",2:"HobbyRoom"},"Junk Food":{0:"Food"}}}return{miniGameName:t,objectCount:a,time:n,assetName:i,assetTag:o,matchKey:s,miniGameIndex:e}};var Application=pc.createScript("application"),self=null,firstInitLoad=!1;Application.prototype.initialize=function(){setFillMode();var e=document.createElement("style");document.head.appendChild(e),e.innerHTML="canvas{-webkit-touch-callout:none;-webkit-user-select:none -khtml-user-select:none;-moz-user-select:none;-ms-user select:none;user-select:none;outline:0;-webkit-tap-highlight-color:rgba(255,255255,0)",e.innerHTML="body{-webkit-touch-callout:none;-webkit-user-select:none -khtml-user-select:none;-moz-user-select:none;-ms-user select:none;user-select:none;outline:0}",this.app.mouse.disableContextMenu(),self=this,this._loadingScene=!1,this.app.on("game:Ready",this.LoadSceneData,this)},Application.prototype.LoadSceneData=function(e){var t=this.app.scenes.find(e);this.app.off("game:Ready",this),this.app.scenes.loadSceneData(t,function(e,a){if(e)console.error(e);else{for(var n=this.app.root.children;n.length>0;)n[0].destroy();this.app.scenes.loadSceneHierarchy(t),this.app.scenes.loadSceneSettings(t),this.app.scenes.unloadSceneData(t)}}.bind(this))};var ADSManager=pc.createScript("adsManager");const ADS_ID_Array=["107b707a-2caa-4b9e-ac06-24d756c37c05"],ADS_ID="107b707a-2caa-4b9e-ac06-24d756c37c05";ADSManager.prototype.initialize=function(){ADSManager.instance=this,this.log=new Log("ADS_MANAGER"),this.matchStartAds=!1},ADSManager.prototype.OpenRewardVideo=async function(e,t,a){this.adsShowTypeValue=e,window.famobi?window.famobi.rewardedAd(e=>{e.rewardGranted?(this.completeAds(t),a(!0)):a(!1)}):(a(!0),this.completeAds(t))},ADSManager.prototype.continueSound=function(){var e,t=this.app.systems.sound;e&&clearTimeout(e),t.context.suspend(),e=setTimeout(function(){"running"!==t.context.state&&t.context.resume()},100)},ADSManager.prototype.completeAds=function(e){ADSManager.instance.continueSound(),this.adsShowTypeValue===adsEnum.Interstitial?1==this.matchStartAds?(GameManager.instance.ExtraTime(),this.matchStartAds=!1):1==playExtraTime?GameManager.instance.GameStart():e==adsGameFinishEnum.Lose?GameManager.instance.GameLose():e==adsGameFinishEnum.CompleteMatch?(completeMatchStatus=!0,GameManager.instance.GameWin()):e==adsGameFinishEnum.Win&&GameManager.instance.GameWin():this.adsShowTypeValue===adsEnum.MatchThemAll?GameManager.instance.OfferPlay(!1):this.adsShowTypeValue===adsEnum.ShakeBoard?ShakeTable.instance.shakeAnimation():this.adsShowTypeValue===adsEnum.JokerMiniWordGame?WordMiniGameJoker.instance.jokerAction():this.adsShowTypeValue===adsEnum.JokerMiniLinkGame?WordMiniGameJoker.instance.jokerLinkGame():this.adsShowTypeValue===adsEnum.JokerMiniMathGame?WordMiniGameJoker.instance.jokerMathGame():this.adsShowTypeValue===adsEnum.JokerMiniAttentionGame?WordMiniGameJoker.instance.jokerAttentionGame():GameManager.instance.OfferPlay(!0)},ADSManager.prototype.checkADSReady=async function(e){sc.app?(await sc.isAdReady(ADS_ID)).isReady?(ADSManager.instance.log.info("Reklam Hazır"),e(!0)):(e(!1),ADSManager.instance.log.info("An Ad is not ready at this time. Please try again later.")):sc.pc&&e(!0)},ADSManager.prototype.onAdReady=function(e){e===ADS_ID&&ADSManager.instance.log.info("Adready Hazır:")};var Touch=pc.createScript("touch");Touch.attributes.add("OnTouch",{type:"boolean"}),Touch.attributes.add("Cover",{type:"entity"}),Touch.attributes.add("posX",{type:"number"}),Touch.attributes.add("posY",{type:"number"}),Touch.attributes.add("dist",{type:"vec3"}),Touch.prototype.initialize=function(){let e=this.app.root.findByName("MainUI"),t=this.app.root.findByName("NarrowPlane"),a=this.app.root.findByName("WidePlane"),n=e.findByName("GameBottomGroup");pc.platform.mobile?(e.screen.scaleBlend=0,t.enabled=!1,a.enabled=!0,n.setLocalPosition(new pc.Vec3(0,56.253,0))):(e.screen.scaleBlend=1,t.enabled=!0,a.enabled=!1,n.setLocalPosition(new pc.Vec3(0,0,0))),Touch.instance=this,this.select=null,this.time_passed=0,this.power_multiplier=.3,this.leftClickStatus=!1,this.ray=new pc.Ray,this.pos=new pc.Vec3,this.cameraEntity=this.entity,this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onTouchMove,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onSelect,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onTouchEnd,this),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onSelect,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.app.on("gameManager:updatestatus",this.Status,this),this.entity.on("destroy",this.OnDestroy,this),this.velocity=new pc.Vec3(0,0,0),this.direction=new pc.Vec3,this.distance=0,this.power=0,this.StartWorldPos=new pc.Vec3(0,0,0),this.EndWorldPos=new pc.Vec3(0,0,0),this.touchStarted=!1,this.touchEnded=!1,this.startPos=new pc.Vec2(0,0),this.EndPos=new pc.Vec2(0,0),this.time=0,this.duration=0,this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.canThrow=!1,this.canvas=document.getElementById("application-canvas"),this.canvas.addEventListener("mouseleave",function(e){Touch.instance.leftClickStatus&&Touch.instance.onTouchEnd()},!1),this.disableTouchController=!0},Touch.prototype.doRayCast=function(e,t){this.startPos.set(e,t),this.startX=e,this.startY=t,this.power=0;var a=this.entity.camera.screenToWorld(e,t,this.entity.camera.nearClip),n=this.entity.camera.screenToWorld(e,t,this.entity.camera.farClip);this.app.systems.rigidbody.raycastFirst(a,n,function(a){if("drop_area"==a.entity.name){if(untouchableSelect=this.app.root.findByTag("untouchable")[0],Touch.instance.select=this.app.root.findByTag("dropped")[0],null!=untouchableSelect||void 0===Touch.instance.select)return;Touch.instance.select.tween(Touch.instance.select.getLocalScale()).to(new pc.Vec3(1.3,1.3,1.3),.2,pc.CubicInOut).start(),Touch.instance.select.rigidbody.type=pc.BODYTYPE_KINEMATIC,Touch.OnTouch=!0,this.dist=Touch.instance.entity.camera.worldToScreen(a.entity.getPosition()),this.posX=e-this.dist.x,this.posY=t-this.dist.y}else a.entity.tags.has("Select")&&(Touch.instance.select=a.entity,Touch.instance.select.tween(Touch.instance.select.getLocalScale()).to(new pc.Vec3(1.3,1.3,1.3),.2,pc.CubicInOut).start(),Touch.instance.select.rigidbody.type=pc.BODYTYPE_KINEMATIC,Touch.OnTouch=!0,this.dist=Touch.instance.entity.camera.worldToScreen(a.entity.getPosition()),this.posX=e-this.dist.x,this.posY=t-this.dist.y,"Donut Shop"===PlayerManager.instance.levelData.levelName&&(0==Tutorial.instance.isCheckMoveTutorialStatus&&(Tutorial.instance.moveObjectTutorialOnOff(!1),Tutorial.instance.isCheckMoveTutorialStatus=!0),1==Tutorial.instance.isCheckFactorTutorialStatus&&(Tutorial.instance.moveFactorTutorialOnOff(!1),isCheckFactorTutorialStatus=!1)))})},Touch.prototype.onSelect=function(e){this.disableTouchController||(this.time=0,this.duration=0,this.touchStarted=!0,this.touchEnded=!1,!0===this.touchStarted&&this.startCounter(),this.app.touch?(this.leftClickStatus=!0,this.doRayCast(e.touches[0].x,e.touches[0].y),e.event.preventDefault()):e.button===pc.MOUSEBUTTON_LEFT&&(this.leftClickStatus=!0,this.doRayCast(e.x,e.y)))},Touch.prototype.onTouchMove=function(e){if(!this.disableTouchController&&(this.app.touch&&(e.x=e.touches[0].x,e.y=e.touches[0].y,e.event.preventDefault()),!0===Touch.OnTouch)){this.EndPos.set(e.x,e.y),this.canThrow=!0,this.endX=e.x,this.endY=e.y;var t=new pc.Vec3(e.x-this.posX,e.y-this.posY,this.dist.z),a=this.entity.camera.screenToWorld(t.x,t.y,13,a);this.select.rigidbody.teleport(a.x,a.y+.5,a.z)}},Touch.prototype.onTouchEnd=function(e){if(this.touchStarted=!1,this.touchEnded=!0,!this.disableTouchController&&1==Touch.OnTouch){if(this.leftClickStatus=!1,this.select.tween(this.select.getLocalScale()).to(new pc.Vec3(1,1,1),.2,pc.CubicInOut).start(),Touch.OnTouch=!1,this.select.rigidbody.enabled=!0,this.select.rigidbody.type=pc.BODYTYPE_DYNAMIC,this.select.tags.remove("dropped"),this.select.tags.remove("untouchable"),this.time_passed>0?this.time=this.time_passed:this.time=.2*Math.random()+.3,this.stopCounter(),this.touchEnded){this.time_passed<=10?this.power_multiplier=.22:this.time_passed>10&&this.time_passed<=20?this.power_multiplier=.18:(this.time_passed,this.power_multiplier=.1),this.direction.sub2(this.EndWorldPos,this.StartWorldPos),this.distance=this.direction.length(),this.power=this.distance/(this.time*this.power_multiplier);var t=this.EndWorldPos.x-this.StartWorldPos.x,a=this.EndWorldPos.y-this.StartWorldPos.y,n=this.EndWorldPos.z-this.StartWorldPos.z;x=10*this.power*2*(100*t),y=10*this.power*2*(100*a),z=10*this.power*2*(100*n),this.select.rigidbody.applyImpulse(x,y,z)}this.distanceBetween(this.Cover,this.select)<2.5&&this.app.fire("covermanager:entity",this.select),this.select=null}},Touch.prototype.Status=function(e){e===gamestatus.Lose||e===gamestatus.Quit||e===gamestatus.Win?this.disableTouchController=!0:e!==gamestatus.Play&&e!==gamestatus.OfferPlay&&e!==gamestatus.Resume||GameManager.instance.isGamePaused||("Donut Shop"==PlayerManager.instance.levelData.levelName?this.disableTouchController=!1:PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame?1==PlayerManager.instance.userData.jokerTutorial&&(this.disableTouchController=!1):1==PlayerManager.instance.userData.shakeTutorial&&(this.disableTouchController=!1))},Touch.prototype.Pause=function(){this.disableTouchController=!0},Touch.prototype.Continue=function(){PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame?1==PlayerManager.instance.userData.jokerTutorial&&(this.disableTouchController=!1):1==PlayerManager.instance.userData.shakeTutorial&&(this.disableTouchController=!1)},Touch.prototype.distanceBetween=function(e,t){var a=e.getPosition(),n=t.getPosition(),i=n.x-a.x,o=n.y-a.y,s=n.z-a.z;return Math.sqrt(i*i+o*o+s*s)},Touch.prototype.startCounter=function(){this.time_passed=0,this.stopInterval=setInterval(function(){Touch.instance.time_passed+=1},300)},Touch.prototype.stopCounter=function(){clearInterval(this.stopInterval)},Touch.prototype.OnDestroy=function(){this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onTouchMove,this),this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onSelect,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onTouchEnd,this),this.app.touch&&(this.app.touch.off(pc.EVENT_TOUCHSTART,this.onSelect,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.entity.off("destroy",this.OnDestroy,this)};var GameManager=pc.createScript("gameManager");GameManager.prototype.initialize=function(){GameManager.instance=this,this.log=new Log("GAME_MANAGER"),this.isGamePaused=!1,this.isOfferPlay=!1,this.isGameFinish=!1,this.placeData=new PlaceData,this.eventData=new EventData,this.blurPauseStatus=!1,this.startTime="",this.finishTime="",this.playinglevelName="",this.app.on("uiManager:lose",this.gamelose,this),this.app.on("uiManager:win",this.gamewin,this),this.app.on("game:Ready",this.checkLoadAssets,this);let e=this.app.root.findByName("2DScreen");pc.platform.mobile?e.screen.scaleBlend=0:e.screen.scaleBlend=1},GameManager.prototype.GameStart=function(e){if(completeMatchStatus=!1,matchObjectCounter=0,this.startTime=new Date,this.isGamePaused=!1,GameUi.instance.showHideJokerButton(!1),1==PlayerManager.instance.userData.newPlayer?GameUi.instance.showHideHomeButton(!1):GameUi.instance.showHideHomeButton(!0),EventsManager.instance.changeEventsWallActive(!1),1==PlayerManager.instance.userData.newPlayer&&PlayerManager.instance.userData.userScore>0&&(PlayerManager.instance.userData.newPlayer=!1),PlayerManager.instance.userData.gameMode==gamePlayMode.Normal){if(this.app.fire("gameManager:gamePlayMode",gamePlayMode.Normal),1==PlayerManager.instance.userData.interruption){let e=PlayerManager.instance.levelData.time;matchObjectCounter=PlayerManager.instance.userData.savedMatchedObjectCount,roomObjectList=[],roomObjectList=PlayerManager.instance.userData.roomAssets,this.loadInterruptionData(),window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:PlayerManager.instance.levelData.levelName});let t=e-PlayerManager.instance.levelData.time;this.startTime=new Date(this.startTime-1e3*t),CoverManager.instance.updateMatchStatus(PlayerManager.instance.levelData.minObjectCount,matchObjectCounter,!0),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","ContinueSingleGame",PlayerManager.instance.levelData.levelName,detectCurrentLevel()[0])}else PlayerManager.instance.userData.score=0,0==playExtraTime?this.initializeTimer(0,!0):(GameUi.instance.showHideShakeButton(!0),this.initializeTimer(30,!0),playExtraTime=!1),"Donut Shop"==PlayerManager.instance.levelData.levelName?(CoverManager.instance.updateMatchStatus(PlayerManager.instance.levelData.minObjectCount,0,!1),Tutorial.instance.moveObjectTutorialOnOff(!0)):CoverManager.instance.updateMatchStatus(PlayerManager.instance.levelData.minObjectCount,matchObjectCounter,!0),this.playinglevelName=PlayerManager.instance.levelData.levelName,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","SingleGame",PlayerManager.instance.levelData.levelName,detectCurrentLevel()[0]),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:this.playinglevelName});SpawnManager.instance.spawninitalize()}else PlayerManager.instance.userData.gameMode==gamePlayMode.Places&&(this.app.fire("gameManager:gamePlayMode",gamePlayMode.Places),PlayerManager.instance.userData.score=0,CoverManager.instance.updateMatchStatus(this.placeData.minObjectCount,matchObjectCounter,!0),this.initializeTimer(0,!0),SpawnManager.instance.spawninitalize(this.placeData.objectCount),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","Places",GameManager.instance.placeData.levelName,detectCurrentLevel()[0]),this.playinglevelName=GameManager.instance.placeData.levelName,window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:this.playinglevelName}));this.app.fire("gameManager:updatestatus",gamestatus.Play)},GameManager.prototype.GameWin=function(){this.finishTime=new Date,this.sendScore(),this.app.fire("gameManager:updatestatus",gamestatus.Win),gamePlayStatus=gamestatus.Win,GameUi.instance.showHideHomeButton(!1),Timer.instance.StopTimer(),roomObjectList=[]},GameManager.prototype.sendScore=function(){ScoreManager.instance.extraPoints();let e=0;var t={PlayTime:GameManager.instance.gamePlayDuration()};if(PlayerManager.instance.userData.gameMode==gamePlayMode.Normal){let a;1==PlayerManager.instance.userData.newPlayer?(e=PlayerManager.instance.userData.score,this.UpdateLevel(e,!0),isTutorialStageComplete=!0):(1==completeMatchStatus?(a=ScoreManager.instance.extraPoints(),e=PlayerManager.instance.userData.score+parseInt(a)):e=PlayerManager.instance.userData.score,this.UpdateLevel(e,!1)),GameAnalyticsSdk.instance.gaStatus&&(GameAnalytics("addProgressionEvent","Complete","SingleGame",PlayerManager.instance.levelData.levelName,detectCurrentLevel()[0],parseInt(e),t),GameAnalytics("addDesignEvent","GamePlayTime:SingleGame:"+GameManaPlayerManagerger.instance.levelData.levelName,parseFloat(GameManager.instance.gamePlayDuration()))),clearCacheFunction()}else if(PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(e=PlayerManager.instance.userData.score,PlayerManager.instance.userData.userScore=parseInt(PlayerManager.instance.userData.userScore)+parseInt(e),PlayerManager.instance.SavePlayerData(),GameAnalyticsSdk.instance.gaStatus))if(GameAnalytics("addProgressionEvent","Complete","MiniGame",playingMiniGameName,detectCurrentLevel()[0],parseInt(e),t),"Math Game"==playingMiniGameName)GameAnalytics("addDesignEvent","GamePlayTime:MiniGame:"+playingMiniGameName,parseFloat(GameManager.instance.gamePlayDuration()));else{let e="Attention Game"==playingMiniGameName?GameManager.instance.eventData.matchKey.toString().replaceAll(",","-"):GameManager.instance.eventData.matchKey;GameAnalytics("addDesignEvent","GamePlayTime:MiniGame:"+playingMiniGameName+":"+e,parseFloat(GameManager.instance.gamePlayDuration()))}},GameManager.prototype.UpdateLevel=async function(e){PlayerManager.instance.userData.placeMode||PlayerManager.instance.userData.gameMode!=gamePlayMode.Normal||(currentLevelName=PlayerManager.instance.levelData.levelTemplate,PlayerManager.instance.userData.userScore+=e,PlayerManager.instance.userData.level<13?PlayerManager.instance.userData.level++:(this.isGameFinish=!0,PlayerManager.instance.userData.level=1),this.clearInterruptionData(),PlayerManager.instance.userData.newPlayer?(PlayerManager.instance.userData.newPlayer=!1,PlayerManager.instance.GetUserLevel("updateLevel")):PlayerManager.instance.GetUserLevel("updateLevel"),PlayerManager.instance.SavePlayerData())},GameManager.prototype.GameLose=function(){if(this.finishTime=new Date,this.app.fire("gameManager:updatestatus",gamestatus.Lose),gamePlayStatus=gamestatus.Lose,GameUi.instance.showHideHomeButton(!1),Timer.instance.StopTimer(),this.clearInterruptionData(),GameAnalyticsSdk.instance.gaStatus){var e={PlayTime:GameManager.instance.gamePlayDuration()};if(PlayerManager.instance.userData.gameMode==gamePlayMode.Normal)GameAnalytics("addProgressionEvent","Fail","SingleGame",PlayerManager.instance.levelData.levelName,detectCurrentLevel()[0],parseInt(PlayerManager.instance.userData.score),e);else if(PlayerManager.instance.userData.gameMode==gamePlayMode.Places)GameAnalytics("addProgressionEvent","Fail","Places",GameManager.instance.placeData.levelName,detectCurrentLevel()[0],parseInt(PlayerManager.instance.userData.score),e);else if(PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame)if(GameAnalytics("addProgressionEvent","Fail","MiniGame",playingMiniGameName,detectCurrentLevel()[0],0,e),"Math Game"==playingMiniGameName)GameAnalytics("addDesignEvent","GamePlayTime:MiniGame:"+playingMiniGameName,parseFloat(GameManager.instance.gamePlayDuration()));else{let e="Attention Game"==playingMiniGameName?GameManager.instance.eventData.matchKey.toString().replaceAll(",","-"):GameManager.instance.eventData.matchKey;GameAnalytics("addDesignEvent","GamePlayTime:MiniGame:"+playingMiniGameName+":"+e,parseFloat(GameManager.instance.gamePlayDuration()))}}clearCacheFunction()},GameManager.prototype.startMiniGame=function(){if(this.startTime=new Date,this.app.fire("gameManager:gamePlayMode",gamePlayMode.MiniGame),EventsManager.instance.changeEventsWallActive(!0),CoverManager.instance.updateMatchStatus(0,0,!1),PlayerManager.instance.userData.score=0,timeBarTotalTime=this.eventData.time,matchObjectCounter=0,1==this.eventData.eventId){let e=EventsManager.instance.initMathChallange();this.eventData.matchKey=e[0],this.eventData.mathChallengeOperationKey=e[1],PlayerManager.instance.userData.score="50",playingMiniGameName="Math Game",this.playinglevelName="MathGame",SpawnManager.instance.spawninitalize(this.eventData.assetTag,this.eventData.objectCount),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","MiniGame","MathGame"),window.famobi&&window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:"MathGame"})}else if(2==this.eventData.eventId)PlayerManager.instance.userData.score="150",playingMiniGameName="Word Game",this.playinglevelName="WordGame",this.eventData.matchKey=EventsManager.instance.initWordChallenge(),SpawnManager.instance.spawninitalize(this.eventData.assetTag,this.eventData.objectCount),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","MiniGame","WordGame",String(this.eventData.matchKey)),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:"WordGame"});else if(4==this.eventData.eventId){PlayerManager.instance.userData.score="100",EventsManager.instance.initAttentionChallenge(),playingMiniGameName="Attention Game",this.playinglevelName="AttentionGame";const e=this.eventData.matchKey.toString().replaceAll(",","-");SpawnManager.instance.eventAttentionSpawn(this.eventData.matchKey,this.eventData.assetTag,this.eventData.objectCount),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","MiniGame","AttentionGame",e),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:"AttentionGame"})}else if(6==this.eventData.eventId){PlayerManager.instance.userData.score="250",playingMiniGameName="Link Game",this.playinglevelName="LinkGame",EventsManager.instance.initThemeChallenge();let e=SpawnManager.instance.eventMultipleAssetInitialize(this.eventData.matchKey,this.eventData.spawnedArrayList,this.eventData.objectCount);CoverManager.instance.updateMatchStatus(e,0,!0),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addProgressionEvent","Start","MiniGame","LinkGame",String(this.eventData.matchKey)),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:"LinkGame"})}this.initializeTimer(0,!0)},GameManager.prototype.PauseGame=function(){window.famobi&&window.famobi_analytics.trackEvent("EVENT_PAUSE"),this.isGamePaused=!0,Touch.instance.Pause(),Timer.instance.PauseTimer(),TimeBar.instance.resetBar(),this.app.fire("gameManager:updatestatus",gamestatus.Pause)},GameManager.prototype.ResumeGame=function(){window.famobi&&window.famobi_analytics.trackEvent("EVENT_RESUME"),GameManager.instance.blurPauseStatus=!1,this.isGamePaused=!1,Touch.instance.Continue(),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),this.app.fire("gameManager:updatestatus",gamestatus.Play)},GameManager.prototype.ExtraTime=function(e){Timer.instance.StopTimer(),TimeBar.instance.resetBar(),
GameUi.instance.showHideHomeButton(!0),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&GameUi.instance.showHideJokerButton(!0),e?this.initializeTimer(30,!1,!0):this.initializeTimer(30,!1),this.ResumeGame()},GameManager.prototype.OfferPlay=function(e){this.app.fire("gameManager:updatestatus",gamestatus.OfferPlay),e&&(PlayerManager.instance.userData.gameMode!=gamePlayMode.MiniGame&&CoverManager.instance.updateMatchStatus(PlayerManager.instance.levelData.minObjectCount,matchObjectCounter,!0),WinAndLoseUi.instance.showTopBar(),checkOffer=!1),this.ExtraTime(!0)},GameManager.prototype.gamePlayDuration=function(){let e=(this.finishTime.getTime()-this.startTime.getTime())/1e3;return Math.abs(e)},GameManager.prototype.LoadEventData=function(e,t){var a=GameData.instance.getMiniGameData(e);this.eventData.eventId=a.miniGameIndex,this.eventData.eventName=a.miniGameName,this.eventData.objectCount=a.objectCount,this.eventData.time=a.time,this.eventData.assetName=a.assetName,this.eventData.assetTag=a.assetTag,this.eventData.matchKey=a.matchKey,this.eventData.mathChallengeOperationKey="",prepareMiniGameData(e,t)},GameManager.prototype.LoadPlaceData=function(e,t){PlayerManager.instance.userData.gameMode=gamePlayMode.Places;let a=GameData.instance.getLevelData(e);this.placeData.levelID=a.levelID,this.placeData.levelName=a.levelName,this.placeData.levelItem=a.levelItem,this.placeData.objectCount=a.objectCount,this.placeData.time=a.time,this.placeData.levelTemplate=a.levelTemplate,this.placeData.levelRoom=a.levelRoom,this.placeData.minObjectCount=a.objectCount,placesButtonIsClicked=!1,t(!0)},GameManager.prototype.loadInterruptionData=function(){window.famobi?PlayerManager.instance.levelData=JSON.parse(window.famobi.localStorage.getItem("backupLevelData")):PlayerManager.instance.levelData=JSON.parse(localStorage.getItem("backupLevelData")),0==playExtraTime?(Timer.instance.timeFormat(PlayerManager.instance.levelData.time),Timer.instance.StartTimer(PlayerManager.instance.levelData.time),timeBarTotalTime=PlayerManager.instance.levelData.time,_remainTime=PlayerManager.instance.levelData.time):(Timer.instance.timeFormat(PlayerManager.instance.levelData.time+30),Timer.instance.StartTimer(PlayerManager.instance.levelData.time+30),timeBarTotalTime=PlayerManager.instance.levelData.time+30,_remainTime=PlayerManager.instance.levelData.time+30,playExtraTime=!1)},GameManager.prototype.clearInterruptionData=function(){PlayerManager.instance.userData.interruption=0,PlayerManager.instance.userData.roomAssets=[],PlayerManager.instance.userData.lastTimeProgressBar=null,PlayerManager.instance.userData.savedMatchedObjectCount=null},GameManager.prototype.CheckNewLevel=function(e){PlayerManager.instance.userData.level<=13&&"LivingRoom"!=currentLevelName&&"HobbyRoom"!=PlayerManager.instance.levelData.levelTemplate?PlayerManager.instance.levelData.levelTemplate==currentLevelName||completeMatchStatus?levelUpStatus=!1:(levelUpStatus=!0,LevelUpbanner.instance.showUI(e),currentLevelName=PlayerManager.instance.levelData.levelRoom):levelUpStatus=!1},GameManager.prototype.initializeTimer=function(e,t,a){PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?a?(Timer.instance.timeFormat(e),Timer.instance.StartTimer(e),_remainTime=e,timeBarTotalTime=e):(Timer.instance.timeFormat(PlayerManager.instance.levelData.time+e),Timer.instance.StartTimer(PlayerManager.instance.levelData.time+e),_remainTime=PlayerManager.instance.levelData.time+e,timeBarTotalTime=PlayerManager.instance.levelData.time+e):PlayerManager.instance.userData.gameMode==gamePlayMode.Places?(Timer.instance.timeFormat(this.placeData.time+e),Timer.instance.StartTimer(this.placeData.time+e),timeBarTotalTime=this.placeData.time+e):PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(a?(Timer.instance.timeFormat(e),Timer.instance.StartTimer(e),timeBarTotalTime=e):(Timer.instance.timeFormat(this.eventData.time+e),Timer.instance.StartTimer(this.eventData.time+e),timeBarTotalTime=this.eventData.time+e)),t&&this.app.fire("startTimerEffect")},GameManager.prototype.getLevelName=function(){let e="";return PlayerManager.instance.userData.gameMode==gamePlayMode.Places?e=GameManager.instance.placeData.levelName:PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?e=PlayerManager.instance.levelData.levelName:PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(e=playingMiniGameName),e},GameManager.prototype.update=function(e){let t=this;window.onfocus=function(){"Game"==GameManager.instance.app.root.children[0].name&&!window.dirtyPause&&(GameManager.instance.blurPauseStatus||(t.timeScale=1,window.famobi&&window.famobi_analytics.trackEvent("EVENT_RESUME"),GameManager.instance.isGamePaused=!1,Touch.instance.Continue(),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),GameManager.instance.app.fire("gameManager:updatestatus",gamestatus.Play)))},window.onblur=function(){"Game"==GameManager.instance.app.root.children[0].name&&(GameManager.instance.isGamePaused&&!window.dirtyPause?GameManager.instance.blurPauseStatus=!0:(t.timeScale=0,window.famobi&&window.famobi_analytics.trackEvent("EVENT_PAUSE"),GameManager.instance.isGamePaused=!0,Touch.instance.Pause(),Timer.instance.PauseTimer(),TimeBar.instance.blurPaused(),GameManager.instance.app.fire("gameManager:updatestatus",gamestatus.Pause)))}};var loadLevelData,PlaceManager=pc.createScript("placeManager");PlaceManager.attributes.add("closePlaceItems",{type:"entity",array:!0}),PlaceManager.attributes.add("openPlaceItems",{type:"entity",array:!0}),PlaceManager.attributes.add("placesUIPanel",{type:"entity"});var placesButtonIsClicked=!1;PlaceManager.prototype.initialize=function(){PlaceManager.instance=this,placesButtonIsClicked=!1,this.initButtons(),PlayerManager.instance.userData.gameMode===gamePlayMode.Places&&!0===showPlaceModUI&&(this.initPlace(),this.placesUIPanel.enabled=!0)},PlaceManager.prototype.initPlace=function(){if(1==PlayerManager.instance.userData.unlockLevel)for(let e=0;e<this.openPlaceItems.length;e++)this.closePlaceItems[e].enabled=!1,this.openPlaceItems[e].enabled=!0;else this.newDefineScenePanel()},PlaceManager.prototype.initButtons=function(){this.openPlaceItems[0].children[1].button.on("click",function(e){let t=PlayerManager.instance.userData.unlockLevel;placesButtonIsClicked||((1==t||loadLevelData>3)&&(loadLevelData=3),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","HobbyRoomButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(loadLevelData))},this),this.openPlaceItems[1].children[1].button.on("click",function(e){let t=PlayerManager.instance.userData.unlockLevel;placesButtonIsClicked||((1==t||loadLevelData>5)&&(loadLevelData=5),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","KidsRoomButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(loadLevelData))},this),this.openPlaceItems[2].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","SchoolButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(6))},this),this.openPlaceItems[3].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","FarmersMarketButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(7))},this),this.openPlaceItems[4].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","BedroomButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(8))},this),this.openPlaceItems[5].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","CellarButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(9))},this),this.openPlaceItems[6].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","KitchenButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(10))},this),this.openPlaceItems[7].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","FoodCourtButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(11))},this),this.openPlaceItems[8].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","GymButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(12))},this),this.openPlaceItems[9].children[1].button.on("click",function(e){placesButtonIsClicked||(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LivingRoomButton:Click",1),placesButtonIsClicked=!0,this.loadPlacesScene(13))},this)},PlaceManager.prototype.loadPlacesScene=function(e){loadScene("LoadingScene",{hierarchy:!0,settings:!0},()=>{GameManager.instance.LoadPlaceData(e,function(e){1==e&&PreloadManager.instance.loadGameAssets(GameManager.instance.placeData.levelItem,function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{GameManager.instance.GameStart()})})})})},PlaceManager.prototype.newDefineScenePanel=function(){var e=0;let t=!1;for(0==PlayerManager.instance.userData.newPlayer&&(e=0,customEventPlayStatus=!0),1==PlayerManager.instance.userData.level||2==PlayerManager.instance.userData.level||3==PlayerManager.instance.userData.level?(loadLevelData="Hobby Room1"===PlayerManager.instance.levelData.levelName?1:"Hobby Room2"===PlayerManager.instance.levelData.levelName?2:3,e=0):4==PlayerManager.instance.userData.level||5==PlayerManager.instance.userData.level?(loadLevelData="Kids Room1"===PlayerManager.instance.levelData.levelName?4:5,e=1):6==PlayerManager.instance.userData.level?(e=2,loadLevelData=6):7==PlayerManager.instance.userData.level?(e=3,loadLevelData=7):8==PlayerManager.instance.userData.level?(e=4,loadLevelData=8):9==PlayerManager.instance.userData.level?(e=5,loadLevelData=9):10==PlayerManager.instance.userData.level?(e=6,loadLevelData=10):11==PlayerManager.instance.userData.level?(e=7,loadLevelData=11):12==PlayerManager.instance.userData.level?(e=8,loadLevelData=12):13==PlayerManager.instance.userData.level&&(e=9,loadLevelData=13),t=PlayerManager.instance.userData.unlockLevel,i=0;i<10;i++)1==PlayerManager.instance.userData.newPlayer?(this.closePlaceItems[i].enabled=!0,this.openPlaceItems[i].enabled=!1):1==t||i<=e?(this.closePlaceItems[i].enabled=!1,this.openPlaceItems[i].enabled=!0,this.openPlaceItems[i].children[1].button.active=!0):(this.closePlaceItems[i].enabled=!0,this.openPlaceItems[i].enabled=!1)};var CoverManager=pc.createScript("coverManager");CoverManager.attributes.add("posOne",{type:"entity"}),CoverManager.attributes.add("posTwo",{type:"entity"}),CoverManager.attributes.add("eventNum1",{type:"entity"}),CoverManager.attributes.add("eventNum2",{type:"entity"}),CoverManager.attributes.add("mathStatusIndicator",{type:"entity"}),CoverManager.attributes.add("matchObjectStatusBar",{type:"entity"}),CoverManager.attributes.add("minObjectLabel",{type:"entity"}),CoverManager.attributes.add("matchedObjectLabel",{type:"entity"}),CoverManager.attributes.add("wrongMatchIcon",{type:"entity"}),CoverManager.attributes.add("mathBarUI",{type:"entity"}),CoverManager.attributes.add("attentionBarUI",{type:"entity"}),CoverManager.attributes.add("wordBarUI",{type:"entity"}),CoverManager.attributes.add("linkBarUI",{type:"entity"}),CoverManager.prototype.initialize=function(){CoverManager.instance=this,this.log=new Log("COVER_MANAGER"),this.objectOnTheCover=null,this.selectedObject1=null,this.selectedObject2=null,this.num1=null,this.num2=null,this.particleEntity=this.app.root.findByName("PARTICLE_Success_Match3D"),spawnPositions=this.app.root.findByTag("spawnposition"),this.animEntity=this.app.root.findByName("Cover"),this.app.on("covermanager:entity",this.Placement,this),this.app.on("gameManager:updatestatus",this.Status,this),this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.entity.on("destroy",this.OnDestroy,this)},CoverManager.prototype.updateMatchStatus=function(e,t,a){this.matchObjectStatusBar.enabled=a,matchObjectCounter=t,this.minimumObjectNumber=e,this.minObjectLabel.element.text=e,this.matchedObjectLabel.element.text=matchObjectCounter},CoverManager.prototype.ObjectStageTwo=function(e,t){this.app.fire("cover:stat",!0),this.particleEntity.particlesystem.play(),t.tween(t.getLocalPosition()).to({x:0,y:.5,z:4},.15,pc.Linear).on("complete",function(){t.destroy()}).start(),e.tween(e.getLocalPosition()).to({x:0,y:.5,z:4},.15,pc.Linear).on("complete",function(){CoverManager.instance.ObjectStageThree(e)}).start()},CoverManager.prototype.ObjectStageThree=function(e){e.tween(e.getLocalScale()).to(new pc.Vec3(.4,.4,.4),.15,pc.CubicInOut).on("complete",function(){CoverManager.instance.ObjectCheck(e)}).start(),this.particleEntity.particlesystem.reset()},CoverManager.prototype.Placement=function(e){var t;if(spawnPositions[0].findByTag("dropped").length<1)SoundManager.instance.playSound("PlaceObject"),this.objectOnTheCover=e,1==GameManager.instance.eventData.eventId&&PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.eventNum1.element.text=e.tags.list()[1]),t=new pc.Vec3(.408,0,4.144),e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(t,.2,pc.Linear).start(),e.rigidbody.enabled=!1,e.tags.add("dropped"),this.selectedObject1=e.clone();else if(this.selectedObject2=e.clone(),timer>0)if(this.checkMatchPlacement(this.selectedObject1,this.selectedObject2)){let a=spawnPositions[0].findByTag("dropped")[0];a.tags.remove("dropped"),SoundManager.instance.playSound("MergeObject"),e.tags.add("untouchable"),matchObjectCounter++,(PlayerManager.instance.userData.gameMode!=gamePlayMode.MiniGame||6==GameManager.instance.eventData.eventId)&&(this.matchedObjectLabel.element.text=matchObjectCounter,this.matchedObjectLabel.tween(this.matchedObjectLabel.getLocalScale()).to(new pc.Vec3(1.5,1.5,1),.5,pc.SineOut).yoyo(!0).repeat(2).start()),!0===PlayerManager.instance.userData.newPlayer&&"Donut Shop"==PlayerManager.instance.levelData.levelName&&(1==matchObjectCounter&&(Tutorial.instance.isCheckFactorTutorialStatus=!0),!1===isFactorTutorialCompleted&&Tutorial.instance.moveFactorTutorialOnOff(!0)),e.rigidbody.enabled=!1,PlayerManager.instance.userData.gameMode!=gamePlayMode.MiniGame&&this.app.fire("Score:add"),t=new pc.Vec3(-.272,0,4.144),e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.2,pc.Linear).on("complete",function(){CoverManager.instance.ObjectStageTwo(e,a)}).start(),e.tween(e.getLocalPosition()).to(t,.15,pc.Linear).start()}else SoundManager.instance.playSound("WrongObject"),e.rigidbody.teleport(e.parent.getPosition().x,e.parent.getPosition().y,e.parent.getPosition().z),e.rigidbody.enabled=!0;else e.rigidbody.teleport(e.parent.getPosition().x,e.parent.getPosition().y,e.parent.getPosition().z),e.rigidbody.enabled=!0},CoverManager.prototype.checkMatchPlacement=function(e,t){let a=this.wrongMatchIcon;var n;if(PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame)if(1==GameManager.instance.eventData.eventId){let o=this.eventNum1.element,s=this.eventNum2.element;var i;this.num1=e.tags.list()[1],this.num2=t.tags.list()[1],"addition"==GameManager.instance.eventData.mathChallengeOperationKey?i=parseInt(this.num1)+parseInt(this.num2):"subtraction"==GameManager.instance.eventData.mathChallengeOperationKey?i=parseInt(this.num1)-parseInt(this.num2):"multiplication"==GameManager.instance.eventData.mathChallengeOperationKey?i=parseInt(this.num1)*parseInt(this.num2):"division"==GameManager.instance.eventData.mathChallengeOperationKey&&(i=parseInt(this.num1)/parseInt(this.num2)),i===GameManager.instance.eventData.matchKey?(this.eventNum2.element.text=this.num2,this.mathStatusIndicator.tween(this.mathStatusIndicator.getLocalScale()).to(new pc.Vec3(1.5,1.5,1.5),.5,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){o.text="_",s.text="_"}).start(),n=!0):(this.eventNum1.element.text="_",this.eventNum2.element.text="_",this.wrongMatchIcon.enabled=!0,this.wrongMatchIcon.tween(this.wrongMatchIcon.getLocalScale()).to(new pc.Vec3(1,1,1),.7,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){a.enabled=!1}).start(),spawnPositions[0].findByTag("dropped")[0].rigidbody.teleport(spawnPositions[0].findByTag("dropped")[0].parent.getPosition().x,spawnPositions[0].findByTag("dropped")[0].parent.getPosition().y,spawnPositions[0].findByTag("dropped")[0].parent.getPosition().z),spawnPositions[0].findByTag("dropped")[0].rigidbody.enabled=!0,spawnPositions[0].findByTag("dropped")[0].tags.remove("dropped"),n=!1)}else 2==GameManager.instance.eventData.eventId?selectedWordKeys.includes(t.tags.list()[1])&&e.name===t.name?(EventsManager.instance.wordChallengeShowMatchLetters(t.tags.list()[1]),n=!0):(this.wrongMatchIcon.enabled=!0,this.wrongMatchIcon.tween(this.wrongMatchIcon.getLocalScale()).to(new pc.Vec3(1,1,1),.7,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){a.enabled=!1}).start(),spawnPositions[0].findByTag("dropped")[0].rigidbody.teleport(spawnPositions[0].findByTag("dropped")[0].parent.getPosition().x,spawnPositions[0].findByTag("dropped")[0].parent.getPosition().y,spawnPositions[0].findByTag("dropped")[0].parent.getPosition().z),spawnPositions[0].findByTag("dropped")[0].rigidbody.enabled=!0,spawnPositions[0].findByTag("dropped")[0].tags.remove("dropped"),n=!1):3!=GameManager.instance.eventData.eventId&&4!=GameManager.instance.eventData.eventId&&6!=GameManager.instance.eventData.eventId||(e.name===t.name&&this.checkExistObject(t.name)?(4==GameManager.instance.eventData.eventId&&(findByAttentionObjects.shift(),findByAttentionObjects.length>0&&EventsManager.instance.attentionObjectUpdateStatus()),n=!0):(this.wrongMatchIcon.enabled=!0,this.wrongMatchIcon.tween(this.wrongMatchIcon.getLocalScale()).to(new pc.Vec3(1,1,1),.7,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){a.enabled=!1}).start(),spawnPositions[0].findByTag("dropped")[0].rigidbody.teleport(spawnPositions[0].findByTag("dropped")[0].parent.getPosition().x,spawnPositions[0].findByTag("dropped")[0].parent.getPosition().y,spawnPositions[0].findByTag("dropped")[0].parent.getPosition().z),spawnPositions[0].findByTag("dropped")[0].rigidbody.enabled=!0,spawnPositions[0].findByTag("dropped")[0].tags.remove("dropped"),n=!1));else if(e.name===t.name){const e=roomObjectList.indexOf(t.name);e>-1&&roomObjectList.splice(e,1),!0===PlayerManager.instance.userData.newPlayer&&"Donut Shop"==PlayerManager.instance.levelData.levelName&&!1===isFactorTutorialCompleted&&Tutorial.instance.moveFactorTutorialOnOff(!0),n=!0}else n=!1;return n},CoverManager.prototype.onCollisionStart=function(e){this.Placement(e.other)},CoverManager.prototype.ObjectCounter=function(){var e=!1;if(PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame){if(1==GameManager.instance.eventData.eventId){for(j=0;j<spawnPositions[0].children.length;j++)if(this.checkExistObject(parseInt(spawnPositions[0].children[j].tags.list()[1]))){e=!0;break}0==e&&(this.app.root.findByTag("mathPanel")[0].enabled=!1)}else 2==GameManager.instance.eventData.eventId?cloneSelectedWordKeys.length>0?e=!0:(this.app.root.findByTag("wordPanel")[0].enabled=!1,e=!1):4==GameManager.instance.eventData.eventId?0==findByAttentionObjects.length?(this.app.root.findByTag("attentionPanel")[0].enabled=!1,e=!1):e=!0:6==GameManager.instance.eventData.eventId&&(0==matchThemeAssetList.length?(this.app.root.findByTag("linkPanel")[0].enabled=!1,e=!1):e=!0);e||(SpawnManager.instance.clearObjects(),Timer.instance.StopTimer(),GameManager.instance.GameWin())}else 0===spawnPositions[0].children.length&&(SpawnManager.instance.clearObjects(),Timer.instance.StopTimer(),"DonutShop"==PlayerManager.instance.levelData.levelTemplate||(completeMatchStatus=!0),GameManager.instance.GameWin())},CoverManager.prototype.checkExistObject=function(e,t){var a,n=!1;if(1==GameManager.instance.eventData.eventId)for(i=0;i<spawnPositions[0].children.length;i++){if(e==(a=parseInt(spawnPositions[0].children[i].tags.list()[1]))){n=!1;break}if("addition"==GameManager.instance.eventData.mathChallengeOperationKey){if(e+a===GameManager.instance.eventData.matchKey){n=!0;break}}else if("subtraction"==GameManager.instance.eventData.mathChallengeOperationKey){if(Math.abs(e-a)==GameManager.instance.eventData.matchKey){n=!0;break}}else if("multiplication"==GameManager.instance.eventData.mathChallengeOperationKey){if(e*a==GameManager.instance.eventData.matchKey){n=!0;break}}else if("division"==GameManager.instance.eventData.mathChallengeOperationKey&&(e/a==GameManager.instance.eventData.matchKey||a/e==GameManager.instance.eventData.matchKey)){n=!0;break}}else if(4==GameManager.instance.eventData.eventId)this.app.assets.findByTag(findByAttentionObjects[0])[0].id==e&&(n=!0);else if(6==GameManager.instance.eventData.eventId)for(i=matchThemeAssetList.length-1;i>=0;i--)matchThemeAssetList[i].id==e&&(matchThemeAssetList.splice(i,1),n=!0);return n},CoverManager.prototype.OnDestroy=function(){this.app.off("covermanager:entity",this.Placement,this),this.app.off("gameManager:updatestatus",this.Status,this),this.entity.off("destroy",this.OnDestroy,this)},CoverManager.prototype.ObjectCheck=function(e){this.app.fire("cover:stat",!1),e.destroy(),this.ObjectCounter()},CoverManager.prototype.GetRotate=function(e){return e.tags.has("return")?new pc.Vec3(-90,0,0):new pc.Vec3(0,0,0)};var SpawnManager=pc.createScript("spawnManager");SpawnManager.attributes.add("SpawnPosition",{type:"entity"});var roomObjectList=[];SpawnManager.prototype.initialize=function(){this.log=new Log("SPAWN_MANAGER"),SpawnManager.instance=this,this.app.on("spawnManager:Start",this.spawninitalize,this),this.entity.on("destroy",this.OnDestroy,this)},SpawnManager.prototype.spawninitalize=function(e,t){let a="";PlayerManager.instance.userData.gameMode==gamePlayMode.Places?(this.assetsList=this.app.assets.findByTag(GameManager.instance.placeData.levelTemplate),a=GameManager.instance.placeData.levelTemplate,this.prepareSpawnObjectList(this.assetsList,!0,a,!1)):PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?(this.assetsList=this.app.assets.findByTag(PlayerManager.instance.levelData.levelTemplate),a=PlayerManager.instance.levelData.levelTemplate,1==PlayerManager.instance.userData.interruption?roomObjectList.forEach(e=>{var t=this.app.assets.get(e).resource.instantiate();t.name=e,t.setPosition(this.SpawnPosition.getPosition().x,this.SpawnPosition.getPosition().y,this.SpawnPosition.getPosition().z);var a=t.clone();this.SpawnPosition.addChild(t),this.SpawnPosition.addChild(a)}):this.prepareSpawnObjectList(this.assetsList,!0,a,!1)):PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.assetsList=this.app.assets.findByTag(e),a=e,"Number"==e?this.prepareSpawnObjectList(this.assetsList,!1,a,!0):this.prepareSpawnObjectList(this.assetsList,!1,a,!1))},SpawnManager.prototype.prepareSpawnObjectList=function(e,t,a,n){let o="School"==a||"Number"==a;if("DonutShop"==a&&(t=!1),t)for(i=0;i<spawnAssetRandomIndexes.length;i++){var s=spawnAssetRandomIndexes[i];this.Spawn(e[s],n,o)}else for(i=0;i<e.length;i++)this.Spawn(e[i],n,o)},SpawnManager.prototype.eventAttentionSpawn=function(e,t,a){var n=0,o=0;for(i=0;i<e.length;i++)priorityAssetList=this.app.assets.findByTag(e[i])[0],this.Spawn(priorityAssetList,!1,!1);var s=this.app.assets.findByTag(t);let r=a-e.length,c=s.length-e.length,l=0;for(l=r<=c?r:c,o=0;n<l&&o<s.length;)0==SpawnManager.instance.checkEntityHasTag(s[o],e)&&(this.Spawn(s[o],!1,!1),n++),o++},SpawnManager.prototype.checkEntityHasTag=function(e,t){let a=!1;for(i=0;i<t.length;i++)if(e.tags.has(t[i])){a=!0;break}return a},SpawnManager.prototype.eventMultipleAssetInitialize=function(e,t,a){var n=0;priorityAssetList=this.app.assets.findByTag(e);let o=priorityAssetList.length>14?14:priorityAssetList.length;var s=[];for(matchThemeAssetList=[];s.length<o;){var r=Math.floor(Math.random()*priorityAssetList.length);-1===s.indexOf(r)&&s.push(r)}for(i=0;i<s.length;i++)matchThemeAssetList.push(priorityAssetList[s[i]]),this.Spawn(priorityAssetList[s[i]],!1,!1);let c=this.app.assets.findByTag(t[0]),l=a-o,m=c.length-o,h=0;for(h=l<=m?l:m,counter=0;n<h&&counter<c.length;)0==c[counter].tags.has(e)&&(this.Spawn(c[counter],!1,!1),n++),counter++;return o},SpawnManager.prototype.Spawn=function(e,t,a){var n=e.resource.instantiate();n.name=e.id,PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&n.tags.add(e.tags.list()[2]),roomObjectList.push(n.name),n.setPosition(this.SpawnPosition.getPosition().x,this.SpawnPosition.getPosition().y,this.SpawnPosition.getPosition().z);var i=function(e,t){t?e.rigidbody.applyImpulse(0,17,0):e.rigidbody.applyImpulse(0,6.5,0)};if(this.SpawnPosition.addChild(n),i(n,a),!t){var o=n.clone();this.SpawnPosition.addChild(o),i(o,a)}},SpawnManager.prototype.OnDestroy=function(){this.app.off("spawnManager:Start",this.resetBar,this),this.entity.off("destroy",this.OnDestroy,this)},SpawnManager.prototype.clearObjects=function(){for(i=this.SpawnPosition.children.length-1;i>=0;i--)this.SpawnPosition.children[i].destroy()};var Timer=pc.createScript("timer");Timer.attributes.add("Timetext",{type:"entity"}),Timer.prototype.initialize=function(){Timer.instance=this,this.timerContinue=!1,this.percent=0,this.entity.on("destroy",this.OnDestroy,this)},Timer.prototype.StartTimer=function(e){this.percent=5,timer=e,this.stopInterval=setInterval(this.TimeCounter,1e3),this.intervalId=this.stopInterval,this.timerContinue=!0,this.app.fire("timeBar:start",e)},Timer.prototype.StopTimer=function(){this.timerContinue=!1,clearInterval(this.intervalId),TimeBar.instance.pauseBar()},Timer.prototype.PauseTimer=function(){this.timerContinue=!1},Timer.prototype.ContinueTimer=function(){this.timerContinue=!0},Timer.prototype.timeFormat=function(e){Timer.instance.Timetext.setLocalScale(1,1,1),this.timerContinue=!1,minutes=parseInt(e/60,10),seconds=parseInt(e%60,10),minutes=minutes<10?"0"+minutes:minutes,seconds=seconds<10?"0"+seconds:seconds,Timer.instance.Timetext.element.text=minutes+":"+seconds},Timer.prototype.TimeCounter=function(){if(Timer.instance.timerContinue)if(timer<=0)if(SoundManager.instance.stopSound("TimeRunning"),PlayerManager.instance.userData.gameMode==gamePlayMode.Normal||PlayerManager.instance.userData.gameMode==gamePlayMode.Places){let e=PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?PlayerManager.instance.levelData.minObjectCount:GameManager.instance.placeData.minObjectCount;matchObjectCounter>=e&&0==matchThemAllButtonClick&&spawnPositions[0].children.length>0?MatchThemAllAnimation.instance.startAnimation():Timer.instance.levelEnding()}else Timer.instance.levelEnding();else timer<=Timer.instance.percent&&(GameUi.instance.showHideHomeButton(!1),SoundManager.instance.playSound("TimeRunning"),Timer.instance.Timetext.tween(Timer.instance.Timetext.getLocalScale()).to(new pc.Vec3(1,1,1),.5,pc.SineOut).on("complete",function(){Timer.instance.percentAnim()},this).start()),timer--,minutes=parseInt(timer/60,10),seconds=parseInt(timer%60,10),minutes=minutes<10?"0"+minutes:minutes,seconds=seconds<10?"0"+seconds:seconds,Timer.instance.Timetext.element.text=minutes+":"+seconds,_remainTime=timer},Timer.prototype.levelEnding=function(){if(PlayerManager.instance.userData.gameMode==gamePlayMode.Normal||PlayerManager.instance.userData.gameMode==gamePlayMode.Places){let e=PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?PlayerManager.instance.levelData.minObjectCount:GameManager.instance.placeData.minObjectCount;matchObjectCounter>=e?(Timer.instance.StopTimer(),GameManager.instance.GameWin()):(Timer.instance.StopTimer(),GameManager.instance.GameLose())}else Timer.instance.StopTimer(),GameManager.instance.GameLose()},Timer.prototype.extraTime=function(){this.StopTimer(),Timer.instance.Timetext.setLocalScale(1,1,1);let e=this.percent;e=30,timeBarTotalTime=30,this.timeFormat(30),this.StartTimer(30),TimeBar.prototype.continueBar()},Timer.prototype.percentAnim=function(){0!==timer?Timer.instance.Timetext.tween(Timer.instance.Timetext.getLocalScale()).to(new pc.Vec3(0,0,0),.5,pc.SineOut).start():Timer.instance.Timetext.tween(Timer.instance.Timetext.getLocalScale()).to(new pc.Vec3(1,1,1),.5,pc.SineOut).start()},Timer.prototype.OnDestroy=function(){this.entity.off("destroy",this.OnDestroy,this)};var ScoreManager=pc.createScript("scoreManager");ScoreManager.attributes.add("Star",{type:"entity"}),ScoreManager.attributes.add("ScoreText",{type:"entity"}),ScoreManager.attributes.add("FactorText",{type:"entity"}),ScoreManager.attributes.add("FactorYellowMaterial",{type:"entity"});var earnExtraPointsScore=0;ScoreManager.prototype.initialize=function(){this.log=new Log("SCORE_MANAGER"),ScoreManager.instance=this,this.comboCounter=2,this.maxComboCounter=1,this.stickerCounter=0,this.factor=1,this.speed=.05,this.scoreVal=0,this.scoreManagerIsPaused=!1,this.animationStarting=!1,this.animationContinue=!0,this.cloneFactorYellow=this.FactorYellowMaterial.element,this.cloneFactorYellow.material=this.cloneFactorYellow.material.clone(),this.progressStatus=!1,this.progress=.12,this.FactorText.element.text="1x",this.app.on("gameManager:updatestatus",this.status,this),this.app.on("Score:add",this.ScoreCounter,this),this.entity.on("destroy",this.OnDestroy,this)},ScoreManager.prototype.setScore=function(e){this.scoreVal=e,this.ScoreText.element.text=this.scoreVal.toString()},ScoreManager.prototype.ScoreCounter=function(){for(i=0;i<this.factor;i++)this.StarSpawns(i);this.UpdateFactor()},ScoreManager.prototype.StarSpawns=function(e){let t=this.Star.clone(),a=this.Star,n=PlayerManager.instance.userData.score;PlayerManager.instance.userData.score++;let i=200;e<10?i=200:e<20?i=100:e>=20&&(i=50),setTimeout(function(){a.parent.addChild(t),t.enabled=!0,n++,ScoreManager.instance.ScoreText.element.text=n.toString(),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LIVESCORE",{liveScore:parseInt(n)})},i*e,this)},ScoreManager.prototype.UpdateFactor=function(){this.Star.script.starAnimation.SpeedUpdate(),this.factor>1?(this.comboCounter++,this.factor+1>=this.maxComboCounter&&(this.maxComboCounter=this.factor+1)):this.comboCounter=1,this.factor+=1,this.factorTextAnimation=this.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(1.742,2.948,1),.4,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimationDefault(1)}),1==this.animationStarting?(ScoreManager.instance.animationContinue=!1,setTimeout(function(){ScoreManager.instance.factorTextAnimation.start(),ScoreManager.instance.animationStarting=!0,ScoreManager.instance.animationContinue=!0},500,this)):(this.factorTextAnimation.start(),this.animationStarting=!0,this.animationContinue=!0),this.speed+=.015,this.FactorText.element.text=this.factor.toString()+"x",this.progress=.12,this.scoreManagerIsPaused||(this.progressStatus=!0),SoundManager.instance.playSound("StarFillUp")},ScoreManager.prototype.extraPoints=function(){earnExtraPointsScore=0;let e=PlayerManager.instance.userData.userScore;return e>=1e5?(earnExtraPointsScore=400,400):e>=5e4?(earnExtraPointsScore=350,350):e>=1e4?(earnExtraPointsScore=300,300):e>=5e3?(earnExtraPointsScore=250,250):e>=1e3?(earnExtraPointsScore=200,200):e>=500?(earnExtraPointsScore=150,150):e>=0?(earnExtraPointsScore=100,100):void 0},ScoreManager.prototype.status=function(e){2===e&&(ScoreManager.instance.ScoreText.element.text=PlayerManager.instance.userData.score.toString())},ScoreManager.prototype.setProgress=function(e){this.progress=pc.math.clamp(e,0,1),this.cloneFactorYellow.material.alphaTest=this.progress},ScoreManager.prototype.update=function(e){this.progressStatus&&(this.setProgress(this.progress+e*ScoreManager.instance.speed),this.progress>=.9&&(this.Star.script.starAnimation.SpeedReset(),this.progressStatus=!1,ScoreManager.instance.factor=1,
ScoreManager.instance.speed=.05,ScoreManager.instance.FactorText.element.text="1x"))},ScoreManager.prototype.resetFactory=function(){this.progressStatus=!1,this.cloneFactorYellow.material.alphaTest=1,this.Star.script.starAnimation.SpeedReset(),this.factor=1,this.speed=.05,this.FactorText.element.text="1x"},ScoreManager.prototype.OnDestroy=function(){this.factor=1,this.speed=.05,this.app.off("Score:add",this.ScoreCounter,this),this.app.off("gameManager:updatestatus",this.status,this),this.entity.off("destroy",this.OnDestroy,this)},ScoreManager.prototype.isPaused=function(){.12!=this.progress&&(this.progressStatus=!1),this.scoreManagerIsPaused=!0},ScoreManager.prototype.isContinue=function(){.12!=this.progress&&(this.progressStatus=!0),this.scoreManagerIsPaused=!1},ScoreManager.prototype.factorAnimationDefault=function(e){1==e?ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(.871,1.474,1),.4,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimation3x()}).start():3==e?ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(.871,1.474,1),.375,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimation2x()}).start():5==e?ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(.871,1.474,1),.35,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimation1x()}).start():7==e&&ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(.871,1.474,1),.325,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.animationStarting=!1}).start()},ScoreManager.prototype.factorAnimation3x=function(){1==ScoreManager.instance.animationContinue&&ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(1.52425,2.5795,1),.375,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimationDefault(3)}).start()},ScoreManager.prototype.factorAnimation2x=function(){1==ScoreManager.instance.animationContinue&&ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(1.3065,2.211,1),.35,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimationDefault(5)}).start()},ScoreManager.prototype.factorAnimation1x=function(){1==ScoreManager.instance.animationContinue&&ScoreManager.instance.FactorText.tween(ScoreManager.instance.FactorText.getLocalScale()).to(new pc.Vec3(1.08875,1.8425,1),.325,pc.QuadraticInOut).on("complete",function(){ScoreManager.instance.factorAnimationDefault(7)}).start()};var Cover=pc.createScript("cover");Cover.prototype.initialize=function(){Cover.instance=this,pc.platform.mobile?(this.cap1=this.app.root.findByName("Hatch_Right"),this.cap2=this.app.root.findByName("Hatch_Left")):(this.cap1=this.app.root.findByName("Hatch_Right_Narrow"),this.cap2=this.app.root.findByName("Hatch_Left_Narrow")),this.animEnt=this.entity.anim,this.app.on("cover:stat",this.coverpos,this),this.entity.on("destroy",this.OnDestroy,this)},Cover.prototype.coverpos=function(e){!0===e?(SoundManager.instance.playSound("CoverOpen"),this.cap1.tween(this.cap1.getLocalPosition()).to({x:1.4,y:.098,z:4.639},.15,pc.Linear).start(),this.cap2.tween(this.cap2.getLocalPosition()).to({x:-1.4,y:.098,z:4.639},.15,pc.Linear).start()):(SoundManager.instance.playSound("CoverClose"),this.cap1.tween(this.cap1.getLocalPosition()).to({x:.465,y:.098,z:4.639},.15,pc.Linear).start(),this.cap2.tween(this.cap2.getLocalPosition()).to({x:-.55,y:.098,z:4.639},.15,pc.Linear).start())},Cover.prototype.closeCover=function(){this.cap1.tween(this.cap1.getLocalPosition()).to({x:.465,y:.098,z:4.639},.15,pc.Linear).start(),this.cap2.tween(this.cap2.getLocalPosition()).to({x:-.55,y:.098,z:4.639},.15,pc.Linear).start()},Cover.prototype.OnDestroy=function(){this.app.off("cover:stat",this.coverpos,this),this.entity.off("destroy",this.OnDestroy,this)};var AutoResizeHeight=pc.createScript("autoResizeHeight");AutoResizeHeight.prototype.initialize=function(){AutoResizeHeight.instance=this,this.app.on("contentchanged",this._onContentChanged,this)},AutoResizeHeight.prototype._onContentChanged=function(){var e=this.entity.layoutgroup;if(e){for(var t=e.padding.y+e.padding.w,a=0,n=this.entity.children,i=0;i<n.length;++i){var o=n[i];o.layoutchild&&(a+=1,t+=o.element.height)}t+=Math.max(0,a-1)*e.spacing.y,this.entity.element.height=t}};var assetName,PreloadManager=pc.createScript("preloadManager"),firstScene=!0;PreloadManager.prototype.initialize=function(){PreloadManager.instance=this},PreloadManager.prototype.loadSingleItem=function(e,t){for(var a=0,n=function(){1===(a+=1)&&t(!0)},i=0;i<1;i++)e.resource?n():(e.ready(n),this.app.assets.load(e))},PreloadManager.prototype.unloadAsset=function(){var e=String(assetName).split(","),t=[];for(i=0;i<e.length;i++)for(t=this.app.assets.findByTag(e[i]),del=0;del<t.length;del++)t[del].unload()},PreloadManager.prototype.getLoadingTotalAssetCount=function(){let e=this.app.assets.findByTag("GameTexture"),t=this.app.assets.findByTag("preload");return e.length+t.length},PreloadManager.prototype.loadMiniGameAssets=function(e,t){var a=null,n=String(e).split(",");a=n.length>1?this.app.assets.findByTag(n[0],n[1],n[2]):this.app.assets.findByTag(e),null!=assetName&&PreloadManager.instance.unloadAsset(),assetName=e;for(var i=0,o=a.length,s=function(e){i+=1,LoadingManager.instance.setProgress(i/o),i===o&&t(!0)},r=0;r<a.length;r++)a[r].resource?s():(a[r].ready(s),this.app.assets.load(a[r]));a.length||t(!0)},PreloadManager.prototype.loadGameAssets=function(e,t){createSpawnAssetsRandomIndexArray();var a=this.app.assets.findByTag(e);null!=assetName&&PreloadManager.instance.unloadAsset(),assetName=e;for(var n=0,i=spawnAssetRandomIndexes.length,o=function(e){n+=1,LoadingManager.instance.setProgress(n/i),n===i&&t(!0)},s=0;s<spawnAssetRandomIndexes.length;s++)a[spawnAssetRandomIndexes[s]].resource?o():(a[spawnAssetRandomIndexes[s]].ready(o),this.app.assets.load(a[spawnAssetRandomIndexes[s]]));spawnAssetRandomIndexes.length||t(!0)},pc.extend(pc,function(){var e=function(e){this._app=e,this._tweens=[],this._add=[]};e.prototype={add:function(e){return this._add.push(e),e},update:function(e){for(var t=0,a=this._tweens.length;t<a;)this._tweens[t].update(e)?t++:(this._tweens.splice(t,1),a--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var t=function(e,t,a){pc.events.attach(this),this.manager=t,a&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=e,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},a=function(e){var t;return e instanceof pc.Vec2?t={x:e.x,y:e.y}:e instanceof pc.Vec3?t={x:e.x,y:e.y,z:e.z}:e instanceof pc.Vec4||e instanceof pc.Quat?t={x:e.x,y:e.y,z:e.z,w:e.w}:e instanceof pc.Color?(t={r:e.r,g:e.g,b:e.b},void 0!==e.a&&(t.a=e.a)):t=e,t};t.prototype={to:function(e,t,n,i,o,s){return this._properties=a(e),this.duration=t,n&&(this.easing=n),i&&this.delay(i),o&&this.repeat(o),s&&this.yoyo(s),this},from:function(e,t,n,i,o,s){return this._properties=a(e),this.duration=t,n&&(this.easing=n),i&&this.delay(i),o&&this.repeat(o),s&&this.yoyo(s),this._from=!0,this},rotate:function(e,t,n,i,o,s){return this._properties=a(e),this.duration=t,n&&(this.easing=n),i&&this.delay(i),o&&this.repeat(o),s&&this.yoyo(s),this._slerp=!0,this},start:function(){var e,t,a,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(e in this._properties)this._properties.hasOwnProperty(e)&&(this._sv[e]=this._properties[e],this._ev[e]=this.target[e]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),t=void 0!==this._properties.x?this._properties.x:this.target.x,a=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(t,a,n))}else{for(e in this._properties)this._properties.hasOwnProperty(e)&&(this._sv[e]=this.target[e],this._ev[e]=this._properties[e]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),t=void 0!==this._properties.x?this._properties.x:this.target.x,a=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(t,a,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(e){return this._delay=e,this.pending=!0,this},repeat:function(e,t){return this._count=0,this._numRepeats=e,this._repeatDelay=t||0,this},loop:function(e){return e?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(e){return this._yoyo=e,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var e=arguments.length;e--;)e>0?arguments[e-1]._chained=arguments[e]:this._chained=arguments[e];return this},update:function(e){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=e*this.timeScale:this.time-=e*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}var t=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(t=this.duration-this.time,this.time=0):(t=this.time-this.duration,this.time=this.duration));var a,n,i=0===this.duration?1:this.time/this.duration,o=this.easing(i);for(var s in this._properties)this._properties.hasOwnProperty(s)&&(a=this._sv[s],n=this._ev[s],this.target[s]=a+(n-a)*o);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,o),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",e),this.complete){var r=this._repeat(t);return r?this.fire("loop"):(this.fire("complete",t),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),r}return!0},_repeat:function(e){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-e:this.time=e,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var t in this._properties){var a=this._sv[t];this._sv[t]=this._ev[t],this._ev[t]=a}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var n=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},i=function(e){return 1-n(1-e)};return{TweenManager:e,Tween:t,Linear:function(e){return e},QuadraticIn:function(e){return e*e},QuadraticOut:function(e){return e*(2-e)},QuadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},CubicIn:function(e){return e*e*e},CubicOut:function(e){return--e*e*e+1},CubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},QuarticIn:function(e){return e*e*e*e},QuarticOut:function(e){return 1- --e*e*e*e},QuarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},QuinticIn:function(e){return e*e*e*e*e},QuinticOut:function(e){return--e*e*e*e*e+1},QuinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},SineIn:function(e){return 0===e?0:1===e?1:1-Math.cos(e*Math.PI/2)},SineOut:function(e){return 0===e?0:1===e?1:Math.sin(e*Math.PI/2)},SineInOut:function(e){return 0===e?0:1===e?1:.5*(1-Math.cos(Math.PI*e))},ExponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},ExponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},ExponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},CircularIn:function(e){return 1-Math.sqrt(1-e*e)},CircularOut:function(e){return Math.sqrt(1- --e*e)},CircularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},BackIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},BackOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},BackInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},BounceIn:i,BounceOut:n,BounceInOut:function(e){return e<.5?.5*i(2*e):.5*n(2*e-1)+.5},ElasticIn:function(e){var t,a=.1;return 0===e?0:1===e?1:(!a||a<1?(a=1,t=.1):t=.4*Math.asin(1/a)/(2*Math.PI),-a*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},ElasticOut:function(e){var t,a=.1;return 0===e?0:1===e?1:(!a||a<1?(a=1,t=.1):t=.4*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},ElasticInOut:function(e){var t,a=.1,n=.4;return 0===e?0:1===e?1:(!a||a<1?(a=1,t=.1):t=n*Math.asin(1/a)/(2*Math.PI),(e*=2)<1?a*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*-.5:a*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",function(e){this._tweenManager.update(e)})},pc.Application.prototype.tween=function(e){return new pc.Tween(e,this._tweenManager)},pc.Entity.prototype.tween=function(e,t){var a=this._app.tween(e);return a.entity=this,this.once("destroy",a.stop,a),t&&t.element&&(a.element=t.element),a};var e=pc.Application.getApplication();e&&e.addTweenManager()}();var ObjectDetector=pc.createScript("objectDetector");ObjectDetector.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.onCollisionStart,this)},ObjectDetector.prototype.onCollisionStart=function(e){var t=e.other;t.rigidbody.teleport(t.parent.getPosition().x,t.parent.getPosition().y,t.parent.getPosition().z)};var Tutorial=pc.createScript("tutorial");Tutorial.attributes.add("tutorialPanel",{type:"entity"}),Tutorial.attributes.add("tutorialMovePanel",{type:"entity"}),Tutorial.attributes.add("tutorialMoveEnt",{type:"entity"}),Tutorial.attributes.add("factorMoveEnt",{type:"entity"}),Tutorial.attributes.add("factorPanel",{type:"entity"}),Tutorial.attributes.add("factorBar",{type:"entity"}),Tutorial.attributes.add("spawnObjects",{type:"entity"}),Tutorial.attributes.add("homeMenuBtn",{type:"entity"}),Tutorial.attributes.add("passBtn",{type:"entity"});var isFactorTutorialCompleted=!1;Tutorial.prototype.initialize=function(){Tutorial.instance=this,this.factorProgresStatus=!1,this.isMoveObjectCompleted=!1,this.isCheckMoveTutorialStatus=!1,this.isCheckFactorTutorialStatus=!1,this.tween=this.tutorialMoveEnt.tween(this.tutorialMoveEnt.getLocalPosition()).to({x:0,y:-816,z:0},1.5,pc.SineOut).loop(!0),this.factorTween=this.factorMoveEnt.tween(this.factorMoveEnt.getLocalPosition()).to({x:-160.128,y:0,z:0},1.5,pc.SineOut).loop(!0),this._element=this.factorBar.element,this._element.material=this._element.material.clone(),this.factorProgress=.12,isFactorTutorialCompleted=!1,this.passBtn.button.on("click",function(e){this.passTutorialView()},this)},Tutorial.prototype.moveObjectTutorialOnOff=function(e){e?(this.pauseAction(),this.tutorialPanel.enabled=!0,this.tutorialMovePanel.enabled=!0,this.isCheckMoveTutorialStatus=!1,this.isCheckFactorTutorialStatus=!1,this.tween.start()):(this.tween.stop(),this.continueAction(),this.tutorialPanel.enabled=!1,this.tutorialMovePanel.enabled=!1,this.isMoveObjectCompleted=!0)},Tutorial.prototype.moveFactorTutorialOnOff=function(e){e?(this.pauseAction(),this.tutorialPanel.enabled=!0,this.factorPanel.enabled=!0,this.factorProgresStatus=!0,this.factorTween.start(),isFactorTutorialCompleted=!0):(this.factorTween.stop(),this.continueAction(),this.tutorialPanel.enabled=!1,this.factorPanel.enabled=!1,isFactorTutorialCompleted=!0)},Tutorial.prototype.pauseAction=function(){this.homeMenuBtn.enabled=!1,Timer.instance.PauseTimer(),TimeBar.instance.pauseBar(),ScoreManager.instance.isPaused()},Tutorial.prototype.continueAction=function(){this.homeMenuBtn.enabled=!0,Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),ScoreManager.instance.isContinue()},Tutorial.prototype.update=function(e){this.factorProgresStatus&&(this.setProgress(this.factorProgress+.3*e),this.factorProgress>=.9&&(this.factorProgresStatus=!1))},Tutorial.prototype.setProgress=function(e){this.factorProgress=pc.math.clamp(e,0,1),this._element.material.alphaTest=1-this.factorProgress},Tutorial.prototype.shineEffect=function(){shine.tween(shine.getLocalPosition()).to({x:0,y:-98.086,z:2.524},1,pc.Linear).on("complete",function(){Tutorial.instance.scaleEffectStageOne()}).start()},Tutorial.prototype.scaleEffectStageOne=function(){currentEntity.tween(currentEntity.getLocalScale()).to(new pc.Vec3(.8,.8,.8),.2,pc.Linear).on("complete",function(){Tutorial.instance.scaleEffectStageTwo()}).start()},Tutorial.prototype.scaleEffectStageTwo=function(){shine.setLocalPosition(new pc.Vec3(-250,0,0)),currentEntity.tween(currentEntity.getLocalScale()).to(new pc.Vec3(1,1,1),.2,pc.Linear).on("complete",function(){Tutorial.instance.shineEffect()},this).start()};var PlayButton=pc.createScript("playButton");PlayButton.prototype.initialize=function(){PlayButton.instance=this,this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(1.1,1.1,1.1),.5,pc.SineOut).loop(!0).yoyo(!0).start(),this.entity.button.once("click",function(e){this.entity.button.active=!1,playExtraTime=!1,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","PlayButton:Click",1),window.famobi.showInterstitialAd({eventId:"button:main:start",callback:()=>{PlayerManager.instance.userData.gameMode=gamePlayMode.Normal,loadScene("LoadingScene",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.newPlayer&&0==isTutorialStageComplete?PreloadManager.instance.loadMiniGameAssets("DonutItem",function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{GameManager.instance.GameStart()})}):PreloadManager.instance.loadGameAssets(PlayerManager.instance.levelData.levelItem,function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.interruption&&!1===PlayerManager.instance.userData.placeMode?this.app.root.findByName("RestorePanel").enabled=!0:GameManager.instance.GameStart()})})})}})},this),progressVal=.12};var StarAnimation=pc.createScript("starAnimation");StarAnimation.attributes.add("pointA",{type:"entity",title:"Point A"}),StarAnimation.attributes.add("pointB",{type:"entity",title:"Point B"}),StarAnimation.prototype.initialize=function(){this.speed=5,this.time=0},StarAnimation.prototype.update=function(e){this.time+=e,this.time>this.speed&&(this.time-=this.speed);var t=this.time/this.speed,a=this.entity.getPosition();a.lerp(this.pointA.getPosition(),this.pointB.getPosition(),t),a.x>.93&&this.entity.destroy(),this.entity.setPosition(a)},StarAnimation.prototype.SpeedUpdate=function(){1!==this.speed&&(this.speed-=.25)},StarAnimation.prototype.SpeedReset=function(){this.speed=5};var ConfettiEffect=pc.createScript("confettiEffect"),duration=15e3,animationEnd=Date.now()+duration,defaults={startVelocity:30,spread:360,ticks:60,zIndex:0},timeLeft=animationEnd-Date.now(),conf1=null,conf2=null;ConfettiEffect.prototype.initialize=function(){ConfettiEffect.instance=this,this.entity.on("destroy",this.OnDestroy,this),this.app.on("showConfetti",this.status,this)},ConfettiEffect.prototype.createInitialVariables=function(){duration=15e3,animationEnd=Date.now()+duration,defaults={startVelocity:30,spread:360,ticks:60,zIndex:0},timeLeft=animationEnd-Date.now()},ConfettiEffect.prototype.status=function(){this.createInitialVariables(),this.StartEffect()},ConfettiEffect.prototype.StartEffect=function(){var e=setInterval(function(){if((timeLeft=animationEnd-Date.now())<=0)return clearInterval(e);var t=timeLeft/duration*50;confetti(Object.assign({},defaults,{particleCount:t,origin:{x:randomInRange(.1,.3),y:Math.random()-.2}})),confetti(Object.assign({},defaults,{particleCount:t,origin:{x:randomInRange(.7,.9),y:Math.random()-.2}}))},250)},ConfettiEffect.prototype.OnDestroy=function(){timeLeft=0,this.app.off("gameManager:updatestatus",this.status,this),this.entity.off("destroy",this.OnDestroy,this)},ConfettiEffect.prototype.DisableConfetti=function(){timeLeft=0,animationEnd=Date.now()};var MapManager=pc.createScript("mapManager");MapManager.attributes.add("LevelImages",{type:"entity",array:!0}),MapManager.attributes.add("MapTextures",{type:"asset",assetType:"sprite",array:!0}),MapManager.prototype.initialize=function(){MapManager.instance=this},MapManager.prototype.InitializeMap=function(){let e=PlayerManager.instance.getUserLevelByUserScore();for(var t=0;t<e;t++)e-1===t?(this.LevelImages[t].element.spriteAsset=this.MapTextures[1],this.rankElement=this.LevelImages[t],this.anim=this.rankElement.tween(MapManager.instance.rankElement.getLocalScale()).to(new pc.Vec3(1.1,1.1,1.1),1,pc.SineOut).loop(!0).yoyo(!0),this.anim.start(),this.rankElement.children[2].findByName("scoreTxt").element.text=PlayerManager.instance.userData.userScore):(this.LevelImages[t].element.spriteAsset=this.MapTextures[0],this.LevelImages[t].children[2].enabled=!0)};var EventsManager=pc.createScript("eventsManager");EventsManager.attributes.add("wordLetterGroup",{type:"entity"}),EventsManager.attributes.add("mathStatusBar",{type:"entity"}),EventsManager.attributes.add("mathOperator",{type:"entity"}),EventsManager.attributes.add("mathResult",{type:"entity"}),EventsManager.attributes.add("wordStatusBar",{type:"entity"}),EventsManager.attributes.add("wordTemplateLetter",{type:"entity"}),EventsManager.attributes.add("wordIcon",{type:"entity"}),EventsManager.attributes.add("gourmetStatusBar",{type:"entity"}),EventsManager.attributes.add("gourmetIconGroup",{type:"entity"}),EventsManager.attributes.add("gourmetTemplateIcon",{type:"entity"}),EventsManager.attributes.add("attentionStatusBar",{type:"entity"}),EventsManager.attributes.add("attentionMatchKeyword",{type:"entity"}),EventsManager.attributes.add("attentionIcon",{type:"entity"}),EventsManager.attributes.add("themeStatusBar",{type:"entity"}),EventsManager.attributes.add("themeTextStatusBar",{type:"entity"}),EventsManager.attributes.add("GameHomeButton",{type:"entity"}),EventsManager.attributes.add("EventsTopWall",{type:"entity"}),EventsManager.attributes.add("EventsTopWallLinkGame",{type:"entity"}),EventsManager.attributes.add("EventsTopWall_Web",{type:"entity"}),EventsManager.attributes.add("EventsTopWallLinkGame_Web",{type:"entity"}),EventsManager.attributes.add("JokerWall",{type:"entity"}),EventsManager.attributes.add("JokerWall_Web",{type:"entity"});let mathOperatorList=["addition","subtraction","multiplication","division"];var selectedWordKeys,cloneSelectedWordKeys,matchThemeAssetList=[],findByAttentionObjects=[];EventsManager.prototype.initialize=function(){this.entity.on("destroy",this.OnDestroy,this),EventsManager.instance=this},EventsManager.prototype.initMathChallange=function(){var e,t,a,n;if(this.mathStatusBar.enabled=!0,e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random()),"addition"===(a=mathOperatorList[Math.floor(4*Math.random())])||"multiplication"===a){for(;1!=this.mathChallangeCheckOperationValid(e,t,a);)e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random());n="addition"===a?e+t:e*t}else"subtraction"===a?n=Math.floor(7*Math.random())+1:"division"===a&&(n=Math.floor(4*Math.random())+2);return this.mathOperator.element.text=this.convertOperatorToCharacter(a),this.mathResult.element.text=n.toString(),[n,a]},EventsManager.prototype.initWordChallenge=function(){this.wordStatusBar.enabled=!0;var e=this.app.assets.find("WordGameData.json").resource.TiKey,t=e[Math.floor(Math.random()*e.length)],a=this.app.assets.findByTag(t)[0];for(selectedWordKeys=t.toUpperCase().split(""),cloneSelectedWordKeys=[...selectedWordKeys],i=0;i<t.length-1;i++){var n=this.wordTemplateLetter.clone();this.wordLetterGroup.addChild(n)}let o=this.wordIcon;return a.resource?(o.enabled=!0,o.element.texture=a.resource):(a.on("load",function(e){o.enabled=!0,o.element.texture=e.resource}),this.app.assets.load(a)),t},EventsManager.prototype.attentionObjectUpdateStatus=function(){var e=this.app.assets.findByTag(findByAttentionObjects[0]+"UI");let t=this.attentionIcon;e[0].resource?(t.enabled=!0,t.element.texture=e[0].resource):(e[0].on("load",function(e){t.enabled=!0,t.element.texture=e.resource}),this.app.assets.load(e[0])),this.attentionMatchKeyword.element.text=findByAttentionObjects[0]},EventsManager.prototype.initThemeChallenge2=function(){this.themeStatusBar.enabled=!0;let e=JSON.parse(GameManager.instance.eventData.matchKey).TiKey,t=e[Math.floor(Math.random()*e.length)];return this.themeTextStatusBar.element.text=t,t},EventsManager.prototype.initAttentionChallenge=function(){this.attentionStatusBar.enabled=!0,this.attentionObjectUpdateStatus()},EventsManager.prototype.initThemeChallenge=function(){this.themeStatusBar.enabled=!0,this.themeTextStatusBar.element.text=GameManager.instance.eventData.matchKey},EventsManager.prototype.mathChallangeCheckOperationValid=function(e,t,a){return e!=t&&("addition"==a?e+t>0:e*t>0)},EventsManager.prototype.wordChallengeShowMatchLetters=function(e){for(i=0;i<selectedWordKeys.length;i++)selectedWordKeys[i].toUpperCase()==e&&(this.wordLetterGroup.children[i+1].children[0].element.text=e);for(k=cloneSelectedWordKeys.length-1;k>=0;k--)cloneSelectedWordKeys[k]==e&&cloneSelectedWordKeys.splice(k,1)},EventsManager.prototype.convertOperatorToCharacter=function(e){return"addition"==e?"+":"subtraction"==e?"-":"multiplication"==e?"x":"division"==e?"/":void 0},EventsManager.prototype.changeEventsWallActive=function(e){1==e?6==GameManager.instance.eventData.eventId?pc.platform.mobile?(this.EventsTopWall.enabled=!1,this.EventsTopWallLinkGame.enabled=!0,this.JokerWall.enabled=!0,this.JokerWall_Web.enabled=!1):(this.EventsTopWall_Web.enabled=!1,this.EventsTopWallLinkGame_Web.enabled=!0,this.JokerWall.enabled=!1,this.JokerWall_Web.enabled=!0):pc.platform.mobile?(this.EventsTopWall.enabled=!0,this.EventsTopWallLinkGame.enabled=!1,this.JokerWall.enabled=!0,this.JokerWall_Web.enabled=!1):(this.EventsTopWall_Web.enabled=!0,this.EventsTopWallLinkGame_Web.enabled=!1,this.JokerWall.enabled=!1,this.JokerWall_Web.enabled=!0):(this.EventsTopWall.enabled=!1,this.EventsTopWallLinkGame.enabled=!1,this.JokerWall.enabled=!1,this.JokerWall_Web.enabled=!1)},EventsManager.prototype.OnDestroy=function(){this.entity.off("destroy",this.OnDestroy,this)};var TimeBar=pc.createScript("timeBar");TimeBar.attributes.add("ProgressBar",{type:"entity"});var timeBarTotalTime,progressVal=.12;TimeBar.prototype.initialize=function(){TimeBar.instance=this,this.progressBarState=!1,this.checkIsContinue(),this.savedProgressBar=0,this.isPaused=!1,this.element=this.ProgressBar.element,this.element.material=this.element.material.clone(),this.setProgress(.12),this.app.on("timeBar:reset",this.resetBar,this),this.app.on("timeBar:start",this.startBar,this),this.entity.on("destroy",this.OnDestroy,this)},TimeBar.prototype.setProgress=function(e){progressVal=pc.math.clamp(e,0,1),this.element.material.alphaTest=progressVal},TimeBar.prototype.update=function(e){if(this.progressBarState){this.isPaused&&(progressVal=this.savedProgressBar,this.isPaused=!1);var t=progressVal+e/timeBarTotalTime*.75;this.setProgress(t),progressVal>=1&&(progressVal=.12)}},TimeBar.prototype.blurPaused=function(){this.isPaused=!0,this.savedProgressBar=progressVal,this.progressBarState=!1},TimeBar.prototype.pauseBar=function(){this.progressBarState=!1},TimeBar.prototype.continueBar=function(){this.progressBarState=!0},TimeBar.prototype.resetBar=function(){this.progressBarState=!1,this.checkIsContinue()},TimeBar.prototype.startBar=function(e){this.checkIsContinue(),this.progressBarState=!0},TimeBar.prototype.OnDestroy=function(){this.app.off("timeBar:reset",this.resetBar,this),this.app.off("timeBar:start",this.startBar,this),this.entity.off("destroy",this.OnDestroy,this)},TimeBar.prototype.checkIsContinue=function(){if(PlayerManager.instance.userData.gameMode==gamePlayMode.Normal)if(1==(window.famobi?window.famobi.localStorage.getItem("interruption"):localStorage.getItem("interruption"))){var e="";e=window.famobi?JSON.parse(window.famobi.localStorage.getItem("extraInfo")):JSON.parse(localStorage.getItem("extraInfo")),progressVal=parseFloat(e.lastTimeBar)}else progressVal=.12;else progressVal=.12};var RestorePanel=pc.createScript("restorePanel");RestorePanel.attributes.add("YesButton",{type:"entity"}),RestorePanel.attributes.add("NoButton",{type:"entity"}),RestorePanel.attributes.add("main",{type:"entity"}),RestorePanel.prototype.initialize=function(){this.main.enabled=!1,this.YesButton.button.on("click",function(e){this.entity.enabled=!1,this.main.enabled=!0,1==playExtraTime||GameManager.instance.GameStart()},this),this.NoButton.button.on("click",function(e){clearCacheFunction(),roomObjectList=[],PlayerManager.instance.userData.roomAssets=[],PlayerManager.instance.userData.lastTimeProgressBar=null,PlayerManager.instance.userData.savedMatchedObjectCount=null,PlayerManager.instance.userData.interruption=0,PlayerManager.instance.userData.score=0,PlayerManager.instance.SavePlayerData(),userLevel=GameData.instance.getLevelData(PlayerManager.instance.userData.level),PlayerManager.instance.loadLevelData(userLevel),this.entity.enabled=!1,this.main.enabled=!0,1==playExtraTime||GameManager.instance.GameStart()},this)};var CheckVersion=pc.createScript("checkVersion");CheckVersion.attributes.add("versionNo",{type:"string"}),CheckVersion.attributes.add("versionLabel",{type:"entity"});var gameVersion="";CheckVersion.prototype.initialize=function(){gameVersion=this.versionNo},function(e,t){!function e(t,a,n,i){function o(){}function s(e){var n=a.exports.Promise,i=void 0!==n?n:t.Promise;return"function"==typeof i?new i(e):(e(o,o),null)}function r(e,t,a){return function(e,t){return t?t(e):e}(e&&null!=e[t]?e[t]:D[t],a)}function c(e){return e<0?0:Math.floor(e)}function l(e){return parseInt(e,16)}function m(e){return e.map(h)}function h(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:l(t.substring(0,2)),g:l(t.substring(2,4)),b:l(t.substring(4,6))}}function u(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function d(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function p(e,t,a,o,r){var c,l,m=t.slice(),h=e.getContext("2d"),u=s(function(t){function s(){c=l=null,h.clearRect(0,0,o.width,o.height),r(),t()}c=B.frame(function t(){!n||o.width===i.width&&o.height===i.height||(o.width=e.width=i.width,o.height=e.height=i.height),o.width||o.height||(a(e),o.width=e.width,o.height=e.height),h.clearRect(0,0,o.width,o.height),(m=m.filter(function(e){return function(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.wobble+=.1,t.velocity*=t.decay,t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+5,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble);var a=t.tick++/t.totalTicks,n=t.x+t.random*t.tiltCos,i=t.y+t.random*t.tiltSin,o=t.wobbleX+t.random*t.tiltCos,s=t.wobbleY+t.random*t.tiltSin;return e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-a)+")",e.beginPath(),"circle"===t.shape?e.ellipse?e.ellipse(t.x,t.y,Math.abs(o-n)*t.ovalScalar,Math.abs(s-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,a,n,i,o,s,r,c){
e.save(),e.translate(t,a),e.rotate(o),e.scale(n,i),e.arc(0,0,1,s,r,c),e.restore()}(e,t.x,t.y,Math.abs(o-n)*t.ovalScalar,Math.abs(s-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):(e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(i)),e.lineTo(Math.floor(o),Math.floor(s)),e.lineTo(Math.floor(n),Math.floor(t.wobbleY))),e.closePath(),e.fill(),t.tick<t.totalTicks}(h,e)})).length?c=B.frame(t):s()}),l=s});return{addFettis:function(e){return m=m.concat(e),u},canvas:e,promise:u,reset:function(){c&&B.cancel(c),l&&l()}}}function g(e,a){function n(t,a,n){for(var i,s,l,h,u,d=r(t,"particleCount",c),g=r(t,"angle",Number),y=r(t,"spread",Number),f=r(t,"startVelocity",Number),M=r(t,"decay",Number),v=r(t,"gravity",Number),b=r(t,"drift",Number),P=r(t,"colors",m),T=r(t,"ticks",Number),w=r(t,"shapes"),B=r(t,"scalar"),A=function(e){var t=r(e,"origin",Object);return t.x=r(t,"x",Number),t.y=r(t,"y",Number),t}(t),D=d,G=[],L=e.width*A.x,C=e.height*A.y;D--;)G.push((i={x:L,y:C,angle:g,spread:y,startVelocity:f,color:P[D%P.length],shape:w[(h=0,u=w.length,Math.floor(Math.random()*(u-h))+h)],ticks:T,decay:M,gravity:v,drift:b,scalar:B},s=void 0,l=void 0,s=i.angle*(Math.PI/180),l=i.spread*(Math.PI/180),{x:i.x,y:i.y,wobble:10*Math.random(),velocity:.5*i.startVelocity+Math.random()*i.startVelocity,angle2D:-s+(.5*l-Math.random()*l),tiltAngle:Math.random()*Math.PI,color:i.color,shape:i.shape,tick:0,totalTicks:i.ticks,decay:i.decay,drift:i.drift,random:Math.random()+5,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*i.gravity,ovalScalar:.6,scalar:i.scalar}));return o?o.addFettis(G):(o=p(e,G,S,a,n)).promise}function i(a){function i(){if(y){var t={getBoundingClientRect:function(){if(!l)return e.getBoundingClientRect()}};return S(t),void y.postMessage({resize:{width:t.width,height:t.height}})}d.width=d.height=null}function c(){o=null,h&&t.removeEventListener("resize",i),l&&e&&(document.body.removeChild(e),e=null,f=!1)}var m=g||r(a,"disableForReducedMotion",Boolean),u=r(a,"zIndex",Number);if(m&&M)return s(function(e){e()});l&&o?e=o.canvas:l&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(u),document.body.appendChild(e)),h&&!f&&S(e);var d={width:e.width,height:e.height};return y&&!f&&y.init(e),f=!0,y&&(e.__confetti_initialized=!0),h&&t.addEventListener("resize",i,!1),y?y.fire(a,d,c):n(a,d,c)}var o,l=!e,h=!!r(a||{},"resize"),g=r(a,"disableForReducedMotion",Boolean),y=w&&r(a||{},"useWorker")?A():null,S=l?u:d,f=!(!e||!y||!e.__confetti_initialized),M="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;return i.reset=function(){y&&y.reset(),o&&o.reset()},i}var y,S,f,M,v,b,P,T,w=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),B=(f=Math.floor(1e3/60),M={},v=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(y=function(e){var t=Math.random();return M[t]=requestAnimationFrame(function a(n){v===n||v+f-1<n?(v=n,delete M[t],e()):M[t]=requestAnimationFrame(a)}),t},S=function(e){M[e]&&cancelAnimationFrame(M[e])}):(y=function(e){return setTimeout(e,f)},S=function(e){return clearTimeout(e)}),{frame:y,cancel:S}),A=(T={},function(){if(b)return b;if(!n&&w){var t=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{b=new Worker(URL.createObjectURL(new Blob([t])))}catch(e){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("🎊 Could not load worker",e),null}!function(e){function t(t,a){e.postMessage({options:t||{},callback:a})}e.init=function(t){var a=t.transferControlToOffscreen();e.postMessage({canvas:a},[a])},e.fire=function(a,n,i){if(P)return t(a,null),P;var o=Math.random().toString(36).slice(2);return P=s(function(n){function s(t){t.data.callback===o&&(delete T[o],e.removeEventListener("message",s),P=null,i(),n())}e.addEventListener("message",s),t(a,o),T[o]=s.bind(null,{data:{callback:o}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),T)T[t](),delete T[t]}}(b)}return b}),D={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};a.exports=g(null,{useWorker:!0,resize:!0}),a.exports.create=g}(function(){return void 0!==e?e:void 0!==self?self:this||{}}(),t,!1),e.confetti=t.exports}(window,{});var CloseButtonUi=pc.createScript("closeButtonUi");CloseButtonUi.prototype.initialize=function(){this.entity.button.on("click",function(e){loadScene("Menu",{hierarchy:!0,settings:!0})},this)};var VersionNumber=pc.createScript("versionNumber");VersionNumber.prototype.initialize=function(){this.entity.element.text=gameVersion};var HomeButtonUi=pc.createScript("homeButtonUi");HomeButtonUi.attributes.add("HomeEnt",{type:"entity"}),HomeButtonUi.attributes.add("CloseBtn",{type:"entity"}),HomeButtonUi.attributes.add("ReturnMenuBtn",{type:"entity"}),HomeButtonUi.attributes.add("SpawnManagerView",{type:"entity"}),HomeButtonUi.attributes.add("shakeButton",{type:"entity"}),HomeButtonUi.attributes.add("jokerButton",{type:"entity"}),HomeButtonUi.prototype.initialize=function(){HomeButtonUi.instance=this,this.isHomeButtonIsCliked=!1,this.buttonsinit(),this.brandingImage=this.app.root.findByName("BrandingImage"),this.entity.on("destroy",function(){this.app.off("gameManager:gamePlayMode",this.Status,this)},this)},HomeButtonUi.prototype.Status=function(e){let t=null;e==gamePlayMode.Normal||e==gamePlayMode.Places?(pc.platform.mobile,this.entity.setLocalPosition(new pc.Vec3(-26.453,-128.265,0)),this.entity.children[1].enabled=!0,this.entity.children[0].enabled=!0,this.entity.element.width=140,this.entity.element.height=76,t=this.app.assets.findByTag("homeButtonGame")):e==gamePlayMode.MiniGame&&(pc.platform.mobile?this.entity.setLocalPosition(new pc.Vec3(-16.773,-128.265,0)):this.entity.setLocalPosition(new pc.Vec3(-40.453,-115,0)),this.entity.children[1].enabled=!1,this.entity.children[0].enabled=!1,this.entity.element.width=230,this.entity.element.height=187,t=this.app.assets.findByTag("homeButtonEvent")),t[0].resource?e==gamePlayMode.Normal?this.entity.element.spriteAsset=t[0]:e==gamePlayMode.MiniGame&&(this.entity.element.texture=t[0].resource):(t[0].on("load",function(e){HomeButtonUi.instance.entity.element.texture=e.resource}),this.app.assets.load(t[0]))},HomeButtonUi.prototype.showHomePanel=function(){this.SpawnManagerView.enabled=!1,Timer.instance.PauseTimer(),TimeBar.instance.pauseBar(),Touch.instance.Pause(),ScoreManager.instance.isPaused(),this.HomeEnt.enabled=!0},HomeButtonUi.prototype.buttonsinit=function(){this.entity.button.on("click",function(e){this.SpawnManagerView.enabled=!1,GameManager.instance.PauseGame(),ScoreManager.instance.isPaused(),this.HomeEnt.enabled=!0,"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(this.shakeButton.enabled=!1),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.jokerButton.enabled=!1)},this),this.CloseBtn.button.on("click",function(e){this.SpawnManagerView.enabled=!0,GameManager.instance.ResumeGame(),ScoreManager.instance.isContinue(),this.HomeEnt.enabled=!1,"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(this.shakeButton.enabled=!0),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.jokerButton.enabled=!0)},this),this.ReturnMenuBtn.button.on("click",function(e){if(0==this.isHomeButtonIsCliked){var t;if(this.isHomeButtonIsCliked=!0,PlayerManager.instance.userData.gameMode==gamePlayMode.Normal||PlayerManager.instance.userData.gameMode==gamePlayMode.Places)PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?(t={LevelName:PlayerManager.instance.levelData.levelName,UserRank:detectCurrentLevel()[0]},window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:GameManager.instance.playinglevelName,reason:"quit"})):(t={LevelName:GameManager.instance.placeData.levelName,UserRank:detectCurrentLevel()[0]},window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:GameManager.instance.playinglevelName,reason:"quit"})),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","ExitGameButton:Click",1,t);else if(PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame){let e="Attention Game"==playingMiniGameName?GameManager.instance.eventData.matchKey.toString().replaceAll(",","-"):GameManager.instance.eventData.matchKey;t={MiniGameName:playingMiniGameName,MiniGameTheme:e},GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","ExitMiniGameButton:Click",1,t),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:GameManager.instance.playinglevelName,reason:"quit"})}PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(clearCacheFunction(),PlayerManager.instance.userData.roomAssets=[...roomObjectList],PlayerManager.instance.userData.lastTimeProgressBar=progressVal,PlayerManager.instance.userData.savedMatchedObjectCount=matchObjectCounter,PlayerManager.instance.userData.interruption=1,PlayerManager.instance.SavePlayerData(),PlayerManager.instance.SaveLevelData()):(PlayerManager.instance.userData.gameMode,gamePlayMode.Places),Timer.instance.StopTimer(),ScoreManager.instance.isContinue(),loadScene("Menu",{hierarchy:!0,settings:!0})}},this)};var SafeAreaGamePlay=pc.createScript("safeAreaGamePlay");SafeAreaGamePlay.attributes.add("topWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("bottomWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("homeWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("soundWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("matchInfoWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("eventsWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("bottomRightWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("bottomLeftWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("coverLeftWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("coverRightWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("shakeButtonWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("jokerButtonWall",{type:"entity"}),SafeAreaGamePlay.attributes.add("shakeButton",{type:"entity"}),SafeAreaGamePlay.attributes.add("jokerButton",{type:"entity"}),SafeAreaGamePlay.attributes.add("topWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("bottomWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("homeWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("soundWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("matchInfoWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("eventsWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("bottomRightWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("bottomLeftWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("coverLeftWall_Web",{type:"entity"}),SafeAreaGamePlay.attributes.add("coverRightWall_Web",{type:"entity"}),SafeAreaGamePlay.prototype.initialize=function(){SafeAreaGamePlay.instance=this,this._initialHeight=this.entity.element.height,"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(this.shakeButton.enabled=!0),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.jokerButton.enabled=!0),this.safeAreaUpdate()},SafeAreaGamePlay.prototype.updateEventWall=function(){},SafeAreaGamePlay.prototype.safeAreaUpdate=function(){var e=window.innerHeight*window.devicePixelRatio;this.topPercentage=0/e;var t=0/e,a=this._initialHeight*this.topPercentage,n=this._initialHeight*t,i=this.entity.element.margin;i.y=n,i.w=a,this.entity.element.margin=i,this.topPercentage=.04932182490752158;let o=4.325*this.topPercentage-4.325;this.homeWall.rigidbody.teleport(new pc.Vec3(-2.913,0,o));let s=4.77*this.topPercentage-4.77;if(this.matchInfoWall.rigidbody.teleport(new pc.Vec3(.066,0,s)),0!=t){let e=5.387-5.387*t;this.bottomRightWall.rigidbody.teleport(new pc.Vec3(2.343,1.985,e));let a=5.407-5.407*t;this.bottomLeftWall.rigidbody.teleport(new pc.Vec3(-2.355,1.985,a)),this.shakeButton.setLocalPosition(new pc.Vec3(this.shakeButton.getLocalPosition().x,this.shakeButton.getLocalPosition().y-0,this.shakeButton.getLocalPosition().z)),this.jokerButton.setLocalPosition(new pc.Vec3(this.jokerButton.getLocalPosition().x,this.jokerButton.getLocalPosition().y-0,this.jokerButton.getLocalPosition().z))}};var PlayButtonExtraTime=pc.createScript("playButtonExtraTime");PlayButtonExtraTime.prototype.initialize=function(){PlayButtonExtraTime.instance=this,this.entity.button.once("click",function(e){playExtraTime=!0,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","PlayButtonExtraTime:Click",1),LevelLoader.instance.LoadLevel("LoadingScene","ExtraTimePlay")},this)};var ProgressStatusBar=pc.createScript("progressStatusBar");ProgressStatusBar.attributes.add("currentLevel",{type:"entity"}),ProgressStatusBar.attributes.add("nextLevel",{type:"entity"}),ProgressStatusBar.attributes.add("progressImage",{type:"entity"}),ProgressStatusBar.attributes.add("progressImageMaxWidth",{type:"number"}),ProgressStatusBar.attributes.add("NewRankLabel",{type:"entity"}),ProgressStatusBar.attributes.add("userScore",{type:"entity"}),ProgressStatusBar.prototype.initialize=function(){let e=this.app.root.findByName("MainUI");pc.platform.mobile?e.screen.scaleBlend=0:e.screen.scaleBlend=1,ProgressStatusBar.instance=this,this.updateScore()},ProgressStatusBar.prototype.updateScore=function(){let e=detectCurrentLevel();this.currentLevel.element.text=e[0].toUpperCase(),this.setProgress(e[2]),PlayerManager.instance.userData.userScore>=1e5?(this.userScore.element.text=PlayerManager.instance.userData.userScore,this.nextLevel.element.text="---"):(this.userScore.element.text=PlayerManager.instance.userData.userScore+" / "+e[3],this.nextLevel.element.text=e[1].toUpperCase()),this.checkNewRank()},ProgressStatusBar.prototype.checkNewRank=function(){let e=this.NewRankLabel;currentRankName.toUpperCase()!=this.currentLevel.element.text&&(currentRankName=this.currentLevel.element.text,this.NewRankLabel.enabled=!0,this.NewRankLabel.children[0].element.text="New rank: "+this.currentLevel.element.text+"!",this.NewRankLabel.tween(this.NewRankLabel.getLocalPosition()).to(new pc.Vec3(0,-293.728,0),2,pc.SineOut).on("complete",function(){setTimeout(function(){ProgressStatusBar.instance.newRankSlideTop(e)},2e3,this)}).start())},ProgressStatusBar.prototype.newRankSlideTop=function(e){e.tween(e.getLocalPosition()).to(new pc.Vec3(0,-212.981,0),2,pc.SineOut).on("complete",function(){e.enabled=!1}).start()},ProgressStatusBar.prototype.setProgress=function(e){e=pc.math.clamp(e,0,1),this.progress=e;var t=pc.math.lerp(0,this.progressImageMaxWidth,e);this.progressImage.element.width=t,this.progressImage.element.rect=this.progressImage.element.rect};var btnSelf,ButtonDelayEnable=pc.createScript("buttonDelayEnable");ButtonDelayEnable.prototype.initialize=function(){btnSelf=this,setTimeout(function(){btnSelf.entity.children[1].enabled=!0},2500,this)};var ExtraScoreStarAnimation=pc.createScript("extraScoreStarAnimation");ExtraScoreStarAnimation.attributes.add("pointC",{type:"entity",title:"Point C"}),ExtraScoreStarAnimation.attributes.add("type",{type:"string"}),ExtraScoreStarAnimation.prototype.initialize=function(){this.speed=5,this.time=0,this.gameScoreStarLocation=this.app.root.findByName("StarBase")},ExtraScoreStarAnimation.prototype.update=function(e){this.time+=e,this.time>this.speed&&(this.time-=this.speed);var t=this.time/this.speed,a=this.entity.getPosition();"single"==this.type?(a.lerp(this.entity.getPosition(),this.gameScoreStarLocation.getPosition(),t),a.x>=.258&&this.entity.destroy()):(a.lerp(this.entity.getPosition(),this.pointC.getPosition(),t),a.x>=.5&&this.entity.destroy()),this.entity.setPosition(a)},ExtraScoreStarAnimation.prototype.changeType=function(e){this.type=e};var MainMenuLoader=pc.createScript("mainMenuLoader");MainMenuLoader.attributes.add("NextLevelAssets",{type:"boolean",default:!0}),MainMenuLoader.attributes.add("GameIconAssets",{type:"boolean",default:!0});var downloadedImgArray=[];MainMenuLoader.prototype.initialize=function(){splashAnimStatus=!1,this.NextLevelAssets&&this.preloadNextLevelAssets(),this.GameIconAssets&&this.preloadGameIconAssets()},MainMenuLoader.prototype.preloadNextLevelAssets=function(){let e=PlayerManager.instance.userData.newPlayer?"DonutItem":PlayerManager.instance.levelData.levelItem;""!=PlayerManager.instance.levelData.levelName&&e==PlayerManager.instance.levelData.levelName||PreloadManager.instance.loadMiniGameAssets(e,function(){})},MainMenuLoader.prototype.preloadGameIconAssets=function(){for(var e=this.app.assets.findByTag("mainPreload"),t=(e.length,function(){}),a=0;a<e.length;a++)e[a].resource?t():(e[a].ready(t),this.app.assets.load(e[a]))};var CheckAdsReadyButton=pc.createScript("checkAdsReadyButton");CheckAdsReadyButton.attributes.add("buttonType",{type:"string"}),CheckAdsReadyButton.attributes.add("startExtraTimeButton",{type:"entity"}),CheckAdsReadyButton.prototype.initialize=function(){this.failExtraTimeButton=this.app.root.findByTag("levelFailedExtraTimeButton")[0]},CheckAdsReadyButton.prototype.update=function(e){"start"==this.buttonType?this.startExtraTimeButton.enabled=!0:(this.entity.button.active=!0,this.failExtraTimeButton.script.scripts[1].enabled=!0)};var BoingAnimation=pc.createScript("boingAnimation");BoingAnimation.attributes.add("scaleInValue",{type:"number"}),BoingAnimation.attributes.add("scaleOutValue",{type:"number"}),BoingAnimation.prototype.initialize=function(){BoingAnimation.instance=this,this.stage1(),this.entity.on("destroy",this.OnDestroy,this)},BoingAnimation.prototype.stage1=function(){(boingAnim=this.entity.tween(this.entity.getLocalScale()).to({x:this.scaleOutValue,y:this.scaleOutValue,z:this.scaleOutValue},.2,pc.Linear).on("complete",function(){BoingAnimation.instance.stage2()}).delay(1)).start()},BoingAnimation.prototype.stage2=function(){boingAnim=this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(this.scaleInValue,this.scaleInValue,this.scaleInValue),.2,pc.Linear).on("complete",function(){BoingAnimation.instance.stage1()}).start()},BoingAnimation.prototype.OnDestroy=function(){boingAnim.stop(),this.entity.off("destroy",this.OnDestroy,this)};var BoingAndShineAnimation=pc.createScript("boingAndShineAnimation");BoingAndShineAnimation.attributes.add("shine",{type:"entity"}),BoingAndShineAnimation.attributes.add("shineStartPosition",{type:"number"}),BoingAndShineAnimation.attributes.add("shineEndPosition",{type:"number"}),BoingAndShineAnimation.attributes.add("autoStartAnimation",{type:"boolean",default:!0}),BoingAndShineAnimation.prototype.initialize=function(){BoingAndShineAnimation.instance=this,this.autoStartAnimation&&this.stage1()},BoingAndShineAnimation.prototype.stage1=function(){this.boingAndShineTweenAnim=this.shine.tween(this.shine.getLocalPosition()).to({x:this.shineEndPosition,y:this.shine.getLocalPosition().y,z:this.shine.getLocalPosition().z},1,pc.Linear).on("complete",function(){BoingAndShineAnimation.instance.stage2()}),this.boingAndShineTweenAnim.start()},BoingAndShineAnimation.prototype.stage2=function(){this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(.8,.8,.8),.2,pc.Linear).on("complete",function(){BoingAndShineAnimation.instance.stage3()}).start()},BoingAndShineAnimation.prototype.stage3=function(){this.entity.tween(this.entity.getLocalScale()).to(new pc.Vec3(1,1,1),.2,pc.Linear).on("complete",function(){BoingAndShineAnimation.instance.stage1()}).start()},BoingAndShineAnimation.prototype.startTween=function(){this.stage1()},BoingAndShineAnimation.prototype.stopTween=function(){};var BoingTriggerAnimation=pc.createScript("boingTriggerAnimation");BoingTriggerAnimation.attributes.add("challengeType",{type:"string"}),BoingTriggerAnimation.prototype.initialize=function(){BoingTriggerAnimation.instance=this,this.delay=500,1==completeMatchStatus&&(this.delay=3500),setTimeout(function(){BoingTriggerAnimation.instance.entity.tween(BoingTriggerAnimation.instance.entity.getLocalScale()).to(new pc.Vec3(1.3,1.3,1.3),.5,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){BoingTriggerAnimation.instance.triggerChallengeButton()}).start()},this.delay,this)},BoingTriggerAnimation.prototype.triggerChallengeButton=function(){var e;"Win"==this.challengeType?e=this.app.root.findByTag("challengeWinFriendsPanel")[0]:"Lose"==this.challengeType?e=this.app.root.findByTag("challengeLoseFriendsPanel")[0]:"LoseOffer"==this.challengeType?e=this.app.root.findByTag("challengeLoseOfferFriendsPanel")[0]:"Draw"==this.challengeType?e=this.app.root.findByTag("challengeDrawFriendsPanel")[0]:"LoseExtraTime"==this.challengeType&&(e=this.app.root.findByTag("challengeLoseExtraTimePanel")[0]),e.script.scripts[0].enabled=!0};var LevelUpbanner=pc.createScript("levelUpbanner");LevelUpbanner.attributes.add("levelUpUI",{type:"entity"}),LevelUpbanner.attributes.add("levelNameTxt",{type:"entity"}),LevelUpbanner.attributes.add("gameTopBar",{type:"entity"}),LevelUpbanner.prototype.initialize=function(){LevelUpbanner.instance=this},LevelUpbanner.prototype.showUI=function(e){this.levelNameTxt.element.text=e.toUpperCase(),this.levelUpUI.enabled=!0,this.levelUpUI.tween(this.levelUpUI.getLocalPosition()).to(new pc.Vec3(0,-20,0),2,pc.SineOut).on("complete",function(){}).start()};var PerfectScoreBanner=pc.createScript("perfectScoreBanner");PerfectScoreBanner.prototype.initialize=function(){PerfectScoreBanner.instance=this,this.currentStar=this.entity.findByName("Star"),this.extraPointText=this.entity.findByName("ExtraScore"),this.entity.on("destroy",this.OnDestroy,this)},PerfectScoreBanner.prototype.isLostStatus=function(e){1==e&&setTimeout(function(){PerfectScoreBanner.instance.entity.children[1].enabled=!1},3e3,this)},PerfectScoreBanner.prototype.extraPointStartAnimation=function(){let e=this.extraPointText;this.extraPointText.tween(this.extraPointText.getLocalScale()).to(new pc.Vec3(1.3,1.3,1.3),.5,pc.SineOut).on("complete",function(){PerfectScoreBanner.instance.extraPointEffect(e)},this).start()},PerfectScoreBanner.prototype.extraPointChallengeStartAnimation=function(){let e=this.extraPointText;this.extraPointText.tween(this.extraPointText.getLocalScale()).to(new pc.Vec3(1.3,1.3,1.3),.5,pc.SineOut).on("complete",function(){PerfectScoreBanner.instance.extraPointChallengeEffect(e)},this).start()},PerfectScoreBanner.prototype.extraPointEffect=function(e){e.tween(e.getLocalScale()).to(new pc.Vec3(1,1,1),.5,pc.SineOut).on("complete",PerfectScoreBanner.instance.dropStars()).start()},PerfectScoreBanner.prototype.extraPointChallengeEffect=function(e){e.tween(e.getLocalScale()).to(new pc.Vec3(1,1,1),.5,pc.SineOut).start()},PerfectScoreBanner.prototype.dropStars=function(){let e=1,t=this.entity.children[3];setTimeout(function(){for(i=0;i<parseInt(t.element.text);i++)i%10==0&&(PerfectScoreBanner.instance.addExtraScore(e),e+=1),PerfectScoreBanner.instance.addExtraScoreText(i)},1e3,this)},PerfectScoreBanner.prototype.addExtraScore=function(e){let t=1e3/(parseInt(this.entity.children[3].element.text)/10);setTimeout(function(){let e=PerfectScoreBanner.instance.currentStar.clone();PerfectScoreBanner.instance.currentStar.parent.addChild(e),e.enabled=!0},t*e,this)},PerfectScoreBanner.prototype.addExtraScoreText=function(e){let t=1e3/parseInt(this.entity.children[3].element.text),a=this.entity.children[3],n=this.entity.children[2],i=this.app.root.findByName("WinPanelWithoutADS2").findByName("ScoreTxt"),o=this.app.root.findByName("ScoreText");setTimeout(function(){a.element.text=parseInt(a.element.text)-1,0==parseInt(a.element.text)?n.enabled=!1:n.element.text="Extra "+a.element.text+" stars!";let e=i.element.text.split("SCORE: "),t=parseInt(e[1])+1;i.element.text="SCORE: "+t,o.element.text=t},t*e,this)},PerfectScoreBanner.prototype.OnDestroy=function(){this.app.off("gameManager:updatestatus",this.Status,this),this.entity.off("destroy",this.OnDestroy,this)};var timeoutBtn,WinPanel=pc.createScript("winPanel");WinPanel.prototype.initialize=function(){var e=this;this.continueButton=this.entity.findByName("ContinueBtn"),this.scoreText=this.entity.findByName("ScoreTxt"),this.comboText=this.entity.findByName("ComboCount"),this.app.fire("showConfetti"),SoundManager.instance.playSound("WinSound"),this.entity.on("destroy",this.OnDestroy,this),this.scoreText.element.text="SCORE: "+PlayerManager.instance.userData.score.toString(),PlayerManager.instance.userData.gameMode!=gamePlayMode.MiniGame&&"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(ScoreManager.instance.maxComboCounter>0?(this.comboText.enabled=!0,this.comboText.children[1].element.text=ScoreManager.instance.maxComboCounter+"x"):this.comboText.enabled=!1),winScore=PlayerManager.instance.userData.score,this.continueButton.button.once("click",function(t){window.famobi.showInterstitialAd({eventId:"button:result:start",callback:()=>{if(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LevelEndContinueButton:Click",1),SoundManager.instance.stopSound("WinSound"),SpawnManager.instance.clearObjects(),matchObjectCounter=0,CoverManager.instance.updateMatchStatus(0,0,!1),1==completeMatchStatus&&WinAndLoseUi.instance.perfectBanner.destroy(),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame)loadScene("MiniGames",{hierarchy:!0,settings:!0});else if(PlayerManager.instance.userData.gameMode==gamePlayMode.Normal)GameManager.instance.isGameFinish?(PlayerManager.instance.userData.unlockLevel=!0,PlayerManager.instance.SavePlayerData(),loadScene("Menu",{hierarchy:!0,settings:!0})):(showPlaceModUI=!1,PlayerManager.instance.userData.score=0,levelUpStatus&&slideTop(),loadScene("LoadingScene",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.newPlayer&&0==isTutorialStageComplete?PreloadManager.instance.loadGameAssets("DonutItem",function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{GameManager.instance.GameStart()})}):PreloadManager.instance.loadGameAssets(PlayerManager.instance.levelData.levelItem,function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.interruption&&!1===PlayerManager.instance.userData.placeMode?this.app.root.findByName("RestorePanel").enabled=!0:GameManager.instance.GameStart()})})}));else if(PlayerManager.instance.userData.gameMode==gamePlayMode.Places){let t=e.scoreText.element.text.split(" ")[1];e.sendAndUpdateScore(t),loadScene("Menu",{hierarchy:!0,settings:!0})}else showPlaceModUI=!1,PlayerManager.instance.userData.score=0,levelUpStatus&&slideTop(),loadScene("LoadingScene",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.newPlayer&&0==isTutorialStageComplete?PreloadManager.instance.loadGameAssets("DonutItem",function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{GameManager.instance.GameStart()})}):PreloadManager.instance.loadGameAssets(PlayerManager.instance.levelData.levelItem,function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.interruption&&!1===PlayerManager.instance.userData.placeMode?this.app.root.findByName("RestorePanel").enabled=!0:GameManager.instance.GameStart()})})});completeMatchStatus=!1,e.entity.destroy()}})})},WinPanel.prototype.sendAndUpdateScore=function(e){var t={PlayTime:GameManager.instance.gamePlayDuration()};PlayerManager.instance.userData.userScore=parseInt(PlayerManager.instance.userData.userScore)+parseInt(e),PlayerManager.instance.SavePlayerData(),GameAnalyticsSdk.instance.gaStatus&&(GameAnalytics("addProgressionEvent","Complete","Places",GameManager.instance.placeData.levelName,detectCurrentLevel()[0],parseInt(e),t),GameAnalytics("addDesignEvent","GamePlayTime:Places:"+GameManager.instance.placeData.levelName,parseFloat(GameManager.instance.gamePlayDuration())))},WinPanel.prototype.OnDestroy=function(){this.entity.off("destroy",this.OnDestroy,this)};var MiniGamesUi=pc.createScript("miniGamesUi");MiniGamesUi.attributes.add("EventsItems",{type:"entity",array:!0}),MiniGamesUi.attributes.add("EventCloseButton",{type:"entity"}),MiniGamesUi.attributes.add("ContentLayout",{type:"entity"}),MiniGamesUi.prototype.initialize=function(){let e=this.app.root.findByName("2D Screen");pc.platform.mobile?e.screen.scaleBlend=0:e.screen.scaleBlend=1,this.checkLevelStatusForGame(),this.EventsItems[0].button.once("click",function(e){GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","MathGameButton:Click",1),this.loadMiniGameScene(1)},this),this.EventsItems[1].button.once("click",function(e){GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","AttentionGameButton:Click",1),this.loadMiniGameScene(4)},this),this.EventsItems[2].button.once("click",function(e){GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","WordGameButton:Click",1),this.loadMiniGameScene(2)},this),this.EventsItems[3].button.once("click",function(e){GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LinkGameButton:Click",1),this.loadMiniGameScene(6)},this),this.EventCloseButton.button.once("click",function(e){loadScene("Menu",{hierarchy:!0,settings:!0})},this)},MiniGamesUi.prototype.checkLevelStatusForGame=function(){"Beginner"==detectCurrentLevel()[0]?(this.EventsItems[0].button.active=!0,this.EventsItems[0].element.useInput=!0,this.EventsItems[0].children[0].children[0].enabled=!1,this.EventsItems[0].children[0].children[1].children[2].enabled=!1):"Advanced"==detectCurrentLevel()[0]?(this.EventsItems[0].button.active=!0,this.EventsItems[1].button.active=!0,this.EventsItems[0].element.useInput=!0,this.EventsItems[1].element.useInput=!0,this.EventsItems[0].children[0].children[0].enabled=!1,this.EventsItems[1].children[0].children[0].enabled=!1,this.EventsItems[0].children[0].children[1].children[2].enabled=!1,this.EventsItems[1].children[0].children[1].children[2].enabled=!1):"Competent"==detectCurrentLevel()[0]?(this.EventsItems[0].button.active=!0,this.EventsItems[1].button.active=!0,this.EventsItems[2].button.active=!0,this.EventsItems[0].element.useInput=!0,this.EventsItems[1].element.useInput=!0,this.EventsItems[2].element.useInput=!0,this.EventsItems[0].children[0].children[0].enabled=!1,this.EventsItems[1].children[0].children[0].enabled=!1,this.EventsItems[2].children[0].children[0].enabled=!1,this.EventsItems[0].children[0].children[1].children[2].enabled=!1,this.EventsItems[1].children[0].children[1].children[2].enabled=!1,this.EventsItems[2].children[0].children[1].children[2].enabled=!1):PlayerManager.instance.userData.userScore>=5e3&&(this.EventsItems[0].button.active=!0,this.EventsItems[1].button.active=!0,this.EventsItems[2].button.active=!0,this.EventsItems[3].button.active=!0,this.EventsItems[0].element.useInput=!0,this.EventsItems[1].element.useInput=!0,this.EventsItems[2].element.useInput=!0,this.EventsItems[3].element.useInput=!0,this.EventsItems[0].children[0].children[0].enabled=!1,this.EventsItems[1].children[0].children[0].enabled=!1,this.EventsItems[2].children[0].children[0].enabled=!1,this.EventsItems[3].children[0].children[0].enabled=!1,
this.EventsItems[0].children[0].children[1].children[2].enabled=!1,this.EventsItems[1].children[0].children[1].children[2].enabled=!1,this.EventsItems[2].children[0].children[1].children[2].enabled=!1,this.EventsItems[3].children[0].children[1].children[2].enabled=!1)},MiniGamesUi.prototype.loadMiniGameScene=function(e){PlayerManager.instance.userData.gameMode=gamePlayMode.MiniGame,loadScene("LoadingScene",{hierarchy:!0,settings:!0},()=>{GameManager.instance.LoadEventData(e,function(e){""!=e&&PreloadManager.instance.loadMiniGameAssets(e,function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{GameManager.instance.startMiniGame()})})})})};var extraTimeBtnShown,StartTimerAnimation=pc.createScript("startTimerAnimation");StartTimerAnimation.attributes.add("extraTimeButton",{type:"entity"}),StartTimerAnimation.attributes.add("timerText",{type:"entity"}),StartTimerAnimation.attributes.add("homeButton",{type:"entity"}),StartTimerAnimation.attributes.add("Shine",{type:"entity"}),StartTimerAnimation.attributes.add("shakeAnimationButton",{type:"entity"}),StartTimerAnimation.attributes.add("shakeAnimationTutorialImage",{type:"entity"}),StartTimerAnimation.attributes.add("jokerAnimationButton",{type:"entity"}),StartTimerAnimation.attributes.add("miniGameJokerTutorialImage",{type:"entity"});var shineAnimation,startGameSoundStatus=!0;StartTimerAnimation.prototype.initialize=function(){StartTimerAnimation.instance=this,this.entity.enabled=!1,this.timerAnim=null,this.extraTimeButtonAnim=null,this.gameMod="",this.extraTimeButton.button.on("click",function(e){ADSManager.instance.matchStartAds=!0,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LevelStartExtraTimeButton:Click",1),ADSManager.instance.OpenRewardVideo(adsEnum.Interstitial,"",function(e){e?(SoundManager.instance.stopSound("StartSound"),extraTimeBtnShown=!1,StartTimerAnimation.instance.entity.enabled=!1,StartTimerAnimation.instance.timerAnim.stop(),StartTimerAnimation.instance.extraTimeButtonAnim.stop(),SoundManager.instance.playSound("LevelStart")):GameManager.instance.PauseGame()})},this),this.app.on("gameManager:gamePlayMode",this.gameMode,this),this.app.on("startTimerEffect",this.startEffect,this),this.entity.on("destroy",this.OnDestroy,this)},StartTimerAnimation.prototype.gameMode=function(e){this.gameMod=e},StartTimerAnimation.prototype.checkRewardedAds=function(){},StartTimerAnimation.prototype.startEffect=function(){var e=3;"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(extraTimeBtnShown=!1,TimeBar.instance.setProgress(.12),this.homeButton.enabled=!1,GameManager.instance.PauseGame(),this.entity.enabled=!0,this.timerText.enabled=!0,SoundManager.instance.playSound("StartSound"),(shineAnimation=this.Shine.tween(this.Shine.getLocalPosition()).to({x:269.172,y:-13.637,z:0},1.5,pc.Linear).on("complete",function(){StartTimerAnimation.instance.Shine.setLocalPosition(new pc.Vec3(-271.456,-13.637,0))}).loop(!0)).start(),this.timerAnim=this.timerText.tween(this.timerText.getLocalScale()).to(new pc.Vec3(1,1,1),.8,pc.QuadraticInOut).on("complete",function(){--e>=0&&(StartTimerAnimation.instance.timerText.element.text=e),e>=0?(this.extraTimeButtonAnim.start(),this.timerAnim.start()):this.finishTimerAnimation()},this).yoyo(!0).repeat(2),this.extraTimeButtonAnim=this.extraTimeButton.tween(this.extraTimeButton.getLocalScale()).to(new pc.Vec3(.8,.8,.8),.8,pc.QuadraticInOut).yoyo(!0).repeat(2),this.extraTimeButtonAnim.start(),this.timerAnim.start(),setTimeout(function(){StartTimerAnimation.instance.extraTimeButton.tween(StartTimerAnimation.instance.extraTimeButton.getLocalScale()).to(new pc.Vec3(1,1,1),.8,pc.QuadraticInOut).yoyo(!0).repeat(2).start()},5,this))},StartTimerAnimation.prototype.playStartSound=function(){SoundManager.instance.playSound("LevelStart")},StartTimerAnimation.prototype.timerAnimation2=function(){this.timerTextAnimation2=this.timerText.tween(this.timerText.getLocalScale()).to(new pc.Vec3(1,1,1),.8,pc.QuadraticInOut).on("complete",function(){StartTimerAnimation.instance.timerText.element.text="1",StartTimerAnimation.instance.timerAnimation3()}).yoyo(!0).repeat(2).start(),this.extraTimeButton.tween(this.extraTimeButton.getLocalScale()).to(new pc.Vec3(1,1,1),.8,pc.QuadraticInOut).yoyo(!0).repeat(2).start()},StartTimerAnimation.prototype.timerAnimation3=function(){this.timerTextAnimation3=this.timerText.tween(this.timerText.getLocalScale()).to(new pc.Vec3(1,1,1),1,pc.QuadraticInOut).on("complete",function(){StartTimerAnimation.instance.timerText.element.text="0",StartTimerAnimation.instance.timerAnimation4()}).yoyo(!0).repeat(2).start(),this.extraTimeButton.tween(this.extraTimeButton.getLocalScale()).to(new pc.Vec3(1,1,1),.8,pc.QuadraticInOut).yoyo(!0).repeat(2).start()},StartTimerAnimation.prototype.finishTimerAnimation=function(){this.checkShakeJokerButtonTutorial(),clearInterval(StartTimerAnimation.instance.checkRewardAdsInterval),SoundManager.instance.stopSound("StartSound"),SoundManager.instance.playSound("LevelStart"),StartTimerAnimation.instance.entity.enabled=!1,StartTimerAnimation.instance.timerText.enabled=!1,StartTimerAnimation.instance.timerText.element.text="3",GameButtonController.instance.Status(this.gameMod),shineAnimation.stop(),StartTimerAnimation.instance.shakeAnimationButton.enabled=!0},StartTimerAnimation.prototype.checkShakeJokerButtonTutorial=function(){PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame?null==PlayerManager.instance.userData.jokerTutorial||"0"==PlayerManager.instance.userData.jokerTutorial||null==PlayerManager.instance.userData.jokerTutorial?StartTimerAnimation.instance.miniGameJokerTutorialImage.enabled=!0:(StartTimerAnimation.instance.miniGameJokerTutorialImage.enabled=!1,GameManager.instance.ResumeGame()):(StartTimerAnimation.instance.jokerAnimationButton.enabled=!1,null==PlayerManager.instance.userData.shakeTutorial||"0"==PlayerManager.instance.userData.shakeTutorial||null==PlayerManager.instance.userData.shakeTutorial||0==PlayerManager.instance.userData.shakeTutorial?StartTimerAnimation.instance.shakeAnimationTutorialImage.enabled=!0:(StartTimerAnimation.instance.shakeAnimationTutorialImage.enabled=!1,GameManager.instance.ResumeGame()))},StartTimerAnimation.prototype.OnDestroy=function(){this.app.off("startTimerEffect",this.startEffect,this),this.entity.off("destroy",this.OnDestroy,this)};var NewPlacesUnlockBtn=pc.createScript("newPlacesUnlockBtn");NewPlacesUnlockBtn.prototype.initialize=function(){this.entity.button.on("click",function(e){},this)};var WinAndLoseUi=pc.createScript("winAndLoseUi");WinAndLoseUi.attributes.add("GameEnt",{type:"entity"}),WinAndLoseUi.attributes.add("PanelPosition",{type:"entity"}),WinAndLoseUi.attributes.add("ExtraScorePanelPosition",{type:"entity"}),WinAndLoseUi.attributes.add("winPanelTemplate",{type:"asset",assetType:"template"}),WinAndLoseUi.attributes.add("offerPanelTemplate",{type:"asset",assetType:"template"}),WinAndLoseUi.attributes.add("losePanelTemplate",{type:"asset",assetType:"template"}),WinAndLoseUi.attributes.add("perfectScorePanelTemplate",{type:"asset",assetType:"template"});var winLoseSelf,checkOffer=!0,winScore=0;WinAndLoseUi.prototype.initialize=function(){WinAndLoseUi.instance=this,winLoseSelf=this,this.app.on("gameManager:updatestatus",this.Status,this),this.entity.on("destroy",this.OnDestroy,this)},WinAndLoseUi.prototype.showTopBar=function(){this.GameEnt.enabled=!0},WinAndLoseUi.prototype.Status=function(e){if(e===gamestatus.Win)if(Touch.instance.Pause(),checkOffer=!0,window.famobi){let e=PlayerManager.instance.userData.score;1==completeMatchStatus&&(e+=ScoreManager.instance.extraPoints()),window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"LEVELEND",result:"success",score:parseInt(e)}).then(function(){setTimeout(()=>{Promise.all([window.famobi_analytics.trackEvent("EVENT_LEVELSUCCESS",{levelName:GameManager.instance.playinglevelName}),window.famobi_analytics.trackEvent("EVENT_LEVELSCORE",{levelName:GameManager.instance.playinglevelName,levelScore:parseInt(e)}),window.famobi_analytics.trackEvent("EVENT_TOTALSCORE",{totalScore:parseInt(e)})]).then(()=>{WinAndLoseUi.instance.showPanel=WinAndLoseUi.instance.winPanelTemplate.resource.instantiate(),1==completeMatchStatus&&(1==levelUpStatus?WinAndLoseUi.instance.showPerfectScoreBanner(!1,WinAndLoseUi.instance.showPanel.children[3],WinAndLoseUi.instance.showPanel.children[7],!0,!0):WinAndLoseUi.instance.showPerfectScoreBanner(!1,WinAndLoseUi.instance.showPanel.children[3],WinAndLoseUi.instance.showPanel.children[7],!0,!1)),WinAndLoseUi.instance.PanelPosition.addChild(WinAndLoseUi.instance.showPanel)})},2e3)})}else this.showPanel=this.winPanelTemplate.resource.instantiate(),setTimeout(()=>{1==completeMatchStatus&&(1==levelUpStatus?WinAndLoseUi.instance.showPerfectScoreBanner(!1,this.showPanel.children[3],this.showPanel.children[7],!0,!0):WinAndLoseUi.instance.showPerfectScoreBanner(!1,this.showPanel.children[3],this.showPanel.children[7],!0,!1)),WinAndLoseUi.instance.PanelPosition.addChild(this.showPanel)},1250,this);else e===gamestatus.Lose&&(Touch.instance.Pause(),1==checkOffer?(this.showPanel=this.offerPanelTemplate.resource.instantiate(),WinAndLoseUi.instance.PanelPosition.addChild(this.showPanel)):window.famobi?window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"LEVELEND",result:"fail",score:parseInt(PlayerManager.instance.userData.score)}).then(function(){setTimeout(()=>{Promise.all([window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:GameManager.instance.playinglevelName,reason:"dead"}),window.famobi_analytics.trackEvent("EVENT_TOTALSCORE",{totalScore:parseInt(PlayerManager.instance.userData.score)})]).then(()=>{WinAndLoseUi.instance.showPanel=WinAndLoseUi.instance.losePanelTemplate.resource.instantiate(),checkOffer=!0,WinAndLoseUi.instance.PanelPosition.addChild(WinAndLoseUi.instance.showPanel)})},2e3)}):(WinAndLoseUi.instance.showPanel=WinAndLoseUi.instance.losePanelTemplate.resource.instantiate(),checkOffer=!0,WinAndLoseUi.instance.PanelPosition.addChild(WinAndLoseUi.instance.showPanel)))},WinAndLoseUi.prototype.showPerfectScoreBanner=function(e,t,a,n,i){WinAndLoseUi.instance.perfectBanner=this.perfectScorePanelTemplate.resource.instantiate(),WinAndLoseUi.instance.perfectBanner.script.perfectScoreBanner.isLostStatus(e),WinAndLoseUi.instance.perfectBanner.script.perfectScoreBanner.winScore=t,WinAndLoseUi.instance.perfectBanner.children[0].script.extraScoreStarAnimation.pointB=a,WinAndLoseUi.instance.perfectBanner.children[3].element.text=earnExtraPointsScore,WinAndLoseUi.instance.perfectBanner.children[2].element.text="Extra "+earnExtraPointsScore+" stars!",WinAndLoseUi.instance.ExtraScorePanelPosition.addChild(WinAndLoseUi.instance.perfectBanner),0==i?WinAndLoseUi.instance.ExtraScorePanelPosition.children[0].setLocalPosition(new pc.Vec3(0,667.87,0)):WinAndLoseUi.instance.ExtraScorePanelPosition.children[0].setLocalPosition(new pc.Vec3(0,558.668,0)),n&&PerfectScoreBanner.instance.extraPointStartAnimation()},WinAndLoseUi.prototype.OnDestroy=function(){ConfettiEffect.instance.DisableConfetti(),this.app.off("gameManager:updatestatus",this.Status,this),this.entity.off("destroy",this.OnDestroy,this)};var OfferPanel=pc.createScript("offerPanel");OfferPanel.prototype.initialize=function(){var e=this;extraTimeBtnShown=!1,this.extraTimeButton=this.entity.findByName("ContinueBtn"),this.noThanksButton=this.entity.findByName("NoThanksButton"),this.scoreText=this.entity.findByName("ScoreTxt"),this.losePanel=this.app.assets.findByTag("losePanel")[0],PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame?this.scoreText.element.text="SCORE: 0":this.scoreText.element.text="SCORE: "+PlayerManager.instance.userData.score.toString(),SoundManager.instance.playSound("LoseSound"),this.extraTimeButton.button.on("click",function(t){SoundManager.instance.stopSound("LoseSound"),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LevelEndExtraTimeButton:Click",1),startExtraTimeButton=!1,ADSManager.instance.OpenRewardVideo(adsEnum.Offer,"",function(t){t?e.entity.destroy():Touch.instance.Pause()})}),this.noThanksButton.button.once("click",function(t){if(SoundManager.instance.stopSound("LoseSound"),roomObjectList=[],Timer.instance.StopTimer(),window.famobi)window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"LEVELEND",result:"fail",score:parseInt(PlayerManager.instance.userData.score)}).then(function(){setTimeout(()=>{Promise.all([window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:GameManager.instance.getLevelName(),reason:"dead"}),window.famobi_analytics.trackEvent("EVENT_TOTALSCORE",{totalScore:parseInt(PlayerManager.instance.userData.score)})]).then(()=>{let t=e.losePanel.resource.instantiate();WinAndLoseUi.instance.PanelPosition.addChild(t),e.entity.destroy()})},2e3)});else{let t=e.losePanel.resource.instantiate();WinAndLoseUi.instance.PanelPosition.addChild(t),e.entity.destroy()}GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LevelEndNoThanksButton:Click",1)})};var LosePanel=pc.createScript("losePanel");LosePanel.prototype.initialize=function(){var e=this;this.continueButton=this.entity.findByName("ContinueBtn"),this.scoreText=this.entity.findByName("ScoreTxt"),this.restartButton=this.entity.findByName("RestartBtn"),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame?this.scoreText.element.text="SCORE: 0":this.scoreText.element.text="SCORE: "+PlayerManager.instance.userData.score.toString(),SoundManager.instance.playSound("LoseSound"),setTimeout(function(){e.continueButton&&(e.continueButton.enabled=!0)},2e3,this),this.continueButton.button.once("click",function(e){GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","LevelEndContinueButton:Click",1),SoundManager.instance.stopSound("LoseSound"),roomObjectList=[],loadScene("Menu",{hierarchy:!0,settings:!0})}),this.restartButton.button.once("click",function(e){window.famobi.showInterstitialAd({eventId:"button:result:restart",callback:()=>{PlayerManager.instance.userData.gameMode=gamePlayMode.Normal,SoundManager.instance.stopSound("LoseSound"),loadScene("LoadingScene",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.newPlayer&&0==isTutorialStageComplete?PreloadManager.instance.loadMiniGameAssets("DonutItem",function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{GameManager.instance.GameStart()})}):PreloadManager.instance.loadGameAssets(PlayerManager.instance.levelData.levelItem,function(e){e&&loadScene("Game",{hierarchy:!0,settings:!0},()=>{1==PlayerManager.instance.userData.interruption&&!1===PlayerManager.instance.userData.placeMode?this.app.root.findByName("RestorePanel").enabled=!0:GameManager.instance.GameStart()})})})}})})};var SplashLoadingBar=pc.createScript("splashLoadingBar");SplashLoadingBar.attributes.add("progressImage",{type:"entity"}),SplashLoadingBar.attributes.add("progressImageMaxWidth",{type:"number"}),SplashLoadingBar.attributes.add("progressText",{type:"entity"}),SplashLoadingBar.attributes.add("leftCover",{type:"entity"}),SplashLoadingBar.attributes.add("rightCover",{type:"entity"}),SplashLoadingBar.prototype.initialize=function(){SplashLoadingBar.instance=this,this.app.on("splashLoadingBar:loadAssets",this.preloadAssets,this),this.setProgress(.1),this.increase=!0,this.app.fire("UserData","asdasd")},SplashLoadingBar.prototype.loadTextureAsset=function(){var e=this.app.assets.findByTag("GameTexture"),t=this.progress,a=function(n){n<e.length?PreloadManager.instance.loadSingleItem(e[n],function(e){if(1==e){let e=t+n/PreloadManager.instance.getLoadingTotalAssetCount()*.8;SplashLoadingBar.instance.setProgress(e),a(n+=1)}}):SplashLoadingBar.instance.loadPreloadAssets()};a(0)},SplashLoadingBar.prototype.loadPreloadAssets=function(){var e=this.app.assets.findByTag("preload"),t=this.progress,a=function(n){n<e.length?PreloadManager.instance.loadSingleItem(e[n],function(e){if(1==e){let e=t+n/PreloadManager.instance.getLoadingTotalAssetCount()*.8;SplashLoadingBar.instance.setProgress(e),a(n+=1)}}):(SplashLoadingBar.instance.setProgress(1),window.famobi&&window.famobi.gameReady(),SplashLoadingBar.instance.app.fire("game:Ready","Menu"))};a(0)},SplashLoadingBar.prototype.setProgress=function(e){e=pc.math.clamp(e,0,1),this.progress=e;var t=pc.math.lerp(0,this.progressImageMaxWidth,e);this.progressImage.element.width=t;var a=pc.math.lerp(-212.023,-634.566,e),n=pc.math.lerp(212.023,634.566,e);this.leftCover.setLocalPosition(a,this.leftCover.getLocalPosition().y,this.leftCover.getLocalPosition().z),this.rightCover.setLocalPosition(n,this.rightCover.getLocalPosition().y,this.rightCover.getLocalPosition().z),window.famobi&&window.famobi.setPreloadProgress(Math.ceil(100*e)),this.progressText.element.text="LOADING % "+Math.ceil(100*e)};var matchTimeBtnShown,matchTimeBtnTween,matchTimeBtnShineTween,MatchThemAllAnimation=pc.createScript("matchThemAllAnimation");MatchThemAllAnimation.attributes.add("matchThemAllButton",{type:"entity"}),MatchThemAllAnimation.attributes.add("continueButton",{type:"entity"}),MatchThemAllAnimation.attributes.add("homeButton",{type:"entity"}),MatchThemAllAnimation.attributes.add("Shine",{type:"entity"}),MatchThemAllAnimation.prototype.initialize=function(){MatchThemAllAnimation.instance=this,this.entity.enabled=!1,this.checkRewardedAds(),this.matchThemAllButton.button.on("click",function(e){matchThemAllButtonClick=!0,matchTimeBtnTween.stop(),matchTimeBtnShineTween.stop(),this.entity.enabled=!1,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","WantToMatchThemAllButton:Click",1),ADSManager.instance.OpenRewardVideo(adsEnum.MatchThemAll,"",function(e){e||(matchTimeBtnTween.stop(),matchTimeBtnShineTween.stop(),MatchThemAllAnimation.instance.entity.enabled=!1,Timer.instance.StopTimer(),GameManager.instance.GameWin())})},this),this.continueButton.button.on("click",function(e){matchTimeBtnTween.stop(),matchTimeBtnShineTween.stop(),this.entity.enabled=!1,Timer.instance.levelEnding()},this),matchTimeBtnTween=this.matchThemAllButton.tween(this.matchThemAllButton.getLocalScale()).to(new pc.Vec3(1,1,1),.8,pc.QuadraticInOut).yoyo(!0).loop(!0),matchTimeBtnShineTween=this.Shine.tween(this.Shine.getLocalPosition()).to({x:521.019,y:-13.637,z:0},1.5,pc.Linear).on("complete",function(){StartTimerAnimation.instance.Shine.setLocalPosition(new pc.Vec3(-271.456,-13.637,0))}).loop(!0)},MatchThemAllAnimation.prototype.checkRewardedAds=function(){let e=this;this.checkRewardAdsInterval=setInterval(()=>{window.famobi?window.famobi.hasFeature("rewarded")&&window.famobi.hasRewardedAd()?e.matchThemAllButton.enabled=!0:e.matchThemAllButton.enabled=!1:e.matchThemAllButton.enabled=!0},500)},MatchThemAllAnimation.prototype.startAnimation=function(){"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(GameManager.instance.PauseGame(),matchThemAllButton=!1,this.homeButton.enabled=!1,this.entity.enabled=!0,matchTimeBtnTween.start(),matchTimeBtnShineTween.start())};var boingAnim,PlayButtonExtraTimeAnimation=pc.createScript("playButtonExtraTimeAnimation");PlayButtonExtraTimeAnimation.attributes.add("Shine",{type:"entity"}),PlayButtonExtraTimeAnimation.attributes.add("InviteStar",{type:"entity"}),PlayButtonExtraTimeAnimation.prototype.initialize=function(){var e=this;boingAnim=this.Shine.tween(this.Shine.getLocalPosition()).to({x:250,y:0,z:0},1,pc.Linear).on("complete",function(){e.InviteStar.tween(e.InviteStar.getLocalScale()).to(new pc.Vec3(1,1,1),.2,pc.Linear).yoyo(!0).repeat(2).start(),e.Shine.enabled=!1,e.entity.tween(e.entity.getLocalScale()).to(new pc.Vec3(.8,.8,.8),.2,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){e.Shine.setLocalPosition(new pc.Vec3(-250,0,0)),e.Shine.enabled=!0,boingAnim.start()}).start()}).yoyo(!0).start()};var CameraFrameWithinAspectRatio=pc.createScript("cameraFrameWithinAspectRatio");CameraFrameWithinAspectRatio.attributes.add("leftWall",{type:"entity"}),CameraFrameWithinAspectRatio.attributes.add("rightWall",{type:"entity"}),CameraFrameWithinAspectRatio.prototype.initialize=function(){this.newCalculateRatio(),this.entity.on("destroy",this.OnDestroy,this)},CameraFrameWithinAspectRatio.prototype.newCalculateRatio=function(){let e=(6.375/(+this.app.graphicsDevice.height/this.app.graphicsDevice.width)).toFixed(2);this.leftWall.rigidbody.teleport(new pc.Vec3(-e,this.leftWall.getLocalPosition().z,this.leftWall.getLocalPosition().y));let t=(6.375/(+this.app.graphicsDevice.height/this.app.graphicsDevice.width)).toFixed(2);this.rightWall.rigidbody.teleport(new pc.Vec3(t,this.rightWall.getLocalPosition().y,this.rightWall.getLocalPosition().z))},CameraFrameWithinAspectRatio.prototype.OnDestroy=function(){this.entity.off("destroy",this.OnDestroy,this)};let canvasRender=pc.Application.getApplication();canvasRender.autoRender=!1,window.requestAnimationFrame(renderLoop);let fps,secondsPassed=0,oldTimeStamp=0,totalSeconds=0;var shineAnim,ShineAnimation=pc.createScript("shineAnimation");ShineAnimation.attributes.add("shineStartPosition",{type:"number"}),ShineAnimation.attributes.add("shineEndPosition",{type:"number"}),ShineAnimation.prototype.initialize=function(){ShineAnimation.instance=this,(shineAnim=this.entity.tween(ShineAnimation.instance.entity.getLocalPosition()).to({x:ShineAnimation.instance.shineEndPosition,y:28.979,z:0},1.3,pc.Linear).on("complete",function(){ShineAnimation.instance.entity.setLocalPosition(new pc.Vec3(ShineAnimation.instance.shineStartPosition,28.979,0)),shineAnim.start()})).start(),this.entity.on("destroy",this.OnDestroy,this)},ShineAnimation.prototype.OnDestroy=function(){shineAnim.stop(),this.entity.off("destroy",this.OnDestroy,this)};var LoadingManager=pc.createScript("loadingManager");LoadingManager.attributes.add("progressImage",{type:"entity"}),LoadingManager.attributes.add("progressImageMaxWidth",{type:"number"}),LoadingManager.prototype.initialize=function(){let e=this.app.root.findByName("2D Screen");pc.platform.mobile?e.screen.scaleBlend=0:e.screen.scaleBlend=1,LoadingManager.instance=this},LoadingManager.prototype.setProgress=function(e){e=pc.math.clamp(e,0,1),this.progress=e;var t=pc.math.lerp(0,this.progressImageMaxWidth,e);this.progressImage.element.width=t};var refreshAnim,RefreshButton=pc.createScript("refreshButton");RefreshButton.prototype.initialize=function(){refreshAnim=this.entity.tween(this.entity.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-180),.2,pc.Linear).yoyo(!0).repeat(2)};var MapButton=pc.createScript("mapButton");MapButton.attributes.add("MapPanel",{type:"entity"}),MapButton.attributes.add("MenuPanel",{type:"entity"}),MapButton.attributes.add("CloseButton",{type:"entity"}),MapButton.prototype.initialize=function(){let e=this.app.root.findByName("MenuBackground"),t=this.app.assets.findByTag("MenuBackground")[0],a=this.app.assets.findByTag("MapBackground")[0];this.entity.button.on("click",function(){e.element.texture=a.resource,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","MapButton:Click",1),this.MapPanel.enabled=!0,this.MenuPanel.enabled=!1,MapManager.instance.InitializeMap()},this),this.CloseButton.button.on("click",function(){this.MenuPanel&&(this.MenuPanel.enabled=!0),e.element.texture=t.resource,MapManager.instance.anim.stop(),MapManager.instance.rankElement.setLocalScale(1,1,1),this.MapPanel.enabled=!1},this)};var PlacesButton=pc.createScript("placesButton");PlacesButton.attributes.add("CloseButton",{type:"entity"}),PlacesButton.attributes.add("PlacesMenu",{type:"entity"}),PlacesButton.attributes.add("Menu",{type:"entity"}),PlacesButton.prototype.initialize=function(){let e=this.app.root.findByName("MenuBackground"),t=this.app.assets.findByTag("PlacesBackground")[0],a=this.app.assets.findByTag("MenuBackground")[0];this.entity.button.on("click",function(a){e.element.texture=t.resource,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","PlacesButton:Click",1),PlaceManager.instance.initPlace(),this.PlacesMenu.enabled=!0,this.Menu.enabled=!1},this),this.CloseButton.button.on("click",function(t){e.element.texture=a.resource,this.PlacesMenu.enabled=!1,this.Menu.enabled=!0},this)};var MiniGameButton=pc.createScript("miniGameButton");MiniGameButton.prototype.initialize=function(){this.entity.button.once("click",function(e){showPlaceModUI=!1,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","MiniGamesButton:Click",1),loadScene("MiniGames",{hierarchy:!0,settings:!0})},this)};var ShakeTable=pc.createScript("shakeTable");ShakeTable.attributes.add("GameBoard",{type:"entity"}),ShakeTable.attributes.add("Rigid",{type:"entity"}),ShakeTable.attributes.add("RigidbodyNarrowBoard",{type:"entity"}),ShakeTable.attributes.add("Cover",{type:"entity"}),ShakeTable.attributes.add("CoverNarrow",{type:"entity"}),ShakeTable.attributes.add("ShakeWalls",{type:"entity"}),ShakeTable.attributes.add("ShakeWallsNarrow",{type:"entity"}),ShakeTable.attributes.add("JokerButton",{type:"entity"}),ShakeTable.prototype.initialize=function(){ShakeTable.instance=this,this.objectOnTheCover=null,window.famobi&&(this.checkRewardedAds(),window.famobi.hasFeature("rewarded")&&window.famobi.hasRewardedAd()?(this.entity.element.opacity=1,this.entity.button.active=!0):(this.entity.element.opacity=.5,this.entity.button.active=!1)),this.entity.button.on("click",function(){Timer.instance.PauseTimer(),TimeBar.instance.pauseBar(),Touch.instance.Pause(),ShakeTable.instance.entity.enabled=!1,GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","ShakeButton:Click",1),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.JokerButton.enabled=!1),null==PlayerManager.instance.userData.shakeTutorial||0==PlayerManager.instance.userData.shakeTutorial?(PlayerManager.instance.userData.shakeTutorial=!0,PlayerManager.instance.SavePlayerData(),this.entity.children[3].enabled=!1,this.shakeAnimation()):ADSManager.instance.OpenRewardVideo(adsEnum.ShakeBoard,"",function(e){e||(Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue(),ShakeTable.instance.entity.enabled=!0,ShakeTable.instance.entity.element.opacity=.5,ShakeTable.instance.entity.button.active=!1)})},this),this.entity.on("destroy",function(){clearInterval(ShakeTable.instance.checkRewardAdsInterval)},this)},ShakeTable.prototype.checkRewardedAds=function(){let e=this;this.checkRewardAdsInterval=setInterval(()=>{window.famobi.hasFeature("rewarded")&&window.famobi.hasRewardedAd()?(e.entity.element.opacity=1,e.entity.button.active=!0):(e.entity.element.opacity=.5,e.entity.button.active=!1)},2e3)},ShakeTable.prototype.shakeAnimation=function(){pc.platform.mobile?(this.Rigid.rigidbody.type=pc.BODYTYPE_KINEMATIC,ShakeTable.instance.Cover.rigidbody.enabled=!1,ShakeTable.instance.Cover.collision.enabled=!1,ShakeTable.instance.Cover.enabled=!1,ShakeTable.instance.ShakeWalls.enabled=!0):(this.RigidbodyNarrowBoard.rigidbody.type=pc.BODYTYPE_KINEMATIC,ShakeTable.instance.CoverNarrow.rigidbody.enabled=!1,ShakeTable.instance.CoverNarrow.collision.enabled=!1,ShakeTable.instance.CoverNarrow.enabled=!1,ShakeTable.instance.ShakeWallsNarrow.enabled=!0),1==spawnPositions[0].findByTag("dropped").length&&(this.objectOnTheCover=spawnPositions[0].findByTag("dropped")[0],ShakeTable.instance.shakeObjectOnTheCoverStageOne()),this.shakeStageOne()},ShakeTable.prototype.shakeStageOne=function(){ShakeTable.instance.GameBoard.tween(ShakeTable.instance.GameBoard.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-30),.15,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.GameBoard.tween(ShakeTable.instance.GameBoard.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,30),.15,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.shakeStageTwo()}).start()}).start()},ShakeTable.prototype.shakeStageTwo=function(){ShakeTable.instance.GameBoard.tween(ShakeTable.instance.GameBoard.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-30),.1,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.GameBoard.tween(ShakeTable.instance.GameBoard.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,30),.1,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.shakeStageThree()}).start()}).start()},ShakeTable.prototype.shakeStageThree=function(){ShakeTable.instance.GameBoard.tween(ShakeTable.instance.GameBoard.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-30),.05,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.GameBoard.tween(ShakeTable.instance.GameBoard.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,30),.05,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){setTimeout(()=>{ShakeTable.instance.entity.enabled=!0,PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(ShakeTable.instance.JokerButton.enabled=!0)},700,this),pc.platform.mobile?(ShakeTable.instance.Rigid.rigidbody.type=pc.BODYTYPE_STATIC,ShakeTable.instance.Cover.rigidbody.enabled=!0,ShakeTable.instance.Cover.collision.enabled=!0,ShakeTable.instance.Cover.enabled=!0,ShakeTable.instance.ShakeWalls.enabled=!1):(ShakeTable.instance.RigidbodyNarrowBoard.rigidbody.type=pc.BODYTYPE_STATIC,ShakeTable.instance.CoverNarrow.rigidbody.enabled=!0,ShakeTable.instance.CoverNarrow.collision.enabled=!0,ShakeTable.instance.CoverNarrow.enabled=!0,ShakeTable.instance.ShakeWallsNarrow.enabled=!1),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()}).start()}).start()},ShakeTable.prototype.shakeObjectOnTheCoverStageOne=function(){ShakeTable.instance.objectOnTheCover.tween(ShakeTable.instance.objectOnTheCover.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-30),.15,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.objectOnTheCover.tween(ShakeTable.instance.objectOnTheCover.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,30),.15,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.shakeObjectOnTheCoverStageTwo()}).start()}).start()},ShakeTable.prototype.shakeObjectOnTheCoverStageTwo=function(){ShakeTable.instance.objectOnTheCover.tween(ShakeTable.instance.objectOnTheCover.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-30),.1,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.objectOnTheCover.tween(ShakeTable.instance.objectOnTheCover.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,30),.1,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.shakeObjectOnTheCoverStageThree()}).start()}).start()},ShakeTable.prototype.shakeObjectOnTheCoverStageThree=function(){ShakeTable.instance.objectOnTheCover.tween(ShakeTable.instance.objectOnTheCover.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,-30),.05,pc.Linear).yoyo(!0).repeat(2).on("complete",function(){ShakeTable.instance.objectOnTheCover.tween(ShakeTable.instance.objectOnTheCover.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,30),.05,pc.Linear).yoyo(!0).repeat(2).start()}).start()};var WordMiniGameJoker=pc.createScript("wordMiniGameJoker");WordMiniGameJoker.attributes.add("cam",{type:"entity"}),WordMiniGameJoker.attributes.add("banner",{type:"entity"}),WordMiniGameJoker.attributes.add("coverPos1",{type:"entity"}),WordMiniGameJoker.attributes.add("coverPos2",{type:"entity"}),WordMiniGameJoker.attributes.add("shakeButton",{type:"entity"}),WordMiniGameJoker.prototype.initialize=function(){WordMiniGameJoker.instance=this,this.entity.button.on("click",function(e){this.jokerTutorialAnimation=!1,Timer.instance.PauseTimer(),TimeBar.instance.pauseBar(),Touch.instance.Pause(),WordMiniGameJoker.instance.entity.button.active=!1,WordMiniGameJoker.instance.shakeButton.button.active=!1,null!=PlayerManager.instance.userData.jokerTutorial&&0!=PlayerManager.instance.userData.jokerTutorial||(this.jokerTutorialAnimation=!0,PlayerManager.instance.userData.jokerTutorial=!0,PlayerManager.instance.SavePlayerData(),this.entity.children[3].enabled=!1,Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()),
"Attention Game"==playingMiniGameName?(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","JokerButtonMiniAttentionGame:Click",1),0==this.jokerTutorialAnimation?ADSManager.instance.OpenRewardVideo(adsEnum.JokerMiniAttentionGame,"",function(e){e||(Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue(),WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0)}):this.jokerAttentionGame()):"Word Game"==playingMiniGameName?(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","JokerButtonMiniWordGame:Click",1),0==this.jokerTutorialAnimation?ADSManager.instance.OpenRewardVideo(adsEnum.JokerMiniWordGame,"",function(e){e||(Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue(),WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0)}):this.jokerAction()):"Link Game"==playingMiniGameName?(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","JokerButtonMiniLinkGame:Click",1),0==this.jokerTutorialAnimation?ADSManager.instance.OpenRewardVideo(adsEnum.JokerMiniLinkGame,"",function(e){e||(Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue(),WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0)}):this.jokerLinkGame()):"Math Game"==playingMiniGameName&&(GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","JokerButtonMiniMathGame:Click",1),0==this.jokerTutorialAnimation?ADSManager.instance.OpenRewardVideo(adsEnum.JokerMiniMathGame,"",function(e){e||(Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue(),WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0)}):this.jokerMathGame())},this),this.entity.on("destroy",function(){clearInterval(ShakeTable.instance.checkRewardAdsInterval)},this)},WordMiniGameJoker.prototype.checkRewardedAds=function(){let e=this;this.checkRewardAdsInterval=setInterval(()=>{window.famobi.hasFeature("rewarded")&&window.famobi.hasRewardedAd()?(e.entity.element.opacity=1,e.entity.button.active=!0):(e.entity.element.opacity=.5,e.entity.button.active=!1)},2e3)},WordMiniGameJoker.prototype.jokerMathGame=function(){let e=null,t=null;if(spawnPositions[0].findByTag("dropped").length>=1){CoverManager.instance.eventNum1.element.text="_",CoverManager.instance.eventNum2.element.text="_";let e=spawnPositions[0].findByTag("dropped")[0];e.tags.remove("dropped"),e.rigidbody.teleport(e.parent.getPosition().x,e.parent.getPosition().y,e.parent.getPosition().z),e.rigidbody.enabled=!0}if("addition"==GameManager.instance.eventData.mathChallengeOperationKey)for(i=0;i<SpawnManager.instance.SpawnPosition.children.length;i++){let a=parseInt(SpawnManager.instance.SpawnPosition.children[i].tags.list()[1]);for(j=0;j<SpawnManager.instance.SpawnPosition.children.length;j++){let n=parseInt(SpawnManager.instance.SpawnPosition.children[j].tags.list()[1]);if(a+n==parseInt(GameManager.instance.eventData.matchKey))return e=SpawnManager.instance.SpawnPosition.children[i],t=SpawnManager.instance.SpawnPosition.children[j],CoverManager.instance.eventNum1.element.text=a,CoverManager.instance.eventNum2.element.text=n,setTimeout(()=>{CoverManager.instance.mathStatusIndicator.tween(CoverManager.instance.mathStatusIndicator.getLocalScale()).to(new pc.Vec3(1.5,1.5,1.5),.5,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){CoverManager.instance.eventNum1.element.text="_",CoverManager.instance.eventNum2.element.text="_"}).start()},700,this),e.rigidbody.enabled=!1,e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos2.getLocalPosition(),.8,pc.Linear).start(),t.rigidbody.enabled=!1,t.tween(t.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(t),.3,pc.Linear).start(),void t.tween(t.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos1.getLocalPosition(),.8,pc.Linear).on("complete",function(){setTimeout(()=>{CoverManager.instance.ObjectStageTwo(e,t),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()},300,this),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},1300,this)}).start()}}else if("subtraction"==GameManager.instance.eventData.mathChallengeOperationKey)for(i=SpawnManager.instance.SpawnPosition.children.length-1;i>=0;i--){let a=parseInt(SpawnManager.instance.SpawnPosition.children[i].tags.list()[1]);for(j=0;j<SpawnManager.instance.SpawnPosition.children.length;j++){let n=parseInt(SpawnManager.instance.SpawnPosition.children[j].tags.list()[1]);if(a-n==parseInt(GameManager.instance.eventData.matchKey))return e=SpawnManager.instance.SpawnPosition.children[i],t=SpawnManager.instance.SpawnPosition.children[j],CoverManager.instance.eventNum1.element.text=a,CoverManager.instance.eventNum2.element.text=n,setTimeout(()=>{CoverManager.instance.mathStatusIndicator.tween(CoverManager.instance.mathStatusIndicator.getLocalScale()).to(new pc.Vec3(1.5,1.5,1.5),.5,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){CoverManager.instance.eventNum1.element.text="_",CoverManager.instance.eventNum2.element.text="_"}).start()},700,this),e.rigidbody.enabled=!1,e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos2.getLocalPosition(),.8,pc.Linear).start(),t.rigidbody.enabled=!1,t.tween(t.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(t),.3,pc.Linear).start(),void t.tween(t.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos1.getLocalPosition(),.8,pc.Linear).on("complete",function(){setTimeout(()=>{CoverManager.instance.ObjectStageTwo(e,t),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()},300,this),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},1300,this)}).start()}}else if("multiplication"==GameManager.instance.eventData.mathChallengeOperationKey)for(i=0;i<SpawnManager.instance.SpawnPosition.children.length;i++){let a=parseInt(SpawnManager.instance.SpawnPosition.children[i].tags.list()[1]);for(j=0;j<SpawnManager.instance.SpawnPosition.children.length;j++){let n=parseInt(SpawnManager.instance.SpawnPosition.children[j].tags.list()[1]);if(a*n==parseInt(GameManager.instance.eventData.matchKey))return e=SpawnManager.instance.SpawnPosition.children[i],t=SpawnManager.instance.SpawnPosition.children[j],CoverManager.instance.eventNum1.element.text=a,CoverManager.instance.eventNum2.element.text=n,setTimeout(()=>{CoverManager.instance.mathStatusIndicator.tween(CoverManager.instance.mathStatusIndicator.getLocalScale()).to(new pc.Vec3(1.5,1.5,1.5),.5,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){CoverManager.instance.eventNum1.element.text="_",CoverManager.instance.eventNum2.element.text="_"}).start()},700,this),e.rigidbody.enabled=!1,e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos2.getLocalPosition(),.8,pc.Linear).start(),t.rigidbody.enabled=!1,t.tween(t.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(t),.3,pc.Linear).start(),void t.tween(t.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos1.getLocalPosition(),.8,pc.Linear).on("complete",function(){setTimeout(()=>{CoverManager.instance.ObjectStageTwo(e,t),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()},300,this),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},1300,this)}).start()}}else if("division"==GameManager.instance.eventData.mathChallengeOperationKey)for(i=SpawnManager.instance.SpawnPosition.children.length-1;i>=0;i--){let a=parseInt(SpawnManager.instance.SpawnPosition.children[i].tags.list()[1]);for(j=0;j<SpawnManager.instance.SpawnPosition.children.length;j++){let n=parseInt(SpawnManager.instance.SpawnPosition.children[j].tags.list()[1]);if(a%n==0&&a/n==parseInt(GameManager.instance.eventData.matchKey))return e=SpawnManager.instance.SpawnPosition.children[i],t=SpawnManager.instance.SpawnPosition.children[j],CoverManager.instance.eventNum1.element.text=a,CoverManager.instance.eventNum2.element.text=n,setTimeout(()=>{CoverManager.instance.mathStatusIndicator.tween(CoverManager.instance.mathStatusIndicator.getLocalScale()).to(new pc.Vec3(1.5,1.5,1.5),.5,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){CoverManager.instance.eventNum1.element.text="_",CoverManager.instance.eventNum2.element.text="_"}).start()},700,this),e.rigidbody.enabled=!1,e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos2.getLocalPosition(),.8,pc.Linear).start(),t.rigidbody.enabled=!1,t.tween(t.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(t),.3,pc.Linear).start(),void t.tween(t.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos1.getLocalPosition(),.8,pc.Linear).on("complete",function(){setTimeout(()=>{CoverManager.instance.ObjectStageTwo(e,t),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()},300,this),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},1300,this)}).start()}}},WordMiniGameJoker.prototype.jokerLinkGame=function(){let e,t,a=Math.floor(Math.random()*matchThemeAssetList.length);if(spawnPositions[0].findByTag("dropped").length>=1){let e=spawnPositions[0].findByTag("dropped")[0];e.tags.remove("dropped"),e.rigidbody.teleport(e.parent.getPosition().x,e.parent.getPosition().y,e.parent.getPosition().z),e.rigidbody.enabled=!0}for(i=0;i<SpawnManager.instance.SpawnPosition.children.length;i++)SpawnManager.instance.SpawnPosition.children[i].name==matchThemeAssetList[a].id&&(null==e?(e=SpawnManager.instance.SpawnPosition.children[i],e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos1.getLocalPosition(),.8,pc.Linear).start(),e.rigidbody.enabled=!1):null!=e&&(t=SpawnManager.instance.SpawnPosition.children[i],t.tween(t.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(t),.3,pc.Linear).start(),t.tween(t.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos2.getLocalPosition(),.8,pc.Linear).on("complete",function(){setTimeout(()=>{CoverManager.instance.ObjectStageTwo(e,t),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()},300,this),matchThemeAssetList.splice(a,1),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},1300,this)}).start(),t.rigidbody.enabled=!1))},WordMiniGameJoker.prototype.jokerAttentionGame=function(){let e,t,a=this.app.assets.findByTag(findByAttentionObjects[0]);if(spawnPositions[0].findByTag("dropped").length>=1){let e=spawnPositions[0].findByTag("dropped")[0];e.tags.remove("dropped"),e.rigidbody.teleport(e.parent.getPosition().x,e.parent.getPosition().y,e.parent.getPosition().z),e.rigidbody.enabled=!0}for(i=0;i<SpawnManager.instance.SpawnPosition.children.length;i++)SpawnManager.instance.SpawnPosition.children[i].name==a[0].id&&(null==e?(e=SpawnManager.instance.SpawnPosition.children[i],e.tween(e.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(e),.3,pc.Linear).start(),e.tween(e.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos1.getLocalPosition(),.8,pc.Linear).start(),e.rigidbody.enabled=!1):null!=e&&(t=SpawnManager.instance.SpawnPosition.children[i],t.tween(t.getLocalEulerAngles()).rotate(CoverManager.instance.GetRotate(t),.3,pc.Linear).start(),t.tween(t.getLocalPosition()).to(WordMiniGameJoker.instance.coverPos2.getLocalPosition(),.8,pc.Linear).on("complete",function(){setTimeout(()=>{CoverManager.instance.ObjectStageTwo(e,t),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()},300,this),findByAttentionObjects.shift(),findByAttentionObjects.length>0&&EventsManager.instance.attentionObjectUpdateStatus(),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},1300,this)}).start(),t.rigidbody.enabled=!1))},WordMiniGameJoker.prototype.jokerAction=function(){this.cam.camera.screenToWorld(this.banner.getLocalPosition().x,this.banner.getLocalPosition().y,this.cam.camera.nearClip);var e=window.innerHeight-this.banner.getLocalPosition().y,t=this.banner.getLocalPosition().x;this.cam.camera.screenToWorld(t,e,this.cam.camera.nearClip);let a,n,o=Math.floor(Math.random()*cloneSelectedWordKeys.length),s=cloneSelectedWordKeys[o];for(i=0;i<SpawnManager.instance.SpawnPosition.children.length;i++)SpawnManager.instance.SpawnPosition.children[i].tags.list()[1]===s&&(null==a?(a=SpawnManager.instance.SpawnPosition.children[i],a.tween(a.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,0),.3,pc.Linear).yoyo(!0).on("complete",function(){a.tween(a.getLocalPosition()).to(new pc.Vec3(0,5,0),1,pc.Linear).yoyo(!0).start()}).start()):null!=a&&(n=SpawnManager.instance.SpawnPosition.children[i],n.tween(n.getLocalEulerAngles()).rotate(new pc.Vec3(0,0,0),.3,pc.Linear).yoyo(!0).on("complete",function(){n.tween(n.getLocalPosition()).to(new pc.Vec3(0,5,0),1,pc.SineOut).yoyo(!0).on("complete",function(){a.destroy(),n.tween(n.getLocalPosition()).to(new pc.Vec3(1,0,-3.5),.5,pc.SineOut).yoyo(!0).on("complete",function(){EventsManager.instance.wordChallengeShowMatchLetters(s),CoverManager.instance.ObjectCounter(),Timer.instance.ContinueTimer(),TimeBar.instance.continueBar(),Touch.instance.Continue()}).start(),n.tween(n.getLocalScale()).to(new pc.Vec3(.2,.2,.2),.5,pc.SineOut).yoyo(!0).on("complete",function(){n.destroy(),setTimeout(()=>{WordMiniGameJoker.instance.entity.button.active=!0,WordMiniGameJoker.instance.shakeButton.button.active=!0},500,this)}).start()}).start()}).start()))};var ShakeTutorialAnimation=pc.createScript("shakeTutorialAnimation");ShakeTutorialAnimation.prototype.initialize=function(){this.entity.tween(this.entity.getLocalEulerAngles()).rotate(new pc.Vec3(25,0,0),.4,pc.Linear).loop(!0).yoyo(!0).start()};var GameAnalyticsSdk=pc.createScript("gameAnalyticsSdk");GameAnalyticsSdk.prototype.initialize=function(){GameAnalyticsSdk.instance=this,this.gaStatus=!1},GameAnalyticsSdk.prototype.configureGameAnalytics=function(){this.gaStatus=!0,GameAnalytics("setEnabledInfoLog",!0),GameAnalytics("setEnabledVerboseLog",!0),GameAnalytics("configureBuild","v1.2.7"),GameAnalytics("initialize","7f6442d22813bc078ec4b93cee700d15","5049f191ec6db2ed0bc3627ec2d2ac34c7e17337")};var PlayerManager=pc.createScript("playerManager");PlayerManager.prototype.initialize=function(){PlayerManager.instance=this,this.userData=new UserData,this.levelData=new LevelData,this.app.on("UserData",this.GetUserData,this)},PlayerManager.prototype.GetUserData=async function(){var e="";null==(e=window.famobi?window.famobi.localStorage.getItem("PairUp:isNewUser"):localStorage.getItem("PairUp:isNewUser"))||""==e||0==e?(playerData=new UserData,window.famobi?(window.famobi.localStorage.setItem("PairUp:isNewUser",!1),window.famobi.localStorage.setItem("PairUp:PlayerData",JSON.stringify(this.userData))):(localStorage.setItem("PairUp:isNewUser",!1),localStorage.setItem("PairUp:PlayerData",JSON.stringify(this.userData)))):window.famobi?playerData=JSON.parse(window.famobi.localStorage.getItem("PairUp:PlayerData")):playerData=JSON.parse(localStorage.getItem("PairUp:PlayerData")),this.loadUserData(playerData),currentRankName=detectCurrentLevel()[0],SplashLoadingBar.instance.setProgress(.2),this.GetUserLevel("initialization",!0,function(e){})},PlayerManager.prototype.GetUserLevel=async function(e){var t="";"updateLevel"==e?(t=GameData.instance.getLevelData(this.userData.level),this.loadLevelData(t),GameManager.instance.CheckNewLevel(t.levelRoom)):"initialization"==e&&(t=GameData.instance.getLevelData(playerData.level),this.loadLevelData(t),SplashLoadingBar.instance.loadTextureAsset())},PlayerManager.prototype.loadUserData=function(e){this.userData.level=e.level,this.userData.score=e.score,this.userData.userScore=e.userScore,this.userData.unlockLevel=e.unlockLevel,this.userData.newPlayer=e.newPlayer,this.userData.unlockFriends=e.unlockFriends,this.userData.shakeTutorial=e.shakeTutorial,this.userData.jokerTutorial=e.jokerTutorial,this.userData.interruption=e.interruption,this.userData.roomAssets=e.roomAssets,this.userData.lastTimeProgressBar=e.lastTimeProgressBar,this.userData.savedMatchedObjectCount=e.savedMatchedObjectCount,this.userData.gameSound=e.gameSound,shakeAnimationIsComplete=e.shakeTutorial,jokerAnimationIsComplete=e.jokerTutorial,unlockFriendsCount=e.unlockFriends},PlayerManager.prototype.loadLevelData=function(e){0==this.userData.newPlayer?(this.levelData.levelID=e.levelID,this.levelData.levelName=e.levelName,this.levelData.levelItem=e.levelItem,this.levelData.objectCount=e.objectCount,this.levelData.time=e.time,this.levelData.levelTemplate=e.levelTemplate,this.levelData.levelRoom=e.levelRoom,this.levelData.minObjectCount=e.objectCount,console.log("SAVE LOADED")):this.loadTutorialData()},PlayerManager.prototype.loadTutorialData=function(){this.levelData.levelID=0,this.levelData.levelName="Donut Shop",this.levelData.levelItem="DonutItem",this.levelData.objectCount=3,this.levelData.time=30,this.levelData.levelTemplate="DonutShop",this.levelData.levelRoom="DonutShop",this.levelData.minObjectCount=3},PlayerManager.prototype.SavePlayerData=function(){window.famobi?(this.userData.gameSound?window.famobi.localStorage.setItem("muted",!0):window.famobi.localStorage.removeItem("muted"),window.famobi.localStorage.setItem("PairUp:PlayerData",JSON.stringify(this.userData)),playerData=JSON.parse(window.famobi.localStorage.getItem("PairUp:PlayerData"))):(localStorage.setItem("PairUp:PlayerData",JSON.stringify(this.userData)),playerData=JSON.parse(localStorage.getItem("PairUp:PlayerData")))},PlayerManager.prototype.SaveLevelData=function(){this.createdLevelData=new LevelData,this.createdLevelData.levelID=this.levelData.levelID,this.createdLevelData.levelName=this.levelData.levelName,this.createdLevelData.levelItem=this.levelData.levelItem,this.createdLevelData.objectCount=spawnPositions[0].children.length/2,this.createdLevelData.time=_remainTime,this.createdLevelData.levelTemplate=this.levelData.levelTemplate,this.createdLevelData.minObjectCount=this.levelData.minObjectCount,window.famobi?window.famobi.localStorage.setItem("backupLevelData",JSON.stringify(this.createdLevelData)):localStorage.setItem("backupLevelData",JSON.stringify(this.createdLevelData))},PlayerManager.prototype.getUserLevelByUserScore=function(){let e=this.userData.userScore;return e>=1e5?8:e>=5e4?7:e>=1e4?6:e>=5e3?5:e>=1e3?4:e>=500?3:e>=100?2:e>=0?1:void 0},PlayerManager.prototype.spawnObjectCountByUserScore=function(e){let t;return t=null!=e?e:this.userData.userScore,t>=1e5?40:t>=5e4?35:t>=1e4?30:t>=5e3?28:t>=1e3?26:t>=500?24:t>=100?22:t>=0?20:void 0};var app=pc.Application.getApplication(),completeMatchStatus=!1,spawnAssetRandomIndexes=[],isTutorialStageComplete=!1,playingMiniGameName="",playExtraTime=!1,timer=0,_remainTime=0,matchObjectCounter=0,spawnPositions="",matchThemAllButtonClick=!1,showPlaceModUI=!1,gamePlayStatus="";const gamestatus={Wait:1,Play:2,Win:3,Lose:4,OfferPlay:5,Quit:6,Resume:7,Pause:8},gamePlayMode={Tutorial:0,Normal:1,Places:2,MiniGame:3},adsEnum={Interstitial:0,Offer:1,ChallengeOffer:2,ChallengeExtraTime:3,MatchThemAll:4,ShakeBoard:5,JokerMiniWordGame:6,JokerMiniAttentionGame:7,JokerMiniLinkGame:8,JokerMiniMathGame:9},adsGameFinishEnum={Lose:0,Win:1,CompleteMatch:2};let status=gamestatus.Wait;var UserData=function(){this.level=0,this.score=0,this.userScore=0,this.newPlayer=!0,this.placeMode=!1,this.unlockLevel=!1,this.unlockFriends=0,this.shakeTutorial=!1,this.jokerTutorial=!1,this.interruption=0,this.roomAssets=[],this.lastTimeProgressBar=null,this.savedMatchedObjectCount=null,this.gameMode=gamePlayMode.Normal,this.gameSound=!0},DefaultUserData=function(){this.level=0,this.score=0,this.levelID=1,this.unlockFriends=0,this.allLevelUnlock=!1,this.newPlayer=!0,this.shakeTutorial=!1,this.jokerTutorial=!1,this.interruption=0,this.roomAssets=[],this.lastTimeProgressBar=null,this.savedMatchedObjectCount=null},Cloud=function(){this.gameVersion="v1.2.8",this.shakeTutorial=!1,this.jokerTutorial=!1,this.interruption=0,this.backupData=new BackupDataInfo},ExtraInfo=function(){this.roomAssets=[],this.lastTimeProgressBar=null,this.savedMatchedObjectCount=null},BackupDataInfo=function(){this.levelData=new LevelData,this.extraInfo=new ExtraInfo},LevelData=function(){this.levelID=0,this.levelName=null,this.levelItem=null,this.objectCount=null,this.time=null,this.levelTemplate=null,this.levelRoom=null,this.minObjectCount=0},PlaceData=function(){this.levelID=0,this.levelName=null,this.levelItem=null,this.objectCount=0,this.time=0,this.levelTemplate=null,this.levelRoom=null,this.minObjectCount=0},EventData=function(){this.eventId=0,this.eventName=null,this.objectCount=null,this.time=0,this.assetName=null,this.assetTag=null,this.matchKey=null,this.spawnedArrayList="",this.mathChallengeOperationKey=null},GameUi=pc.createScript("gameUi");GameUi.attributes.add("homeButton",{type:"entity"}),GameUi.attributes.add("jokerButton",{type:"entity"}),GameUi.attributes.add("shakeButton",{type:"entity"}),GameUi.attributes.add("levelLabel",{type:"entity"}),GameUi.attributes.add("gameVersion",{type:"entity"}),GameUi.prototype.initialize=function(){GameUi.instance=this,this.app.on("gameManager:gamePlayMode",this.Status,this),this.app.on("gameManager:updatestatus",this.gameUpdateStatus,this),this.entity.on("destroy",function(){this.app.off("gameManager:gamePlayMode",this.Status,this)},this)},GameUi.prototype.showHideHomeButton=function(e){this.homeButton.enabled=e},GameUi.prototype.showHideJokerButton=function(e){this.jokerButton.enabled=e},GameUi.prototype.showHideShakeButton=function(e){this.shakeButton.enabled=e},GameUi.prototype.showLevelName=function(e){this.levelLabel.element.text=e},GameUi.prototype.Status=function(e){e==gamePlayMode.Normal?this.levelLabel.element.text=PlayerManager.instance.levelData.levelName:e==gamePlayMode.Places?this.levelLabel.element.text=GameManager.instance.placeData.levelName:e==gamePlayMode.MiniGame&&(this.levelLabel.element.text=GameManager.instance.eventData.eventName)},GameUi.prototype.gameUpdateStatus=function(e){e===gamestatus.Lose||e===gamestatus.Quit||e===gamestatus.Win?this.showHideShakeButton(!1):e!==gamestatus.Play&&e!==gamestatus.OfferPlay&&e!==gamestatus.Resume||(1==PlayerManager.instance.userData.newPlayer?this.showHideShakeButton(!1):this.showHideShakeButton(!0))};var SoundManager=pc.createScript("soundManager");SoundManager.prototype.initialize=function(){SoundManager.instance=this,window.famobi_onPauseRequested=function(){SoundManager.instance.entity.sound.pause()},window.famobi_onResumeRequested=function(){SoundManager.instance.entity.sound.resume()}},SoundManager.prototype.playSound=function(e){PlayerManager.instance.userData.gameSound&&this.entity.sound.play(e)},SoundManager.prototype.stopSound=function(e){PlayerManager.instance.userData.gameSound&&this.entity.sound.stop(e)};var GameSoundButton=pc.createScript("gameSoundButton");window.famobi.onRequest("enableAudio",function(){window.dirtyMute=!1,PlayerManager.instance.userData.gameSound=!0}),window.famobi.onRequest("disableAudio",function(){window.dirtyMute=!0,PlayerManager.instance.userData.gameSound=!1}),window.famobi.onRequest("pauseGameplay",function(){window.dirtyPause=!0,window.onblur()}),window.famobi.onRequest("resumeGameplay",function(){window.dirtyPause=!1,window.onfocus()}),GameSoundButton.attributes.add("muteOn",{type:"asset",assetType:"texture"}),GameSoundButton.attributes.add("muteOff",{type:"asset",assetType:"texture"}),GameSoundButton.attributes.add("parentStatus",{type:"string"}),GameSoundButton.prototype.initialize=function(){GameSoundButton.prototype.soundOff=function(){window.dirtyMute||(PlayerManager.instance.userData.gameSound=!1,"parent"==GameSoundButton.instance.parentStatus?GameSoundButton.instance.entity.element.texture=this.muteOn.resource:GameSoundButton.instance.entity.children[0].element.texture=this.muteOn.resource)},GameSoundButton.prototype.soundOn=function(){window.dirtyMute||(PlayerManager.instance.userData.gameSound=!0,"parent"==GameSoundButton.instance.parentStatus?GameSoundButton.instance.entity.element.texture=this.muteOff.resource:GameSoundButton.instance.entity.children[0].element.texture=this.muteOff.resource)},GameSoundButton.instance=this,1==PlayerManager.instance.userData.gameSound?"parent"==GameSoundButton.instance.parentStatus?GameSoundButton.instance.entity.element.texture=this.muteOff.resource:GameSoundButton.instance.entity.children[0].element.texture=this.muteOff.resource:"parent"==GameSoundButton.instance.parentStatus?this.entity.element.texture=this.muteOn.resource:GameSoundButton.instance.entity.children[0].element.texture=this.muteOn.resource,this.entity.button.on("click",function(){PlayerManager.instance.userData.gameSound?this.soundOff():this.soundOn(),PlayerManager.instance.SavePlayerData()},this)},pc.script.createLoadingScreen(function(e){var t,a;hideSplash=function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)},t=["body {","    background-color: #000;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #000;","}","","#application-splash {","    position: absolute;","    top: calc(50% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","","#application-splash img {","    width: 100%;","}","","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 7px;","    border-radius: 60px 60px 60px 60px;","    width: 100%;","    background-color: #1d292c;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    border-radius: 60px 60px 60px 60px;","    background-color: #b60000;","}","","#progress-text {","width : 100%;","height : 100%;","color: #ffffff;","margin-top : 100;","text-align : center;","}","","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("div");a.id="progress-bar-container",t.appendChild(a);var n=document.createElement("div");n.id="progress-bar",a.appendChild(n);var i=document.createElement("h1");i.id="progress-text",a.appendChild(i)}(),e.on("preload:end",function(){e.off("preload:progress")}),e.on("preload:progress",function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%"),document.getElementById("progress-text")&&(e=Math.min(1,Math.max(0,e)),document.getElementById("progress-text").innerHTML=100*+e.toFixed(2)+"%")}),e.on("start",hideSplash)});var BrandingImageFamobi=pc.createScript("brandingImageFamobi");BrandingImageFamobi.prototype.initialize=function(){let e=this.entity.findByName("BrandingImage");if(window.famobi){e.enabled=!0;let a=window.famobi.getBrandingButtonImage([!0]);this.app.loader.getHandler("texture").crossOrigin="anonymous";var t=new pc.Asset("myTexture","texture",{url:a});this.app.assets.add(t),t.on("load",function(t){e.element.texture=t.resource}),this.app.assets.load(t),e.button.on("click",function(){window.famobi.openBrandingLink()},this)}else e.enabled=!1};var HomeButtonPanel=pc.createScript("homeButtonPanel");HomeButtonPanel.attributes.add("HomeEnt",{type:"entity"}),HomeButtonPanel.attributes.add("CloseBtn",{type:"entity"}),HomeButtonPanel.attributes.add("ReturnMenuBtn",{type:"entity"}),HomeButtonPanel.attributes.add("SpawnManagerView",{type:"entity"}),HomeButtonPanel.attributes.add("shakeButton",{type:"entity"}),HomeButtonPanel.attributes.add("jokerButton",{type:"entity"}),HomeButtonPanel.attributes.add("gameHomeButton",{type:"entity"}),HomeButtonPanel.attributes.add("gameSoundButton",{type:"entity"}),HomeButtonPanel.attributes.add("miniGameHomeButton",{type:"entity"}),HomeButtonPanel.attributes.add("miniGameSoundButton",{type:"entity"}),HomeButtonPanel.prototype.initialize=function(){HomeButtonPanel.instance=this,this.isHomeButtonIsCliked=!1,this.buttonsinit(),this.brandingImage=this.app.root.findByName("BrandingImage"),this.app.on("gameManager:gamePlayMode",this.Status,this),this.entity.on("destroy",function(){this.app.off("gameManager:gamePlayMode",this.Status,this)},this)},HomeButtonUi.prototype.Status=function(e){let t=null;e==gamePlayMode.Normal||e==gamePlayMode.Places?this.gameHomeButton.setLocalPosition(new pc.Vec3(-26.453,-128.265,0)):e==gamePlayMode.MiniGame&&(pc.platform.mobile?this.entity.setLocalPosition(new pc.Vec3(-16.773,-128.265,0)):this.entity.setLocalPosition(new pc.Vec3(-40.453,-115,0)),this.entity.children[1].enabled=!1,this.entity.children[0].enabled=!1,this.entity.element.width=230,this.entity.element.height=187,t=this.app.assets.findByTag("homeButtonEvent")),t[0].resource?e==gamePlayMode.Normal?this.entity.element.spriteAsset=t[0]:e==gamePlayMode.MiniGame&&(this.entity.element.texture=t[0].resource):(t[0].on("load",function(e){HomeButtonUi.instance.entity.element.texture=e.resource}),this.app.assets.load(t[0]))},HomeButtonPanel.prototype.update=function(e){};var GameButtonController=pc.createScript("gameButtonController");GameButtonController.attributes.add("HomeEnt",{type:"entity"}),GameButtonController.attributes.add("CloseBtn",{type:"entity"}),GameButtonController.attributes.add("ReturnMenuBtn",{type:"entity"}),GameButtonController.attributes.add("SpawnManagerView",{type:"entity"}),GameButtonController.attributes.add("shakeButton",{type:"entity"}),GameButtonController.attributes.add("jokerButton",{type:"entity"}),GameButtonController.attributes.add("gameHomeButton",{type:"entity"}),GameButtonController.attributes.add("gameSoundButton",{type:"entity"}),GameButtonController.attributes.add("miniGameHomeButton",{type:"entity"}),GameButtonController.attributes.add("miniGameSoundButton",{type:"entity"}),GameButtonController.prototype.initialize=function(){GameButtonController.instance=this,this.isHomeButtonIsCliked=!1,this.buttonsinit(),this.brandingImage=this.app.root.findByName("BrandingImage"),this.entity.on("destroy",function(){this.app.off("gameManager:gamePlayMode",this.Status,this)},this)},GameButtonController.prototype.Status=function(e){e==gamePlayMode.Normal||e==gamePlayMode.Places?(this.gameHomeButton.enabled=!0,window.famobi.hasFeature("external_mute")?this.gameSoundButton.enabled=!1:this.gameSoundButton.enabled=!0,this.miniGameHomeButton.enabled=!1,this.miniGameSoundButton.enabled=!1):e==gamePlayMode.MiniGame&&(6==GameManager.instance.eventData.eventId?(this.miniGameHomeButton.setLocalPosition(new pc.Vec3(this.miniGameHomeButton.getLocalPosition().x,-176.106,this.miniGameHomeButton.getLocalPosition().z)),
this.miniGameSoundButton.setLocalPosition(new pc.Vec3(this.miniGameSoundButton.getLocalPosition().x,-255.468,this.miniGameSoundButton.getLocalPosition().z))):(this.miniGameHomeButton.setLocalPosition(new pc.Vec3(this.miniGameHomeButton.getLocalPosition().x,-128.265,this.miniGameHomeButton.getLocalPosition().z)),this.miniGameSoundButton.setLocalPosition(new pc.Vec3(this.miniGameSoundButton.getLocalPosition().x,-202.311,this.miniGameSoundButton.getLocalPosition().z))),this.gameHomeButton.enabled=!1,this.gameSoundButton.enabled=!1,this.miniGameHomeButton.enabled=!0,window.famobi.hasFeature("external_mute")?this.miniGameSoundButton.enabled=!1:this.miniGameSoundButton.enabled=!0)},GameButtonController.prototype.showHomePanel=function(){this.SpawnManagerView.enabled=!1,Timer.instance.PauseTimer(),TimeBar.instance.pauseBar(),Touch.instance.Pause(),ScoreManager.instance.isPaused(),this.HomeEnt.enabled=!0},GameButtonController.prototype.homeButtonClickEvent=function(){this.SpawnManagerView.enabled=!1,GameManager.instance.PauseGame(),ScoreManager.instance.isPaused(),this.HomeEnt.enabled=!0,"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(this.shakeButton.enabled=!1),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.jokerButton.enabled=!1)},GameButtonController.prototype.noButtonEvent=function(){this.SpawnManagerView.enabled=!0,GameManager.instance.ResumeGame(),ScoreManager.instance.isContinue(),this.HomeEnt.enabled=!1,"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(this.shakeButton.enabled=!0),PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame&&(this.jokerButton.enabled=!0)},GameButtonController.prototype.yesButtonEvent=function(){0==this.isHomeButtonIsCliked&&window.famobi.showInterstitialAd({eventId:"button:level:quit",callback:()=>{var e;if(this.isHomeButtonIsCliked=!0,PlayerManager.instance.userData.gameMode==gamePlayMode.Normal||PlayerManager.instance.userData.gameMode==gamePlayMode.Places)PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?(e={LevelName:PlayerManager.instance.levelData.levelName,UserRank:detectCurrentLevel()[0]},window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:PlayerManager.instance.levelData.levelName,reason:"quit"})):(e={LevelName:GameManager.instance.placeData.levelName,UserRank:detectCurrentLevel()[0]},window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:GameManager.instance.placeData.levelName,reason:"quit"})),GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","ExitGameButton:Click",1,e);else if(PlayerManager.instance.userData.gameMode==gamePlayMode.MiniGame){let t="Attention Game"==playingMiniGameName?GameManager.instance.eventData.matchKey.toString().replaceAll(",","-"):GameManager.instance.eventData.matchKey;e={MiniGameName:playingMiniGameName,MiniGameTheme:t},GameAnalyticsSdk.instance.gaStatus&&GameAnalytics("addDesignEvent","ExitMiniGameButton:Click",1,e),window.famobi_analytics&&window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:playingMiniGameName,reason:"quit"})}PlayerManager.instance.userData.gameMode==gamePlayMode.Normal?"Donut Shop"!=PlayerManager.instance.levelData.levelName&&(clearCacheFunction(),PlayerManager.instance.userData.roomAssets=[...roomObjectList],PlayerManager.instance.userData.lastTimeProgressBar=progressVal,PlayerManager.instance.userData.savedMatchedObjectCount=matchObjectCounter,PlayerManager.instance.userData.interruption=1,PlayerManager.instance.SavePlayerData(),PlayerManager.instance.SaveLevelData()):(PlayerManager.instance.userData.gameMode,gamePlayMode.Places),Timer.instance.StopTimer(),ScoreManager.instance.isContinue(),loadScene("Menu",{hierarchy:!0,settings:!0})}})},GameButtonController.prototype.buttonsinit=function(){this.gameHomeButton.button.on("click",function(e){GameButtonController.instance.homeButtonClickEvent()},this),this.miniGameHomeButton.button.on("click",function(e){GameButtonController.instance.homeButtonClickEvent()},this),this.CloseBtn.button.on("click",function(e){GameButtonController.instance.noButtonEvent()},this),this.ReturnMenuBtn.button.on("click",function(e){GameButtonController.instance.yesButtonEvent()},this)},window.famobi.hasFeature("external_mute")&&(pc.app.root.findByName("GameSoundButton").enabled=!1)&&(pc.app.root.findByName("miniGameSoundButton").enabled=!1);